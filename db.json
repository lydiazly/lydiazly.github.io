{"meta":{"version":1,"warehouse":"4.0.1"},"models":{"Asset":[{"_id":"node_modules/hexo-theme-next/source/css/main.styl","path":"css/main.styl","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/css/noscript.styl","path":"css/noscript.styl","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/bookmark.js","path":"js/bookmark.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/comments-buttons.js","path":"js/comments-buttons.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/comments.js","path":"js/comments.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/config.js","path":"js/config.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/motion.js","path":"js/motion.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/next-boot.js","path":"js/next-boot.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/pjax.js","path":"js/pjax.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/schedule.js","path":"js/schedule.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/utils.js","path":"js/utils.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/images/apple-touch-icon-next.png","path":"images/apple-touch-icon-next.png","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/images/avatar.gif","path":"images/avatar.gif","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/images/favicon-16x16-next.png","path":"images/favicon-16x16-next.png","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/images/favicon-32x32-next.png","path":"images/favicon-32x32-next.png","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/images/logo-algolia-nebula-blue-full.svg","path":"images/logo-algolia-nebula-blue-full.svg","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/images/logo.svg","path":"images/logo.svg","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/schemes/muse.js","path":"js/schemes/muse.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/third-party/fancybox.js","path":"js/third-party/fancybox.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/third-party/pace.js","path":"js/third-party/pace.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/third-party/quicklink.js","path":"js/third-party/quicklink.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/third-party/rating.js","path":"js/third-party/rating.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/third-party/analytics/baidu-analytics.js","path":"js/third-party/analytics/baidu-analytics.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/third-party/analytics/google-analytics.js","path":"js/third-party/analytics/google-analytics.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/third-party/analytics/growingio.js","path":"js/third-party/analytics/growingio.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/third-party/chat/chatra.js","path":"js/third-party/chat/chatra.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/third-party/chat/gitter.js","path":"js/third-party/chat/gitter.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/third-party/chat/tidio.js","path":"js/third-party/chat/tidio.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/third-party/comments/changyan.js","path":"js/third-party/comments/changyan.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/third-party/comments/disqus.js","path":"js/third-party/comments/disqus.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/third-party/comments/disqusjs.js","path":"js/third-party/comments/disqusjs.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/third-party/comments/gitalk.js","path":"js/third-party/comments/gitalk.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/third-party/comments/isso.js","path":"js/third-party/comments/isso.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/third-party/comments/livere.js","path":"js/third-party/comments/livere.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/third-party/comments/utterances.js","path":"js/third-party/comments/utterances.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/third-party/math/katex.js","path":"js/third-party/math/katex.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/third-party/math/mathjax.js","path":"js/third-party/math/mathjax.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/third-party/search/algolia-search.js","path":"js/third-party/search/algolia-search.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/third-party/search/local-search.js","path":"js/third-party/search/local-search.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/third-party/statistics/firestore.js","path":"js/third-party/statistics/firestore.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/third-party/statistics/lean-analytics.js","path":"js/third-party/statistics/lean-analytics.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/third-party/tags/mermaid.js","path":"js/third-party/tags/mermaid.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-next/source/js/third-party/tags/pdf.js","path":"js/third-party/tags/pdf.js","modified":1,"renderable":1},{"_id":"source/images/android-chrome-96x96.png","path":"images/android-chrome-96x96.png","modified":1,"renderable":0},{"_id":"source/images/apple-touch-icon.png","path":"images/apple-touch-icon.png","modified":1,"renderable":0},{"_id":"source/images/favicon-16x16.png","path":"images/favicon-16x16.png","modified":1,"renderable":0},{"_id":"source/images/favicon-32x32.png","path":"images/favicon-32x32.png","modified":1,"renderable":0},{"_id":"source/images/favicon128.png","path":"images/favicon128.png","modified":1,"renderable":0},{"_id":"source/images/logo.png","path":"images/logo.png","modified":1,"renderable":0},{"_id":"source/images/favicon.ico","path":"images/favicon.ico","modified":1,"renderable":0},{"_id":"source/images/mstile-150x150.png","path":"images/mstile-150x150.png","modified":1,"renderable":0},{"_id":"source/images/safari-pinned-tab.svg","path":"images/safari-pinned-tab.svg","modified":1,"renderable":0},{"_id":"source/images/logo2.png","path":"images/logo2.png","modified":1,"renderable":0},{"_id":"source/downloads/code/download-example","path":"downloads/code/download-example","modified":1,"renderable":0},{"_id":"source/downloads/notebooks/installpy.zip","path":"downloads/notebooks/installpy.zip","modified":1,"renderable":0},{"_id":"source/downloads/notebooks/python-intro.zip","path":"downloads/notebooks/python-intro.zip","modified":1,"renderable":0}],"Cache":[{"_id":"source/404/index.md","hash":"fdf31c860863a26ca217e464ab261cde3ba3f722","modified":1657641859080},{"_id":"source/_posts/2018-07-02-installpy.md","hash":"413dbea6ce30a361b28082e5f8fbd0429335efa9","modified":1657763063200},{"_id":"source/_posts/2018-07-02-advance.md","hash":"4a5c81629fbd77acd92cabfc1c30c824a237a460","modified":1657764626760},{"_id":"source/_posts/2018-07-02-main.md","hash":"3b142d3203de48125cde2db27432ec98c7937e8d","modified":1657762846350},{"_id":"source/_posts/2018-10-15-scripts-and-interactive-mode.md","hash":"f04e4f77ca182da91d6ecc8cad8b354d94b60b81","modified":1657761727580},{"_id":"source/_posts/2018-10-20-pickle.md","hash":"16cc367a40395ef231a0f774c25d4a65dc5659c6","modified":1657764855100},{"_id":"source/_posts/2018-12-04-pandas-sep.md","hash":"c79ca87ee53021e877603562bef1def7b92be026","modified":1657764820180},{"_id":"source/_posts/2022-07-12-Coming-back-soon.md","hash":"be96445479a4f6441d6a88fb627337e65b4fadbc","modified":1657642016050},{"_id":"source/about/index.md","hash":"5d7a6e66d9e58c36c7da47d9705785f0b59fc732","modified":1657760998020},{"_id":"source/categories/index.md","hash":"7823a026c8ce30097b466f0b4a7483c487202bf9","modified":1657641726780},{"_id":"source/images/android-chrome-96x96.png","hash":"be1c25c11612f1a1b48d546a477bbf59726015e4","modified":1657626730000},{"_id":"source/images/apple-touch-icon.png","hash":"368602710fc60228e3b614dd2a39565bf6f098b5","modified":1657626731000},{"_id":"source/images/favicon-16x16.png","hash":"ef1a4fe6e91e5febcd1330647977a5df9260189b","modified":1657626731000},{"_id":"source/images/favicon-32x32.png","hash":"78be7c38199edc4062863e553b5208a59b142a74","modified":1657626731000},{"_id":"source/images/favicon128.png","hash":"d77a797e11372dd26b55b6038ede6a412ff95207","modified":1602060792000},{"_id":"source/images/logo.png","hash":"f195962e8c25c4940e5b384c3386b699962d626e","modified":1602060792000},{"_id":"source/images/favicon.ico","hash":"80e0e1ec359b41445db75c72a864966ccf200f45","modified":1657626732000},{"_id":"source/images/mstile-150x150.png","hash":"7740d2fb915f9caed52257d3246752f048afdd99","modified":1657626732000},{"_id":"source/images/safari-pinned-tab.svg","hash":"82373a0caeb61176027b54dca25c835e2e743aa0","modified":1657626732000},{"_id":"source/images/logo2.png","hash":"f09346a132e26170746df59fe290e80898dd1ebd","modified":1657626120880},{"_id":"source/tags/index.md","hash":"3c60537a4511b0e95f756793b0fd11a420ba01ba","modified":1657640274810},{"_id":"source/_posts/2018-07-02-advance/Screenshot_20180618-151438.png","hash":"c010216dbdcf810870960a476f340a74d84da3a5","modified":1657757761030},{"_id":"source/_posts/2018-07-02-advance/advance_279_1.png","hash":"3839a416cd92c0edc14d871918372dfd800f5207","modified":1657758166890},{"_id":"source/_posts/2018-07-02-advance/advance_283_0.png","hash":"faf76b662c6523975aafefb13979edf8ca19914e","modified":1657758166890},{"_id":"source/_posts/2018-07-02-advance/advance_285_0.png","hash":"b444a2dec2f04ad009a9fb5a021fb361d5d65eac","modified":1657758166900},{"_id":"source/_posts/2018-07-02-advance/nbtutor1.png","hash":"59898a68419bc4c26161cbc5c19e516c1c6d9516","modified":1657757761020},{"_id":"source/_posts/2018-07-02-advance/nbtutor2.png","hash":"912cb2a637d97c807a1bf2dca65592059e9cfeca","modified":1657757761020},{"_id":"source/_posts/2018-07-02-advance/scope_resolution_1.png","hash":"ff25a56ea6333a280c6d272e9409cd265ee24619","modified":1657757761020},{"_id":"source/_posts/2018-07-02-advance/tut_a_2.png","hash":"bb91721eb2bb9f16c2b9ac346dbca952be4b454d","modified":1657757761030},{"_id":"source/_posts/2018-07-02-main/Canopy-Packages-min-1.png","hash":"d60aae8acfa48c2b66cadd9ace973b331a969c1a","modified":1657758187810},{"_id":"source/_posts/2018-07-02-main/Conda — Conda documentation.png","hash":"61da7e0899e5103ff0e2a2437ab273658c1dde82","modified":1657758187760},{"_id":"source/_posts/2018-07-02-main/Conda-DistributionDiagram-01.png","hash":"adc44a69e5c879dd37820088c2ec939c19fbe440","modified":1657758187760},{"_id":"source/_posts/2018-07-02-main/DataScienceLibraries-01.png","hash":"d2a4e85bbfce25f00b652358ee6a2d22b291e6e4","modified":1657758187760},{"_id":"source/_posts/2018-07-02-main/Python Developers Survey 2017 - Results-018.png","hash":"9f83ecc157cc30f70f2cea3fc736e02397329eb2","modified":1657758187740},{"_id":"source/_posts/2018-07-02-main/Python Developers Survey 2017 - Results-019.png","hash":"fb19cbd908c0be98b963068f422319c4f840b650","modified":1657758187750},{"_id":"source/_posts/2018-07-02-main/annotation_demo2_00.png","hash":"bf7ec4bcb9ae5c8738fab6ec6ce5dd08fb1d5a7d","modified":1657758187790},{"_id":"source/_posts/2018-07-02-main/astropy_banner.svg","hash":"57c914d37f9c8b734738b7e1242517d2b67f91d0","modified":1657758187800},{"_id":"source/_posts/2018-07-02-main/jupyterlogo.png","hash":"f11277aeaf353e904cdbfc89e981cfacc84a3aff","modified":1657758187770},{"_id":"source/_posts/2018-07-02-main/logo-large.72ad8bf1.svg","hash":"f9366c64d591e4b0bddb322d43d10f37b4ee5327","modified":1657758187750},{"_id":"source/_posts/2018-07-02-main/scikitlogo.png","hash":"5b31342ddbf28d20f9cb2d0b39b989520e2a5efa","modified":1657758187780},{"_id":"source/downloads/code/download-example","hash":"c180e0ae1440eb001934af845ef7eec6ee94cbc4","modified":1657630825610},{"_id":"source/downloads/code/download-installpy.md","hash":"c112a9a094b76c23c018316916d263d0d42b5a00","modified":1657630875120},{"_id":"source/downloads/notebooks/installpy.zip","hash":"dfdbb7ee6a8bda4869fd5fd94e7840279fee4fa8","modified":1657764679040},{"_id":"source/_posts/2018-07-02-advance/Screenshot_20180617-181206.png","hash":"c01357dfd99b6fa68bf3b4d76f8426e03fb45c37","modified":1657757761020},{"_id":"source/_posts/2018-07-02-advance/advance_205_0.png","hash":"a3c6d1aa1c624ef3d39b707bd00c40d099acbaaf","modified":1657758166890},{"_id":"source/_posts/2018-07-02-advance/anatomy.png","hash":"22cf979d9183a449bf759788524f7134dc28bdf3","modified":1657757761020},{"_id":"source/_posts/2018-07-02-advance/nbtutor3.png","hash":"e3e8e6f331456c25ffc6ccfa7d7925c41573c57b","modified":1657757761030},{"_id":"source/_posts/2018-07-02-advance/nbtutor4.png","hash":"8b7096dd766d425cca4696f120cbe8e399505877","modified":1657757761030},{"_id":"source/_posts/2018-07-02-advance/nbtutor5.png","hash":"25ebefe85d5c83c1a9ac68db5ce5546a00dd023e","modified":1657757761030},{"_id":"source/_posts/2018-07-02-main/Matplotlib.png","hash":"b467048b9ae4bd3b5562c8087e723eef38b3df54","modified":1657758187780},{"_id":"source/_posts/2018-07-02-main/Python Developers Survey 2017 - Results-020.png","hash":"a441ea5700a4fde0e6eeb42282dbf074bf32240a","modified":1657758187750},{"_id":"source/_posts/2018-07-02-main/Screenshot_20180625-005924.png","hash":"6ce3aa5e44cec31147feeb25c943930e62c24640","modified":1657758187800},{"_id":"source/_posts/2018-07-02-main/contour_demo_05.png","hash":"cedd2640a373274ae6384ba0925196bc05624662","modified":1657758187790},{"_id":"source/_posts/2018-07-02-main/jupyterlab.png","hash":"9abd39b3586af308c977b9ae661646618b04d0f0","modified":1657758187810},{"_id":"source/_posts/2018-07-02-main/main_126_1.png","hash":"61cb4a4259b363b7b2b2c68ea9012849458ba91b","modified":1657758186800},{"_id":"source/_posts/2018-07-02-main/IPython.png","hash":"a80c12e52bdd9a99aa1bbe16ca52bfa1d61f86f0","modified":1657758187770},{"_id":"source/_posts/2018-07-02-main/SciPy.png","hash":"6f82cd398ae7641230ad5e5cfdeca837dd55c179","modified":1657758187780},{"_id":"source/_posts/2018-07-02-main/named_colors.png","hash":"b1064f1d26a71dfdfdef897aa1f425403f1356d8","modified":1657758187790},{"_id":"source/_posts/2018-07-02-main/skimage01.png","hash":"82b5265d4034ab1b2f02db31a9a0ca8bebde008c","modified":1657758187780},{"_id":"source/_posts/2018-07-02-main/sphx_glr_lat_lon_lines_001.png","hash":"842821eef4c6254f2ceb705cc6093d0bb02c755d","modified":1657758187800},{"_id":"source/_posts/2018-07-02-main/sphx_glr_submaps_and_cropping_001.png","hash":"52d40b15aba50e980fc78f8647b446482548d444","modified":1657758187810},{"_id":"source/_posts/2018-07-02-main/nbviewer.png","hash":"c0383936000a1009803281017cbf9ad7231e603f","modified":1657758187770},{"_id":"source/_posts/2018-07-02-main/pycharm.jpg","hash":"2739c8d4e5d312e49fe56d29a5df653a4ede7673","modified":1657758187810},{"_id":"node_modules/hexo-theme-next/LICENSE.md","hash":"68fc9a03d50fd4b5ea97092b05967d1819dea2c4","modified":1657618280050},{"_id":"node_modules/hexo-theme-next/_vendors.yml","hash":"4a00898e7f4e08e6b42604a33dd926ba57e11939","modified":1657618280460},{"_id":"node_modules/hexo-theme-next/README.md","hash":"56638e4978154a2f2a3f03ba84047b77b4a499cc","modified":1657618280290},{"_id":"node_modules/hexo-theme-next/_config.yml","hash":"ca90890962fd3d003f68cc710e3dc1f9161e5ce5","modified":1657625021610},{"_id":"node_modules/hexo-theme-next/package.json","hash":"ed04579cb05e09d83946d898edcca4677897e328","modified":1657618280040},{"_id":"node_modules/hexo-theme-next/docs/AGPL3.md","hash":"0d2b8c5fa8a614723be0767cc3bca39c49578036","modified":1657618280040},{"_id":"node_modules/hexo-theme-next/docs/AUTHORS.md","hash":"a648823121563c34a177ae91f5a774b5e29f01a0","modified":1657618280040},{"_id":"node_modules/hexo-theme-next/docs/LICENSE.txt","hash":"f5b14f791b7cfa1d16da981d929152e088a5d1b8","modified":1657618280450},{"_id":"node_modules/hexo-theme-next/languages/README.md","hash":"b2567e32805dda79601157351a07e5ca9fe01315","modified":1657618280290},{"_id":"node_modules/hexo-theme-next/languages/ar.yml","hash":"bca66db21c015dbd32970d8708b898518a773e1e","modified":1657618280460},{"_id":"node_modules/hexo-theme-next/languages/bn.yml","hash":"fccbf2855392186e11daa8590121073594037b7b","modified":1657618280460},{"_id":"node_modules/hexo-theme-next/languages/de.yml","hash":"4be7b8b76c81bf1853eb36d2e874b17546a0e792","modified":1657618280460},{"_id":"node_modules/hexo-theme-next/languages/en.yml","hash":"814d81c27fed736055ee300e0a6505b26ff4313c","modified":1657618280460},{"_id":"node_modules/hexo-theme-next/languages/es.yml","hash":"b813da5aed9d73b809133db4dfb08f90ec56afd9","modified":1657618280460},{"_id":"node_modules/hexo-theme-next/languages/fa.yml","hash":"6456d40dd42f44101d9d6e7054e9884e9163f948","modified":1657618280460},{"_id":"node_modules/hexo-theme-next/languages/fr.yml","hash":"b15dc05afdc94de02e5d3fee4f8d3dc5594dd37e","modified":1657618280460},{"_id":"node_modules/hexo-theme-next/languages/id.yml","hash":"14e794db4eca36b257994d81eb513e61d1edcbd6","modified":1657618280460},{"_id":"node_modules/hexo-theme-next/languages/it.yml","hash":"c1eeab4992c76bfd436bb205ce58b1cfeef55ee6","modified":1657618280460},{"_id":"node_modules/hexo-theme-next/languages/ja.yml","hash":"d48c4157e0e02e847aac7b513580d3364c81948c","modified":1657618280470},{"_id":"node_modules/hexo-theme-next/languages/ko.yml","hash":"819c19eb9d142e5411f77cf3821d90f740ee114a","modified":1657618280470},{"_id":"node_modules/hexo-theme-next/languages/nl.yml","hash":"ecb8e39c6225f3c068a5fdd569ee7dafd5c41a1f","modified":1657618280470},{"_id":"node_modules/hexo-theme-next/languages/pt-BR.yml","hash":"a1f27b3a592fc58f17d247f5563ff4a90a3da5f2","modified":1657618280470},{"_id":"node_modules/hexo-theme-next/languages/pt.yml","hash":"63a3e1e728ba5e6e22150de7331bb8a654f34960","modified":1657618280470},{"_id":"node_modules/hexo-theme-next/languages/ru.yml","hash":"8c2b6361f2de17561c1a3eede2bf47b4e2ba6ce5","modified":1657618280470},{"_id":"node_modules/hexo-theme-next/languages/si.yml","hash":"615d18d044f44df476d6bfbf73f7b0edc2632168","modified":1657618280470},{"_id":"node_modules/hexo-theme-next/languages/tk.yml","hash":"519239e35c3bda7b62b00ff5d34644f45b16fe6a","modified":1657618280470},{"_id":"node_modules/hexo-theme-next/languages/tr.yml","hash":"0bebba73d6f06c7dad61f80c0d7ad5f6f1791a01","modified":1657618280470},{"_id":"node_modules/hexo-theme-next/languages/uk.yml","hash":"7dd24580c0865c5a7bc4d391855045366a598936","modified":1657618280470},{"_id":"node_modules/hexo-theme-next/languages/vi.yml","hash":"c669c34da544a563ceae3e196addc9df6a78e024","modified":1657618280480},{"_id":"node_modules/hexo-theme-next/languages/zh-CN.yml","hash":"5a3ab21210304efef736e96bad254f789f42c567","modified":1657618280480},{"_id":"node_modules/hexo-theme-next/languages/zh-HK.yml","hash":"f195bb0502ffe66e850077a1af1033455ea65f93","modified":1657618280480},{"_id":"node_modules/hexo-theme-next/languages/zh-TW.yml","hash":"92256b90028de9a1e79c6bc0e5885b93e7fb4b17","modified":1657618280480},{"_id":"node_modules/hexo-theme-next/layout/_layout.njk","hash":"20e4160cd0deb4fa272cc3aed0f43520b3cf4a9c","modified":1657618280290},{"_id":"node_modules/hexo-theme-next/layout/archive.njk","hash":"d759f4d2cf5ddc6875ea250113a00662c1caf6d1","modified":1657618280300},{"_id":"node_modules/hexo-theme-next/layout/category.njk","hash":"c68b7343d0f8145010f93351908cc36ef6212ec1","modified":1657618280300},{"_id":"node_modules/hexo-theme-next/layout/index.njk","hash":"dd63e488ae8cc144335a5958acedf6a16edd7a92","modified":1657618280320},{"_id":"node_modules/hexo-theme-next/layout/page.njk","hash":"6c40aa438c658eb7f0cd0f6a759f18b43e7e8f93","modified":1657618280330},{"_id":"node_modules/hexo-theme-next/layout/post.njk","hash":"6abeb85fb3e4c382ed4bb6049b12a807e6226e67","modified":1657618280340},{"_id":"node_modules/hexo-theme-next/layout/tag.njk","hash":"9e16ba20c28a7f2c6bc75aa427f48122301a30aa","modified":1657618280340},{"_id":"node_modules/hexo-theme-next/docs/ru/README.md","hash":"6c82bfd2ec8248c248da701f091b548a7a133580","modified":1657618280050},{"_id":"node_modules/hexo-theme-next/docs/zh-CN/CODE_OF_CONDUCT.md","hash":"7a06d443f374bd1e84294067a0ac796afd9fbe60","modified":1657618280050},{"_id":"node_modules/hexo-theme-next/docs/zh-CN/CONTRIBUTING.md","hash":"a089f7a8368ab0b7d7b9b7ec0ac3767a453435df","modified":1657618280050},{"_id":"node_modules/hexo-theme-next/docs/zh-CN/README.md","hash":"ccf27b9249524b9fec1c15497b4353c8d1748c6c","modified":1657618280290},{"_id":"node_modules/hexo-theme-next/layout/_macro/post-collapse.njk","hash":"1a30d751871dabfa80940042ddb1f77d07d830b9","modified":1657618280330},{"_id":"node_modules/hexo-theme-next/layout/_macro/post.njk","hash":"434b3e76a040a816169e1929657e4176e7b8164c","modified":1657618280340},{"_id":"node_modules/hexo-theme-next/layout/_partials/comments.njk","hash":"d0c470b0f6690aa217e9ada848c5e2e73fb27c6f","modified":1657618280310},{"_id":"node_modules/hexo-theme-next/layout/_macro/sidebar.njk","hash":"eb786e8b35e354287cda345c524cd35ec955f692","modified":1657618280340},{"_id":"node_modules/hexo-theme-next/layout/_partials/footer.njk","hash":"19713f472972caac33ae5fbcfe9105da61257de4","modified":1657618280310},{"_id":"node_modules/hexo-theme-next/layout/_partials/languages.njk","hash":"e43f22198cccb5f6e306b1ce0d28d12a4fb891f8","modified":1657618280320},{"_id":"node_modules/hexo-theme-next/layout/_partials/pagination.njk","hash":"9876dbfc15713c7a47d4bcaa301f4757bd978269","modified":1657618280330},{"_id":"node_modules/hexo-theme-next/layout/_partials/widgets.njk","hash":"852a750524decf1efa587cd52b09e387ed8315de","modified":1657618280350},{"_id":"node_modules/hexo-theme-next/layout/_scripts/index.njk","hash":"6668878a0f9a1166c6a879755f54a08d942da870","modified":1657618280320},{"_id":"node_modules/hexo-theme-next/layout/_scripts/vendors.njk","hash":"be80b9fe415a9a09d74c28e230995fd292dfc123","modified":1657618280350},{"_id":"node_modules/hexo-theme-next/layout/_third-party/fancybox.njk","hash":"844559f46e2ff1c8be234d5763703106e2072a7b","modified":1657618280310},{"_id":"node_modules/hexo-theme-next/layout/_third-party/index.njk","hash":"d41eeb262978e34de4679d8971a9e7ac5d90ecbc","modified":1657618280320},{"_id":"node_modules/hexo-theme-next/layout/_third-party/pace.njk","hash":"d7ad5714079f7f65446f880baf14722435ca9061","modified":1657618280330},{"_id":"node_modules/hexo-theme-next/layout/_third-party/quicklink.njk","hash":"0efed71ed530447718c4ea5bbd5fc8695b0b0d5f","modified":1657618280340},{"_id":"node_modules/hexo-theme-next/layout/_third-party/rating.njk","hash":"1bcdbc7fde26d6d9ef4e7fa43ffcff5a9506b20e","modified":1657618280340},{"_id":"node_modules/hexo-theme-next/scripts/events/index.js","hash":"3ce10d4cce94e3d4c482c2e18bb6f0f0ca380d3d","modified":1657618280010},{"_id":"node_modules/hexo-theme-next/scripts/filters/default-injects.js","hash":"872f01cb10e422a648ea505436532e776e92926b","modified":1657618279990},{"_id":"node_modules/hexo-theme-next/scripts/filters/locals.js","hash":"9eb5310664759931287dd28ea39165dfb67f12ed","modified":1657618280020},{"_id":"node_modules/hexo-theme-next/scripts/filters/minify.js","hash":"f160e39943e39d7276da86adb47c3f08e5f22c7a","modified":1657618280020},{"_id":"node_modules/hexo-theme-next/scripts/filters/post.js","hash":"30e03a1d4828259f82d46e64cbfe2955b6cff9a9","modified":1657618280030},{"_id":"node_modules/hexo-theme-next/scripts/helpers/engine.js","hash":"d292b78485e8e8055712b0ed6de7cf559c5fbdcd","modified":1657618280000},{"_id":"node_modules/hexo-theme-next/scripts/helpers/font.js","hash":"3394185a7f0393c16ce52c8028f90da3e9239c55","modified":1657618280000},{"_id":"node_modules/hexo-theme-next/scripts/helpers/navigation.js","hash":"78107021101553c3d23e89290f7530b60cf4aa86","modified":1657618280020},{"_id":"node_modules/hexo-theme-next/scripts/helpers/next-config.js","hash":"226fccbe9c93265e65a300e3cb4bf6f9065cfdd7","modified":1657618280030},{"_id":"node_modules/hexo-theme-next/scripts/helpers/next-url.js","hash":"a11b71ba0c5012e2cdcab31c15439156b215563e","modified":1657618280030},{"_id":"node_modules/hexo-theme-next/scripts/helpers/next-vendors.js","hash":"afdd6a188a74c188f0dd154fac70efd4080ca262","modified":1657618280030},{"_id":"node_modules/hexo-theme-next/scripts/tags/button.js","hash":"c6ad2ed544fbb25ecb5d820c36e76302504271b7","modified":1657618279980},{"_id":"node_modules/hexo-theme-next/scripts/tags/caniuse.js","hash":"935a311142a409c1896b3ae3f01fe7a9e2db1134","modified":1657618279980},{"_id":"node_modules/hexo-theme-next/scripts/tags/center-quote.js","hash":"92c19d796bdb3320df9caea59bf52df7a95d9da9","modified":1657618279980},{"_id":"node_modules/hexo-theme-next/scripts/tags/group-pictures.js","hash":"9ed799c329abf830f623689d7e136991256a24ca","modified":1657618280010},{"_id":"node_modules/hexo-theme-next/scripts/tags/index.js","hash":"17f9451ce1f10f78437f52218757d38d4e1591b0","modified":1657618280010},{"_id":"node_modules/hexo-theme-next/scripts/tags/label.js","hash":"8a73348186113bae0a51ea2f891c1bb882fab05a","modified":1657618280010},{"_id":"node_modules/hexo-theme-next/scripts/tags/link-grid.js","hash":"18a483c2d5afd701f6080ffdddf2d1321370336c","modified":1657618280020},{"_id":"node_modules/hexo-theme-next/scripts/tags/mermaid.js","hash":"4fb01ca650fa8b256b8d48f50dc1b18350bd3d6d","modified":1657618280020},{"_id":"node_modules/hexo-theme-next/scripts/tags/note.js","hash":"7b94ddb46b7d4b0fe815f2fbe4bd375f07f55363","modified":1657618280030},{"_id":"node_modules/hexo-theme-next/scripts/tags/pdf.js","hash":"344636b6fd7e27e8831c1e194039afc0d61931cd","modified":1657618280030},{"_id":"node_modules/hexo-theme-next/scripts/tags/tabs.js","hash":"0eabe51da40b4b13e16419c8fe02452d9a4fef73","modified":1657618280030},{"_id":"node_modules/hexo-theme-next/scripts/tags/video.js","hash":"2ee926448583be8f95af1f2884ae2c9c4830151d","modified":1657618280040},{"_id":"node_modules/hexo-theme-next/source/css/_colors.styl","hash":"3c6798c10cc220d83481cb3f3782e78558cee789","modified":1657618280360},{"_id":"node_modules/hexo-theme-next/source/css/_mixins.styl","hash":"32d31cb5a155681c19f5ad0bb56dcb08429f93ef","modified":1657618280390},{"_id":"node_modules/hexo-theme-next/source/css/main.styl","hash":"78ce791cc4ac95386cf6839ca72f5f7b51f86ee9","modified":1657618280430},{"_id":"node_modules/hexo-theme-next/source/css/noscript.styl","hash":"263eddabfae40e54c0591e7baa8403ade8cdd56d","modified":1657618280430},{"_id":"node_modules/hexo-theme-next/source/js/bookmark.js","hash":"0f563ffbf05fad30e854e413ab17ff7164ab5a53","modified":1657618279980},{"_id":"node_modules/hexo-theme-next/source/js/comments-buttons.js","hash":"1a7344440321713426a0b2ab17e276b5bdf85ade","modified":1657618279990},{"_id":"node_modules/hexo-theme-next/source/js/comments.js","hash":"66ae2e26ea36a41b72c638ea8b220296638ae952","modified":1657618279990},{"_id":"node_modules/hexo-theme-next/source/js/config.js","hash":"4c4ebbe3b3f3841a26f9d5af6d0ba8bc6da01c54","modified":1657618279990},{"_id":"node_modules/hexo-theme-next/source/js/motion.js","hash":"f7c825cbff11885fa0dffa64824fd00e505d6a8d","modified":1657618280020},{"_id":"node_modules/hexo-theme-next/source/js/next-boot.js","hash":"da0f07f9eaaa83de70128b0feaea3fdadb90457a","modified":1657618280030},{"_id":"node_modules/hexo-theme-next/source/js/pjax.js","hash":"919f5281c4a04d11cfd94573ecf57b3dbabd3cc8","modified":1657618280030},{"_id":"node_modules/hexo-theme-next/source/js/schedule.js","hash":"a1333258726caf84f368a8f8454639c7dc1626bb","modified":1657618280030},{"_id":"node_modules/hexo-theme-next/source/js/utils.js","hash":"200088bfd042f5304b2a04befab0829148845e0e","modified":1657618280040},{"_id":"node_modules/hexo-theme-next/source/images/apple-touch-icon-next.png","hash":"2959dbc97f31c80283e67104fe0854e2369e40aa","modified":1657618280350},{"_id":"node_modules/hexo-theme-next/source/images/avatar.gif","hash":"2dbc3e2f2d624b2ca1afe6edc2ca17307f1950c8","modified":1657618279970},{"_id":"node_modules/hexo-theme-next/source/images/favicon-16x16-next.png","hash":"943a0d67a9cdf8c198109b28f9dbd42f761d11c3","modified":1657618280350},{"_id":"node_modules/hexo-theme-next/source/images/favicon-32x32-next.png","hash":"0749d7b24b0d2fae1c8eb7f671ad4646ee1894b1","modified":1657618280350},{"_id":"node_modules/hexo-theme-next/source/images/logo-algolia-nebula-blue-full.svg","hash":"b85e274207b1392782476a0430feac98db1e7da0","modified":1657618280450},{"_id":"node_modules/hexo-theme-next/source/images/logo.svg","hash":"2cb74fd3ea2635e015eabc58a8d488aed6cf6417","modified":1657618280450},{"_id":"node_modules/hexo-theme-next/layout/_partials/head/head-unique.njk","hash":"8da52a144060db1a0a088ccb2e6cc8376d1fce70","modified":1657618280310},{"_id":"node_modules/hexo-theme-next/layout/_partials/head/head.njk","hash":"0ba2bf0266f1fcb8edbd961869f8521b29685c56","modified":1657618280310},{"_id":"node_modules/hexo-theme-next/layout/_partials/header/brand.njk","hash":"aff4613756456be26415febc668860fdab8d33c5","modified":1657618280300},{"_id":"node_modules/hexo-theme-next/layout/_partials/header/index.njk","hash":"650de421a8ce4cf685428ffbe0087ff84cbd1356","modified":1657618280320},{"_id":"node_modules/hexo-theme-next/layout/_partials/header/menu-item.njk","hash":"41a8b0cc16f60fa085cb719d07216d86b6bc4bf8","modified":1657618280330},{"_id":"node_modules/hexo-theme-next/layout/_partials/header/menu.njk","hash":"ee6fc2f111572d3eeab0a2fecbb2d6b3e37ab26b","modified":1657618280330},{"_id":"node_modules/hexo-theme-next/layout/_partials/header/sub-menu.njk","hash":"06480d8ec5f0b87eafd47f082f07968d7282dd5c","modified":1657618280340},{"_id":"node_modules/hexo-theme-next/layout/_partials/page/breadcrumb.njk","hash":"89825e75cc45e9709fa6ba89883669eedaff6f46","modified":1657618280300},{"_id":"node_modules/hexo-theme-next/layout/_partials/page/categories.njk","hash":"17156d99941f28a225951ffdcfa9a115e20dc2d2","modified":1657618280300},{"_id":"node_modules/hexo-theme-next/layout/_partials/page/page-header.njk","hash":"7ed4f102a1825195cff8d7995bf9219f323a9034","modified":1657618280330},{"_id":"node_modules/hexo-theme-next/layout/_partials/page/schedule.njk","hash":"0f4bc8e257da60f77c0c1738607b2bde55810684","modified":1657618280340},{"_id":"node_modules/hexo-theme-next/layout/_partials/page/tags.njk","hash":"a18d1598e36cc72f2b0b24c3cc3c5990dfaa3254","modified":1657618280350},{"_id":"node_modules/hexo-theme-next/layout/_partials/post/post-copyright.njk","hash":"133942922e34abae9e4de7ea5591d77c0caa4b37","modified":1657618280330},{"_id":"node_modules/hexo-theme-next/layout/_partials/post/post-followme.njk","hash":"154df0bb323c332d8c25343f258ee865e5553423","modified":1657618280330},{"_id":"node_modules/hexo-theme-next/layout/_partials/post/post-footer.njk","hash":"bde2c7356d9362972bde41cc206d5816f8ed714d","modified":1657618280330},{"_id":"node_modules/hexo-theme-next/layout/_partials/post/post-meta.njk","hash":"9fa47e4fb342811da590ee4adc91cf81118c0a39","modified":1657618280340},{"_id":"node_modules/hexo-theme-next/layout/_partials/post/post-related.njk","hash":"57eca76cfbbe9a65bc2a77f1deebf003ed335673","modified":1657618280340},{"_id":"node_modules/hexo-theme-next/layout/_partials/post/post-reward.njk","hash":"002b51d0cae3f2e2e008bdc58be90c728282de5b","modified":1657618280340},{"_id":"node_modules/hexo-theme-next/layout/_partials/search/algolia-search.njk","hash":"efb2b6f19df02ba5ae623a1f274fff52aed21e6f","modified":1657618280290},{"_id":"node_modules/hexo-theme-next/layout/_partials/search/index.njk","hash":"8f6f256ab3b351ffc80f1f3f1d9834e9a7cfac31","modified":1657618280320},{"_id":"node_modules/hexo-theme-next/layout/_partials/search/localsearch.njk","hash":"661f7acae43f0be694266323320f977d84119abe","modified":1657618280320},{"_id":"node_modules/hexo-theme-next/layout/_partials/sidebar/site-overview.njk","hash":"3d8591bb92df77ceb9d5b07bc76da1ca89e5bd76","modified":1657618280340},{"_id":"node_modules/hexo-theme-next/layout/_third-party/analytics/baidu-analytics.njk","hash":"6215309aee028dcb734452beec448c5afb6c63fc","modified":1657618280300},{"_id":"node_modules/hexo-theme-next/layout/_third-party/analytics/cloudflare.njk","hash":"a5b8297c2c383124dd6a56e256ecc0c0dcf489be","modified":1657618280300},{"_id":"node_modules/hexo-theme-next/layout/_third-party/analytics/google-analytics.njk","hash":"d89066ff53879693f023e540d59c86137172c529","modified":1657618280310},{"_id":"node_modules/hexo-theme-next/layout/_third-party/analytics/growingio.njk","hash":"8afaa772c390bd9d53a5cff9645ac3168334eb98","modified":1657618280310},{"_id":"node_modules/hexo-theme-next/layout/_third-party/analytics/index.njk","hash":"45477a04cf2b3c077061c8c3ada216c1ae288e0e","modified":1657618280320},{"_id":"node_modules/hexo-theme-next/layout/_third-party/chat/chatra.njk","hash":"d7263fca16d0278ccf1f6aa1c6df6902a6344a09","modified":1657618280300},{"_id":"node_modules/hexo-theme-next/layout/_third-party/analytics/microsoft-clarity.njk","hash":"9dc00fcb0a05899f048eace9f9160b78956655d5","modified":1657618280330},{"_id":"node_modules/hexo-theme-next/layout/_third-party/chat/gitter.njk","hash":"f8cc14b7aa949999a1faaeb7855e2f20b59a386d","modified":1657618280310},{"_id":"node_modules/hexo-theme-next/layout/_third-party/chat/tidio.njk","hash":"02aab857c27fc103216029be991688b12a73a525","modified":1657618280350},{"_id":"node_modules/hexo-theme-next/layout/_third-party/comments/changyan.njk","hash":"d1c950f8fbdf85e7a3eae5463767a89e858e8220","modified":1657618280300},{"_id":"node_modules/hexo-theme-next/layout/_third-party/comments/disqus.njk","hash":"9375b19a89b7fa9474e558d085af5448d4c5c50c","modified":1657618280310},{"_id":"node_modules/hexo-theme-next/layout/_third-party/comments/disqusjs.njk","hash":"0749cb6902baecdfd01f779a2a2513f6d2f6a823","modified":1657618280310},{"_id":"node_modules/hexo-theme-next/layout/_third-party/comments/gitalk.njk","hash":"b63b7e2ede0d3e66e732fa1a06bda9b19e1e85d4","modified":1657618280310},{"_id":"node_modules/hexo-theme-next/layout/_third-party/comments/isso.njk","hash":"64cc3bdaf644fd32c0d0a247f29f5b6904da9af3","modified":1657618280320},{"_id":"node_modules/hexo-theme-next/layout/_third-party/comments/livere.njk","hash":"3b13b09fba84ec6000886890a6710736a2b8fafe","modified":1657618280320},{"_id":"node_modules/hexo-theme-next/layout/_third-party/comments/utterances.njk","hash":"5a94032bc3512a10ad4328fc19ec07b819a1d687","modified":1657618280350},{"_id":"node_modules/hexo-theme-next/layout/_third-party/math/index.njk","hash":"abf37fc55aa86702118e8fdf5bf2d389dd589aa0","modified":1657618280320},{"_id":"node_modules/hexo-theme-next/layout/_third-party/math/mathjax.njk","hash":"3677017fd4572b158311f5f5d870590ab25184e0","modified":1657618280330},{"_id":"node_modules/hexo-theme-next/layout/_third-party/math/katex.njk","hash":"1ebf658690468ea197bdd0416eb7cfa4bd0b083a","modified":1657618280320},{"_id":"node_modules/hexo-theme-next/layout/_third-party/search/algolia-search.njk","hash":"24ed76e0c72a25ac152820c750a05826a706b6f4","modified":1657618280300},{"_id":"node_modules/hexo-theme-next/layout/_third-party/search/localsearch.njk","hash":"e45ea3542cdc9ed7ec8447b5e6f35df4c5e82758","modified":1657618280330},{"_id":"node_modules/hexo-theme-next/layout/_third-party/statistics/busuanzi-counter.njk","hash":"a4bc501da0f22f7e420f0ca47e83988ce90b1368","modified":1657618280300},{"_id":"node_modules/hexo-theme-next/layout/_third-party/statistics/firestore.njk","hash":"d32ebe94560fa95824478ebbff531bffc47b194d","modified":1657618280310},{"_id":"node_modules/hexo-theme-next/layout/_third-party/statistics/index.njk","hash":"568ddf7955d11d93fb5e842b403a7ac8b1b7fdb1","modified":1657618280320},{"_id":"node_modules/hexo-theme-next/layout/_third-party/statistics/lean-analytics.njk","hash":"2446e748cdc102c78492216319ac02148db7daf6","modified":1657618280320},{"_id":"node_modules/hexo-theme-next/layout/_third-party/tags/mermaid.njk","hash":"099e031f52fb8e47b3af5b2684737efc9e643ee7","modified":1657618280330},{"_id":"node_modules/hexo-theme-next/layout/_third-party/tags/pdf.njk","hash":"2c81984cc4f5123103460442f6e046f5b6c97127","modified":1657618280330},{"_id":"node_modules/hexo-theme-next/scripts/events/lib/config.js","hash":"c8b59b404f5d2a0b3b5cd1a6c9a10af5f30e43b5","modified":1657618279990},{"_id":"node_modules/hexo-theme-next/scripts/events/lib/highlight.js","hash":"6aec7b2c38c50989a23bfaa0d560e75c7f553e12","modified":1657618280010},{"_id":"node_modules/hexo-theme-next/scripts/events/lib/injects.js","hash":"d987709267a1bc6e5014411e9983d7c49c102c16","modified":1657618280010},{"_id":"node_modules/hexo-theme-next/scripts/events/lib/navigation.js","hash":"dd3562686d95a50375e6fd32e717ccb0d99c1e3d","modified":1657618280020},{"_id":"node_modules/hexo-theme-next/scripts/events/lib/utils.js","hash":"ec996d0673f766167c86df0966e9da1ae036e103","modified":1657618280030},{"_id":"node_modules/hexo-theme-next/scripts/events/lib/vendors.js","hash":"64e4024376b51fe81be7ad80235abdf0a83853bd","modified":1657618280040},{"_id":"node_modules/hexo-theme-next/scripts/filters/comment/common.js","hash":"19a402a225c31edffc50f202a14e0d582d3db23e","modified":1657618279990},{"_id":"node_modules/hexo-theme-next/scripts/filters/comment/default-config.js","hash":"93ee5f9109dad885dc38c49bcee630c10f9dce6e","modified":1657618279990},{"_id":"node_modules/hexo-theme-next/scripts/filters/comment/changyan.js","hash":"7fa8701c86485b2fe7324e017101a32417902397","modified":1657618279980},{"_id":"node_modules/hexo-theme-next/scripts/filters/comment/disqus.js","hash":"7f71d6b271ba65ff333d5682e7575711d368c0d2","modified":1657618279990},{"_id":"node_modules/hexo-theme-next/scripts/filters/comment/disqusjs.js","hash":"135b87d151055eefdbc711d9e704b112b3214a84","modified":1657618280000},{"_id":"node_modules/hexo-theme-next/scripts/filters/comment/gitalk.js","hash":"7bb7dafdd7f6bca8464b54e17e552ce7f1714195","modified":1657618280000},{"_id":"node_modules/hexo-theme-next/scripts/filters/comment/isso.js","hash":"ff8b5b5145220a17d0ecd9508ba9bd2d3b2da47d","modified":1657618280010},{"_id":"node_modules/hexo-theme-next/scripts/filters/comment/livere.js","hash":"5a07d8bb52bc1d51a624ca8db54be144566c306b","modified":1657618280020},{"_id":"node_modules/hexo-theme-next/scripts/filters/comment/utterances.js","hash":"d3bded697bc32dace689d2a6dfb6eb7514169d15","modified":1657618280040},{"_id":"node_modules/hexo-theme-next/source/css/_variables/Gemini.styl","hash":"96e0a7c2a65ce68215e17e369085b2ea2f1334f2","modified":1657618280410},{"_id":"node_modules/hexo-theme-next/source/css/_variables/Mist.styl","hash":"e1fbf169b9b6a194b518240cbd06ec3c48b83d61","modified":1657618280430},{"_id":"node_modules/hexo-theme-next/source/css/_variables/Muse.styl","hash":"e3be898f5ebcf435a26542653a9297ff2c71aeb0","modified":1657618280430},{"_id":"node_modules/hexo-theme-next/source/css/_variables/Pisces.styl","hash":"c65536a128b9bc9dbe2fbb1b235a3cded2891002","modified":1657618280440},{"_id":"node_modules/hexo-theme-next/source/css/_variables/base.styl","hash":"163c7441d777bee87042d475e6ce0fde199add28","modified":1657618280400},{"_id":"node_modules/hexo-theme-next/source/js/schemes/muse.js","hash":"9794bd4fc6a458322949d6a0ade89cd1026bc69f","modified":1657618280020},{"_id":"node_modules/hexo-theme-next/source/js/third-party/fancybox.js","hash":"c098d14e65dd170537134358d4b8359ad0539c2c","modified":1657618280000},{"_id":"node_modules/hexo-theme-next/source/js/third-party/pace.js","hash":"0ef04218b93561ba4d0ff420d556c3d90a756d32","modified":1657618280030},{"_id":"node_modules/hexo-theme-next/source/js/third-party/quicklink.js","hash":"eed02e6fced8e5a653077205d4d4d7834ca71472","modified":1657618280030},{"_id":"node_modules/hexo-theme-next/source/js/third-party/rating.js","hash":"4e92c2d107ba47b47826829f9668030d5ea9bfb8","modified":1657618280030},{"_id":"node_modules/hexo-theme-next/source/css/_common/components/back-to-top.styl","hash":"bab653bcf226311381e8411a0492202f1bf1fce9","modified":1657618280390},{"_id":"node_modules/hexo-theme-next/source/css/_common/components/index.styl","hash":"fe1868f47681e00a33a96199302be85377282f63","modified":1657618280410},{"_id":"node_modules/hexo-theme-next/source/css/_common/components/reading-progress.styl","hash":"90a86045a33c1bae49fc2f6fa1e1b53170c7f77b","modified":1657618280440},{"_id":"node_modules/hexo-theme-next/source/css/_common/outline/index.styl","hash":"8e34df131830d4fa3725e4590a672ba1cf1903e5","modified":1657618280420},{"_id":"node_modules/hexo-theme-next/source/css/_common/outline/mobile.styl","hash":"64775c729512b30b144ab5ae9dc4a4dfd4e13f35","modified":1657618280430},{"_id":"node_modules/hexo-theme-next/source/css/_common/scaffolding/base.styl","hash":"d0a7c99095f490b0d2ed6b1be43d435960798cec","modified":1657618280400},{"_id":"node_modules/hexo-theme-next/source/css/_common/scaffolding/buttons.styl","hash":"a042571d85ff7265f799004239a45f36b716b8a6","modified":1657618280400},{"_id":"node_modules/hexo-theme-next/source/css/_common/scaffolding/comments.styl","hash":"e4fecc889ba3317a64e9abba5842c79dff9b7827","modified":1657618280410},{"_id":"node_modules/hexo-theme-next/source/css/_common/scaffolding/index.styl","hash":"523fb7b653b87ae37fc91fc8813e4ffad87b0d7e","modified":1657618280420},{"_id":"node_modules/hexo-theme-next/source/css/_common/scaffolding/normalize.styl","hash":"b56367ea676ea8e8783ea89cd4ab150c7da7a060","modified":1657618280430},{"_id":"node_modules/hexo-theme-next/source/css/_common/scaffolding/pagination.styl","hash":"b5c7782368889fa9fd93807d28ff2daf270e3703","modified":1657618280430},{"_id":"node_modules/hexo-theme-next/source/css/_common/scaffolding/tables.styl","hash":"e840b23d33023e6d45e018f6e84b683dd56efd8d","modified":1657618280450},{"_id":"node_modules/hexo-theme-next/source/css/_common/scaffolding/toggles.styl","hash":"572a41499391677d84b16d8dbd6a996a3d5ce041","modified":1657618280450},{"_id":"node_modules/hexo-theme-next/source/css/_schemes/Gemini/index.styl","hash":"fd49b521d67eaccc629f77b4e095cb7310327565","modified":1657618280430},{"_id":"node_modules/hexo-theme-next/source/css/_schemes/Mist/_header.styl","hash":"4817e77577896ab5c0da434549917ee703a3f4cf","modified":1657618280370},{"_id":"node_modules/hexo-theme-next/source/css/_schemes/Mist/_layout.styl","hash":"5604ac1e161099a4d3e5657d53507268866dc717","modified":1657618280380},{"_id":"node_modules/hexo-theme-next/source/css/_schemes/Mist/_menu.styl","hash":"fb550935d374e0bdf1097fce187337dc05cad3e1","modified":1657618280380},{"_id":"node_modules/hexo-theme-next/source/css/_schemes/Mist/_posts-expand.styl","hash":"be6cf377ae8f4a01ee76f9b3014e74161d4d5d17","modified":1657618280390},{"_id":"node_modules/hexo-theme-next/source/css/_schemes/Mist/index.styl","hash":"ab16a3dcdc0393b9b582ef59dcc13db9320e917c","modified":1657618280430},{"_id":"node_modules/hexo-theme-next/source/css/_schemes/Muse/_header.styl","hash":"06080fd963c904d96c00eff098a284e337953013","modified":1657618280370},{"_id":"node_modules/hexo-theme-next/source/css/_schemes/Muse/_layout.styl","hash":"82a29572dd90451f75358a2ee2522b87304a0bb8","modified":1657618280380},{"_id":"node_modules/hexo-theme-next/source/css/_schemes/Muse/_menu.styl","hash":"b7f48be3c43bfa393d62142544a5487a67871713","modified":1657618280390},{"_id":"node_modules/hexo-theme-next/source/css/_schemes/Muse/_sidebar.styl","hash":"944364893bd7160d954c10ba931af641c91515a4","modified":1657618280390},{"_id":"node_modules/hexo-theme-next/source/css/_schemes/Muse/_sub-menu.styl","hash":"c48ccd8d6651fe1a01faff8f01179456d39ba9b1","modified":1657618280390},{"_id":"node_modules/hexo-theme-next/source/css/_schemes/Muse/index.styl","hash":"6ad168288b213cec357e9b5a97674ff2ef3a910c","modified":1657618280430},{"_id":"node_modules/hexo-theme-next/source/css/_schemes/Pisces/_header.styl","hash":"b741ab96e73370711c63a6581159f2ea8b5bfa1b","modified":1657618280380},{"_id":"node_modules/hexo-theme-next/source/css/_schemes/Pisces/_layout.styl","hash":"6eee86c8f0175d6c09e434053516cd8556f78d44","modified":1657618280380},{"_id":"node_modules/hexo-theme-next/source/css/_schemes/Pisces/_menu.styl","hash":"72dc825c50357402c342d62ab60fc0c478ab6bc1","modified":1657618280390},{"_id":"node_modules/hexo-theme-next/source/css/_schemes/Pisces/_sidebar.styl","hash":"d9141e6e14a56b5952488101e9a8388c2170e270","modified":1657618280390},{"_id":"node_modules/hexo-theme-next/source/css/_schemes/Pisces/_sub-menu.styl","hash":"778ed2ad5643b93970c95626b325defeb586733f","modified":1657618280390},{"_id":"node_modules/hexo-theme-next/source/css/_schemes/Pisces/index.styl","hash":"8000075b227749a7495eaf417cac6ccfbe441580","modified":1657618280430},{"_id":"node_modules/hexo-theme-next/source/js/third-party/analytics/baidu-analytics.js","hash":"f629acc46ff40c071ffd31b77d5c7616f0fdd778","modified":1657618279980},{"_id":"node_modules/hexo-theme-next/source/js/third-party/analytics/google-analytics.js","hash":"59684383385059dc4f8a1ff85dbbeb703bcdbcb5","modified":1657618280000},{"_id":"node_modules/hexo-theme-next/source/js/third-party/analytics/growingio.js","hash":"78dd3cf04082b7dbe6246e404b2aa8e726922402","modified":1657618280010},{"_id":"node_modules/hexo-theme-next/source/js/third-party/chat/chatra.js","hash":"c32180522788c10e51df1803aa6842ef0432ddc9","modified":1657618279990},{"_id":"node_modules/hexo-theme-next/source/js/third-party/chat/gitter.js","hash":"cc38c94125f90dadde11b5ebac7d8bf99a1a08a2","modified":1657618280000},{"_id":"node_modules/hexo-theme-next/source/js/third-party/chat/tidio.js","hash":"b0079f6a4601e06ca6fe46e83a2f5af553e9bc3c","modified":1657618280030},{"_id":"node_modules/hexo-theme-next/source/js/third-party/comments/changyan.js","hash":"260d1a77d6a3bb33a579d3e4cca1997003e799b5","modified":1657618279980},{"_id":"node_modules/hexo-theme-next/source/js/third-party/comments/disqus.js","hash":"e1cc671b0d524864fd445e3ab4ade9ee6d07e565","modified":1657618279990},{"_id":"node_modules/hexo-theme-next/source/js/third-party/comments/disqusjs.js","hash":"b6c58f098473b526d6a3cd35655caf34b77f7cff","modified":1657618280000},{"_id":"node_modules/hexo-theme-next/source/js/third-party/comments/gitalk.js","hash":"0ec038cf83e8ec067534f16a54041e47a3c1e59a","modified":1657618280000},{"_id":"node_modules/hexo-theme-next/source/js/third-party/comments/isso.js","hash":"753a873b6f566aff5ba77ca23f91b78eb880ca64","modified":1657618280010},{"_id":"node_modules/hexo-theme-next/source/js/third-party/comments/livere.js","hash":"2247d88c934c765c43013337860774aaa99f0b31","modified":1657618280020},{"_id":"node_modules/hexo-theme-next/source/js/third-party/comments/utterances.js","hash":"f67f90eb03e284c82da2b8cf2f1e31801813c16d","modified":1657618280040},{"_id":"node_modules/hexo-theme-next/source/js/third-party/math/katex.js","hash":"83c54ee536e487a1031783443fe0cb63b1b4767e","modified":1657618280010},{"_id":"node_modules/hexo-theme-next/source/js/third-party/math/mathjax.js","hash":"5c749b9c1c3bb738122d0516211ecff6496d4907","modified":1657618280020},{"_id":"node_modules/hexo-theme-next/source/js/third-party/search/algolia-search.js","hash":"fdb7b7cef1a147d897e7f7cd8903b58368ec2062","modified":1657618279970},{"_id":"node_modules/hexo-theme-next/source/js/third-party/search/local-search.js","hash":"4536cb6d0a9bbaaa86fab3fa0101f6a3a3ec5a76","modified":1657618280020},{"_id":"node_modules/hexo-theme-next/source/js/third-party/statistics/firestore.js","hash":"411a72df581f5b21317dc28633c7993207eb9e1c","modified":1657618280000},{"_id":"node_modules/hexo-theme-next/source/js/third-party/statistics/lean-analytics.js","hash":"5a928990856b8e456f0663cf3b6b406733672e39","modified":1657618280020},{"_id":"node_modules/hexo-theme-next/source/js/third-party/tags/mermaid.js","hash":"f27d817b0c2138dd3215b1f46af0753f60a008f3","modified":1657618280020},{"_id":"node_modules/hexo-theme-next/source/js/third-party/tags/pdf.js","hash":"af78c22f0e61c8c8aa8794e585e0d632c6d4fcb8","modified":1657618280030},{"_id":"node_modules/hexo-theme-next/source/css/_common/components/pages/breadcrumb.styl","hash":"8afdc311c6b8db121758371f95cf1c5e77354f42","modified":1657618280400},{"_id":"node_modules/hexo-theme-next/source/css/_common/components/pages/index.styl","hash":"7504dbc5c70262b048143b2c37d2b5aa2809afa2","modified":1657618280420},{"_id":"node_modules/hexo-theme-next/source/css/_common/components/pages/categories.styl","hash":"b6e2eb1550a7845cb2adf86081a4ab6c7bde1e68","modified":1657618280400},{"_id":"node_modules/hexo-theme-next/source/css/_common/components/pages/schedule.styl","hash":"6b816c2511242ee503fb5f34cd3e4dcdafc06b85","modified":1657618280440},{"_id":"node_modules/hexo-theme-next/source/css/_common/components/pages/tag-cloud.styl","hash":"1a81d1a71fcf0699629ce6e72dfd0a15f3a2dd0a","modified":1657618280450},{"_id":"node_modules/hexo-theme-next/source/css/_common/components/post/index.styl","hash":"d0805a763176b3c0003967401644f41dfe3bc9e8","modified":1657618280420},{"_id":"node_modules/hexo-theme-next/source/css/_common/components/post/post-body.styl","hash":"d757768a58743601d0d84158ba955eb15d4c3c01","modified":1657618280440},{"_id":"node_modules/hexo-theme-next/source/css/_common/components/post/post-collapse.styl","hash":"ec37a36e94ba791663607a5022f763915778578f","modified":1657618280440},{"_id":"node_modules/hexo-theme-next/source/css/_common/components/post/post-followme.styl","hash":"fc1a7bac6493f24aa50665574f37f3dd954f210c","modified":1657618280440},{"_id":"node_modules/hexo-theme-next/source/css/_common/components/post/post-gallery.styl","hash":"aa366d37389760c8595529b850f461569577a1c5","modified":1657618280440},{"_id":"node_modules/hexo-theme-next/source/css/_common/components/post/post-footer.styl","hash":"1d284f3ea03ba9b4feb76b375e539a8e0bccf1c3","modified":1657618280440},{"_id":"node_modules/hexo-theme-next/source/css/_common/components/post/post-header.styl","hash":"010c901e4ef49a606f8a350efbf09044e76d2ff3","modified":1657618280440},{"_id":"node_modules/hexo-theme-next/source/css/_common/components/post/post-nav.styl","hash":"9ac6f477177264c26a46e8333b8456720a0444dc","modified":1657618280440},{"_id":"node_modules/hexo-theme-next/source/css/_common/components/post/post-reward.styl","hash":"07cff69f2d57e6321595f64c16d8b763dc88df6a","modified":1657618280440},{"_id":"node_modules/hexo-theme-next/source/css/_common/components/post/post-widgets.styl","hash":"b6677dc2a2368084ab82bb4f145ac79e5966c150","modified":1657618280440},{"_id":"node_modules/hexo-theme-next/source/css/_common/components/third-party/gitalk.styl","hash":"070737d101e7cd58e997e8c7af09958268c43a21","modified":1657618280410},{"_id":"node_modules/hexo-theme-next/source/css/_common/components/third-party/disqusjs.styl","hash":"c2326ee3e8b724d99c24a818ddee32813ea5bf89","modified":1657618280410},{"_id":"node_modules/hexo-theme-next/source/css/_common/components/third-party/gitter.styl","hash":"35104dc6883a61c31e0e368dac8ac2f697be62fe","modified":1657618280410},{"_id":"node_modules/hexo-theme-next/source/css/_common/components/third-party/index.styl","hash":"979486a41a81f2a9fd8b0b87c4f87d6416c68c7d","modified":1657618280420},{"_id":"node_modules/hexo-theme-next/source/css/_common/components/third-party/math.styl","hash":"9d995eb4871a6c273d9d51558676a1fdabf69e72","modified":1657618280430},{"_id":"node_modules/hexo-theme-next/source/css/_common/components/third-party/related-posts.styl","hash":"41ed817e1eb64078074e245e771446ee041e5790","modified":1657618280440},{"_id":"node_modules/hexo-theme-next/source/css/_common/components/third-party/search.styl","hash":"e72799ce3f9b79753e365b2f8c8ef6c310668d4a","modified":1657618280440},{"_id":"node_modules/hexo-theme-next/source/css/_common/components/third-party/utterances.styl","hash":"56d90ae0559caa55b75f3c300ff2711f9ed65fc4","modified":1657618280450},{"_id":"node_modules/hexo-theme-next/source/css/_common/outline/footer/index.styl","hash":"8b9407e5cfd0571ef8de7df19022b268f962fa2f","modified":1657618280420},{"_id":"node_modules/hexo-theme-next/source/css/_common/outline/header/bookmark.styl","hash":"e74f4bb47a101b014ee2a1783c87f3b87323f9a0","modified":1657618280400},{"_id":"node_modules/hexo-theme-next/source/css/_common/outline/header/index.styl","hash":"ff642130354a0b3be0d708c43044ed4d710b5e83","modified":1657618280420},{"_id":"node_modules/hexo-theme-next/source/css/_common/outline/header/github-banner.styl","hash":"38c64c2d04e46848382bfa246a0e9c508294767b","modified":1657618280410},{"_id":"node_modules/hexo-theme-next/source/css/_common/outline/header/menu.styl","hash":"392fd53a8dd4e3f33a853ebb24290a622300e0ff","modified":1657618280430},{"_id":"node_modules/hexo-theme-next/source/css/_common/outline/header/site-meta.styl","hash":"759e582d34d08e3386c55d87a835a9523608619f","modified":1657618280450},{"_id":"node_modules/hexo-theme-next/source/css/_common/outline/header/site-nav.styl","hash":"bf3ad8b4268f763a1e26377681644887694bc009","modified":1657618280450},{"_id":"node_modules/hexo-theme-next/source/css/_common/outline/sidebar/index.styl","hash":"cee43480eba028c37d51cb620c2d81486aa24e01","modified":1657618280420},{"_id":"node_modules/hexo-theme-next/source/css/_common/outline/sidebar/sidebar-author-links.styl","hash":"52fc98b1435129eb3edb9293ced9e507741f1350","modified":1657618280450},{"_id":"node_modules/hexo-theme-next/source/css/_common/outline/sidebar/sidebar-author.styl","hash":"5b38ac4a0f1ade0e681aff0e3366c481d9cf3dcd","modified":1657618280450},{"_id":"node_modules/hexo-theme-next/source/css/_common/outline/sidebar/sidebar-blogroll.styl","hash":"9950c3188a28e1c63b5498b7bdcd14b12ace3e28","modified":1657618280450},{"_id":"node_modules/hexo-theme-next/source/css/_common/outline/sidebar/sidebar-button.styl","hash":"b926e368f702f8686aaa2eb98d3d2e533418958c","modified":1657618280450},{"_id":"node_modules/hexo-theme-next/source/css/_common/outline/sidebar/sidebar-dimmer.styl","hash":"fbdb63c6a8887d19b7137325ba7d6806f728139c","modified":1657618280450},{"_id":"node_modules/hexo-theme-next/source/css/_common/outline/sidebar/sidebar-nav.styl","hash":"ee94a1a27090ad24e3ed579093088d97ff96d77d","modified":1657618280450},{"_id":"node_modules/hexo-theme-next/source/css/_common/outline/sidebar/sidebar-toc.styl","hash":"021a37cf178440cc341940a299d3bca359996c6b","modified":1657618280450},{"_id":"node_modules/hexo-theme-next/source/css/_common/outline/sidebar/sidebar-toggle.styl","hash":"3103b81fc76b59e1e2c161e2c484625c770ed66f","modified":1657618280450},{"_id":"node_modules/hexo-theme-next/source/css/_common/outline/sidebar/site-state.styl","hash":"26dd0adfcb1db6df29c6090c8d7e9b5a43583fb0","modified":1657618280450},{"_id":"node_modules/hexo-theme-next/source/css/_common/scaffolding/highlight/copy-code.styl","hash":"670fc109b56a010b166b86b616823a1aae97a738","modified":1657618280410},{"_id":"node_modules/hexo-theme-next/source/css/_common/scaffolding/highlight/index.styl","hash":"f2328caa94645836e06fb39a6a9c9a84ed68a8b5","modified":1657618280420},{"_id":"node_modules/hexo-theme-next/source/css/_common/scaffolding/tags/blockquote-center.styl","hash":"d6418fd2bbfba7b73ddf11ec62db9637fdf5d8af","modified":1657618280400},{"_id":"node_modules/hexo-theme-next/source/css/_common/scaffolding/tags/group-pictures.styl","hash":"393ff96234e4196b569d4b11496774eb78e147de","modified":1657618280410},{"_id":"node_modules/hexo-theme-next/source/css/_common/scaffolding/tags/index.styl","hash":"3f76c73a891bbc10679753e702feba9e8a5ffdd2","modified":1657618280420},{"_id":"node_modules/hexo-theme-next/source/css/_common/scaffolding/tags/label.styl","hash":"debee14539272fbe3835a7d3853af2230baa3501","modified":1657618280430},{"_id":"node_modules/hexo-theme-next/source/css/_common/scaffolding/tags/link-grid.styl","hash":"7f8a7345e6537a62cd9e9a94c8f7065b541d9b04","modified":1657618280430},{"_id":"node_modules/hexo-theme-next/source/css/_common/scaffolding/tags/mermaid.styl","hash":"48d35dba575a7c9e8845b16652e76b7d4a4646de","modified":1657618280430},{"_id":"node_modules/hexo-theme-next/source/css/_common/scaffolding/tags/note.styl","hash":"d27fbf7799695295dd5860a161a13ac4d90c5ba4","modified":1657618280430},{"_id":"node_modules/hexo-theme-next/source/css/_common/scaffolding/tags/pdf.styl","hash":"b6654a1d7cf82577d8263faffee8af3ad4a5c0e8","modified":1657618280440},{"_id":"node_modules/hexo-theme-next/source/css/_common/scaffolding/tags/tabs.styl","hash":"7a39bcce7274284e87388743db62afc847fe6897","modified":1657618280450},{"_id":"source/downloads/notebooks/python-intro.zip","hash":"34adc563ac1c8180a8343bc562f817b81a153f7f","modified":1657764697930},{"_id":"public/search.xml","hash":"c59f12c520aac6dfa3e3dc29ac05db2bfa45a009","modified":1657764955456},{"_id":"public/404.html","hash":"50764690c48a603771fe74ee9a43104801768820","modified":1657764955456},{"_id":"public/categories/index.html","hash":"cc942da9d68f1811be6cb59a4650557363d48589","modified":1657764955456},{"_id":"public/about/index.html","hash":"1ec4dffc52041d180bcb78173ec0f6d1b488f4b8","modified":1657764955456},{"_id":"public/tags/index.html","hash":"29ff6ca8365ba66c5d86881473990d78598bafb1","modified":1657764955456},{"_id":"public/downloads/code/download-installpy.html","hash":"6f8921d09254d36df2d71de479de2b27371f54fc","modified":1657764955456},{"_id":"public/2022-07-12-Coming-back-soon.html","hash":"f85f8bdcf1471b4745af2d67283eb6bc788ab881","modified":1657764955456},{"_id":"public/2018-12-04-pandas-sep.html","hash":"ca659c6c3df19df9ee18741fed33bcc6a65774f4","modified":1657764955456},{"_id":"public/archives/index.html","hash":"1950da5db2c65cfd10574b7c6e85cb2ffdb4a4a4","modified":1657764955456},{"_id":"public/archives/page/2/index.html","hash":"8bea641bfbec8d051dc3ad85d6585f3756655c16","modified":1657764955456},{"_id":"public/archives/2018/index.html","hash":"a8b70873678b839bcba12afa582fcdc94cbe9665","modified":1657764955456},{"_id":"public/archives/2018/page/2/index.html","hash":"f5c8fc38f8559b430cd8d3383b93b299fc8e7780","modified":1657764955456},{"_id":"public/archives/2018/07/index.html","hash":"754463c4e7b5495f71bdb054e34bd3ee18ab0a03","modified":1657764955456},{"_id":"public/archives/2018/10/index.html","hash":"531e44611ad1b0004ed7aba9b87f453c56889c40","modified":1657764955456},{"_id":"public/archives/2018/12/index.html","hash":"44bef1a74f64ea86af625101c240607f050ab093","modified":1657764955456},{"_id":"public/archives/2022/index.html","hash":"bc6a1942566f8b133da922ee2ec555c6b40a66b2","modified":1657764955456},{"_id":"public/archives/2022/07/index.html","hash":"0c0a074e54add104bdeeceba5a1dbbbf0554152a","modified":1657764955456},{"_id":"public/categories/Solar-Physics/index.html","hash":"50b4cc33eacba124bced8ce2a5afa9a9e56e415c","modified":1657764955456},{"_id":"public/categories/Solar-Physics/page/2/index.html","hash":"10d879dcd4da65c6ff33d4bea3518074472e0781","modified":1657764955456},{"_id":"public/tags/python/index.html","hash":"bab0a6d8071c82cad58fd663de8d95fbc53d52ff","modified":1657764955456},{"_id":"public/tags/python/page/2/index.html","hash":"6eb303d9ef3ea00c419e47dadb651e7985f37729","modified":1657764955456},{"_id":"public/tags/conda/index.html","hash":"6d0e29d3df01250d2e75c4d6ecce9d65d6d58f3f","modified":1657764955456},{"_id":"public/tags/jupyter/index.html","hash":"569a4c3cf43bcab4ee6d2b2812a1d2b0b046d8d2","modified":1657764955456},{"_id":"public/tags/astropy/index.html","hash":"a26fd3f5faba01c2b7545379e85a959e10320264","modified":1657764955456},{"_id":"public/tags/sunpy/index.html","hash":"b7bff81deeb879b20433d42c8ff360edc5877bd4","modified":1657764955456},{"_id":"public/tags/install/index.html","hash":"5643927dd5a92a5979108750ef4befb9f82b20b0","modified":1657764955456},{"_id":"public/tags/pandas/index.html","hash":"85c1fc773f8df59b26f6f0466cfe33f877f5afa3","modified":1657764955456},{"_id":"public/2018-10-20-pickle.html","hash":"c6be27c2c4a80d96e0f32f2103e07c2537641308","modified":1657764955456},{"_id":"public/2018-10-15-scripts-and-interactive-mode.html","hash":"932b42a85f2cd0852cd8a77008fd5e9dbaa2b1e7","modified":1657764955456},{"_id":"public/advance.html","hash":"931a2acbc3a985097cc6a8396fc23aab1627c647","modified":1657764955456},{"_id":"public/main.html","hash":"7ba2c58740b9ddb091ed1ba9561ff9b07fea8f80","modified":1657764955456},{"_id":"public/installpy.html","hash":"fafb55eaf5bcbdab76c249a224f06a52d4bccfc7","modified":1657764955456},{"_id":"public/index.html","hash":"fec2d2142a1949c849db75dca853c54efe27d75b","modified":1657764955456},{"_id":"public/page/2/index.html","hash":"bc9dc38c1cb3b4f2d08c5654543ae54e75cb274c","modified":1657764955456},{"_id":"public/images/apple-touch-icon-next.png","hash":"2959dbc97f31c80283e67104fe0854e2369e40aa","modified":1657764955456},{"_id":"public/images/favicon-16x16-next.png","hash":"943a0d67a9cdf8c198109b28f9dbd42f761d11c3","modified":1657764955456},{"_id":"public/images/avatar.gif","hash":"2dbc3e2f2d624b2ca1afe6edc2ca17307f1950c8","modified":1657764955456},{"_id":"public/images/favicon-32x32-next.png","hash":"0749d7b24b0d2fae1c8eb7f671ad4646ee1894b1","modified":1657764955456},{"_id":"public/images/android-chrome-96x96.png","hash":"be1c25c11612f1a1b48d546a477bbf59726015e4","modified":1657764955456},{"_id":"public/images/apple-touch-icon.png","hash":"368602710fc60228e3b614dd2a39565bf6f098b5","modified":1657764955456},{"_id":"public/images/logo.svg","hash":"2cb74fd3ea2635e015eabc58a8d488aed6cf6417","modified":1657764955456},{"_id":"public/images/favicon-32x32.png","hash":"78be7c38199edc4062863e553b5208a59b142a74","modified":1657764955456},{"_id":"public/images/favicon-16x16.png","hash":"ef1a4fe6e91e5febcd1330647977a5df9260189b","modified":1657764955456},{"_id":"public/images/logo.png","hash":"f195962e8c25c4940e5b384c3386b699962d626e","modified":1657764955456},{"_id":"public/images/favicon128.png","hash":"d77a797e11372dd26b55b6038ede6a412ff95207","modified":1657764955456},{"_id":"public/images/favicon.ico","hash":"80e0e1ec359b41445db75c72a864966ccf200f45","modified":1657764955456},{"_id":"public/images/safari-pinned-tab.svg","hash":"82373a0caeb61176027b54dca25c835e2e743aa0","modified":1657764955456},{"_id":"public/images/mstile-150x150.png","hash":"7740d2fb915f9caed52257d3246752f048afdd99","modified":1657764955456},{"_id":"public/images/logo2.png","hash":"f09346a132e26170746df59fe290e80898dd1ebd","modified":1657764955456},{"_id":"public/downloads/code/download-example","hash":"c180e0ae1440eb001934af845ef7eec6ee94cbc4","modified":1657764955456},{"_id":"public/downloads/notebooks/installpy.zip","hash":"dfdbb7ee6a8bda4869fd5fd94e7840279fee4fa8","modified":1657764955456},{"_id":"public/advance/Screenshot_20180618-151438.png","hash":"c010216dbdcf810870960a476f340a74d84da3a5","modified":1657764955456},{"_id":"public/advance/advance_279_1.png","hash":"3839a416cd92c0edc14d871918372dfd800f5207","modified":1657764955456},{"_id":"public/advance/advance_283_0.png","hash":"faf76b662c6523975aafefb13979edf8ca19914e","modified":1657764955456},{"_id":"public/advance/advance_285_0.png","hash":"b444a2dec2f04ad009a9fb5a021fb361d5d65eac","modified":1657764955456},{"_id":"public/advance/nbtutor2.png","hash":"912cb2a637d97c807a1bf2dca65592059e9cfeca","modified":1657764955456},{"_id":"public/advance/nbtutor1.png","hash":"59898a68419bc4c26161cbc5c19e516c1c6d9516","modified":1657764955456},{"_id":"public/advance/scope_resolution_1.png","hash":"ff25a56ea6333a280c6d272e9409cd265ee24619","modified":1657764955456},{"_id":"public/advance/tut_a_2.png","hash":"bb91721eb2bb9f16c2b9ac346dbca952be4b454d","modified":1657764955456},{"_id":"public/main/Canopy-Packages-min-1.png","hash":"d60aae8acfa48c2b66cadd9ace973b331a969c1a","modified":1657764955456},{"_id":"public/main/Conda — Conda documentation.png","hash":"61da7e0899e5103ff0e2a2437ab273658c1dde82","modified":1657764955456},{"_id":"public/main/Conda-DistributionDiagram-01.png","hash":"adc44a69e5c879dd37820088c2ec939c19fbe440","modified":1657764955456},{"_id":"public/main/DataScienceLibraries-01.png","hash":"d2a4e85bbfce25f00b652358ee6a2d22b291e6e4","modified":1657764955456},{"_id":"public/main/Python Developers Survey 2017 - Results-018.png","hash":"9f83ecc157cc30f70f2cea3fc736e02397329eb2","modified":1657764955456},{"_id":"public/main/Python Developers Survey 2017 - Results-019.png","hash":"fb19cbd908c0be98b963068f422319c4f840b650","modified":1657764955456},{"_id":"public/main/annotation_demo2_00.png","hash":"bf7ec4bcb9ae5c8738fab6ec6ce5dd08fb1d5a7d","modified":1657764955456},{"_id":"public/main/astropy_banner.svg","hash":"57c914d37f9c8b734738b7e1242517d2b67f91d0","modified":1657764955456},{"_id":"public/main/jupyterlogo.png","hash":"f11277aeaf353e904cdbfc89e981cfacc84a3aff","modified":1657764955456},{"_id":"public/main/logo-large.72ad8bf1.svg","hash":"f9366c64d591e4b0bddb322d43d10f37b4ee5327","modified":1657764955456},{"_id":"public/main/scikitlogo.png","hash":"5b31342ddbf28d20f9cb2d0b39b989520e2a5efa","modified":1657764955456},{"_id":"public/advance/Screenshot_20180617-181206.png","hash":"c01357dfd99b6fa68bf3b4d76f8426e03fb45c37","modified":1657764955456},{"_id":"public/advance/advance_205_0.png","hash":"a3c6d1aa1c624ef3d39b707bd00c40d099acbaaf","modified":1657764955456},{"_id":"public/advance/anatomy.png","hash":"22cf979d9183a449bf759788524f7134dc28bdf3","modified":1657764955456},{"_id":"public/advance/nbtutor3.png","hash":"e3e8e6f331456c25ffc6ccfa7d7925c41573c57b","modified":1657764955456},{"_id":"public/advance/nbtutor4.png","hash":"8b7096dd766d425cca4696f120cbe8e399505877","modified":1657764955456},{"_id":"public/advance/nbtutor5.png","hash":"25ebefe85d5c83c1a9ac68db5ce5546a00dd023e","modified":1657764955456},{"_id":"public/main/Matplotlib.png","hash":"b467048b9ae4bd3b5562c8087e723eef38b3df54","modified":1657764955456},{"_id":"public/main/Python Developers Survey 2017 - Results-020.png","hash":"a441ea5700a4fde0e6eeb42282dbf074bf32240a","modified":1657764955456},{"_id":"public/main/Screenshot_20180625-005924.png","hash":"6ce3aa5e44cec31147feeb25c943930e62c24640","modified":1657764955456},{"_id":"public/main/contour_demo_05.png","hash":"cedd2640a373274ae6384ba0925196bc05624662","modified":1657764955456},{"_id":"public/main/jupyterlab.png","hash":"9abd39b3586af308c977b9ae661646618b04d0f0","modified":1657764955456},{"_id":"public/main/main_126_1.png","hash":"61cb4a4259b363b7b2b2c68ea9012849458ba91b","modified":1657764955456},{"_id":"public/css/noscript.css","hash":"ec89b3425fbce20863d554c6fd495ea29c3c303d","modified":1657764955456},{"_id":"public/js/comments.js","hash":"66ae2e26ea36a41b72c638ea8b220296638ae952","modified":1657764955456},{"_id":"public/js/config.js","hash":"4c4ebbe3b3f3841a26f9d5af6d0ba8bc6da01c54","modified":1657764955456},{"_id":"public/js/next-boot.js","hash":"da0f07f9eaaa83de70128b0feaea3fdadb90457a","modified":1657764955456},{"_id":"public/js/utils.js","hash":"200088bfd042f5304b2a04befab0829148845e0e","modified":1657764955456},{"_id":"public/js/third-party/math/mathjax.js","hash":"5c749b9c1c3bb738122d0516211ecff6496d4907","modified":1657764955456},{"_id":"public/js/third-party/search/local-search.js","hash":"4536cb6d0a9bbaaa86fab3fa0101f6a3a3ec5a76","modified":1657764955456},{"_id":"public/css/main.css","hash":"46c9c19740cd9ca5527fb6fa363abaacb838a068","modified":1657764955456},{"_id":"public/main/IPython.png","hash":"a80c12e52bdd9a99aa1bbe16ca52bfa1d61f86f0","modified":1657764955456},{"_id":"public/main/SciPy.png","hash":"6f82cd398ae7641230ad5e5cfdeca837dd55c179","modified":1657764955456},{"_id":"public/main/named_colors.png","hash":"b1064f1d26a71dfdfdef897aa1f425403f1356d8","modified":1657764955456},{"_id":"public/main/skimage01.png","hash":"82b5265d4034ab1b2f02db31a9a0ca8bebde008c","modified":1657764955456},{"_id":"public/main/sphx_glr_lat_lon_lines_001.png","hash":"842821eef4c6254f2ceb705cc6093d0bb02c755d","modified":1657764955456},{"_id":"public/main/sphx_glr_submaps_and_cropping_001.png","hash":"52d40b15aba50e980fc78f8647b446482548d444","modified":1657764955456},{"_id":"public/main/nbviewer.png","hash":"c0383936000a1009803281017cbf9ad7231e603f","modified":1657764955456},{"_id":"public/main/pycharm.jpg","hash":"2739c8d4e5d312e49fe56d29a5df653a4ede7673","modified":1657764955456},{"_id":"public/downloads/notebooks/python-intro.zip","hash":"34adc563ac1c8180a8343bc562f817b81a153f7f","modified":1657764955456}],"Category":[{"name":"Solar Physics","_id":"cl5kegavr0004vxgv6ma09ixa"}],"Data":[],"Page":[{"layout":"page","title":"404","comments":0,"_content":"**Page not found :(**\n\n<pre>\n+------------------------------------------------+\n|                                                |\n|  .:::::::::::::::::.                           |\n|  .ppphhhhhyyyyhhyppy                           |\n|  .ppy......oot...ppy                           |\n|  .ppyoot.........ppy                           |\n|  .pppyyyhhh......ppy                           |\n|  .::::::ppy......ppy                           |\n|        .ppy......ppy                           |\n|        .ppy......ppy                           |\n|      ...ppy......ppy                           |\n|     .pppppy......ppy                           |\n|     .ppy.........ppphhhhhhhhhhhhhhhhhh.        |\n|     .ppy.........ppy:::::::::::::::ypp.        |\n|     .ppy......ttoppy...............ypp.        |\n|     .ppy......hhhhho......:::......ypp......   |\n|     .ppy..................ypp......hyyyyyppp.  |\n|     .ppy..................ypp............ypp.  |\n|     .pppyyyyyyyyyyyyyyyyyypppyyyyyyyyyyyyppp.  |\n|      .......................................   |\n|                                                |\n+------------------------------------------------+\n</pre>","source":"404/index.md","raw":"---\nlayout: page\ntitle: 404\npermalink: /404.html\ncomments: false\n---\n**Page not found :(**\n\n<pre>\n+------------------------------------------------+\n|                                                |\n|  .:::::::::::::::::.                           |\n|  .ppphhhhhyyyyhhyppy                           |\n|  .ppy......oot...ppy                           |\n|  .ppyoot.........ppy                           |\n|  .pppyyyhhh......ppy                           |\n|  .::::::ppy......ppy                           |\n|        .ppy......ppy                           |\n|        .ppy......ppy                           |\n|      ...ppy......ppy                           |\n|     .pppppy......ppy                           |\n|     .ppy.........ppphhhhhhhhhhhhhhhhhh.        |\n|     .ppy.........ppy:::::::::::::::ypp.        |\n|     .ppy......ttoppy...............ypp.        |\n|     .ppy......hhhhho......:::......ypp......   |\n|     .ppy..................ypp......hyyyyyppp.  |\n|     .ppy..................ypp............ypp.  |\n|     .pppyyyyyyyyyyyyyyyyyypppyyyyyyyyyyyyppp.  |\n|      .......................................   |\n|                                                |\n+------------------------------------------------+\n</pre>","date":"2022-07-12T16:04:19.080Z","updated":"2022-07-12T16:04:19.080Z","path":"/404.html","_id":"cl5kegavf0000vxgvd3858b99","content":"<p><strong>Page not found :(</strong></p>\n<pre>\n+------------------------------------------------+\n|                                                |\n|  .:::::::::::::::::.                           |\n|  .ppphhhhhyyyyhhyppy                           |\n|  .ppy......oot...ppy                           |\n|  .ppyoot.........ppy                           |\n|  .pppyyyhhh......ppy                           |\n|  .::::::ppy......ppy                           |\n|        .ppy......ppy                           |\n|        .ppy......ppy                           |\n|      ...ppy......ppy                           |\n|     .pppppy......ppy                           |\n|     .ppy.........ppphhhhhhhhhhhhhhhhhh.        |\n|     .ppy.........ppy:::::::::::::::ypp.        |\n|     .ppy......ttoppy...............ypp.        |\n|     .ppy......hhhhho......:::......ypp......   |\n|     .ppy..................ypp......hyyyyyppp.  |\n|     .ppy..................ypp............ypp.  |\n|     .pppyyyyyyyyyyyyyyyyyypppyyyyyyyyyyyyppp.  |\n|      .......................................   |\n|                                                |\n+------------------------------------------------+\n</pre>\n","site":{"data":{}},"excerpt":"","more":"<p><strong>Page not found :(</strong></p>\n<pre>\n+------------------------------------------------+\n|                                                |\n|  .:::::::::::::::::.                           |\n|  .ppphhhhhyyyyhhyppy                           |\n|  .ppy......oot...ppy                           |\n|  .ppyoot.........ppy                           |\n|  .pppyyyhhh......ppy                           |\n|  .::::::ppy......ppy                           |\n|        .ppy......ppy                           |\n|        .ppy......ppy                           |\n|      ...ppy......ppy                           |\n|     .pppppy......ppy                           |\n|     .ppy.........ppphhhhhhhhhhhhhhhhhh.        |\n|     .ppy.........ppy:::::::::::::::ypp.        |\n|     .ppy......ttoppy...............ypp.        |\n|     .ppy......hhhhho......:::......ypp......   |\n|     .ppy..................ypp......hyyyyyppp.  |\n|     .ppy..................ypp............ypp.  |\n|     .pppyyyyyyyyyyyyyyyyyypppyyyyyyyyyyyyppp.  |\n|      .......................................   |\n|                                                |\n+------------------------------------------------+\n</pre>\n"},{"layout":"page","title":"categories","date":"2022-07-12T16:01:21.000Z","type":"categories","_content":"","source":"categories/index.md","raw":"---\nlayout: page\ntitle: categories\ndate: 2022-07-13 00:01:21\ntype: categories\n---\n","updated":"2022-07-12T16:01:21.000Z","path":"categories/index.html","comments":1,"_id":"cl5kegavl0002vxgv7nhr65nj","content":"\n","site":{"data":{}},"excerpt":"","more":"\n"},{"layout":"page","title":"About","type":"about","comments":0,"_content":"Welcome! This is Lydia Zhang. This blog is about my notes of Python, basically related to solar physics, but not restricted.\n\nSome of the posts and Jupyter notebooks (in Chinese) are backups of my two Python lectures in 2018 when I was in the Solar Physics Group, Nanjing University. The lectures are given to students, as well as researchers who are new to Python or SunPy. The contents are based on my own research experience. Hope they help.\n\nCustom scripts and modules are just examples. Due to the development of SciPy, Astropy, and SunPy, some user-defined functions may no longer be necessary.\n\nPlease contact me if you have any questions. :)\n\n<!-- <a rel=\"license\" href=\"http://creativecommons.org/licenses/by-sa/4.0/\"><img alt=\"Creative Commons License\" style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by-sa/4.0/88x31.png\" /></a><br />This work is licensed under a <a rel=\"license\" href=\"http://creativecommons.org/licenses/by-sa/4.0/\">Creative Commons Attribution-ShareAlike 4.0 International License</a>. -->\n","source":"about/index.md","raw":"---\nlayout: page\ntitle: About\ntype: \"about\"\ncomments: false\n---\nWelcome! This is Lydia Zhang. This blog is about my notes of Python, basically related to solar physics, but not restricted.\n\nSome of the posts and Jupyter notebooks (in Chinese) are backups of my two Python lectures in 2018 when I was in the Solar Physics Group, Nanjing University. The lectures are given to students, as well as researchers who are new to Python or SunPy. The contents are based on my own research experience. Hope they help.\n\nCustom scripts and modules are just examples. Due to the development of SciPy, Astropy, and SunPy, some user-defined functions may no longer be necessary.\n\nPlease contact me if you have any questions. :)\n\n<!-- <a rel=\"license\" href=\"http://creativecommons.org/licenses/by-sa/4.0/\"><img alt=\"Creative Commons License\" style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by-sa/4.0/88x31.png\" /></a><br />This work is licensed under a <a rel=\"license\" href=\"http://creativecommons.org/licenses/by-sa/4.0/\">Creative Commons Attribution-ShareAlike 4.0 International License</a>. -->\n","date":"2022-07-14T01:09:58.020Z","updated":"2022-07-14T01:09:58.020Z","path":"about/index.html","_id":"cl5kegavy0006vxgv3rm30hhl","content":"<p>Welcome! This is Lydia Zhang. This blog is about my notes of Python,\nbasically related to solar physics, but not restricted.</p>\n<p>Some of the posts and Jupyter notebooks (in Chinese) are backups of\nmy two Python lectures in 2018 when I was in the Solar Physics Group,\nNanjing University. The lectures are given to students, as well as\nresearchers who are new to Python or SunPy. The contents are based on my\nown research experience. Hope they help.</p>\n<p>Custom scripts and modules are just examples. Due to the development\nof SciPy, Astropy, and SunPy, some user-defined functions may no longer\nbe necessary.</p>\n<p>Please contact me if you have any questions. :)</p>\n<!-- <a rel=\"license\" href=\"http://creativecommons.org/licenses/by-sa/4.0/\"><img alt=\"Creative Commons License\" style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by-sa/4.0/88x31.png\" /></a><br />This work is licensed under a <a rel=\"license\" href=\"http://creativecommons.org/licenses/by-sa/4.0/\">Creative Commons Attribution-ShareAlike 4.0 International License</a>. -->\n","site":{"data":{}},"excerpt":"","more":"<p>Welcome! This is Lydia Zhang. This blog is about my notes of Python,\nbasically related to solar physics, but not restricted.</p>\n<p>Some of the posts and Jupyter notebooks (in Chinese) are backups of\nmy two Python lectures in 2018 when I was in the Solar Physics Group,\nNanjing University. The lectures are given to students, as well as\nresearchers who are new to Python or SunPy. The contents are based on my\nown research experience. Hope they help.</p>\n<p>Custom scripts and modules are just examples. Due to the development\nof SciPy, Astropy, and SunPy, some user-defined functions may no longer\nbe necessary.</p>\n<p>Please contact me if you have any questions. :)</p>\n<!-- <a rel=\"license\" href=\"http://creativecommons.org/licenses/by-sa/4.0/\"><img alt=\"Creative Commons License\" style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by-sa/4.0/88x31.png\" /></a><br />This work is licensed under a <a rel=\"license\" href=\"http://creativecommons.org/licenses/by-sa/4.0/\">Creative Commons Attribution-ShareAlike 4.0 International License</a>. -->\n"},{"layout":"page","title":"tags","date":"2022-07-12T15:33:25.000Z","type":"tags","_content":"","source":"tags/index.md","raw":"---\nlayout: page\ntitle: tags\ndate: 2022-07-12 23:33:25\ntype: tags\n---\n","updated":"2022-07-12T15:33:25.000Z","path":"tags/index.html","comments":1,"_id":"cl5kegaw00007vxgvg7ym7ed0","content":"\n","site":{"data":{}},"excerpt":"","more":"\n"},{"_content":"[<i class=\"fas fa-download\"></i> Jupyter Notebook](/downloads/notebooks/installpy.zip)","source":"downloads/code/download-installpy.md","raw":"[<i class=\"fas fa-download\"></i> Jupyter Notebook](/downloads/notebooks/installpy.zip)","date":"2022-07-12T13:01:15.120Z","updated":"2022-07-12T13:01:15.120Z","path":"downloads/code/download-installpy.html","title":"","comments":1,"layout":"page","_id":"cl5kegaw10008vxgv0jiw9obu","content":"<p><a\nhref=\"/downloads/notebooks/installpy.zip\"><i class=\"fas fa-download\"></i>\nJupyter Notebook</a></p>\n","site":{"data":{}},"excerpt":"","more":"<p><a\nhref=\"/downloads/notebooks/installpy.zip\"><i class=\"fas fa-download\"></i>\nJupyter Notebook</a></p>\n"}],"Post":[{"title":"Python 进阶 (lecture for Solar Group)","mathjax":true,"date":"2018-07-02T13:46:13.000Z","_content":"[<i class=\"fas fa-download\"></i> Jupyter Notebook](/downloads/notebooks/python-intro.zip)\n\n## Anaconda\n\n> A **conda package** is a compressed tarball file that contains system-level libraries,\nPython or other modules, executable programs and other components.\n**Conda** keeps track of the dependencies between packages and platforms.<br>\n(https://conda.io/docs/user-guide/concepts.html)\n\n* 凡使用 <span style=\"color:blue\">pip install</span> 安装的包均为编译安装, <span style=\"color:blue\">conda install</span> 安装的则为编译好的二进制包.\n* conda 包可以打包其他语言, pip 包容易出现系统依赖问题\n* conda 包的依赖管理更完善\n* conda 环境下仍可使用 pip 进行安装, 但所使用的 pip 命令和系统中的 pip 互不影响, 安装的包的位置也在 conda 本身的目录下.\n* 每个环境互不影响, 各环境下的包虽然必须分别安装 (也可以 clone 一个现有环境),<br>\n  但如果有不同环境中有重复的包 conda 将默认使用 *hard link*.\n\n(更多讨论参考 <http://jakevdp.github.io/blog/2016/08/25/conda-myths-and-misconceptions/)>\n<!-- more -->\n\n<img src='/advance/Screenshot_20180617-181206.png' width='650'/>\n\n* python 位置 (未使用 conda 时)\n\n使用\n```\n$ python -m site\n```\n可以看到有哪些目录.\n\n三个部分:\n\n- **root**\n<pre>\n/<span style=\"color:#800080\"><b>usr</b></span>/lib/...\n/<span style=\"color:#800080\"><b>usr</b></span>/bin/...\n</pre>\n\n- **user**\n<pre>\n/home/&lt;user&gt;/<span style=\"color:#800080\"><b>.local</b></span>/lib/...\n/home/&lt;user&gt;/<span style=\"color:#800080\"><b>.local</b></span>/bin/...\n</pre>\n\n- **anaconda/miniconda**\n<pre>\n/home/&lt;user&gt;/<b><span style=\"color:#800080\">miniconda3</span></b>/</span>/lib/...\n/home/&lt;user&gt;/<b><span style=\"color:#800080\">miniconda3</span></b>/</span>/bin/...\n</pre>\n\n* conda 目录结构 (安装之后自动修改了软连接, 修改环境变量后系统优先使用这个位置)\n\n<pre>\n/home/&lt;user&gt;/<span style=\"color:#800080\"><b>miniconda3/</b></span>\n    ├── <span style=\"color:navy\"><b>pkgs/</b></span>\n    ├── <span style=\"color:dimgray\"><b>bin/</b></span>\n    │        ├── <span style=\"color:magenta\">python</span> -&gt; <span style=\"color:green\">python3.6</span>\n    │        ├── <span style=\"color:magenta\">python3</span> -&gt; <span style=\"color:green\">python3.6</span>\n    │        ├── <span style=\"color:green\">python3.6</span>\n    │        ├── <span style=\"color:green\">jupyter</span>\n    │        ├── <span style=\"color:green\">h5dump</span>\n    │        └── ...\n    ├── <span style=\"color:dimgray\"><b>include/</b></span>\n    ├── <span style=\"color:dimgray\"><b>lib/</b></span>\n    ├── <span style=\"color:dimgray\"><b>share/</b></span>\n    ├── <span style=\"color:navy\"><b>envs</b></span>\n    │        ├── <span style=\"color:blue\"><b>env1/</b></span>\n    │        │        ├── <span style=\"color:dimgray\"><b>bin/</b></span>\n    │        │        ├── <span style=\"color:dimgray\"><b>include/</b></span>\n    │        │        ├── <span style=\"color:dimgray\"><b>lib/</b></span>\n    │        │        ├── <span style=\"color:dimgray\"><b>share/</b></span>\n    │        │        └── ...\n    │        ├── <span style=\"color:blue\"><b>env2/</b></span>\n    │        └── ...\n    └── ...\n</pre>\n\n## IPython & Jupyter\n\n参考文档\n<http://jupyter-notebook.readthedocs.io/en/stable/>\n\n* 配置文件路径\n\n一般用户配置文件在 `~/.jupyter`\n\n```python\n!jupyter --paths\n```\n\n    config:\n        /home/lydia/.jupyter\n        /home/lydia/miniconda3/etc/jupyter\n        /usr/local/etc/jupyter\n        /etc/jupyter\n    data:\n        /home/lydia/.local/share/jupyter\n        /home/lydia/miniconda3/share/jupyter\n        /usr/local/share/jupyter\n        /usr/share/jupyter\n    runtime:\n        /run/user/1000/jupyter\n\n\n* 列出所有 magic functions:\n\n```python\n%lsmagic\n```\n\n* 运行脚本:\n\n```python\n%run script.py\n%run script.ipynb\n```\n\n* 在单个 Cell 中调用其他语言 (子进程):\n\n```sh\n%%sh\ncd ~/miniconda3/\npwd\n```\n\n    /home/lydia/miniconda3\n\n\n可以看到实际并未改变当前目录 (因为是子进程):\n\n```python\npwd\n```\n\n\n\n\n    '/home/lydia/codes/zly/python/python-intro'\n\n\n\n```python\n%%script idl\ncd, current=d\nprint, d\n```\n\n    /home/lydia/codes/zly/python/python-intro\n\n\n    IDL Version 8.2.1 (linux x86_64 m64). (c) 2012, Exelis Visual Information Solutions, Inc.\n    \n\n\n* 逐行使用 bash 命令 (注意不加 '!' 的区别):\n\n```python\n!idl -e field3dgui\n```\n\n```python\n!ls ./\n```\n\n得到的结果可以存入变量:\n\n```python\ncurrent, = !pwd  # returns a list\ncurrent\n```\n\n\n\n\n    '/home/lydia/python-intro'\n\n\n\n下面这两句不能写在一个 Cell 中:\n\n```python\ncd -q ~/miniconda3/\n```\n\n```python\npwd\n```\n\n\n\n\n    '/home/lydia/miniconda3'\n\n\n\n用 `{var}` (推荐) 或 `$var` (不推荐) 调用当前 ipython 环境的变量:\n\n```python\ncd {current}\n```\n\n    /home/lydia/codes/zly/python/python-intro\n\n\n```python\ncd \"$current\"\n```\n\n    /home/lydia/codes/zly/python/python-intro\n\n\n```python\ncd $current\n```\n\n    /home/lydia/codes/zly/python/python-intro\n\n\n见 <http://mmcdan.github.io/posts/interacting-with-the-shell-via-jupyter-notebook/>\n\n* 列出当前的变量信息\n\n```python\na = 1\nb = 'x'\n\n%whos int str\n```\n\n    Variable   Type    Data/Info\n    ----------------------------\n    a          int     1\n    b          str     x\n\n\n## 语法细节\n\n### python2 & python3\n\n```python\n%%python2\nprint 1 / 2\nprint 1 // 2\n```\n\n    0\n    0\n\n\n```python\n%%python3\nprint(1 / 2)\nprint(1 // 2)\n```\n\n    0.5\n    0\n\n\n详见 [Python 2 -> 3 的转换](#Python-2-->-3-的转换)\n\n### list, tuple\n\n* 对 list 或 tuple, 当只有一个元素时, 注意加逗号:\n\n```python\nl = [1]\ntype(l)\n```\n\n\n\n\n    list\n\n\n\n```python\nl = [1,]\ntype(l)\n```\n\n\n\n\n    list\n\n\n\n```python\nl = (1)\ntype(l)\n```\n\n\n\n\n    int\n\n\n\n```python\nl = (1,)\ntype(l)\n```\n\n\n\n\n    tuple\n\n\n\n* 赋值, 星号 (`*`) 表达式用来展开 list/tuple, 双星号 (`**`) 用来展开 dict (常用于函数参数表):\n\n```python\na, b, *c = [0, 1, 2, 3]\na, b, c\n```\n\n\n\n\n    (0, 1, [2, 3])\n\n\n\n```python\na, *_ = [0, 1, 2, 3] # 或 a, = ...\na\n```\n\n\n\n\n    0\n\n\n\n### dict\n\n* dict 改变某个 key 但 value 不变的方法\n\n```python\nd = {'a' : 1, 'b' : 2}\nd['c'] = d.pop('b')  # 利用 `pop` 返回值, 更改 key 值\nd\n```\n\n\n\n\n    {'a': 1, 'c': 2}\n\n\n\n* dict 求并集\n\n```python\nd1 = {'a' : 1, 'b' : 2}\nd2 = {'a' : -1, 'c' : 3, 'd' : 4}\n```\n\n```python\ndict(d1, **d2)  # 重复的 key 取后一个的值\n```\n\n\n\n\n    {'a': -1, 'b': 2, 'c': 3, 'd': 4}\n\n\n\n```python\ndict(list(d1.items()) + list(d2.items()))  # 注意其中的 list\n```\n\n\n\n\n    {'a': -1, 'b': 2, 'c': 3, 'd': 4}\n\n\n\n```python\nd1.update(d2)\nd1\n```\n\n\n\n\n    {'a': -1, 'b': 2, 'c': 3, 'd': 4}\n\n\n\n### set\n\n* set 基本操作\n\n```python\ns = {1, 2}\n```\n\n```python\ns.add(3) # one element only\ns\n```\n\n\n\n\n    {1, 2, 3}\n\n\n\n```python\ns.update([4, 5]) # iterable: list/tuple/set/...\ns\n```\n\n\n\n\n    {1, 2, 3, 4, 5}\n\n\n\n```python\ns.remove(1)\ns\n```\n\n\n\n\n    {2, 3, 4, 5}\n\n\n\n```python\ns.discard(0)  # No error if not exist\ns\n```\n\n\n\n\n    {2, 3, 4, 5}\n\n\n\n* set 求交集, 并集, 差集, 对称差集, 子集\n\n```python\n{1, 2}.intersection({2, 3})\n```\n\n\n\n\n    {2}\n\n\n\n```python\n{1, 2} & {2, 3}  # 或用 and\n```\n\n\n\n\n    {2}\n\n\n\n```python\n{1, 2}.union({2, 3})\n```\n\n\n\n\n    {1, 2, 3}\n\n\n\n```python\n{1, 2} | {2, 3}  # 或用 or\n```\n\n\n\n\n    {1, 2, 3}\n\n\n\n```python\n{1, 2}.difference({2, 3})\n```\n\n\n\n\n    {1}\n\n\n\n```python\n{1, 2} - {2, 3}  # 在前不在后\n```\n\n\n\n\n    {1}\n\n\n\n```python\n{1, 2}.symmetric_difference({2, 3})\n```\n\n\n\n\n    {1, 3}\n\n\n\n```python\n{1, 2} ^ {2, 3}  # 不同时在两边\n```\n\n\n\n\n    {1, 3}\n\n\n\n* 属于, 包含于(子集)\n\n```python\n2 in {1, 2, 3}  # list/tuple/set\n```\n\n\n\n\n    True\n\n\n\n```python\n4 not in {1, 2, 3}  # list/tuple/set\n```\n\n\n\n\n    True\n\n\n\n```python\n{1, 2}.issubset({1, 2, 3})\n```\n\n\n\n\n    True\n\n\n\n```python\n{1, 2} <= {1, 2, 3}\n```\n\n\n\n\n    True\n\n\n\n```python\n{1, 2, 3}.issuperset({1, 2})\n```\n\n\n\n\n    True\n\n\n\n```python\n{1, 2, 3} >= {1, 2}\n```\n\n\n\n\n    True\n\n\n\n### 一些特性的演示\n\n插件 <https://github.com/lgpage/nbtutor><br>\n网页版 <http://pythontutor.com/>\n\n```python\n%reload_ext nbtutor\n```\n\n```python\n%%nbtutor -r -f\nl1= (0)\nl2 = (0,)\n```\n\n    \n\n[网页版演示](http://t.cn/Rg9J3bf)\n\n<img src='/advance/nbtutor1.png' width='550'/>\n\n```python\n%%nbtutor -r -f -i\na = 3\nb = 4\nt = (1, 2, [a, b]) # list in tuple\na = 'x' # change element in list\nt[2][0] = 'xx' # change element in tuple\n```\n\n```python\nprint(t)\n```\n\n    (1, 2, ['xx', 4])\n\n\n[网页版演示](http://t.cn/Rg9idUn)\n\n<img src='/advance/nbtutor2.png' width='550'/>\n\n### 包含判断的单行循环\n\n```python\nl = [1, 2, 3, 4, 5]\n[i for i in l if i > 2]\n```\n\n\n\n\n    [3, 4, 5]\n\n\n\n例如用 `globals()` 来得到字符串形式的变量名 (python 的变量没有提供这个功能的关键字, 因为\"变量名\"存储在namespaces中)\n\n```python\ndef namestr(obj, namespace):\n    return [name for name in namespace if namespace[name] is obj][0]\na = 1\nb = 2\nfor var in (a, b):\n    print(f'{namestr(var, globals())} = {var}')\n```\n\n    a = 1\n    b = 2\n\n\n### 单行 if (三元关系运算)\n\n```python\na = 1\nb = 'y' if a > 0 else 'n'\nb\n```\n\n\n\n\n    'y'\n\n\n\n### 循环, 迭代器, 生成器\n\nPython 的 for 循环不使用索引变量, 而使用遍历**迭代器** (iterator) 的方式处理**可迭代对象** (range, set 等):\n\n```python\nfor i in range(5):\n    ...\n```\n\n遍历的方式是使用 `iter` 和 `next` 函数:\n\n```python\na = iter(range(5))  # 生成一个 range_iterator 对象\n```\n\n```python\nnext(a)\n```\n\n\n\n\n    0\n\n\n\n```python\nlist(range(5))  # 转换为 list\n```\n\n\n\n\n    [0, 1, 2, 3, 4]\n\n\n\n`enumerate` 函数适合需要同时使用索引和内容时使用:\n\n```python\nfor i, item in enumerate(l):  # enumerate()是一个迭代器\n    i = ...\n    item = ...  # l[i] = ...\n```\n\n生成器:\n\n```python\na = (i**2 for i in range(5))  # 产生一个生成器, 可转化成 list, tuple\na\n```\n\n\n\n\n    <generator object <genexpr> at 0x14da87e652b0>\n\n\n\n```python\nnext(a)  # 生成器也是迭代器\n```\n\n\n\n\n    4\n\n\n\n```python\na = [i for i in range(3)]  # 产生一个 list\na\n```\n\n\n\n\n    [0, 1, 2]\n\n\n\n```python\n# 转化成 tuple\ntuple(i for i in range(3))\n```\n\n\n\n\n    (0, 1, 2)\n\n\n\n### 函数定义\n\n* 一般的函数定义:\n\n```python\ndef func(a, b, *args, **kwargs):\n    # func1(x, y, arg1, arg2, ..., key1=val1, key2=val2, ...)\n    ...\n    return ... # 没有 return 或为空 则返回 None\n```\n\n* 单行函数 lambda\n\n```python\ndef f(x, y):\n    return x + y\nf(1, 2)\n```\n\n\n\n\n    3\n\n\n\n用 `lambda` 语法来定义:\n\n```python\nf = lambda x, y: x + y\nf(1, 2)\n```\n\n\n\n\n    3\n\n\n\n```python\n(lambda x, y: x + y)(1, 2)  # 不一定需要定义函数名称\n```\n\n\n\n\n    3\n\n\n\n### 命名空间和变量作用域\n\n<https://sebastianraschka.com/Articles/2014_python_scope_and_namespaces.html>\n\n<img src='/advance/scope_resolution_1.png' width='400' />\n\n* Built-in Functions <https://docs.python.org/3/library/functions.html>\n* Built-in Constants <https://docs.python.org/3/library/constants.html>\n\n`globals()` 以 dict 形式返回当前所有全局变量, 包括导入的包名, ipython/jupyter 的 `In`, `Out` 等.<br>\npython 以 name -> obj 的形式存储这些变量.\n\n```python\na = 1\nb = 2\n```\n\n```python\nglobals()['a'] is a\n```\n\n\n\n\n    True\n\n\n\n```python\ni = 1\ndef f():\n    i = 2\n    print(i, 'local')\n    return\nf()\nprint(i, 'global')\n```\n\n    2 local\n    1 global\n\n\n```python\ni = 1\nfor i in range(4):\n    pass\ni  # 值被改变了 (“leaking”)\n```\n\n\n\n\n    3\n\n\n\n```python\ni = 1\n[i for i in range(3)]\ni  # 用这种方式就不会发生“leaking”\n```\n\n\n\n\n    1\n\n\n\n有关函数中的变量作用方式细节, 参考这里提到的例子: [stackoverflow](https://stackoverflow.com/a/575887)\n\n\n\n> * Any time you see <font color=blue>**varname =**</font>, you're **creating a new name** binding within the function's scope.<br>Whatever value `varname` was bound to before is lost within this scope.\n>\n> * Any time you see <font color=blue>**varname.foo()**</font>, you're **calling a method** on `varname`. The method may alter `varname` (e.g. `list.append`). <br>\n`varname` (or, rather, the object that `varname` names) may exist in more than one scope, and since it's the same object, <br>**any changes will be visible in all scopes**.\n\n## NumPy\n\n### numpy 的数据类型 dtype\n\n<https://www.tutorialspoint.com/numpy/numpy_data_types.htm>\n```python\n>>> np.dtype(np.int64) is np.dtype('i8') is np.dtype('<i8')\nTrue\n>>> np.dtype(np.int64) is np.dtype('int') is np.dtype('int64')\nTrue\n>>> np.dtype(np.int64) is np.dtype('>i8')\nFalse\n```\n```python\n>>> np.dtype(np.float64) is np.dtype('f8') is np.dtype('<f8')\nTrue\n>>> np.dtype(np.float64) is np.dtype('float') is np.dtype('float64')\nTrue\n```\n见 [Fortran 二进制文件读写](#Fortran-二进制文件读写) 中的应用.\n\n### np.arange 参数为浮点数时要注意的细节\n\n```python\nnp.arange(0., 1.8, 0.3)  # 默认不包含 `stop` 这个点\n```\n\n\n\n\n    array([0. , 0.3, 0.6, 0.9, 1.2, 1.5])\n\n\n\n```python\nnp.arange(0., 2.1, 0.3)  # 这里却包括了, 为什么?\n```\n\n\n\n\n    array([0. , 0.3, 0.6, 0.9, 1.2, 1.5, 1.8, 2.1])\n\n\n\n```python\n'%.16f' % 2.1  # 因为浮点数计算方式产生的精度问题\n```\n\n\n\n\n    '2.1000000000000001'\n\n\n\n看一个求和的例子中同样的问题 (用 `list` 和 `numpy.ndarray` 效果一样):\n\n```python\nprint('%.17f' % 0.1)\n# sum([0.1, ..., 0.1])\n\nprint('%.17f' % sum([0.1] * 10))\n# 因为同样问题, 累积了误差\n\nimport math\nprint('%.17f' % math.fsum([0.1] * 10))\n```\n\n    0.10000000000000001\n    0.99999999999999989\n    1.00000000000000000\n\n\n```python\nsum([0.1] * 10) == 1\n```\n\n\n\n\n    False\n\n\n\n```python\nmath.fsum([0.1] * 10) == 1\n```\n\n\n\n\n    True\n\n\n\n```python\nmath.fsum([0.1] * 10) == 1.0\n```\n\n\n\n\n    True\n\n\n\n参考 <https://docs.python.org/3/tutorial/floatingpoint.html>\n\n建议是: 使用整数; 对浮点数的情况, stop 值设得略小一些 (比如减去步长的一般) 以防止改点被包含, 或使用 `np.linspace` 代替.\n\n### 矩阵\n\n`np.matrix`(矩阵) 是 `np.ndarray`(数组) 的一个子类, 继承了父级的方法, 也定义了新的方法 (例如矩阵运算).\n\n```python\nissubclass(np.matrix, np.ndarray)\n```\n\n\n\n\n    True\n\n\n\n```python\na = np.matrix([[0, 1, 2], [3, 4, 5]]); a\n```\n\n\n\n\n    matrix([[0, 1, 2],\n            [3, 4, 5]])\n\n\n\n```python\na = np.matrix(\"0 1 2; 3 4 5\"); a\n```\n\n\n\n\n    matrix([[0, 1, 2],\n            [3, 4, 5]])\n\n\n\n```python\ntype(a)\n```\n\n\n\n\n    numpy.matrixlib.defmatrix.matrix\n\n\n\n`np.asmatrix` (或简写作 `np.mat`) 相当于 `np.matrix(data, copy=False)`\n\n```python\nx = np.array([[1, 2], [3, 4]])\nm = np.matrix(x)\nm[0, 0] = 5\nx\n```\n\n\n\n\n    array([[1, 2],\n           [3, 4]])\n\n\n\n```python\nx = np.array([[1, 2], [3, 4]])\nm = np.mat(x)\nm[0, 0] = 5\nx\n```\n\n\n\n\n    array([[5, 2],\n           [3, 4]])\n\n\n\n```python\nx.__array_interface__['data'][0] == m.__array_interface__['data'][0]\n```\n\n\n\n\n    True\n\n\n\n注意: `np.matrix` 既是一个类名也是一个函数名, 而 `np.mat`, `np.asmatrix` 只是函数名.\n\n### 数组和矩阵运算\n\n#### 数组运算\n\n```python\na = np.arange(12).reshape(3, -1); a\n```\n\n\n\n\n    array([[ 0,  1,  2,  3],\n           [ 4,  5,  6,  7],\n           [ 8,  9, 10, 11]])\n\n\n\n```python\na.max()\n```\n\n\n\n\n    11\n\n\n\n```python\na * a  # 注意这是对应位置的元素间的运算\n```\n\n\n\n\n    array([[  0,   1,   4,   9],\n           [ 16,  25,  36,  49],\n           [ 64,  81, 100, 121]])\n\n\n\n```python\na ** 2  # 注意这是对应位置的元素间的运算\n```\n\n\n\n\n    array([[  0,   1,   4,   9],\n           [ 16,  25,  36,  49],\n           [ 64,  81, 100, 121]])\n\n\n\n#### 使用数组进行矩阵运算\n\n`scipy.linalg` 与 `numpy.linalg` 的比较: \n<https://scipy.github.io/devdocs/tutorial/linalg.html>\n>* `scipy.linalg` contains **all** the functions in `numpy.linalg` plus some other more **advanced** ones not contained in `numpy.linalg`\n* Despite its convenience, the use of the `numpy.matrix` class is **discouraged**.\n* `scipy.linalg` operations can be applied **equally** to `numpy.matrix` or to 2D `numpy.ndarray` objects.\n\n```python\na = np.diagflat([1., 2., 3.]); a\n```\n\n\n\n\n    array([[1., 0., 0.],\n           [0., 2., 0.],\n           [0., 0., 3.]])\n\n\n\n```python\nb = np.array([[-1., -1., -1.],[0., 0., 0.]]); b\n```\n\n\n\n\n    array([[-1., -1., -1.],\n           [ 0.,  0.,  0.]])\n\n\n\n```python\nfrom scipy.linalg import inv\ninv(a)  # 求逆\n```\n\n\n\n\n    array([[ 1.        ,  0.        , -0.        ],\n           [ 0.        ,  0.5       , -0.        ],\n           [ 0.        ,  0.        ,  0.33333333]])\n\n\n\n```python\na.dot(b.T)  # 矩阵内积\n```\n\n\n\n\n    array([[-1.,  0.],\n           [-2.,  0.],\n           [-3.,  0.]])\n\n\n\n#### 直接使用矩阵类型进行运算\n\n使用 numpy 的矩阵类型 `numpy.matrix`\n\n```python\na = np.mat(np.diagflat([1., 2., 3.])); a\n```\n\n\n\n\n    matrix([[1., 0., 0.],\n            [0., 2., 0.],\n            [0., 0., 3.]])\n\n\n\n```python\nb = np.mat(np.array([[-1., -1., -1.],[0., 0., 0.]])); b\n```\n\n\n\n\n    matrix([[-1., -1., -1.],\n            [ 0.,  0.,  0.]])\n\n\n\n```python\na * b.T  # 矩阵内积, 注意与数组的运算符定义不同\n```\n\n\n\n\n    matrix([[-1.,  0.],\n            [-2.,  0.],\n            [-3.,  0.]])\n\n\n\n```python\na @ b.T  # 矩阵内积的新写法, python 3.5+\n```\n\n\n\n\n    matrix([[-1.,  0.],\n            [-2.,  0.],\n            [-3.,  0.]])\n\n\n\n```python\na.I  # 求逆\n```\n\n\n\n\n    matrix([[ 1.        ,  0.        , -0.        ],\n            [ 0.        ,  0.5       , -0.        ],\n            [ 0.        ,  0.        ,  0.33333333]])\n\n\n\n### 用作坐标格点的数组的几种形式\n\n* **`np.meshgrid`**\n\n```python\n>>> x = np.linspace(0, 2, 3); x\narray([ 0.,  1.,  2.])\n>>> y = np.linspace(3, 6, 4); y\narray([3., 4., 5., 6.])\n# X, Y 形状相同: N x M 矩阵, shape=(N, M)\n>>> X, Y = np.meshgrid(x, y)\n>>> X                         # X[j, :] 表示同一层 y[j] 对应的不同 x 值\narray([[0., 1., 2.],          #  0_____x\n       [0., 1., 2.],          #  |\n       [0., 1., 2.],          #  |y\n       [0., 1., 2.]])\n>>> Y\narray([[3., 3., 3.],          # Y[:, i] 表示同一层 x[i] 对应的不同 y 值\n       [4., 4., 4.],\n       [5., 5., 5.],\n       [6., 6., 6.]])\n```\n可用来计算坐标的函数 (例如磁场的表达式等等, 见 [examples/streamplot.py](examples/streamplot.py) )\n```python\nU =   (np.cos(k1 * X) * np.exp(-k1 * Y)\n     - np.cos(k2 * X) * np.exp(-k2 * Y))\nV = (- np.sin(k1 * X) * np.exp(-k1 * Y)\n     + np.sin(k2 * X) * np.exp(-k2 * Y))\n```\n\n```python\nx = np.linspace(0, 2, 3)\ny = np.linspace(3, 6, 4)\nX, Y = np.meshgrid(x, y, indexing='ij')\nY.shape\n```\n\n\n\n\n    (3, 4)\n\n\n\n* **`np.mgrid`**\n\n`j` 标记默认是虚数单位, 但在这里表示前面的数字是格点数.<br>\n格点数使用变量 *`n`* 时, 可写成: *`n`*`*1j + 1j`, 1不能省 (否则j定义为变量)<br>\n类似的 `np.ogrid` 可参见 numpy 相关文档\n\n```python\n>>> x = np.linspace(0, 2, 3)\n>>> y = np.linspace(3, 6, 4)\n\n# 下面三行等价\n>>> X, Y = np.mgrid[0:2:3j, 3:6:4j]\n>>> X, Y = np.array([i.astype(np.float64) for i in np.mgrid[0:3, 3:7]])\n>>> X, Y = np.array(np.meshgrid(x, y, indexing='ij'))\n# np.mgrid[0:2:3j, 3:6:4j] 得到的数据类型为 'float64'\n# np.mgrid[0:3, 3:6] 得到的数据类型为 'int64'\n# np.meshgrid(x, y, indexing='ij') 得到一个 list, 数据格式同x, y\n\n# X, Y 形状相同: M x N 矩阵, shape=(M, N)\n>>> X                      # X[i, :] 表示 x[i]\narray([[0., 0., 0., 0.],   #  0_____y\n       [1., 1., 1., 1.],   #  |\n       [2., 2., 2., 2.]])  #  |x\n>>> Y                      # Y[:, j] 表示 y[j]\narray([[3., 4., 5., 6.],\n       [3., 4., 5., 6.],\n       [3., 4., 5., 6.]])\n```\n\n### mask\n\n```python\na = np.arange(9).reshape(3, -1); a\n```\n\n\n\n\n    array([[0, 1, 2],\n           [3, 4, 5],\n           [6, 7, 8]])\n\n\n\n```python\na > 4  # mask\n```\n\n\n\n\n    array([[False, False, False],\n           [False, False,  True],\n           [ True,  True,  True]])\n\n\n\n```python\nnp.where(a > 4)  # 得到 tuple(col_indexs, row_indexs)\n```\n\n\n\n\n    (array([1, 2, 2, 2]), array([2, 0, 1, 2]))\n\n\n\n```python\nlist(zip(*np.where(a > 4)))  # 也可以用 np.array(np.where(a > 4)).T\n```\n\n\n\n\n    [(1, 2), (2, 0), (2, 1), (2, 2)]\n\n\n\n```python\na[a > 4] = -1; a  # same as a[np.where(a > 4)]\n```\n\n\n\n\n    array([[ 0,  1,  2],\n           [ 3,  4, -1],\n           [-1, -1, -1]])\n\n\n\n### 其他对数组元素的处理\n\n处理含有 NaN 的数据:\n\ne.g. 求最值可使用 `np.nanmin(...)` 和 `np.nanmax(...)`\n\n## Matplotlib\n\n* 官方教程 <https://matplotlib.org/tutorials/introductory/usage.html>\n\n<img src='/advance/anatomy.png' width='600' />\n\n```python\nfig = plt.gcf() # current figure\nax = plt.gca()  # current `Axes`\nim = plt.gci()  # current artist(图像内容), 可由诸如 plt.imshow(...) 得到\n```\n\n* 得到当前 backend:\n```python\n>>> import matplotlib.pyplot as plt\n>>> plt.get_backend()\n```\n或\n```python\n>>> import maplotlib as mpl\n>>> mpl.get_backend()\n```\n* 选择 backend (在导入其他 matplotlib 模块之前):\n```python\n>>> import matplotlib\n>>> matplotlib.use('TkAgg')  # 'Qt5Agg', 'TkAgg', 'Agg', ...\n```\n\n* 用户配置文档 `matplotlibrc`<br>\n通常的位置: `~/.config/matplotlib/matplotlibrc` (Linux)\n\n* 用 `zorder` 来控制图层:\n\n这个例子中也展示了加入一个动态的竖线的方法, 这条线在保存后的图像中不会显示.\n\n```python\n%matplotlib\n%run -e 'examples/test_plot.py'\n```\n\n* 使用 [这个工具](https://github.com/joferkington/mpldatacursor) 动态标注光标位置的值:\n\n```python\n%matplotlib\n%run -e 'examples/test_imshow.py'\n```\n\n* 点击图像后在命令行显示光标处信息的例子\n\n命令行脚本: [examples/test_imshow_click.py](examples/test_imshow_click.py) (jupyter 中无法使用)\n\n* 布局问题 <https://matplotlib.org/tutorials/intermediate/constrainedlayout_guide.html>\n* 绘制平行投影的3D图 <https://matplotlib.org/mpl_toolkits/mplot3d/tutorial.html>\n* 更复杂的 3D 可转存可视化数据用其他软件或使用 Mayavi (http://docs.enthought.com/mayavi/mayavi)\n\n## SunPy 示例\n\n### 示例文件\n\n- 读取 fits, submap, 作图 [example_plothmi](https://lydiazly.coding.me/python-notes/example_plothmi.html)\n\n- 投影 [example_projection](https://lydiazly.coding.me/python-notes/example_projection.html)\n\n- 下载数据 [fido](https://lydiazly.coding.me/python-notes/fido.html), [jsoc](https://lydiazly.coding.me/python-notes/jsoc.html)\n \n 注意: 这些例子只是提供一个使用参考, 不一定是最优的.\n\n### 示例中的 fits 读取方法\n\n更多 FITS 的读取方法参见 [Python 简易教程#FITS-文件读取](main.html#FITS-文件读取)<br>\n另见 [Astropy 的命令行工具](http://docs.astropy.org/en/stable/io/fits/usage/scripts.html)\n\n读取`HMIMap` 的例子:\n\n```python\n# 导入 `sunpy.map` 的时间会略有点长\nimport sunpy.map\nsmap = sunpy.map.Map('data/hmi.B_720s.20150827_052400_TAI.field.fits')\ntype(smap)\n```\n\n\n\n\n    sunpy.map.sources.sdo.HMIMap\n\n\n\n这是 `GenericMap` 的一个子类:\n\n```python\nissubclass(sunpy.map.sources.sdo.HMIMap, sunpy.map.mapbase.GenericMap)\nTrue\n```\n\n\n\n\n    True\n\n\n\n```python\nsmap.meta  # headers\n```\n\n```python\ntype(smap.data)  # 索引从 0 开始\n```\n\n\n\n\n    numpy.ndarray\n\n\n\n```python\nsmap.data.shape  # (dimy, dimx)\n```\n\n\n\n\n    (4096, 4096)\n\n\n\n`smap.data[i, j]` 中的 i 为 Y 轴, 单位为 pixel:\n\n```python\nimport matplotlib.pyplot as plt\nplt.imshow(smap.data[0:2000, :], origin='lower');\nplt.show()\n```\n\n\n    \n![png](/advance/advance_205_0.png)\n    \n\n\n### 关于 Scaled Image Data\n\n这一部分将更仔细地检查 Astropy 对示例中的 FITS 文件的处理.\n\n参见 <http://docs.astropy.org/en/stable/io/fits/usage/image.html#scaled-data>\n\n> Images are scaled only when either of the BSCALE/BZERO keywords are present in the header and either of their values is not the default value (BSCALE=1, BZERO=0).\n\n由于 `astropy.io.fits` 的特性, 读取 'Scaled Image Data' 时, 调用 `.data` 将自动对数据进行缩放:\n```python\nphysical value = BSCALE * (storage value) + BZERO\n```\n`astropy.io.fits.open` 中使用 `do_not_scale_image_data=True` 可禁用这一步骤.\n\n见 [astropy.io.fits FAQ](http://docs.astropy.org/en/stable/io/fits/appendix/faq.html#why-is-an-image-containing-integer-data-being-converted-unexpectedly-to-floats)\n\n数据类型:\n\nBITPIX    |Numpy Data Type\n:---:|:---\n8         |numpy.uint8 (unsigned integer)\n16        |numpy.int16\n32        |numpy.int32\n-32       |numpy.float32\n-64       |numpy.float64\n\n可以使用 Astropy 的命令行工具在 shell 中查看信息:\n\n```python\nfname = 'data/hmi.B_720s.20150827_052400_TAI.field.fits'\n!fitsinfo {fname}\n```\n\n    Filename: data/hmi.B_720s.20150827_052400_TAI.field.fits\n    No.    Name      Ver    Type      Cards   Dimensions   Format\n      0  PRIMARY       1 PrimaryHDU       6   ()      \n      1                1 CompImageHDU    155   (4096, 4096)   int32   \n\n\n可以看到该文件存储的数据类型是整形.\n\n用命令行工具查看关键字 'BITPIX':\n\n```python\n!fitsheader -e 1 --keyword BITPIX {fname}\n```\n\n    # HDU 1 in data/hmi.B_720s.20150827_052400_TAI.field.fits:\n    BITPIX  =                   32 / data type of original image                    \n\n\n使用 `astropy.io.fits`:\n\n```python\nfrom astropy.io import fits\nhdulist = fits.open(fname)\nhdu = hdulist[1]\n```\n\n```python\nhdu.header['BITPIX']\n```\n\n\n\n\n    32\n\n\n\n'BSCALE' 不为零则为 'scaled':\n\n```python\nhdu.header['BSCALE']\n```\n\n\n\n\n    0.01\n\n\n\n```python\nhdu.header['BZERO']\n```\n\n\n\n\n    0.0\n\n\n\n```python\nhdulist.verify('silentfix+warn')  # 调用 `.data` 时如果出错, 需要先进行这一步修复\n```\n\n```python\nhdu.data.dtype  # 已自动变换为 'physical value', 同时 `.header` 将被修改\n```\n\n\n\n\n    dtype('float64')\n\n\n\n```python\nhdu.data[1000, 1000]\n```\n\n\n\n\n    142.83\n\n\n\n```python\nhdu.data[0,0]  # -2147483648 被转为 nan\n```\n\n\n\n\n    nan\n\n\n\n```python\nhdu.header['BITPIX']  # 值被改变了. 同时 'BSCALE', 'BZERO' 被删除\n```\n\n\n\n\n    -64\n\n\n\n手动 scale:\n\n'BSCALE' 虽然之前已被删除, 但值仍存储在 `._orig_bscale` 中. `.scale` 将使用这个值.\n\n```python\nhdu.scale('int32')  # 在此之后 `.data` 将变换回 'storage value'\n```\n\n```python\nhdu._orig_bscale\n```\n\n\n\n\n    0.01\n\n\n\n```python\nhdu._orig_bzero\n```\n\n\n\n\n    0\n\n\n\n```python\nhdu.data[1000, 1000]\n```\n\n\n\n\n    14283\n\n\n\n```python\nhdu.data[0, 0]  # nan 被转为 -2147483648\n```\n\n\n\n\n    -2147483648\n\n\n\n```python\nhdu.header['BITPIX']  # 值再次被改变了\n```\n\n\n\n\n    32\n\n\n\n使用 SunPy 处理时, 'BITPIX', 'BSCALE', 'BZERO' 的值被保留, `.data` 仍进行了 scale 的过程.\n\n针对不同文件, 如果 SunPy 的程序内部使用 `astropy.io.fits` 处理文件时调用了 `.data` 再返回 header, 即 `astropy.io.fits` 已经如上所述改变了 header, 那么 SunPy 所返回的 header 中 'BITPIX', 'BSCALE', 'BZERO' 可能已经被改变.\n\n下面的例子中得到的 header 是最初的值:\n\n```python\nimport sunpy.map\nsmap = sunpy.map.Map('data/hmi.B_720s.20150827_052400_TAI.field.fits')\n```\n\n```python\nsmap.meta['BITPIX']  # 得到的是未被改变的 header\n```\n\n\n\n\n    32\n\n\n\n```python\nsmap.meta['BSCALE']\n```\n\n\n\n\n    0.01\n\n\n\n```python\nsmap.meta['BZERO']\n```\n\n\n\n\n    0.0\n\n\n\n```python\nsmap.data[1000, 1000]  # 这一步并不改变 `.meta` 的值\n```\n\n\n\n\n    142.83\n\n\n\n```python\nsmap.meta['BITPIX']  # 不变\n```\n\n\n\n\n    32\n\n\n\n```python\nsmap.meta['BSCALE']  # 不变\n```\n\n\n\n\n    0.01\n\n\n\n```python\nsmap.meta['BZERO']  # 不变\n```\n\n\n\n\n    0.0\n\n\n\n### 坐标和单位\n\n**SunPy map** <http://docs.sunpy.org/en/stable/code_ref/map.html#using-map-objects>\n>A number of the **properties** of this class are returned as **two-value named tuples**\nthat can either be\n- indexed by position:&ensp;**<font color=blue>[0]</font>,&ensp;<font color=blue>[1]</font>**\n- be accessed by the names:\n  - pixel axes:&ensp;**<font color=blue>.x</font>,&ensp;<font color=blue>.y</font>**<br>\n  x and y refer to the FITS axes (x for columns y for rows)\n  - spatial axes:&ensp;**<font color=blue>.axis1</font>,&ensp;<font color=blue>.axis2</font>**<br>\n  axis1 corresponds to the coordinate axis for x and axis2 corresponds to y.\n\n```python\nsmap.dimensions\n```\n\n\n\n\n    PixelPair(x=<Quantity 4096. pix>, y=<Quantity 4096. pix>)\n\n\n\n```python\nsmap.dimensions.x  # 得到一个 `astropy.units.quantity.Quantity`, 包含 value 和 unit\n```\n\n\n\n\n\\(4096 \\; \\mathrm{pix}\\)\n\n\n\n```python\nsmap.dimensions.x.unit\n```\n\n\n\n\n\\(\\mathrm{pix}\\)\n\n\n\n```python\nsmap.dimensions.x.value\n```\n\n\n\n\n    4096.0\n\n\n\n`astropy.units` 的使用方法:\n\n```python\nimport astropy.units as u\n```\n\n```python\nu.AA\n```\n\n\n\n\n\\(\\mathrm{\\mathring{A}}\\)\n\n\n\n```python\n4096 * u.pix  # same as `u.pixel`\n```\n\n\n\n\n\\(4096 \\; \\mathrm{pix}\\)\n\n\n\n```python\n(4096, 4096) * u.pix  # 注意这里是 `astropy.units` 的运算, 和 list 运算规则不同\n```\n\n\n\n\n\\([4096,~4096] \\; \\mathrm{pix}\\)\n\n\n\n```python\nsmap.dimensions.x.unit is u.pix  # 说明 x 是单位是 u.pix\n```\n\n\n\n\n    True\n\n\n\n```python\ntype(smap.center)\n```\n\n    /home/lydia/miniconda3/lib/python3.6/site-packages/sunpy/map/mapbase.py:669: Warning: Missing metadata for heliographic longitude: assuming longitude of 0 degrees\n      lon=self.heliographic_longitude,\n\n\n\n\n\n    astropy.coordinates.sky_coordinate.SkyCoord\n\n\n\n```python\nlist((0, 0) * u.pix)\n```\n\n\n\n\n    [<Quantity 0. pix>, <Quantity 0. pix>]\n\n\n\n```python\nsmap.pixel_to_world(*(4096, 4096) * u.pix)\n```\n\n\n\n\n    <SkyCoord (Helioprojective: obstime=2015-08-27 05:22:21.800000, rsun=696000000.0 m, observer=<HeliographicStonyhurst Coordinate (obstime=2015-08-27 05:22:21.800000): (lon, lat, radius) in (deg, deg, m)\n        (0., 7.089004, 1.51196988e+11)>): (Tx, Ty) in arcsec\n        (-1040.36199634, -1030.86554911)>\n\n\n\n查看 `SkyCoord` 的帮助:\n\n```python\nimport astropy.coordinates\nhelp(astropy.coordinates.sky_coordinate.SkyCoord)\n```\n\n```python\nsmap.center.Tx\n```\n\n\n\n\n\\(\\mathrm{-7.65399^{\\prime\\prime}}\\)\n\n\n\n```python\nsmap.pixel_to_world(*(2000, 2000) * u.pix)\n```\n\n\n\n\n    <SkyCoord (Helioprojective: obstime=2015-08-27 05:22:21.800000, rsun=696000000.0 m, observer=<HeliographicStonyhurst Coordinate (obstime=2015-08-27 05:22:21.800000): (lon, lat, radius) in (deg, deg, m)\n        (0., 7.089004, 1.51196988e+11)>): (Tx, Ty) in arcsec\n        (16.55031204, 26.53575639)>\n\n\n\n```python\nsmap.pixel_to_world(*(2000, 2000) * u.pix).transform_to('heliographic_stonyhurst')\n```\n\n\n\n\n    <SkyCoord (HeliographicStonyhurst: obstime=2015-08-27 05:22:21.800000): (lon, lat, radius) in (deg, deg, km)\n        (1.00568591, 8.68202918, 696000.0000022)>\n\n\n\n查看坐标信息:\n\n```python\nsmap.coordinate_frame\n```\n\n    /home/lydia/miniconda3/lib/python3.6/site-packages/sunpy/map/mapbase.py:669: Warning: Missing metadata for heliographic longitude: assuming longitude of 0 degrees\n      lon=self.heliographic_longitude,\n\n\n\n\n\n    <Helioprojective Frame (obstime=2015-08-27 05:22:21.800000, rsun=696000000.0 m, observer=<HeliographicStonyhurst Coordinate (obstime=2015-08-27 05:22:21.800000): (lon, lat, radius) in (deg, deg, m)\n        (0., 7.089004, 1.51196988e+11)>)>\n\n\n\n出现这个 Warning 时:\n\n```python\nsmap.meta['hgln_obs'] = 0.; smap.meta['hgln_obs'] = 0.; smap.meta['hgln_obs'] = 0.\nsmap.coordinate_frame\n```\n\n\n\n\n    <Helioprojective Frame (obstime=2015-08-27 05:22:21.800000, rsun=696000000.0 m, observer=<HeliographicStonyhurst Coordinate (obstime=2015-08-27 05:22:21.800000): (lon, lat, radius) in (deg, deg, m)\n        (0., 7.089004, 1.51196988e+11)>)>\n\n\n\n### 语法对比\n\n比较 `plothmi.py` 与对应 IDL 程序的语法:\n\n下面的语句中, 为了简便和方便对比, 使用了自定义的一些函数. 导入方法:\n```python\nfrom usr_sunpy import read_sdo, plot_map, plot_vmap, image_to_helio\n```\n\n读取数据\n```idl\n; IDL\nread_sdo,<fname>,index,data\nindex2map,index,data,mapa\n```\n```python\n# Python\n# 为简化过程而自定义的函数, 读入时打印文件名和数组大小\nmapa = read_sdo(<fname>)\n```\n\n旋转\n```idl\n; IDL\n; 2 表示180°\nmapbx.data = rotate(mapbx,2)\nmapby.data = rotate(mapbx,2)\nmapbz.data = rotate(mapbx,2)\n```\n```python\n# Python\n# 利用 'crota2' 的值确定角度\nmapbx = mapbx.rotate(order=1)\nmapby = mapby.rotate(order=1)\nmapbz = mapbz.rotate(order=1)\n```\n\n截取\n```idl\n; IDL\nsub_map,mapbx,smapbx,xrange=[500,800.0],yrange=[-500,-100.0]\nsub_map,mapby,smapby,ref_map=smapbx\nsub_map,mapbz,smapbz,ref_map=smapbx\n```\n```python\n# Python\n# 左下到右上\nbl = SkyCoord(500*u.arcsec, -500*u.arcsec, frame=mapbz.coordinate_frame)\ntr = SkyCoord(800*u.arcsec, -100.*u.arcsec, frame=mapbz.coordinate_frame)\nsmapbx = mapbx.submap(bl, tr)\nsmapby = mapby.submap(bl, tr)\nsmapbz = mapbz.submap(bl, tr)\n```\n\n绘图\n```idl\n; IDL\nplot_map,smapbz,dmax=2000,dmin=-2000,color=0,charsize=1.8,...\nplot_vmap,/over,smapbx,smapby,mapbz=smapbz,limit=180,scale=0.012,iskip=15,jskip=15,...\n```\n```python\n# Python\n# 主要调用的是 matplotlib\nfig = plt.figure()\nax = fig.add_subplot(111, projection=smapbz) # 使用 smapbz 中定义的坐标系统\nplot_map(ax, smapbz)\nplot_vmap(ax, smapbx, smapby, smapbz, iskip=iskip, jskip=jskip, cmin=100., vmax=500., cmap='binary', ...)\n```\n\n坐标变换\n```idl\n; IDL\n; magnetic_modeling_codes/.../05projection_modified_version.pro\n```\n```python\n# Python\n# `image_to_helio`(变换为 Helioprojective(Cartesian) system)\n# 调用自定义的旋转矩阵函数 `proj_matrix`, 参考文献与原IDL程序相同\nhx, hy = image_to_helio(smapbz)  # numpy 数组\nsmapbx_h, smapby_h, smapbz_h = image_to_helio(smapbx, smapby, smapbz) # sunpy `Map`\n\nplot_map(ax, smapbz_h, coords=(hx, hy))\nplot_vmap(ax, smapbx_h, smapby_h, smapbz_h, coords=(hx, hy), ...)\n```\n\n## 插值, 拟合\n\n选择不限于这里列举的包, 以后也可能会有更合适的方法出现.\n\n相关安装见 [Python 安装和配置](installpy.html#其他)\n\n### 插值\n\n* numpy\n```\nf = interp1d(x, y, kind='cubic'[, fill_value='extrapolate'])\nx2 = np.linspace(...)\ny2 = f(x2)\n```\n见 [examples/test_plot.py](examples/test_plot.py)\n\n* scipy <https://docs.scipy.org/doc/scipy/reference/tutorial/interpolate.html>\n\n### 求极值\n\n* PeakUtils <http://peakutils.readthedocs.io/en/latest/>\n\n官方例图 (http://peakutils.readthedocs.io/en/latest/tutorial_a.html):\n\n```python\nimport peakutils\nindexes = peakutils.indexes(y, thres=0.5, min_dist=30)\n```\n\n<img src='/advance/tut_a_2.png' width='500' />\n\nEnhancing the resolution by interpolation:\n```python\npeaks_x = peakutils.interpolate(x, y, ind=indexes)\n```\n\n### 拟合\n\n* LMFIT (Non-Linear Least-Squares Minimization and Curve-Fitting)\n\n下载 <https://github.com/lmfit/lmfit-py>\n\n文档 <http://lmfit.github.io/lmfit-py/>\n\n有现成模型, 也可以自定义模型.<br>\n可以方便地叠加不同拟合模型(比如多个高斯, 线性加高斯, 等等).<br>\n例子见 [examples/lmfits](examples/lmfits.zip) (来自 [LMFIT网站示例](http://lmfit.github.io/lmfit-py/builtin_models.html#example-1-fit-peak-data-to-gaussian-lorentzian-and-voigt-profiles) )\n\n使用内置模型:\n\n```python\nfrom lmfit.models import GaussianModel  # 内置的模型\n\ndata = np.loadtxt('test_peak.dat')\nx = data[:, 0]\ny = data[:, 1]\n\nmod = GaussianModel()  # 实例化一个模型\npars = mod.guess(y, x=x)  # 给初值\nout = mod.fit(y, pars, x=x)  # 拟合结果\n\nprint(out.fit_report())  # 拟合结果的详细信息\nplt.plot(x, out.init_fit, 'k--')\nplt.plot(x, out.best_fit, 'r-')\n```\n\n```python\n%matplotlib inline\n%run examples/lmfits/fit_peak.py\n```\n\n    [[Model]]\n        Model(voigt)\n    [[Fit Statistics]]\n        # fitting method   = leastsq\n        # function evals   = 21\n        # data points      = 401\n        # variables        = 4\n        chi-square         = 10.9301767\n        reduced chi-square = 0.02753193\n        Akaike info crit   = -1436.57602\n        Bayesian info crit = -1420.60017\n    [[Variables]]\n        sigma:      0.89518909 +/- 0.01415450 (1.58%) (init = 0.8775)\n        center:     9.24374847 +/- 0.00441903 (0.05%) (init = 9.25)\n        amplitude:  34.1914737 +/- 0.17946860 (0.52%) (init = 65.43358)\n        gamma:      0.52540198 +/- 0.01857955 (3.54%) (init = 0.7)\n        fwhm:       3.22385343 +/- 0.05097475 (1.58%) == '3.6013100*sigma'\n        height:     10.0872204 +/- 0.03482130 (0.35%) == 'amplitude*wofz((1j*gamma)/(sigma*sqrt(2))).real/(sigma*sqrt(2*pi))'\n    [[Correlations]] (unreported correlations are < 0.100)\n        C(sigma, gamma)     = -0.928\n        C(amplitude, gamma) =  0.821\n        C(sigma, amplitude) = -0.651\n    \n\n\n\n    \n![png](/advance/advance_279_1.png)\n    \n\n\n多个模型叠加:\n\n```python\nfrom lmfit.models import ExponentialModel, GaussianModel\n\ndata = np.loadtxt('NIST_Gauss2.dat')\nx = data[:, 0]\ny = data[:, 1]\n\nexp_mod = ExponentialModel(prefix='exp_')\ngauss1 = GaussianModel(prefix='g1_')\ngauss2 = GaussianModel(prefix='g2_')\n\npars1 = exp_mod.guess(y, x=x)  # 分段设参数的方法见下面的脚本文件\npars2 = gauss1.guess(y, x=x)\npars3 = gauss2.guess(y, x=x)\n\npars = pars1 + pars2 + pars3  # 叠加参数\nmod = gauss1 + gauss2 + exp_mod  # 叠加模型\n\nout = mod.fit(y, pars, x=x)\n\nprint(out.fit_report())\nplt.plot(x, y, 'b')\nplt.plot(x, out.init_fit, 'k--')\nplt.plot(x, out.best_fit, 'r-')\n```\n\n```python\n%%capture output\n%matplotlib inline\n%run examples/lmfits/fit_peaks.py\n```\n\n```python\noutput.outputs[0]\n```\n\n\n\n\n    \n![png](/advance/advance_283_0.png)\n    \n\n\n\n```python\n%%capture output\n%matplotlib inline\n%run examples/lmfits/fit_peaks_components.py\n```\n\n```python\noutput.outputs[0]\n```\n\n\n\n\n    \n![png](/advance/advance_285_0.png)\n    \n\n\n\n自定义模型的方法见 [LMFIT网站示例](http://lmfit.github.io/lmfit-py/builtin_models.html#user-defined-models)\n\n### 其他\n\n* Sherpa(Modeling and Fitting) <http://cxc.cfa.harvard.edu/contrib/sherpa/><br>\n* 2-D Fitting in Sherpa <https://python4astronomers.github.io/fitting/image.html><br>\n* *etc.*\n\n## copy 注意事项\n\n**\"shallow copy\"** vs **\"deep copy\"**\n\n* 对于 list 的情况\n\n演示插件 <https://github.com/lgpage/nbtutor>\n\n```python\n%%nbtutor -r -f -i\nfrom copy import deepcopy\na = [1, 2, 3]\nb = a\nc = deepcopy(a)\nd = a[:] # 列表的切片是深拷贝\nb[0] = -1\nc[1] = -2\nd[2] = -3\n```\n\n    \n\n```python\nprint(id(a), id(b), id(c), id(d))\n```\n\n    23284866388232 23284866388232 23284855519880 23284856061064\n\n\n[网页版演示](http://t.cn/RgK1OHf)\n\n<img src='/advance/nbtutor3.png' width='550'/>\n\n* 对于 dict 的情况\n\n```python\n%%nbtutor -r -f -i\nfrom copy import deepcopy\na = {1:1, 2:2, 3:3}\nb = a\nc = a.copy()  # 深拷贝\nd = deepcopy(a)\nb[1] = -1\nc[2] = -2\nd[3] = -3\n```\n\n    \n\n```python\nprint(id(a), id(b), id(c), id(d))\n```\n\n    22492371132064 22492371132064 22492397510376 22492397507280\n\n\n[网页版演示](http://t.cn/RgKrHOx)\n\n<img src='/advance/nbtutor4.png' width='550'/>\n\n* 对于 set 的情况\n\n```python\n%%nbtutor -r -f -i\nfrom copy import deepcopy\na = {1, 2, 3}\nb = a\nc = a.copy()  # 深拷贝\nd = deepcopy(a)\nb.add(4)\nc.add(5)\nd.add(6)\n```\n\n    \n\n```python\nprint(id(a), id(b), id(c), id(d))\n```\n\n    22492476895528 22492476895528 22492476895304 22492374233384\n\n\n[网页版演示](http://t.cn/RgKd3E7)\n\n<img src='/advance/nbtutor5.png' width='550'/>\n\n* 对于 numpy 的情况\n\n```python\n%%nbtutor -r -f -i\nimport numpy as np\na = np.arange(1, 4)\nb = a[:] # 浅拷贝!\nc = a.copy()  # 深拷贝, 同 deepcopy(a)\nd = a[[0, 2]]  # 花式切片是深拷贝\nb[0] = -1\nc[1] = -2\nd[1] = -3\n```\n\n    \n\n```python\n# id 虽各不同, 但 .__array_interface__['data'][0] 可能相同\nfor i in (a, b, c, d):\n    print(id(i), i.__array_interface__['data'][0])\n```\n\n    22928831926400 93879086511872\n    22928831928960 93879086511872\n    22928829201984 93879072448320\n    22928829199344 93879078700736\n\n\n[网页版演示](http://t.cn/Rg9hST6) (**Site Error**: Ruby and Python+Anaconda backends are permanently unavailable)\n\n参见之前的 [np.matrix, np.asmatrix](#矩阵)\n\n## 其他格式文件读写\n\n### 用 pandas 读 csv\n\n```python\nimport pandas as pd\ndata = pd.read_csv(\"data/data.csv\")\ndata\n```\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>col1</th>\n      <th>col2</th>\n      <th>col3</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>row1</td>\n      <td>1</td>\n      <td>10.0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>row2</td>\n      <td>2</td>\n      <td>0.2</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>row3</td>\n      <td>3</td>\n      <td>300.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n```python\ndata.columns\n```\n\n\n\n\n    Index(['col1', 'col2', 'col3'], dtype='object')\n\n\n\n```python\ndata.col1\n```\n\n\n\n\n    0    row1\n    1    row2\n    2    row3\n    Name: col1, dtype: object\n\n\n\n```python\ndata['col1']\n```\n\n\n\n\n    0    row1\n    1    row2\n    2    row3\n    Name: col1, dtype: object\n\n\n\n只取一部分:\n\n```python\ndata = pd.read_csv(\"data/data.csv\", nrows=2, usecols=(0,2))\ndata\n```\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>col1</th>\n      <th>col3</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>row1</td>\n      <td>10.0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>row2</td>\n      <td>0.2</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n对于超大文件, 参见: <https://www.dataquest.io/blog/pandas-big-data/>\n\n### Fortran 二进制文件读写\n\n#### Unformatted (sequential)\n\n使用 `scipy.io.FortranFile`<br>\n参考: <https://docs.scipy.org/doc/scipy-0.15.1/reference/generated/scipy.io.FortranFile.read_record.html>\n\n```python\n# python (write)\nfrom scipy.io import FortranFile\nvar1 = 1.1  # '<f8'\nvar2 = 0  # '<i8'\narr = np.arange(6.).reshape((2, 3))  # '(2, 3)<f8'\nprint(var1, var2)\nprint(arr)\nprint(f'arr[0, 1] = {arr[0, 1]}')\n\n# 多行存入\nwith FortranFile('data/data_fortran1-1.dat', 'w') as f:\n    f.write_record(var1)\n    f.write_record(var2)\n    f.write_record(arr)\n# 单行存入\nwith FortranFile('data/data_fortran1-2.dat', 'w') as f:\n    f.write_record(var1, var2, arr)\n```\n\n    1.1 0\n    [[0. 1. 2.]\n     [3. 4. 5.]]\n    arr[0, 1] = 1.0\n\n\n```python\n# python (read)\nfrom scipy.io import FortranFile\n# 多行存入的情况\nwith FortranFile('data/data_fortran1-1.dat', 'r') as f:\n    var1 = float(f.read_record('<f8'))\n    var2 = int(f.read_record('<i8'))  # 注意精度(上面python存入的是默认'int64')\n    arr = f.read_record('(2, 3)<f8')\nprint('data_fortran1-1.dat')\nprint(var1, var2)\nprint(arr)\n# 单行存入的情况\nwith FortranFile('data/data_fortran1-2.dat', 'r') as f:\n#     data = f.read_record('<f8, <i8, (2, 3)<f8')  # 不指定名称\n    data = f.read_record([('var1', '<f8'), ('var2', '<i8'),\n                         ('arr', '(2, 3)<f8')])  # 指定名称: (name, dtype)\nprint('\\ndata_fortran1-2.dat')\nprint(f'keys = {data.dtype.names}')  # 如读取时未指定名称则为 ['f0', 'f1', ...]\nprint(float(data['var1']), int(data['var2']))\nprint(data['arr'])\n```\n\n    data_fortran1-1.dat\n    1.1 0\n    [[0. 1. 2.]\n     [3. 4. 5.]]\n    \n    data_fortran1-2.dat\n    keys = ('var1', 'var2', 'arr')\n    1.1 0\n    [[[0. 1. 2.]\n      [3. 4. 5.]]]\n\n\n```bash\n%%bash\ncd examples/\nifort -o test_read_seq test_read_seq.f90\n./test_read_seq\n```\n\n     data_fortran1-1.dat\n       1.1  0.0\n       0.0  1.0  2.0\n       3.0  4.0  5.0\n     arr(2, 1) =   1.0\n    \n     data_fortran1-2.dat\n       1.1  0.0\n       0.0  1.0  2.0\n       3.0  4.0  5.0\n     arr(2, 1) =   1.0\n\n\n见 Structured arrays: <https://docs.scipy.org/doc/numpy/user/basics.rec.html>\n\n#### Unformatted (stream)\n\n`struct` 参考 <https://docs.python.org/3/library/struct.html>\n\n```python\n# python (write)\nimport struct\nvar1 = 1.1  # '<f8'\nvar2 = 0  # '<i8'\narr = np.arange(6.).reshape((2, 3))  # '(2, 3)<f8'\nprint(var1, var2)\nprint(arr)\nprint(f'arr[0, 1] = {arr[0, 1]}')\nwith open('data/data_fortran2.dat', 'wb') as f:\n    f.write(struct.pack('d', var1))\n    f.write(struct.pack('i', var2))  # 注意 `struct` 的 'i' 是 '<i4'\n    arr.tofile(f)\n```\n\n    1.1 0\n    [[0. 1. 2.]\n     [3. 4. 5.]]\n    arr[0, 1] = 1.0\n\n\n```python\n# python (read)\n# 使用 `np.fromfile`, 读入的是 `ndarray`\nwith open('data/data_fortran2.dat', 'rb') as f:\n    var1 = float(np.fromfile(f, dtype='<f8', count=1))\n    var2 = int(np.fromfile(f, dtype='<i4', count=1))\n    arr = np.fromfile(f, dtype='<f8').reshape(2, 3)\nprint(var1, var2)\nprint(arr)\n```\n\n    1.1 0\n    [[0. 1. 2.]\n     [3. 4. 5.]]\n\n\n```bash\n%%bash\ncd examples/\nifort -o test_read_stream test_read_stream.f90\n./test_read_stream\n```\n\n      1.1 0.0\n      0.0 1.0 2.0\n      3.0 4.0 5.0\n     arr(2, 1) =  1.0\n\n\n### HDF5 文件读写, NCDF, CDF 文件读取\n\n#### 读写 HDF5 文件, 读 NCDF 文件\n\nHDF5 格式介绍 <https://portal.hdfgroup.org/display/HDF5/Introduction+to+HDF5>\n\n相关包: `h5py` 或 `pandas` + `pytables` (http://www.pytables.org/usersguide/datatypes.html)\n\n安装见 [Python 安装和配置](installpy.html#其他)\n\n* 查看\n\n```sh\n$ h5dump -H <filename>.hdf5\n$ ncdump -h <filename>.ncdf\n```\n\n* 用 `h5py` 读写:\n\n```python\nimport h5py\narr = np.arange(10000).reshape(50,-1)\nwith h5py.File('test.hdf5', 'w') as f:\n    f['data'] = arr\n    # 或\n    # f.create_dataset('data', data=arr)\n    # 其中 compression='gzip', compression_opts=[0-9], 可分条目用不同压缩\n    f['lb'] = list(range(100))\n```\n&emsp;读纯 HDF5/NCDF 文件:\n```python\nf = h5py.File('test.hdf5', 'r')\nkeys = list(f.keys())  # ['data', 'lb']\nitems = list(f.items())\na = f['data'].value\n```\n&emsp;读 pandas 存的文件:\n```python\na = f['data']['block0_values'].value\nf.close()\n# f['<key>'] 得到的是 Dataset 或 Group 的引用\n# 用 f['<key>'].value 或切片 f['<key>'][:] 得到原来的格式\n# f['<key>'] 可替代为f.get('<key>')\n# 关闭之后 f['data'] 的引用失效, 因此存出数据要加上.value或[:]保存数据, 或使用 deepcopy\n```\n&emsp;打印读取的信息:\n```python\nfrom pprint import pprint\npprint([(f'{k:>20}', f'{str(f[k].shape):>20}', f'{str(f[k].dtype):>20}') for k in f.keys()])\npprint([(f'{k:>20}', f\"{str(f[k]['block0_values'].shape):>20}\", f\"{str(f[k]['block0_values'].dtype):>20}\") for k in f.keys()])\n```\n\n* 用pandas读写:\n    \n```python\nimport pandas as pd\n```\n&emsp;写:\n```python\narr2 = pd.DataFrame(arr)\n# complevel=[0-9], complib={'zlib', 'lzo', 'bzip2', 'blosc'}\nwith pd.HDFStore('test2.hdf5', 'w') as f:\n    f['data'] = arr2\n    f['lb'] = pd.DataFrame(list(range(100)))\n```\n&emsp;读 pandas 写的文件:\n```python\nf = pd.HDFStore('test2.hdf5', 'r')\nkeys = f.keys()  # ['/data', '/lb'], 存在子目录\nitems = list(f.items())\na = f.data.values  # a = f.<key> 得到的是 DataFrame 的引用, f.<key>.values 得到原来的格式\nf.close()\n```\n\n* 读纯 HDF5/NCDF 文件:<br>\n比如 h5py 写的文件, 目录结构和 pandas 写的不同, 要用`.root`<br>\n其他软件生成的文件可能不能读\n\n```python\nf = pd.HDFStore('test.hdf5', 'r')\nkeys = list(f.root._v_children.keys())  # ['data', 'lb']\nitems = list(f.root._v_children.items())  # ['data', 'lb'], 有些文件没有.items\na = f.root.data.read()\n# f.root 得到 tables.group.RootGroup, f.root.<key> 得到tables.group.CArray\n# f.get_node('<key>') 得到 tables.group.CArray\n# f.root.<key> 可替代为 f['<key>'] (有些文件不行)\nf.close()\n```\n&emsp;打印 (以免数据有 None, 用 `np.shape`):\n```python\npprint([(f'{k}'                      .rjust(20),\n         f'{np.shape(f.get_node(k))}'.rjust(20),\n         f'{np.dtype(f.get_node(k))}'.rjust(20))\n         for k in list(f.root._v_children.keys())])\n```\n&emsp;Bug: 无法读出 `H5T_STRING`\n\n#### 大小比较\n\n用于比较的文件名说明:\n\nFilename | Method\n:---|:---\n*xxx*_np.npy|**`np.save`**\n*xxx*_np.npz|**`np.savez_compressed`**\n*xxx*_compimg.fits|**FITS** CompImageHDU (compressed)\n*xxx*_prim.fits|**FITS** PrimaryHDU\n*xxx*_h5py_0.hdf5|**`h5py`** no compression\n*xxx*_h5py_gzip.hdf5|**`h5py`** compression='gzip', compression_opts=9\n*xxx*_h5py_lzf.hdf5|**`h5py`** compression='lzf'\n*xxx*_pd_0.hdf5|**`pandas`** no compression\n*xxx*_pd_blosc.hdf5|**`pandas`** complib='blosc', complevel=9\n*xxx*_pd_bzip2.hdf5|**`pandas`**  complib='bzip2', complevel=9\n*xxx*_pd_lzo.hdf5|**`pandas`**  complib='lzo', complevel=9\n*xxx*_pd_zlib.hdf5|**`pandas`**  complib='zlib', complevel=9\n\n* 对于相关性强的数组\n\n```python\n%run examples/test_hdf5.py\nprint()\n!du -h data/test_*.np*\nprint()\n!du -h data/test_h5py_*.hdf5\nprint()\n!du -h data/test_pd_*.hdf5\n```\n\n    array: 15.3 M\n    \n    7.7M\tdata/test_np.npy\n    1.3M\tdata/test_np.npz\n    \n    16M\tdata/test_h5py_0.hdf5\n    2.9M\tdata/test_h5py_gzip.hdf5\n    7.7M\tdata/test_h5py_lzf.hdf5\n    \n    16M\tdata/test_pd_0.hdf5\n    272K\tdata/test_pd_blosc.hdf5\n    248K\tdata/test_pd_bzip2.hdf5\n    256K\tdata/test_pd_lzo.hdf5\n    172K\tdata/test_pd_zlib.hdf5\n\n\n* 随机数数组\n\n```python\n%run examples/test_hdf5_2.py\nprint()\n!du -h data/test_*.np*\nprint()\n!du -h data/test_h5py_*.hdf5\nprint()\n!du -h data/test_pd_*.hdf5\n```\n\n    array: 15.3 M\n    \n    7.7M\tdata/test_np.npy\n    7.2M\tdata/test_np.npz\n    \n    16M\tdata/test_h5py_0.hdf5\n    8.0M\tdata/test_h5py_gzip.hdf5\n    9.5M\tdata/test_h5py_lzf.hdf5\n    \n    16M\tdata/test_pd_0.hdf5\n    7.7M\tdata/test_pd_blosc.hdf5\n    7.2M\tdata/test_pd_bzip2.hdf5\n    7.7M\tdata/test_pd_lzo.hdf5\n    7.1M\tdata/test_pd_zlib.hdf5\n\n\n* 从 FITS 文件读取再转存\n\n```python\nfname = 'data/hmi.B_720s.20150827_052400_TAI.field.fits'\n%run examples/test_fits_hdf5.py {fname}\nprint()\n!du -h {fname}\nprint()\n!du -h data/fits_*.np*\nprint()\n!du -h data/fits_*.fits\nprint()\n!du -h data/fits_h5py_*.hdf5\nprint()\n!du -h data/fits_pd_*.hdf5\n```\n\n    array: 64.0 M\n    \n    21M\tdata/hmi.B_720s.20150827_052400_TAI.field.fits\n    \n    65M\tdata/fits_np.npy\n    27M\tdata/fits_np.npz\n    \n    21M\tdata/fits_compimg.fits\n    65M\tdata/fits_prim.fits\n    \n    65M\tdata/fits_h5py_0.hdf5\n    27M\tdata/fits_h5py_gzip.hdf5\n    40M\tdata/fits_h5py_lzf.hdf5\n    \n    65M\tdata/fits_pd_0.hdf5\n    23M\tdata/fits_pd_blosc.hdf5\n    21M\tdata/fits_pd_bzip2.hdf5\n    23M\tdata/fits_pd_lzo.hdf5\n    20M\tdata/fits_pd_zlib.hdf5\n\n\n```python\nfname = 'data/hmi.B_720s.20150827_052400_TAI.disambig.fits'\n%run examples/test_fits_hdf5.py {fname}\nprint()\n!du -h {fname}\nprint()\n!du -h data/fits_*.np*\nprint()\n!du -h data/fits_*.fits\nprint()\n!du -h data/fits_h5py_*.hdf5\nprint()\n!du -h data/fits_pd_*.hdf5\n```\n\n    array: 32.0 M\n    \n    5.4M\tdata/hmi.B_720s.20150827_052400_TAI.disambig.fits\n    \n    33M\tdata/fits_np.npy\n    5.2M\tdata/fits_np.npz\n    \n    5.4M\tdata/fits_compimg.fits\n    33M\tdata/fits_prim.fits\n    \n    33M\tdata/fits_h5py_0.hdf5\n    5.3M\tdata/fits_h5py_gzip.hdf5\n    9.7M\tdata/fits_h5py_lzf.hdf5\n    \n    33M\tdata/fits_pd_0.hdf5\n    9.5M\tdata/fits_pd_blosc.hdf5\n    4.1M\tdata/fits_pd_bzip2.hdf5\n    7.6M\tdata/fits_pd_lzo.hdf5\n    4.8M\tdata/fits_pd_zlib.hdf5\n\n\n#### 读取 CDF 文件\n\n相关包 `cdflib`, 安装见 [Python 安装和配置#其他](installpy.html#其他)\n```python\nimport cdflib\nf = cdflib.CDF(\"<filename>.cdf\")\nf.cdf_info()  # 总体信息\nf.varinq('<key>')  # 变量信息\nf.varget('<key>')  # 值\nf.close()\n```\n\n### NumPy to VTK\n\n参考 <https://pyscience.wordpress.com/2014/09/06/numpy-to-vtk-converting-your-numpy-arrays-to-vtk-arrays-and-files/><br>\n以及 [Python 安装和配置](installpy.html#其他)\n<br><br>\ne.g.<br>\n运行 [examples/field2dvtk.py](examples/field2dvtk.py) ,<br>\n打开Paraview, 选择 state 文件 'field2d.pvsm', 再选择数据文件 'field2d.vtr'\n\n### Matlab mat 文件读写\n\n(未测试)\n```python\nimport scipy.io\nscipy.io.loadmat(\"<filename>\", mdict=None, appendmat=True, **kwargs)\n# 如果 appendmat=True，则文件名不需要'.mat'后缀)\nscipy.io.savemat(\"<filename>\", mdict, appendmat=True, format='5',\n                 long_field_names=False, do_compression=False, oned_as='row')\n```\n\n## 脚本相关\n\n### 脚本结构\n\n文件头:\n```python\n#!/usr/bin/env python\n# -*- coding: utf-8 -*-\n```\n\n脚本结构:\n```python\n#!/usr/bin/env python\n# -*- coding: utf-8 -*-\n\"\"\"\n假设这个文件的名称为 mymodule.py\n使用 `imort mymodule` 导入\n这些文字会出现在 `help(mymodule)` 或 `pydoc mymodule` 中\n\"\"\"\nc = 1\ndef func1(x, y, *args, **kwargs):\n    \"\"\"\n    这个注释必须缩进\n    args: a tuple - (arg1, arg2, ...)\n    kwargs: a dict - {key1 : val1, key2 : val2}\n    \"\"\"\n    global c\n    return x + y + c\ndef func2(x):\n    a = func1(x, x)\n    return a\ndef _func3(x):  # `from xxx import *` 将不会导入这个函数\n    pass\n    return  # return 不写时返回 None\ndef main():\n    # your code here\nif __name__ == \"__main__\":\n    main()\n```\n`import` 这个文档时, `__name__` 为模块名, 因此 `main()` 不执行\n\n`help()` 也可以查看模块内的函数文档:\n\n```python\nimport usr_sunpy\nhelp(usr_sunpy.plot_map)\n```\n\n### try ... except ... 语法\n\n```python\ntry:\n    ...\nexcept ValueError as e:\n    print('ValueError:', e)\nexcept ZeroDivisionError as e:\n    print('ZeroDivisionError:', e)\nelse:\n    print('no error!')\nfinally:\n    print('finally...')\n```\n见 [Paraview 的例子](#Paraview-脚本)\n\n### Paraview 脚本\n\n官方文档 <https://www.paraview.org/ParaView/Doc/Nightly/www/py-doc/index.html>\n<br><br>\n* 记录语句:\n 1. Tools -> Start Trace\n 2. 进行各种操作\n 3. Tools -> Stop Trace 之后得到一个包含刚才操作命令的脚本, 参考其中的语句就可以写自己的脚本了.\n<br><br>\n* 需要导入的模块:\n\n```sh\nfrom paraview.simple import *\n```\n<br>\n* 使用 pvpython (默认渲染) pvbatch (默认不渲染) 来执行脚本:\n\n```sh\npvbatch myscript.py\n```\n\n也可以使用文件头 `#!/usr/bin/env pvbatch`, 加执行权限后直接执行:\n```sh\n./myscript.py\n```\n注意: 打包的 paraview 所使用的 python 是 paraview 自带的 python2.7\n\n<img src='/advance/Screenshot_20180618-151438.png' width='700' />\n\n* 常用语句:\n\n```python\nview = GetActiveView()\nscene = GetAnimationScene()\n```\n`view.ViewTime` 修改时 `scene.AnimationTime` 不变\n`scene.AnimationTime` 修改时 `view.ViewTime` 也同时被改变\n\n注意: filter 必须是显示状态 (`Show(<filter>)`) 才能修改时间\n\n```python\n# e.g.\n!code -n examples/stat1.py\n```\n\n* 字体选择参考路径:<br>\n  - /usr/share/fonts/truetype/dejavu/DejaVuSans.ttf\n  - /home/<user>/miniconda3/lib/python3.6/site-packages/matplotlib/mpl-data/fonts/ttf/DejaVuSans.ttf\n\n\n* python 调用问题 (paraview 5.5.0+ 没有这个问题):\n\nparaview 某个版本之后就默认使用 python 2.7.11+.<br>\n运行之前先修改环境变量 ( `PYTHONPATH` 和 `PYTHONSTARTUP`), <br>\n运行结束结束后恢复这两个变量即可.<br><br>\n这个过程可以使用脚本 (而不用alias):\n```sh\n#!/bin/bash\nunset PYTHONSTARTUP  # 如果有的话\nexport PYTHONPATH=/<your_path>/ParaView/lib/python2.7/site-packages\n/<your_path>/ParaView/bin/paraview $@\n```\n用这个脚本替代原有 `paraview`, `pvpython` 和 `pvbatch` 命令.\n\n### Python 2 -> 3 的转换\n\n比较推荐的安全的检查方式:\n\n* 备份的原文件且自动生成转换过的文件\n```\n$ 2to3 -w filename\n```\n\n* 手动比较, 在需要的地方对照修改 filename.bak<br>\n主要查看 print, range, map 等函数.<br>\n添加<br>\n&emsp;`from __future__ import division, print_function`<br>\n在其他 import 前.\n```\n$ sudo apt-get install meld\n$ meld filename filename.bak\n```\n* 确认无误后, 将手动修改的文件复制回去\n```\n$ mv -v filename.bak filename\n```\n\npython 内查看版本的方法, 可用于 `if` 语句等 (更推荐用 `try...except...` 语法):\n\n```python\nimport sys\nprint(sys.version_info >= (3, 0))\nprint(sys.version_info.major >= 3)\n```\n\n### 执行 shell 命令\n\n<https://docs.python.org/3/library/subprocess.html>\n\n```python\nimport subprocess\n\nfname = 'installpy.ipynb'\n\n# 默认是以列表形式传递参数\nsubprocess.run([\"ls\", \"-l\", fname]) # doesn't capture output\n\n# 输出结果需要 `decode('ascii')` 转码\nprint(subprocess.run([\"ls\", \"-l\", fname], stdout=subprocess.PIPE)\n                    .stdout.decode('ascii'))\nprint(subprocess.check_output([\"ls\", \"-l\", fname]).decode('ascii'))\n```\n\n    -rw-rw-r-- 1 lydia lydia 142508 Jun 24 16:21 installpy.ipynb\n    \n    -rw-rw-r-- 1 lydia lydia 142508 Jun 24 16:21 installpy.ipynb\n    \n\n\n利用 bash 的特长来做一些字符串操作:\n\n```python\n# 使用整行命令需要 `shell=True`, 虽然并不是推荐的做法, 但偶尔使用无妨 (见官方文档)\n# `r`用来取消转义\n# `echo`使用`-n`来去掉输出的 '\\n'\nfname_head = subprocess.check_output(r\"echo -n %s | sed 's/\\.ipynb//'\"\n                                     % fname, shell=True).decode('ascii')\n# 或使用 strip 去掉 '\\n'\nfname_head = subprocess.check_output(r\"echo %s | sed 's/\\.ipynb//'\"\n             % fname, shell=True).strip().decode('ascii')  \nprint(fname_head)\n```\n\n    installpy\n\n\n字符串编码见 [廖雪峰的网站](https://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000/001431664106267f12e9bef7ee14cf6a8776a479bdec9b9000)\n\n* 得到命令执行的路径\n\n```python\nimport os\nos.getcwd()\n```\n\n\n\n\n    '/home/lydia/codes/zly/python/python-intro'\n\n\n\n* 得到脚本文件所在的路径(仅脚本中使用)\n\n```python\nos.path.split(os.path.abspath(__file__))[0]\n```\n或\n```python\nos.path.dirname(os.path.abspath(__file__))\n```\n\n其中 `os.path.split` 和 `os.path.dirname` 的用法:\n\n```python\nos.path.split('your/path/filename')\n```\n\n\n\n\n    ('your/path', 'filename')\n\n\n\n```python\nos.path.dirname('your/path/filename')\n```\n\n\n\n\n    'your/path'\n\n\n\n`os.path.dirname` 类似于 bash 的 `dirname`\n\n```python\n!dirname 'your/path/filename'\n```\n\n    your/path\n\n\n### 脚本选项\n\n推荐 `argparse`, 在过去的其他方法的基础上有所增强 <https://docs.python.org/3/library/argparse.html>\n\n脚本内:\n```python\nimport argparse\nparser = argparse.ArgumentParser(description='Process some integers.')\nparser.add_argument('integers', metavar='N', type=int, nargs='+',\n                    help='an integer for the accumulator')\nparser.add_argument('--sum', dest='accumulate', action='store_const',\n                    const=sum, default=max,\n                    help='sum the integers (default: find the max)')\nargs = parser.parse_args()\nprint(args.accumulate(args.integers))\n```\nShell:\n```\n$ python prog.py -h\nusage: prog.py [-h] [--sum] N [N ...]\nProcess some integers.\npositional arguments:\n N           an integer for the accumulator\noptional arguments:\n -h, --help  show this help message and exit\n --sum       sum the integers (default: find the max)\n```\n\n### 处理 warnings\n\n```python\n# Suppress warnings of NaNs:\nwith np.errstate(invalid='ignore'):\n    ...\n    ...\n# Suppress other warnings, e.g.\nimport warnings\nwith warnings.catch_warnings():\n    warnings.simplefilter(\"ignore\")\n    ...\n    ...\n# Or\nwarnings.simplefilter(\"ignore\", category=xxx)  # UserWarning, FutureWarning, etc.\n...\n...\n```\n\n## urllib, requests\n\n示例和文件来自 <http://python4astronomers.github.com>\n\n注意 python3 不再使用 `urllib2`\n\n```python\n# 方法1\nimport urllib\nurl = 'http://python4astronomers.github.com/_downloads/myidlfile.sav'\nurllib.request.urlretrieve(url, 'myidlfile.sav')\n# 方法2\nwith open('myidlfile.sav', 'wb') as f:\n    f.write(urllib.request.urlopen(url).read())\n# 方法3\nimport requests\nwith open('myidlfile.sav', 'wb') as f:\n    f.write(requests.get(url).content)\n# 分块下载\nimport requests\nr = requests.get(<url>)\nwith open(filename, 'wb') as f:\n    for chunk in r.iter_content(chunk_size=128):\n        f.write(chunk)\n```\n","source":"_posts/2018-07-02-advance.md","raw":"---\ntitle: \"Python 进阶 (lecture for Solar Group)\"\nmathjax: true\npermalink: advance.html\ncategories: 'Solar Physics'\ntags: [python, conda, jupyter, astropy, sunpy]\ndate: 2018-07-02 21:46:13\n---\n[<i class=\"fas fa-download\"></i> Jupyter Notebook](/downloads/notebooks/python-intro.zip)\n\n## Anaconda\n\n> A **conda package** is a compressed tarball file that contains system-level libraries,\nPython or other modules, executable programs and other components.\n**Conda** keeps track of the dependencies between packages and platforms.<br>\n(https://conda.io/docs/user-guide/concepts.html)\n\n* 凡使用 <span style=\"color:blue\">pip install</span> 安装的包均为编译安装, <span style=\"color:blue\">conda install</span> 安装的则为编译好的二进制包.\n* conda 包可以打包其他语言, pip 包容易出现系统依赖问题\n* conda 包的依赖管理更完善\n* conda 环境下仍可使用 pip 进行安装, 但所使用的 pip 命令和系统中的 pip 互不影响, 安装的包的位置也在 conda 本身的目录下.\n* 每个环境互不影响, 各环境下的包虽然必须分别安装 (也可以 clone 一个现有环境),<br>\n  但如果有不同环境中有重复的包 conda 将默认使用 *hard link*.\n\n(更多讨论参考 <http://jakevdp.github.io/blog/2016/08/25/conda-myths-and-misconceptions/)>\n<!-- more -->\n\n<img src='/advance/Screenshot_20180617-181206.png' width='650'/>\n\n* python 位置 (未使用 conda 时)\n\n使用\n```\n$ python -m site\n```\n可以看到有哪些目录.\n\n三个部分:\n\n- **root**\n<pre>\n/<span style=\"color:#800080\"><b>usr</b></span>/lib/...\n/<span style=\"color:#800080\"><b>usr</b></span>/bin/...\n</pre>\n\n- **user**\n<pre>\n/home/&lt;user&gt;/<span style=\"color:#800080\"><b>.local</b></span>/lib/...\n/home/&lt;user&gt;/<span style=\"color:#800080\"><b>.local</b></span>/bin/...\n</pre>\n\n- **anaconda/miniconda**\n<pre>\n/home/&lt;user&gt;/<b><span style=\"color:#800080\">miniconda3</span></b>/</span>/lib/...\n/home/&lt;user&gt;/<b><span style=\"color:#800080\">miniconda3</span></b>/</span>/bin/...\n</pre>\n\n* conda 目录结构 (安装之后自动修改了软连接, 修改环境变量后系统优先使用这个位置)\n\n<pre>\n/home/&lt;user&gt;/<span style=\"color:#800080\"><b>miniconda3/</b></span>\n    ├── <span style=\"color:navy\"><b>pkgs/</b></span>\n    ├── <span style=\"color:dimgray\"><b>bin/</b></span>\n    │        ├── <span style=\"color:magenta\">python</span> -&gt; <span style=\"color:green\">python3.6</span>\n    │        ├── <span style=\"color:magenta\">python3</span> -&gt; <span style=\"color:green\">python3.6</span>\n    │        ├── <span style=\"color:green\">python3.6</span>\n    │        ├── <span style=\"color:green\">jupyter</span>\n    │        ├── <span style=\"color:green\">h5dump</span>\n    │        └── ...\n    ├── <span style=\"color:dimgray\"><b>include/</b></span>\n    ├── <span style=\"color:dimgray\"><b>lib/</b></span>\n    ├── <span style=\"color:dimgray\"><b>share/</b></span>\n    ├── <span style=\"color:navy\"><b>envs</b></span>\n    │        ├── <span style=\"color:blue\"><b>env1/</b></span>\n    │        │        ├── <span style=\"color:dimgray\"><b>bin/</b></span>\n    │        │        ├── <span style=\"color:dimgray\"><b>include/</b></span>\n    │        │        ├── <span style=\"color:dimgray\"><b>lib/</b></span>\n    │        │        ├── <span style=\"color:dimgray\"><b>share/</b></span>\n    │        │        └── ...\n    │        ├── <span style=\"color:blue\"><b>env2/</b></span>\n    │        └── ...\n    └── ...\n</pre>\n\n## IPython & Jupyter\n\n参考文档\n<http://jupyter-notebook.readthedocs.io/en/stable/>\n\n* 配置文件路径\n\n一般用户配置文件在 `~/.jupyter`\n\n```python\n!jupyter --paths\n```\n\n    config:\n        /home/lydia/.jupyter\n        /home/lydia/miniconda3/etc/jupyter\n        /usr/local/etc/jupyter\n        /etc/jupyter\n    data:\n        /home/lydia/.local/share/jupyter\n        /home/lydia/miniconda3/share/jupyter\n        /usr/local/share/jupyter\n        /usr/share/jupyter\n    runtime:\n        /run/user/1000/jupyter\n\n\n* 列出所有 magic functions:\n\n```python\n%lsmagic\n```\n\n* 运行脚本:\n\n```python\n%run script.py\n%run script.ipynb\n```\n\n* 在单个 Cell 中调用其他语言 (子进程):\n\n```sh\n%%sh\ncd ~/miniconda3/\npwd\n```\n\n    /home/lydia/miniconda3\n\n\n可以看到实际并未改变当前目录 (因为是子进程):\n\n```python\npwd\n```\n\n\n\n\n    '/home/lydia/codes/zly/python/python-intro'\n\n\n\n```python\n%%script idl\ncd, current=d\nprint, d\n```\n\n    /home/lydia/codes/zly/python/python-intro\n\n\n    IDL Version 8.2.1 (linux x86_64 m64). (c) 2012, Exelis Visual Information Solutions, Inc.\n    \n\n\n* 逐行使用 bash 命令 (注意不加 '!' 的区别):\n\n```python\n!idl -e field3dgui\n```\n\n```python\n!ls ./\n```\n\n得到的结果可以存入变量:\n\n```python\ncurrent, = !pwd  # returns a list\ncurrent\n```\n\n\n\n\n    '/home/lydia/python-intro'\n\n\n\n下面这两句不能写在一个 Cell 中:\n\n```python\ncd -q ~/miniconda3/\n```\n\n```python\npwd\n```\n\n\n\n\n    '/home/lydia/miniconda3'\n\n\n\n用 `{var}` (推荐) 或 `$var` (不推荐) 调用当前 ipython 环境的变量:\n\n```python\ncd {current}\n```\n\n    /home/lydia/codes/zly/python/python-intro\n\n\n```python\ncd \"$current\"\n```\n\n    /home/lydia/codes/zly/python/python-intro\n\n\n```python\ncd $current\n```\n\n    /home/lydia/codes/zly/python/python-intro\n\n\n见 <http://mmcdan.github.io/posts/interacting-with-the-shell-via-jupyter-notebook/>\n\n* 列出当前的变量信息\n\n```python\na = 1\nb = 'x'\n\n%whos int str\n```\n\n    Variable   Type    Data/Info\n    ----------------------------\n    a          int     1\n    b          str     x\n\n\n## 语法细节\n\n### python2 & python3\n\n```python\n%%python2\nprint 1 / 2\nprint 1 // 2\n```\n\n    0\n    0\n\n\n```python\n%%python3\nprint(1 / 2)\nprint(1 // 2)\n```\n\n    0.5\n    0\n\n\n详见 [Python 2 -> 3 的转换](#Python-2-->-3-的转换)\n\n### list, tuple\n\n* 对 list 或 tuple, 当只有一个元素时, 注意加逗号:\n\n```python\nl = [1]\ntype(l)\n```\n\n\n\n\n    list\n\n\n\n```python\nl = [1,]\ntype(l)\n```\n\n\n\n\n    list\n\n\n\n```python\nl = (1)\ntype(l)\n```\n\n\n\n\n    int\n\n\n\n```python\nl = (1,)\ntype(l)\n```\n\n\n\n\n    tuple\n\n\n\n* 赋值, 星号 (`*`) 表达式用来展开 list/tuple, 双星号 (`**`) 用来展开 dict (常用于函数参数表):\n\n```python\na, b, *c = [0, 1, 2, 3]\na, b, c\n```\n\n\n\n\n    (0, 1, [2, 3])\n\n\n\n```python\na, *_ = [0, 1, 2, 3] # 或 a, = ...\na\n```\n\n\n\n\n    0\n\n\n\n### dict\n\n* dict 改变某个 key 但 value 不变的方法\n\n```python\nd = {'a' : 1, 'b' : 2}\nd['c'] = d.pop('b')  # 利用 `pop` 返回值, 更改 key 值\nd\n```\n\n\n\n\n    {'a': 1, 'c': 2}\n\n\n\n* dict 求并集\n\n```python\nd1 = {'a' : 1, 'b' : 2}\nd2 = {'a' : -1, 'c' : 3, 'd' : 4}\n```\n\n```python\ndict(d1, **d2)  # 重复的 key 取后一个的值\n```\n\n\n\n\n    {'a': -1, 'b': 2, 'c': 3, 'd': 4}\n\n\n\n```python\ndict(list(d1.items()) + list(d2.items()))  # 注意其中的 list\n```\n\n\n\n\n    {'a': -1, 'b': 2, 'c': 3, 'd': 4}\n\n\n\n```python\nd1.update(d2)\nd1\n```\n\n\n\n\n    {'a': -1, 'b': 2, 'c': 3, 'd': 4}\n\n\n\n### set\n\n* set 基本操作\n\n```python\ns = {1, 2}\n```\n\n```python\ns.add(3) # one element only\ns\n```\n\n\n\n\n    {1, 2, 3}\n\n\n\n```python\ns.update([4, 5]) # iterable: list/tuple/set/...\ns\n```\n\n\n\n\n    {1, 2, 3, 4, 5}\n\n\n\n```python\ns.remove(1)\ns\n```\n\n\n\n\n    {2, 3, 4, 5}\n\n\n\n```python\ns.discard(0)  # No error if not exist\ns\n```\n\n\n\n\n    {2, 3, 4, 5}\n\n\n\n* set 求交集, 并集, 差集, 对称差集, 子集\n\n```python\n{1, 2}.intersection({2, 3})\n```\n\n\n\n\n    {2}\n\n\n\n```python\n{1, 2} & {2, 3}  # 或用 and\n```\n\n\n\n\n    {2}\n\n\n\n```python\n{1, 2}.union({2, 3})\n```\n\n\n\n\n    {1, 2, 3}\n\n\n\n```python\n{1, 2} | {2, 3}  # 或用 or\n```\n\n\n\n\n    {1, 2, 3}\n\n\n\n```python\n{1, 2}.difference({2, 3})\n```\n\n\n\n\n    {1}\n\n\n\n```python\n{1, 2} - {2, 3}  # 在前不在后\n```\n\n\n\n\n    {1}\n\n\n\n```python\n{1, 2}.symmetric_difference({2, 3})\n```\n\n\n\n\n    {1, 3}\n\n\n\n```python\n{1, 2} ^ {2, 3}  # 不同时在两边\n```\n\n\n\n\n    {1, 3}\n\n\n\n* 属于, 包含于(子集)\n\n```python\n2 in {1, 2, 3}  # list/tuple/set\n```\n\n\n\n\n    True\n\n\n\n```python\n4 not in {1, 2, 3}  # list/tuple/set\n```\n\n\n\n\n    True\n\n\n\n```python\n{1, 2}.issubset({1, 2, 3})\n```\n\n\n\n\n    True\n\n\n\n```python\n{1, 2} <= {1, 2, 3}\n```\n\n\n\n\n    True\n\n\n\n```python\n{1, 2, 3}.issuperset({1, 2})\n```\n\n\n\n\n    True\n\n\n\n```python\n{1, 2, 3} >= {1, 2}\n```\n\n\n\n\n    True\n\n\n\n### 一些特性的演示\n\n插件 <https://github.com/lgpage/nbtutor><br>\n网页版 <http://pythontutor.com/>\n\n```python\n%reload_ext nbtutor\n```\n\n```python\n%%nbtutor -r -f\nl1= (0)\nl2 = (0,)\n```\n\n    \n\n[网页版演示](http://t.cn/Rg9J3bf)\n\n<img src='/advance/nbtutor1.png' width='550'/>\n\n```python\n%%nbtutor -r -f -i\na = 3\nb = 4\nt = (1, 2, [a, b]) # list in tuple\na = 'x' # change element in list\nt[2][0] = 'xx' # change element in tuple\n```\n\n```python\nprint(t)\n```\n\n    (1, 2, ['xx', 4])\n\n\n[网页版演示](http://t.cn/Rg9idUn)\n\n<img src='/advance/nbtutor2.png' width='550'/>\n\n### 包含判断的单行循环\n\n```python\nl = [1, 2, 3, 4, 5]\n[i for i in l if i > 2]\n```\n\n\n\n\n    [3, 4, 5]\n\n\n\n例如用 `globals()` 来得到字符串形式的变量名 (python 的变量没有提供这个功能的关键字, 因为\"变量名\"存储在namespaces中)\n\n```python\ndef namestr(obj, namespace):\n    return [name for name in namespace if namespace[name] is obj][0]\na = 1\nb = 2\nfor var in (a, b):\n    print(f'{namestr(var, globals())} = {var}')\n```\n\n    a = 1\n    b = 2\n\n\n### 单行 if (三元关系运算)\n\n```python\na = 1\nb = 'y' if a > 0 else 'n'\nb\n```\n\n\n\n\n    'y'\n\n\n\n### 循环, 迭代器, 生成器\n\nPython 的 for 循环不使用索引变量, 而使用遍历**迭代器** (iterator) 的方式处理**可迭代对象** (range, set 等):\n\n```python\nfor i in range(5):\n    ...\n```\n\n遍历的方式是使用 `iter` 和 `next` 函数:\n\n```python\na = iter(range(5))  # 生成一个 range_iterator 对象\n```\n\n```python\nnext(a)\n```\n\n\n\n\n    0\n\n\n\n```python\nlist(range(5))  # 转换为 list\n```\n\n\n\n\n    [0, 1, 2, 3, 4]\n\n\n\n`enumerate` 函数适合需要同时使用索引和内容时使用:\n\n```python\nfor i, item in enumerate(l):  # enumerate()是一个迭代器\n    i = ...\n    item = ...  # l[i] = ...\n```\n\n生成器:\n\n```python\na = (i**2 for i in range(5))  # 产生一个生成器, 可转化成 list, tuple\na\n```\n\n\n\n\n    <generator object <genexpr> at 0x14da87e652b0>\n\n\n\n```python\nnext(a)  # 生成器也是迭代器\n```\n\n\n\n\n    4\n\n\n\n```python\na = [i for i in range(3)]  # 产生一个 list\na\n```\n\n\n\n\n    [0, 1, 2]\n\n\n\n```python\n# 转化成 tuple\ntuple(i for i in range(3))\n```\n\n\n\n\n    (0, 1, 2)\n\n\n\n### 函数定义\n\n* 一般的函数定义:\n\n```python\ndef func(a, b, *args, **kwargs):\n    # func1(x, y, arg1, arg2, ..., key1=val1, key2=val2, ...)\n    ...\n    return ... # 没有 return 或为空 则返回 None\n```\n\n* 单行函数 lambda\n\n```python\ndef f(x, y):\n    return x + y\nf(1, 2)\n```\n\n\n\n\n    3\n\n\n\n用 `lambda` 语法来定义:\n\n```python\nf = lambda x, y: x + y\nf(1, 2)\n```\n\n\n\n\n    3\n\n\n\n```python\n(lambda x, y: x + y)(1, 2)  # 不一定需要定义函数名称\n```\n\n\n\n\n    3\n\n\n\n### 命名空间和变量作用域\n\n<https://sebastianraschka.com/Articles/2014_python_scope_and_namespaces.html>\n\n<img src='/advance/scope_resolution_1.png' width='400' />\n\n* Built-in Functions <https://docs.python.org/3/library/functions.html>\n* Built-in Constants <https://docs.python.org/3/library/constants.html>\n\n`globals()` 以 dict 形式返回当前所有全局变量, 包括导入的包名, ipython/jupyter 的 `In`, `Out` 等.<br>\npython 以 name -> obj 的形式存储这些变量.\n\n```python\na = 1\nb = 2\n```\n\n```python\nglobals()['a'] is a\n```\n\n\n\n\n    True\n\n\n\n```python\ni = 1\ndef f():\n    i = 2\n    print(i, 'local')\n    return\nf()\nprint(i, 'global')\n```\n\n    2 local\n    1 global\n\n\n```python\ni = 1\nfor i in range(4):\n    pass\ni  # 值被改变了 (“leaking”)\n```\n\n\n\n\n    3\n\n\n\n```python\ni = 1\n[i for i in range(3)]\ni  # 用这种方式就不会发生“leaking”\n```\n\n\n\n\n    1\n\n\n\n有关函数中的变量作用方式细节, 参考这里提到的例子: [stackoverflow](https://stackoverflow.com/a/575887)\n\n\n\n> * Any time you see <font color=blue>**varname =**</font>, you're **creating a new name** binding within the function's scope.<br>Whatever value `varname` was bound to before is lost within this scope.\n>\n> * Any time you see <font color=blue>**varname.foo()**</font>, you're **calling a method** on `varname`. The method may alter `varname` (e.g. `list.append`). <br>\n`varname` (or, rather, the object that `varname` names) may exist in more than one scope, and since it's the same object, <br>**any changes will be visible in all scopes**.\n\n## NumPy\n\n### numpy 的数据类型 dtype\n\n<https://www.tutorialspoint.com/numpy/numpy_data_types.htm>\n```python\n>>> np.dtype(np.int64) is np.dtype('i8') is np.dtype('<i8')\nTrue\n>>> np.dtype(np.int64) is np.dtype('int') is np.dtype('int64')\nTrue\n>>> np.dtype(np.int64) is np.dtype('>i8')\nFalse\n```\n```python\n>>> np.dtype(np.float64) is np.dtype('f8') is np.dtype('<f8')\nTrue\n>>> np.dtype(np.float64) is np.dtype('float') is np.dtype('float64')\nTrue\n```\n见 [Fortran 二进制文件读写](#Fortran-二进制文件读写) 中的应用.\n\n### np.arange 参数为浮点数时要注意的细节\n\n```python\nnp.arange(0., 1.8, 0.3)  # 默认不包含 `stop` 这个点\n```\n\n\n\n\n    array([0. , 0.3, 0.6, 0.9, 1.2, 1.5])\n\n\n\n```python\nnp.arange(0., 2.1, 0.3)  # 这里却包括了, 为什么?\n```\n\n\n\n\n    array([0. , 0.3, 0.6, 0.9, 1.2, 1.5, 1.8, 2.1])\n\n\n\n```python\n'%.16f' % 2.1  # 因为浮点数计算方式产生的精度问题\n```\n\n\n\n\n    '2.1000000000000001'\n\n\n\n看一个求和的例子中同样的问题 (用 `list` 和 `numpy.ndarray` 效果一样):\n\n```python\nprint('%.17f' % 0.1)\n# sum([0.1, ..., 0.1])\n\nprint('%.17f' % sum([0.1] * 10))\n# 因为同样问题, 累积了误差\n\nimport math\nprint('%.17f' % math.fsum([0.1] * 10))\n```\n\n    0.10000000000000001\n    0.99999999999999989\n    1.00000000000000000\n\n\n```python\nsum([0.1] * 10) == 1\n```\n\n\n\n\n    False\n\n\n\n```python\nmath.fsum([0.1] * 10) == 1\n```\n\n\n\n\n    True\n\n\n\n```python\nmath.fsum([0.1] * 10) == 1.0\n```\n\n\n\n\n    True\n\n\n\n参考 <https://docs.python.org/3/tutorial/floatingpoint.html>\n\n建议是: 使用整数; 对浮点数的情况, stop 值设得略小一些 (比如减去步长的一般) 以防止改点被包含, 或使用 `np.linspace` 代替.\n\n### 矩阵\n\n`np.matrix`(矩阵) 是 `np.ndarray`(数组) 的一个子类, 继承了父级的方法, 也定义了新的方法 (例如矩阵运算).\n\n```python\nissubclass(np.matrix, np.ndarray)\n```\n\n\n\n\n    True\n\n\n\n```python\na = np.matrix([[0, 1, 2], [3, 4, 5]]); a\n```\n\n\n\n\n    matrix([[0, 1, 2],\n            [3, 4, 5]])\n\n\n\n```python\na = np.matrix(\"0 1 2; 3 4 5\"); a\n```\n\n\n\n\n    matrix([[0, 1, 2],\n            [3, 4, 5]])\n\n\n\n```python\ntype(a)\n```\n\n\n\n\n    numpy.matrixlib.defmatrix.matrix\n\n\n\n`np.asmatrix` (或简写作 `np.mat`) 相当于 `np.matrix(data, copy=False)`\n\n```python\nx = np.array([[1, 2], [3, 4]])\nm = np.matrix(x)\nm[0, 0] = 5\nx\n```\n\n\n\n\n    array([[1, 2],\n           [3, 4]])\n\n\n\n```python\nx = np.array([[1, 2], [3, 4]])\nm = np.mat(x)\nm[0, 0] = 5\nx\n```\n\n\n\n\n    array([[5, 2],\n           [3, 4]])\n\n\n\n```python\nx.__array_interface__['data'][0] == m.__array_interface__['data'][0]\n```\n\n\n\n\n    True\n\n\n\n注意: `np.matrix` 既是一个类名也是一个函数名, 而 `np.mat`, `np.asmatrix` 只是函数名.\n\n### 数组和矩阵运算\n\n#### 数组运算\n\n```python\na = np.arange(12).reshape(3, -1); a\n```\n\n\n\n\n    array([[ 0,  1,  2,  3],\n           [ 4,  5,  6,  7],\n           [ 8,  9, 10, 11]])\n\n\n\n```python\na.max()\n```\n\n\n\n\n    11\n\n\n\n```python\na * a  # 注意这是对应位置的元素间的运算\n```\n\n\n\n\n    array([[  0,   1,   4,   9],\n           [ 16,  25,  36,  49],\n           [ 64,  81, 100, 121]])\n\n\n\n```python\na ** 2  # 注意这是对应位置的元素间的运算\n```\n\n\n\n\n    array([[  0,   1,   4,   9],\n           [ 16,  25,  36,  49],\n           [ 64,  81, 100, 121]])\n\n\n\n#### 使用数组进行矩阵运算\n\n`scipy.linalg` 与 `numpy.linalg` 的比较: \n<https://scipy.github.io/devdocs/tutorial/linalg.html>\n>* `scipy.linalg` contains **all** the functions in `numpy.linalg` plus some other more **advanced** ones not contained in `numpy.linalg`\n* Despite its convenience, the use of the `numpy.matrix` class is **discouraged**.\n* `scipy.linalg` operations can be applied **equally** to `numpy.matrix` or to 2D `numpy.ndarray` objects.\n\n```python\na = np.diagflat([1., 2., 3.]); a\n```\n\n\n\n\n    array([[1., 0., 0.],\n           [0., 2., 0.],\n           [0., 0., 3.]])\n\n\n\n```python\nb = np.array([[-1., -1., -1.],[0., 0., 0.]]); b\n```\n\n\n\n\n    array([[-1., -1., -1.],\n           [ 0.,  0.,  0.]])\n\n\n\n```python\nfrom scipy.linalg import inv\ninv(a)  # 求逆\n```\n\n\n\n\n    array([[ 1.        ,  0.        , -0.        ],\n           [ 0.        ,  0.5       , -0.        ],\n           [ 0.        ,  0.        ,  0.33333333]])\n\n\n\n```python\na.dot(b.T)  # 矩阵内积\n```\n\n\n\n\n    array([[-1.,  0.],\n           [-2.,  0.],\n           [-3.,  0.]])\n\n\n\n#### 直接使用矩阵类型进行运算\n\n使用 numpy 的矩阵类型 `numpy.matrix`\n\n```python\na = np.mat(np.diagflat([1., 2., 3.])); a\n```\n\n\n\n\n    matrix([[1., 0., 0.],\n            [0., 2., 0.],\n            [0., 0., 3.]])\n\n\n\n```python\nb = np.mat(np.array([[-1., -1., -1.],[0., 0., 0.]])); b\n```\n\n\n\n\n    matrix([[-1., -1., -1.],\n            [ 0.,  0.,  0.]])\n\n\n\n```python\na * b.T  # 矩阵内积, 注意与数组的运算符定义不同\n```\n\n\n\n\n    matrix([[-1.,  0.],\n            [-2.,  0.],\n            [-3.,  0.]])\n\n\n\n```python\na @ b.T  # 矩阵内积的新写法, python 3.5+\n```\n\n\n\n\n    matrix([[-1.,  0.],\n            [-2.,  0.],\n            [-3.,  0.]])\n\n\n\n```python\na.I  # 求逆\n```\n\n\n\n\n    matrix([[ 1.        ,  0.        , -0.        ],\n            [ 0.        ,  0.5       , -0.        ],\n            [ 0.        ,  0.        ,  0.33333333]])\n\n\n\n### 用作坐标格点的数组的几种形式\n\n* **`np.meshgrid`**\n\n```python\n>>> x = np.linspace(0, 2, 3); x\narray([ 0.,  1.,  2.])\n>>> y = np.linspace(3, 6, 4); y\narray([3., 4., 5., 6.])\n# X, Y 形状相同: N x M 矩阵, shape=(N, M)\n>>> X, Y = np.meshgrid(x, y)\n>>> X                         # X[j, :] 表示同一层 y[j] 对应的不同 x 值\narray([[0., 1., 2.],          #  0_____x\n       [0., 1., 2.],          #  |\n       [0., 1., 2.],          #  |y\n       [0., 1., 2.]])\n>>> Y\narray([[3., 3., 3.],          # Y[:, i] 表示同一层 x[i] 对应的不同 y 值\n       [4., 4., 4.],\n       [5., 5., 5.],\n       [6., 6., 6.]])\n```\n可用来计算坐标的函数 (例如磁场的表达式等等, 见 [examples/streamplot.py](examples/streamplot.py) )\n```python\nU =   (np.cos(k1 * X) * np.exp(-k1 * Y)\n     - np.cos(k2 * X) * np.exp(-k2 * Y))\nV = (- np.sin(k1 * X) * np.exp(-k1 * Y)\n     + np.sin(k2 * X) * np.exp(-k2 * Y))\n```\n\n```python\nx = np.linspace(0, 2, 3)\ny = np.linspace(3, 6, 4)\nX, Y = np.meshgrid(x, y, indexing='ij')\nY.shape\n```\n\n\n\n\n    (3, 4)\n\n\n\n* **`np.mgrid`**\n\n`j` 标记默认是虚数单位, 但在这里表示前面的数字是格点数.<br>\n格点数使用变量 *`n`* 时, 可写成: *`n`*`*1j + 1j`, 1不能省 (否则j定义为变量)<br>\n类似的 `np.ogrid` 可参见 numpy 相关文档\n\n```python\n>>> x = np.linspace(0, 2, 3)\n>>> y = np.linspace(3, 6, 4)\n\n# 下面三行等价\n>>> X, Y = np.mgrid[0:2:3j, 3:6:4j]\n>>> X, Y = np.array([i.astype(np.float64) for i in np.mgrid[0:3, 3:7]])\n>>> X, Y = np.array(np.meshgrid(x, y, indexing='ij'))\n# np.mgrid[0:2:3j, 3:6:4j] 得到的数据类型为 'float64'\n# np.mgrid[0:3, 3:6] 得到的数据类型为 'int64'\n# np.meshgrid(x, y, indexing='ij') 得到一个 list, 数据格式同x, y\n\n# X, Y 形状相同: M x N 矩阵, shape=(M, N)\n>>> X                      # X[i, :] 表示 x[i]\narray([[0., 0., 0., 0.],   #  0_____y\n       [1., 1., 1., 1.],   #  |\n       [2., 2., 2., 2.]])  #  |x\n>>> Y                      # Y[:, j] 表示 y[j]\narray([[3., 4., 5., 6.],\n       [3., 4., 5., 6.],\n       [3., 4., 5., 6.]])\n```\n\n### mask\n\n```python\na = np.arange(9).reshape(3, -1); a\n```\n\n\n\n\n    array([[0, 1, 2],\n           [3, 4, 5],\n           [6, 7, 8]])\n\n\n\n```python\na > 4  # mask\n```\n\n\n\n\n    array([[False, False, False],\n           [False, False,  True],\n           [ True,  True,  True]])\n\n\n\n```python\nnp.where(a > 4)  # 得到 tuple(col_indexs, row_indexs)\n```\n\n\n\n\n    (array([1, 2, 2, 2]), array([2, 0, 1, 2]))\n\n\n\n```python\nlist(zip(*np.where(a > 4)))  # 也可以用 np.array(np.where(a > 4)).T\n```\n\n\n\n\n    [(1, 2), (2, 0), (2, 1), (2, 2)]\n\n\n\n```python\na[a > 4] = -1; a  # same as a[np.where(a > 4)]\n```\n\n\n\n\n    array([[ 0,  1,  2],\n           [ 3,  4, -1],\n           [-1, -1, -1]])\n\n\n\n### 其他对数组元素的处理\n\n处理含有 NaN 的数据:\n\ne.g. 求最值可使用 `np.nanmin(...)` 和 `np.nanmax(...)`\n\n## Matplotlib\n\n* 官方教程 <https://matplotlib.org/tutorials/introductory/usage.html>\n\n<img src='/advance/anatomy.png' width='600' />\n\n```python\nfig = plt.gcf() # current figure\nax = plt.gca()  # current `Axes`\nim = plt.gci()  # current artist(图像内容), 可由诸如 plt.imshow(...) 得到\n```\n\n* 得到当前 backend:\n```python\n>>> import matplotlib.pyplot as plt\n>>> plt.get_backend()\n```\n或\n```python\n>>> import maplotlib as mpl\n>>> mpl.get_backend()\n```\n* 选择 backend (在导入其他 matplotlib 模块之前):\n```python\n>>> import matplotlib\n>>> matplotlib.use('TkAgg')  # 'Qt5Agg', 'TkAgg', 'Agg', ...\n```\n\n* 用户配置文档 `matplotlibrc`<br>\n通常的位置: `~/.config/matplotlib/matplotlibrc` (Linux)\n\n* 用 `zorder` 来控制图层:\n\n这个例子中也展示了加入一个动态的竖线的方法, 这条线在保存后的图像中不会显示.\n\n```python\n%matplotlib\n%run -e 'examples/test_plot.py'\n```\n\n* 使用 [这个工具](https://github.com/joferkington/mpldatacursor) 动态标注光标位置的值:\n\n```python\n%matplotlib\n%run -e 'examples/test_imshow.py'\n```\n\n* 点击图像后在命令行显示光标处信息的例子\n\n命令行脚本: [examples/test_imshow_click.py](examples/test_imshow_click.py) (jupyter 中无法使用)\n\n* 布局问题 <https://matplotlib.org/tutorials/intermediate/constrainedlayout_guide.html>\n* 绘制平行投影的3D图 <https://matplotlib.org/mpl_toolkits/mplot3d/tutorial.html>\n* 更复杂的 3D 可转存可视化数据用其他软件或使用 Mayavi (http://docs.enthought.com/mayavi/mayavi)\n\n## SunPy 示例\n\n### 示例文件\n\n- 读取 fits, submap, 作图 [example_plothmi](https://lydiazly.coding.me/python-notes/example_plothmi.html)\n\n- 投影 [example_projection](https://lydiazly.coding.me/python-notes/example_projection.html)\n\n- 下载数据 [fido](https://lydiazly.coding.me/python-notes/fido.html), [jsoc](https://lydiazly.coding.me/python-notes/jsoc.html)\n \n 注意: 这些例子只是提供一个使用参考, 不一定是最优的.\n\n### 示例中的 fits 读取方法\n\n更多 FITS 的读取方法参见 [Python 简易教程#FITS-文件读取](main.html#FITS-文件读取)<br>\n另见 [Astropy 的命令行工具](http://docs.astropy.org/en/stable/io/fits/usage/scripts.html)\n\n读取`HMIMap` 的例子:\n\n```python\n# 导入 `sunpy.map` 的时间会略有点长\nimport sunpy.map\nsmap = sunpy.map.Map('data/hmi.B_720s.20150827_052400_TAI.field.fits')\ntype(smap)\n```\n\n\n\n\n    sunpy.map.sources.sdo.HMIMap\n\n\n\n这是 `GenericMap` 的一个子类:\n\n```python\nissubclass(sunpy.map.sources.sdo.HMIMap, sunpy.map.mapbase.GenericMap)\nTrue\n```\n\n\n\n\n    True\n\n\n\n```python\nsmap.meta  # headers\n```\n\n```python\ntype(smap.data)  # 索引从 0 开始\n```\n\n\n\n\n    numpy.ndarray\n\n\n\n```python\nsmap.data.shape  # (dimy, dimx)\n```\n\n\n\n\n    (4096, 4096)\n\n\n\n`smap.data[i, j]` 中的 i 为 Y 轴, 单位为 pixel:\n\n```python\nimport matplotlib.pyplot as plt\nplt.imshow(smap.data[0:2000, :], origin='lower');\nplt.show()\n```\n\n\n    \n![png](/advance/advance_205_0.png)\n    \n\n\n### 关于 Scaled Image Data\n\n这一部分将更仔细地检查 Astropy 对示例中的 FITS 文件的处理.\n\n参见 <http://docs.astropy.org/en/stable/io/fits/usage/image.html#scaled-data>\n\n> Images are scaled only when either of the BSCALE/BZERO keywords are present in the header and either of their values is not the default value (BSCALE=1, BZERO=0).\n\n由于 `astropy.io.fits` 的特性, 读取 'Scaled Image Data' 时, 调用 `.data` 将自动对数据进行缩放:\n```python\nphysical value = BSCALE * (storage value) + BZERO\n```\n`astropy.io.fits.open` 中使用 `do_not_scale_image_data=True` 可禁用这一步骤.\n\n见 [astropy.io.fits FAQ](http://docs.astropy.org/en/stable/io/fits/appendix/faq.html#why-is-an-image-containing-integer-data-being-converted-unexpectedly-to-floats)\n\n数据类型:\n\nBITPIX    |Numpy Data Type\n:---:|:---\n8         |numpy.uint8 (unsigned integer)\n16        |numpy.int16\n32        |numpy.int32\n-32       |numpy.float32\n-64       |numpy.float64\n\n可以使用 Astropy 的命令行工具在 shell 中查看信息:\n\n```python\nfname = 'data/hmi.B_720s.20150827_052400_TAI.field.fits'\n!fitsinfo {fname}\n```\n\n    Filename: data/hmi.B_720s.20150827_052400_TAI.field.fits\n    No.    Name      Ver    Type      Cards   Dimensions   Format\n      0  PRIMARY       1 PrimaryHDU       6   ()      \n      1                1 CompImageHDU    155   (4096, 4096)   int32   \n\n\n可以看到该文件存储的数据类型是整形.\n\n用命令行工具查看关键字 'BITPIX':\n\n```python\n!fitsheader -e 1 --keyword BITPIX {fname}\n```\n\n    # HDU 1 in data/hmi.B_720s.20150827_052400_TAI.field.fits:\n    BITPIX  =                   32 / data type of original image                    \n\n\n使用 `astropy.io.fits`:\n\n```python\nfrom astropy.io import fits\nhdulist = fits.open(fname)\nhdu = hdulist[1]\n```\n\n```python\nhdu.header['BITPIX']\n```\n\n\n\n\n    32\n\n\n\n'BSCALE' 不为零则为 'scaled':\n\n```python\nhdu.header['BSCALE']\n```\n\n\n\n\n    0.01\n\n\n\n```python\nhdu.header['BZERO']\n```\n\n\n\n\n    0.0\n\n\n\n```python\nhdulist.verify('silentfix+warn')  # 调用 `.data` 时如果出错, 需要先进行这一步修复\n```\n\n```python\nhdu.data.dtype  # 已自动变换为 'physical value', 同时 `.header` 将被修改\n```\n\n\n\n\n    dtype('float64')\n\n\n\n```python\nhdu.data[1000, 1000]\n```\n\n\n\n\n    142.83\n\n\n\n```python\nhdu.data[0,0]  # -2147483648 被转为 nan\n```\n\n\n\n\n    nan\n\n\n\n```python\nhdu.header['BITPIX']  # 值被改变了. 同时 'BSCALE', 'BZERO' 被删除\n```\n\n\n\n\n    -64\n\n\n\n手动 scale:\n\n'BSCALE' 虽然之前已被删除, 但值仍存储在 `._orig_bscale` 中. `.scale` 将使用这个值.\n\n```python\nhdu.scale('int32')  # 在此之后 `.data` 将变换回 'storage value'\n```\n\n```python\nhdu._orig_bscale\n```\n\n\n\n\n    0.01\n\n\n\n```python\nhdu._orig_bzero\n```\n\n\n\n\n    0\n\n\n\n```python\nhdu.data[1000, 1000]\n```\n\n\n\n\n    14283\n\n\n\n```python\nhdu.data[0, 0]  # nan 被转为 -2147483648\n```\n\n\n\n\n    -2147483648\n\n\n\n```python\nhdu.header['BITPIX']  # 值再次被改变了\n```\n\n\n\n\n    32\n\n\n\n使用 SunPy 处理时, 'BITPIX', 'BSCALE', 'BZERO' 的值被保留, `.data` 仍进行了 scale 的过程.\n\n针对不同文件, 如果 SunPy 的程序内部使用 `astropy.io.fits` 处理文件时调用了 `.data` 再返回 header, 即 `astropy.io.fits` 已经如上所述改变了 header, 那么 SunPy 所返回的 header 中 'BITPIX', 'BSCALE', 'BZERO' 可能已经被改变.\n\n下面的例子中得到的 header 是最初的值:\n\n```python\nimport sunpy.map\nsmap = sunpy.map.Map('data/hmi.B_720s.20150827_052400_TAI.field.fits')\n```\n\n```python\nsmap.meta['BITPIX']  # 得到的是未被改变的 header\n```\n\n\n\n\n    32\n\n\n\n```python\nsmap.meta['BSCALE']\n```\n\n\n\n\n    0.01\n\n\n\n```python\nsmap.meta['BZERO']\n```\n\n\n\n\n    0.0\n\n\n\n```python\nsmap.data[1000, 1000]  # 这一步并不改变 `.meta` 的值\n```\n\n\n\n\n    142.83\n\n\n\n```python\nsmap.meta['BITPIX']  # 不变\n```\n\n\n\n\n    32\n\n\n\n```python\nsmap.meta['BSCALE']  # 不变\n```\n\n\n\n\n    0.01\n\n\n\n```python\nsmap.meta['BZERO']  # 不变\n```\n\n\n\n\n    0.0\n\n\n\n### 坐标和单位\n\n**SunPy map** <http://docs.sunpy.org/en/stable/code_ref/map.html#using-map-objects>\n>A number of the **properties** of this class are returned as **two-value named tuples**\nthat can either be\n- indexed by position:&ensp;**<font color=blue>[0]</font>,&ensp;<font color=blue>[1]</font>**\n- be accessed by the names:\n  - pixel axes:&ensp;**<font color=blue>.x</font>,&ensp;<font color=blue>.y</font>**<br>\n  x and y refer to the FITS axes (x for columns y for rows)\n  - spatial axes:&ensp;**<font color=blue>.axis1</font>,&ensp;<font color=blue>.axis2</font>**<br>\n  axis1 corresponds to the coordinate axis for x and axis2 corresponds to y.\n\n```python\nsmap.dimensions\n```\n\n\n\n\n    PixelPair(x=<Quantity 4096. pix>, y=<Quantity 4096. pix>)\n\n\n\n```python\nsmap.dimensions.x  # 得到一个 `astropy.units.quantity.Quantity`, 包含 value 和 unit\n```\n\n\n\n\n\\(4096 \\; \\mathrm{pix}\\)\n\n\n\n```python\nsmap.dimensions.x.unit\n```\n\n\n\n\n\\(\\mathrm{pix}\\)\n\n\n\n```python\nsmap.dimensions.x.value\n```\n\n\n\n\n    4096.0\n\n\n\n`astropy.units` 的使用方法:\n\n```python\nimport astropy.units as u\n```\n\n```python\nu.AA\n```\n\n\n\n\n\\(\\mathrm{\\mathring{A}}\\)\n\n\n\n```python\n4096 * u.pix  # same as `u.pixel`\n```\n\n\n\n\n\\(4096 \\; \\mathrm{pix}\\)\n\n\n\n```python\n(4096, 4096) * u.pix  # 注意这里是 `astropy.units` 的运算, 和 list 运算规则不同\n```\n\n\n\n\n\\([4096,~4096] \\; \\mathrm{pix}\\)\n\n\n\n```python\nsmap.dimensions.x.unit is u.pix  # 说明 x 是单位是 u.pix\n```\n\n\n\n\n    True\n\n\n\n```python\ntype(smap.center)\n```\n\n    /home/lydia/miniconda3/lib/python3.6/site-packages/sunpy/map/mapbase.py:669: Warning: Missing metadata for heliographic longitude: assuming longitude of 0 degrees\n      lon=self.heliographic_longitude,\n\n\n\n\n\n    astropy.coordinates.sky_coordinate.SkyCoord\n\n\n\n```python\nlist((0, 0) * u.pix)\n```\n\n\n\n\n    [<Quantity 0. pix>, <Quantity 0. pix>]\n\n\n\n```python\nsmap.pixel_to_world(*(4096, 4096) * u.pix)\n```\n\n\n\n\n    <SkyCoord (Helioprojective: obstime=2015-08-27 05:22:21.800000, rsun=696000000.0 m, observer=<HeliographicStonyhurst Coordinate (obstime=2015-08-27 05:22:21.800000): (lon, lat, radius) in (deg, deg, m)\n        (0., 7.089004, 1.51196988e+11)>): (Tx, Ty) in arcsec\n        (-1040.36199634, -1030.86554911)>\n\n\n\n查看 `SkyCoord` 的帮助:\n\n```python\nimport astropy.coordinates\nhelp(astropy.coordinates.sky_coordinate.SkyCoord)\n```\n\n```python\nsmap.center.Tx\n```\n\n\n\n\n\\(\\mathrm{-7.65399^{\\prime\\prime}}\\)\n\n\n\n```python\nsmap.pixel_to_world(*(2000, 2000) * u.pix)\n```\n\n\n\n\n    <SkyCoord (Helioprojective: obstime=2015-08-27 05:22:21.800000, rsun=696000000.0 m, observer=<HeliographicStonyhurst Coordinate (obstime=2015-08-27 05:22:21.800000): (lon, lat, radius) in (deg, deg, m)\n        (0., 7.089004, 1.51196988e+11)>): (Tx, Ty) in arcsec\n        (16.55031204, 26.53575639)>\n\n\n\n```python\nsmap.pixel_to_world(*(2000, 2000) * u.pix).transform_to('heliographic_stonyhurst')\n```\n\n\n\n\n    <SkyCoord (HeliographicStonyhurst: obstime=2015-08-27 05:22:21.800000): (lon, lat, radius) in (deg, deg, km)\n        (1.00568591, 8.68202918, 696000.0000022)>\n\n\n\n查看坐标信息:\n\n```python\nsmap.coordinate_frame\n```\n\n    /home/lydia/miniconda3/lib/python3.6/site-packages/sunpy/map/mapbase.py:669: Warning: Missing metadata for heliographic longitude: assuming longitude of 0 degrees\n      lon=self.heliographic_longitude,\n\n\n\n\n\n    <Helioprojective Frame (obstime=2015-08-27 05:22:21.800000, rsun=696000000.0 m, observer=<HeliographicStonyhurst Coordinate (obstime=2015-08-27 05:22:21.800000): (lon, lat, radius) in (deg, deg, m)\n        (0., 7.089004, 1.51196988e+11)>)>\n\n\n\n出现这个 Warning 时:\n\n```python\nsmap.meta['hgln_obs'] = 0.; smap.meta['hgln_obs'] = 0.; smap.meta['hgln_obs'] = 0.\nsmap.coordinate_frame\n```\n\n\n\n\n    <Helioprojective Frame (obstime=2015-08-27 05:22:21.800000, rsun=696000000.0 m, observer=<HeliographicStonyhurst Coordinate (obstime=2015-08-27 05:22:21.800000): (lon, lat, radius) in (deg, deg, m)\n        (0., 7.089004, 1.51196988e+11)>)>\n\n\n\n### 语法对比\n\n比较 `plothmi.py` 与对应 IDL 程序的语法:\n\n下面的语句中, 为了简便和方便对比, 使用了自定义的一些函数. 导入方法:\n```python\nfrom usr_sunpy import read_sdo, plot_map, plot_vmap, image_to_helio\n```\n\n读取数据\n```idl\n; IDL\nread_sdo,<fname>,index,data\nindex2map,index,data,mapa\n```\n```python\n# Python\n# 为简化过程而自定义的函数, 读入时打印文件名和数组大小\nmapa = read_sdo(<fname>)\n```\n\n旋转\n```idl\n; IDL\n; 2 表示180°\nmapbx.data = rotate(mapbx,2)\nmapby.data = rotate(mapbx,2)\nmapbz.data = rotate(mapbx,2)\n```\n```python\n# Python\n# 利用 'crota2' 的值确定角度\nmapbx = mapbx.rotate(order=1)\nmapby = mapby.rotate(order=1)\nmapbz = mapbz.rotate(order=1)\n```\n\n截取\n```idl\n; IDL\nsub_map,mapbx,smapbx,xrange=[500,800.0],yrange=[-500,-100.0]\nsub_map,mapby,smapby,ref_map=smapbx\nsub_map,mapbz,smapbz,ref_map=smapbx\n```\n```python\n# Python\n# 左下到右上\nbl = SkyCoord(500*u.arcsec, -500*u.arcsec, frame=mapbz.coordinate_frame)\ntr = SkyCoord(800*u.arcsec, -100.*u.arcsec, frame=mapbz.coordinate_frame)\nsmapbx = mapbx.submap(bl, tr)\nsmapby = mapby.submap(bl, tr)\nsmapbz = mapbz.submap(bl, tr)\n```\n\n绘图\n```idl\n; IDL\nplot_map,smapbz,dmax=2000,dmin=-2000,color=0,charsize=1.8,...\nplot_vmap,/over,smapbx,smapby,mapbz=smapbz,limit=180,scale=0.012,iskip=15,jskip=15,...\n```\n```python\n# Python\n# 主要调用的是 matplotlib\nfig = plt.figure()\nax = fig.add_subplot(111, projection=smapbz) # 使用 smapbz 中定义的坐标系统\nplot_map(ax, smapbz)\nplot_vmap(ax, smapbx, smapby, smapbz, iskip=iskip, jskip=jskip, cmin=100., vmax=500., cmap='binary', ...)\n```\n\n坐标变换\n```idl\n; IDL\n; magnetic_modeling_codes/.../05projection_modified_version.pro\n```\n```python\n# Python\n# `image_to_helio`(变换为 Helioprojective(Cartesian) system)\n# 调用自定义的旋转矩阵函数 `proj_matrix`, 参考文献与原IDL程序相同\nhx, hy = image_to_helio(smapbz)  # numpy 数组\nsmapbx_h, smapby_h, smapbz_h = image_to_helio(smapbx, smapby, smapbz) # sunpy `Map`\n\nplot_map(ax, smapbz_h, coords=(hx, hy))\nplot_vmap(ax, smapbx_h, smapby_h, smapbz_h, coords=(hx, hy), ...)\n```\n\n## 插值, 拟合\n\n选择不限于这里列举的包, 以后也可能会有更合适的方法出现.\n\n相关安装见 [Python 安装和配置](installpy.html#其他)\n\n### 插值\n\n* numpy\n```\nf = interp1d(x, y, kind='cubic'[, fill_value='extrapolate'])\nx2 = np.linspace(...)\ny2 = f(x2)\n```\n见 [examples/test_plot.py](examples/test_plot.py)\n\n* scipy <https://docs.scipy.org/doc/scipy/reference/tutorial/interpolate.html>\n\n### 求极值\n\n* PeakUtils <http://peakutils.readthedocs.io/en/latest/>\n\n官方例图 (http://peakutils.readthedocs.io/en/latest/tutorial_a.html):\n\n```python\nimport peakutils\nindexes = peakutils.indexes(y, thres=0.5, min_dist=30)\n```\n\n<img src='/advance/tut_a_2.png' width='500' />\n\nEnhancing the resolution by interpolation:\n```python\npeaks_x = peakutils.interpolate(x, y, ind=indexes)\n```\n\n### 拟合\n\n* LMFIT (Non-Linear Least-Squares Minimization and Curve-Fitting)\n\n下载 <https://github.com/lmfit/lmfit-py>\n\n文档 <http://lmfit.github.io/lmfit-py/>\n\n有现成模型, 也可以自定义模型.<br>\n可以方便地叠加不同拟合模型(比如多个高斯, 线性加高斯, 等等).<br>\n例子见 [examples/lmfits](examples/lmfits.zip) (来自 [LMFIT网站示例](http://lmfit.github.io/lmfit-py/builtin_models.html#example-1-fit-peak-data-to-gaussian-lorentzian-and-voigt-profiles) )\n\n使用内置模型:\n\n```python\nfrom lmfit.models import GaussianModel  # 内置的模型\n\ndata = np.loadtxt('test_peak.dat')\nx = data[:, 0]\ny = data[:, 1]\n\nmod = GaussianModel()  # 实例化一个模型\npars = mod.guess(y, x=x)  # 给初值\nout = mod.fit(y, pars, x=x)  # 拟合结果\n\nprint(out.fit_report())  # 拟合结果的详细信息\nplt.plot(x, out.init_fit, 'k--')\nplt.plot(x, out.best_fit, 'r-')\n```\n\n```python\n%matplotlib inline\n%run examples/lmfits/fit_peak.py\n```\n\n    [[Model]]\n        Model(voigt)\n    [[Fit Statistics]]\n        # fitting method   = leastsq\n        # function evals   = 21\n        # data points      = 401\n        # variables        = 4\n        chi-square         = 10.9301767\n        reduced chi-square = 0.02753193\n        Akaike info crit   = -1436.57602\n        Bayesian info crit = -1420.60017\n    [[Variables]]\n        sigma:      0.89518909 +/- 0.01415450 (1.58%) (init = 0.8775)\n        center:     9.24374847 +/- 0.00441903 (0.05%) (init = 9.25)\n        amplitude:  34.1914737 +/- 0.17946860 (0.52%) (init = 65.43358)\n        gamma:      0.52540198 +/- 0.01857955 (3.54%) (init = 0.7)\n        fwhm:       3.22385343 +/- 0.05097475 (1.58%) == '3.6013100*sigma'\n        height:     10.0872204 +/- 0.03482130 (0.35%) == 'amplitude*wofz((1j*gamma)/(sigma*sqrt(2))).real/(sigma*sqrt(2*pi))'\n    [[Correlations]] (unreported correlations are < 0.100)\n        C(sigma, gamma)     = -0.928\n        C(amplitude, gamma) =  0.821\n        C(sigma, amplitude) = -0.651\n    \n\n\n\n    \n![png](/advance/advance_279_1.png)\n    \n\n\n多个模型叠加:\n\n```python\nfrom lmfit.models import ExponentialModel, GaussianModel\n\ndata = np.loadtxt('NIST_Gauss2.dat')\nx = data[:, 0]\ny = data[:, 1]\n\nexp_mod = ExponentialModel(prefix='exp_')\ngauss1 = GaussianModel(prefix='g1_')\ngauss2 = GaussianModel(prefix='g2_')\n\npars1 = exp_mod.guess(y, x=x)  # 分段设参数的方法见下面的脚本文件\npars2 = gauss1.guess(y, x=x)\npars3 = gauss2.guess(y, x=x)\n\npars = pars1 + pars2 + pars3  # 叠加参数\nmod = gauss1 + gauss2 + exp_mod  # 叠加模型\n\nout = mod.fit(y, pars, x=x)\n\nprint(out.fit_report())\nplt.plot(x, y, 'b')\nplt.plot(x, out.init_fit, 'k--')\nplt.plot(x, out.best_fit, 'r-')\n```\n\n```python\n%%capture output\n%matplotlib inline\n%run examples/lmfits/fit_peaks.py\n```\n\n```python\noutput.outputs[0]\n```\n\n\n\n\n    \n![png](/advance/advance_283_0.png)\n    \n\n\n\n```python\n%%capture output\n%matplotlib inline\n%run examples/lmfits/fit_peaks_components.py\n```\n\n```python\noutput.outputs[0]\n```\n\n\n\n\n    \n![png](/advance/advance_285_0.png)\n    \n\n\n\n自定义模型的方法见 [LMFIT网站示例](http://lmfit.github.io/lmfit-py/builtin_models.html#user-defined-models)\n\n### 其他\n\n* Sherpa(Modeling and Fitting) <http://cxc.cfa.harvard.edu/contrib/sherpa/><br>\n* 2-D Fitting in Sherpa <https://python4astronomers.github.io/fitting/image.html><br>\n* *etc.*\n\n## copy 注意事项\n\n**\"shallow copy\"** vs **\"deep copy\"**\n\n* 对于 list 的情况\n\n演示插件 <https://github.com/lgpage/nbtutor>\n\n```python\n%%nbtutor -r -f -i\nfrom copy import deepcopy\na = [1, 2, 3]\nb = a\nc = deepcopy(a)\nd = a[:] # 列表的切片是深拷贝\nb[0] = -1\nc[1] = -2\nd[2] = -3\n```\n\n    \n\n```python\nprint(id(a), id(b), id(c), id(d))\n```\n\n    23284866388232 23284866388232 23284855519880 23284856061064\n\n\n[网页版演示](http://t.cn/RgK1OHf)\n\n<img src='/advance/nbtutor3.png' width='550'/>\n\n* 对于 dict 的情况\n\n```python\n%%nbtutor -r -f -i\nfrom copy import deepcopy\na = {1:1, 2:2, 3:3}\nb = a\nc = a.copy()  # 深拷贝\nd = deepcopy(a)\nb[1] = -1\nc[2] = -2\nd[3] = -3\n```\n\n    \n\n```python\nprint(id(a), id(b), id(c), id(d))\n```\n\n    22492371132064 22492371132064 22492397510376 22492397507280\n\n\n[网页版演示](http://t.cn/RgKrHOx)\n\n<img src='/advance/nbtutor4.png' width='550'/>\n\n* 对于 set 的情况\n\n```python\n%%nbtutor -r -f -i\nfrom copy import deepcopy\na = {1, 2, 3}\nb = a\nc = a.copy()  # 深拷贝\nd = deepcopy(a)\nb.add(4)\nc.add(5)\nd.add(6)\n```\n\n    \n\n```python\nprint(id(a), id(b), id(c), id(d))\n```\n\n    22492476895528 22492476895528 22492476895304 22492374233384\n\n\n[网页版演示](http://t.cn/RgKd3E7)\n\n<img src='/advance/nbtutor5.png' width='550'/>\n\n* 对于 numpy 的情况\n\n```python\n%%nbtutor -r -f -i\nimport numpy as np\na = np.arange(1, 4)\nb = a[:] # 浅拷贝!\nc = a.copy()  # 深拷贝, 同 deepcopy(a)\nd = a[[0, 2]]  # 花式切片是深拷贝\nb[0] = -1\nc[1] = -2\nd[1] = -3\n```\n\n    \n\n```python\n# id 虽各不同, 但 .__array_interface__['data'][0] 可能相同\nfor i in (a, b, c, d):\n    print(id(i), i.__array_interface__['data'][0])\n```\n\n    22928831926400 93879086511872\n    22928831928960 93879086511872\n    22928829201984 93879072448320\n    22928829199344 93879078700736\n\n\n[网页版演示](http://t.cn/Rg9hST6) (**Site Error**: Ruby and Python+Anaconda backends are permanently unavailable)\n\n参见之前的 [np.matrix, np.asmatrix](#矩阵)\n\n## 其他格式文件读写\n\n### 用 pandas 读 csv\n\n```python\nimport pandas as pd\ndata = pd.read_csv(\"data/data.csv\")\ndata\n```\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>col1</th>\n      <th>col2</th>\n      <th>col3</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>row1</td>\n      <td>1</td>\n      <td>10.0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>row2</td>\n      <td>2</td>\n      <td>0.2</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>row3</td>\n      <td>3</td>\n      <td>300.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n```python\ndata.columns\n```\n\n\n\n\n    Index(['col1', 'col2', 'col3'], dtype='object')\n\n\n\n```python\ndata.col1\n```\n\n\n\n\n    0    row1\n    1    row2\n    2    row3\n    Name: col1, dtype: object\n\n\n\n```python\ndata['col1']\n```\n\n\n\n\n    0    row1\n    1    row2\n    2    row3\n    Name: col1, dtype: object\n\n\n\n只取一部分:\n\n```python\ndata = pd.read_csv(\"data/data.csv\", nrows=2, usecols=(0,2))\ndata\n```\n\n\n\n\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>col1</th>\n      <th>col3</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>row1</td>\n      <td>10.0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>row2</td>\n      <td>0.2</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n\n对于超大文件, 参见: <https://www.dataquest.io/blog/pandas-big-data/>\n\n### Fortran 二进制文件读写\n\n#### Unformatted (sequential)\n\n使用 `scipy.io.FortranFile`<br>\n参考: <https://docs.scipy.org/doc/scipy-0.15.1/reference/generated/scipy.io.FortranFile.read_record.html>\n\n```python\n# python (write)\nfrom scipy.io import FortranFile\nvar1 = 1.1  # '<f8'\nvar2 = 0  # '<i8'\narr = np.arange(6.).reshape((2, 3))  # '(2, 3)<f8'\nprint(var1, var2)\nprint(arr)\nprint(f'arr[0, 1] = {arr[0, 1]}')\n\n# 多行存入\nwith FortranFile('data/data_fortran1-1.dat', 'w') as f:\n    f.write_record(var1)\n    f.write_record(var2)\n    f.write_record(arr)\n# 单行存入\nwith FortranFile('data/data_fortran1-2.dat', 'w') as f:\n    f.write_record(var1, var2, arr)\n```\n\n    1.1 0\n    [[0. 1. 2.]\n     [3. 4. 5.]]\n    arr[0, 1] = 1.0\n\n\n```python\n# python (read)\nfrom scipy.io import FortranFile\n# 多行存入的情况\nwith FortranFile('data/data_fortran1-1.dat', 'r') as f:\n    var1 = float(f.read_record('<f8'))\n    var2 = int(f.read_record('<i8'))  # 注意精度(上面python存入的是默认'int64')\n    arr = f.read_record('(2, 3)<f8')\nprint('data_fortran1-1.dat')\nprint(var1, var2)\nprint(arr)\n# 单行存入的情况\nwith FortranFile('data/data_fortran1-2.dat', 'r') as f:\n#     data = f.read_record('<f8, <i8, (2, 3)<f8')  # 不指定名称\n    data = f.read_record([('var1', '<f8'), ('var2', '<i8'),\n                         ('arr', '(2, 3)<f8')])  # 指定名称: (name, dtype)\nprint('\\ndata_fortran1-2.dat')\nprint(f'keys = {data.dtype.names}')  # 如读取时未指定名称则为 ['f0', 'f1', ...]\nprint(float(data['var1']), int(data['var2']))\nprint(data['arr'])\n```\n\n    data_fortran1-1.dat\n    1.1 0\n    [[0. 1. 2.]\n     [3. 4. 5.]]\n    \n    data_fortran1-2.dat\n    keys = ('var1', 'var2', 'arr')\n    1.1 0\n    [[[0. 1. 2.]\n      [3. 4. 5.]]]\n\n\n```bash\n%%bash\ncd examples/\nifort -o test_read_seq test_read_seq.f90\n./test_read_seq\n```\n\n     data_fortran1-1.dat\n       1.1  0.0\n       0.0  1.0  2.0\n       3.0  4.0  5.0\n     arr(2, 1) =   1.0\n    \n     data_fortran1-2.dat\n       1.1  0.0\n       0.0  1.0  2.0\n       3.0  4.0  5.0\n     arr(2, 1) =   1.0\n\n\n见 Structured arrays: <https://docs.scipy.org/doc/numpy/user/basics.rec.html>\n\n#### Unformatted (stream)\n\n`struct` 参考 <https://docs.python.org/3/library/struct.html>\n\n```python\n# python (write)\nimport struct\nvar1 = 1.1  # '<f8'\nvar2 = 0  # '<i8'\narr = np.arange(6.).reshape((2, 3))  # '(2, 3)<f8'\nprint(var1, var2)\nprint(arr)\nprint(f'arr[0, 1] = {arr[0, 1]}')\nwith open('data/data_fortran2.dat', 'wb') as f:\n    f.write(struct.pack('d', var1))\n    f.write(struct.pack('i', var2))  # 注意 `struct` 的 'i' 是 '<i4'\n    arr.tofile(f)\n```\n\n    1.1 0\n    [[0. 1. 2.]\n     [3. 4. 5.]]\n    arr[0, 1] = 1.0\n\n\n```python\n# python (read)\n# 使用 `np.fromfile`, 读入的是 `ndarray`\nwith open('data/data_fortran2.dat', 'rb') as f:\n    var1 = float(np.fromfile(f, dtype='<f8', count=1))\n    var2 = int(np.fromfile(f, dtype='<i4', count=1))\n    arr = np.fromfile(f, dtype='<f8').reshape(2, 3)\nprint(var1, var2)\nprint(arr)\n```\n\n    1.1 0\n    [[0. 1. 2.]\n     [3. 4. 5.]]\n\n\n```bash\n%%bash\ncd examples/\nifort -o test_read_stream test_read_stream.f90\n./test_read_stream\n```\n\n      1.1 0.0\n      0.0 1.0 2.0\n      3.0 4.0 5.0\n     arr(2, 1) =  1.0\n\n\n### HDF5 文件读写, NCDF, CDF 文件读取\n\n#### 读写 HDF5 文件, 读 NCDF 文件\n\nHDF5 格式介绍 <https://portal.hdfgroup.org/display/HDF5/Introduction+to+HDF5>\n\n相关包: `h5py` 或 `pandas` + `pytables` (http://www.pytables.org/usersguide/datatypes.html)\n\n安装见 [Python 安装和配置](installpy.html#其他)\n\n* 查看\n\n```sh\n$ h5dump -H <filename>.hdf5\n$ ncdump -h <filename>.ncdf\n```\n\n* 用 `h5py` 读写:\n\n```python\nimport h5py\narr = np.arange(10000).reshape(50,-1)\nwith h5py.File('test.hdf5', 'w') as f:\n    f['data'] = arr\n    # 或\n    # f.create_dataset('data', data=arr)\n    # 其中 compression='gzip', compression_opts=[0-9], 可分条目用不同压缩\n    f['lb'] = list(range(100))\n```\n&emsp;读纯 HDF5/NCDF 文件:\n```python\nf = h5py.File('test.hdf5', 'r')\nkeys = list(f.keys())  # ['data', 'lb']\nitems = list(f.items())\na = f['data'].value\n```\n&emsp;读 pandas 存的文件:\n```python\na = f['data']['block0_values'].value\nf.close()\n# f['<key>'] 得到的是 Dataset 或 Group 的引用\n# 用 f['<key>'].value 或切片 f['<key>'][:] 得到原来的格式\n# f['<key>'] 可替代为f.get('<key>')\n# 关闭之后 f['data'] 的引用失效, 因此存出数据要加上.value或[:]保存数据, 或使用 deepcopy\n```\n&emsp;打印读取的信息:\n```python\nfrom pprint import pprint\npprint([(f'{k:>20}', f'{str(f[k].shape):>20}', f'{str(f[k].dtype):>20}') for k in f.keys()])\npprint([(f'{k:>20}', f\"{str(f[k]['block0_values'].shape):>20}\", f\"{str(f[k]['block0_values'].dtype):>20}\") for k in f.keys()])\n```\n\n* 用pandas读写:\n    \n```python\nimport pandas as pd\n```\n&emsp;写:\n```python\narr2 = pd.DataFrame(arr)\n# complevel=[0-9], complib={'zlib', 'lzo', 'bzip2', 'blosc'}\nwith pd.HDFStore('test2.hdf5', 'w') as f:\n    f['data'] = arr2\n    f['lb'] = pd.DataFrame(list(range(100)))\n```\n&emsp;读 pandas 写的文件:\n```python\nf = pd.HDFStore('test2.hdf5', 'r')\nkeys = f.keys()  # ['/data', '/lb'], 存在子目录\nitems = list(f.items())\na = f.data.values  # a = f.<key> 得到的是 DataFrame 的引用, f.<key>.values 得到原来的格式\nf.close()\n```\n\n* 读纯 HDF5/NCDF 文件:<br>\n比如 h5py 写的文件, 目录结构和 pandas 写的不同, 要用`.root`<br>\n其他软件生成的文件可能不能读\n\n```python\nf = pd.HDFStore('test.hdf5', 'r')\nkeys = list(f.root._v_children.keys())  # ['data', 'lb']\nitems = list(f.root._v_children.items())  # ['data', 'lb'], 有些文件没有.items\na = f.root.data.read()\n# f.root 得到 tables.group.RootGroup, f.root.<key> 得到tables.group.CArray\n# f.get_node('<key>') 得到 tables.group.CArray\n# f.root.<key> 可替代为 f['<key>'] (有些文件不行)\nf.close()\n```\n&emsp;打印 (以免数据有 None, 用 `np.shape`):\n```python\npprint([(f'{k}'                      .rjust(20),\n         f'{np.shape(f.get_node(k))}'.rjust(20),\n         f'{np.dtype(f.get_node(k))}'.rjust(20))\n         for k in list(f.root._v_children.keys())])\n```\n&emsp;Bug: 无法读出 `H5T_STRING`\n\n#### 大小比较\n\n用于比较的文件名说明:\n\nFilename | Method\n:---|:---\n*xxx*_np.npy|**`np.save`**\n*xxx*_np.npz|**`np.savez_compressed`**\n*xxx*_compimg.fits|**FITS** CompImageHDU (compressed)\n*xxx*_prim.fits|**FITS** PrimaryHDU\n*xxx*_h5py_0.hdf5|**`h5py`** no compression\n*xxx*_h5py_gzip.hdf5|**`h5py`** compression='gzip', compression_opts=9\n*xxx*_h5py_lzf.hdf5|**`h5py`** compression='lzf'\n*xxx*_pd_0.hdf5|**`pandas`** no compression\n*xxx*_pd_blosc.hdf5|**`pandas`** complib='blosc', complevel=9\n*xxx*_pd_bzip2.hdf5|**`pandas`**  complib='bzip2', complevel=9\n*xxx*_pd_lzo.hdf5|**`pandas`**  complib='lzo', complevel=9\n*xxx*_pd_zlib.hdf5|**`pandas`**  complib='zlib', complevel=9\n\n* 对于相关性强的数组\n\n```python\n%run examples/test_hdf5.py\nprint()\n!du -h data/test_*.np*\nprint()\n!du -h data/test_h5py_*.hdf5\nprint()\n!du -h data/test_pd_*.hdf5\n```\n\n    array: 15.3 M\n    \n    7.7M\tdata/test_np.npy\n    1.3M\tdata/test_np.npz\n    \n    16M\tdata/test_h5py_0.hdf5\n    2.9M\tdata/test_h5py_gzip.hdf5\n    7.7M\tdata/test_h5py_lzf.hdf5\n    \n    16M\tdata/test_pd_0.hdf5\n    272K\tdata/test_pd_blosc.hdf5\n    248K\tdata/test_pd_bzip2.hdf5\n    256K\tdata/test_pd_lzo.hdf5\n    172K\tdata/test_pd_zlib.hdf5\n\n\n* 随机数数组\n\n```python\n%run examples/test_hdf5_2.py\nprint()\n!du -h data/test_*.np*\nprint()\n!du -h data/test_h5py_*.hdf5\nprint()\n!du -h data/test_pd_*.hdf5\n```\n\n    array: 15.3 M\n    \n    7.7M\tdata/test_np.npy\n    7.2M\tdata/test_np.npz\n    \n    16M\tdata/test_h5py_0.hdf5\n    8.0M\tdata/test_h5py_gzip.hdf5\n    9.5M\tdata/test_h5py_lzf.hdf5\n    \n    16M\tdata/test_pd_0.hdf5\n    7.7M\tdata/test_pd_blosc.hdf5\n    7.2M\tdata/test_pd_bzip2.hdf5\n    7.7M\tdata/test_pd_lzo.hdf5\n    7.1M\tdata/test_pd_zlib.hdf5\n\n\n* 从 FITS 文件读取再转存\n\n```python\nfname = 'data/hmi.B_720s.20150827_052400_TAI.field.fits'\n%run examples/test_fits_hdf5.py {fname}\nprint()\n!du -h {fname}\nprint()\n!du -h data/fits_*.np*\nprint()\n!du -h data/fits_*.fits\nprint()\n!du -h data/fits_h5py_*.hdf5\nprint()\n!du -h data/fits_pd_*.hdf5\n```\n\n    array: 64.0 M\n    \n    21M\tdata/hmi.B_720s.20150827_052400_TAI.field.fits\n    \n    65M\tdata/fits_np.npy\n    27M\tdata/fits_np.npz\n    \n    21M\tdata/fits_compimg.fits\n    65M\tdata/fits_prim.fits\n    \n    65M\tdata/fits_h5py_0.hdf5\n    27M\tdata/fits_h5py_gzip.hdf5\n    40M\tdata/fits_h5py_lzf.hdf5\n    \n    65M\tdata/fits_pd_0.hdf5\n    23M\tdata/fits_pd_blosc.hdf5\n    21M\tdata/fits_pd_bzip2.hdf5\n    23M\tdata/fits_pd_lzo.hdf5\n    20M\tdata/fits_pd_zlib.hdf5\n\n\n```python\nfname = 'data/hmi.B_720s.20150827_052400_TAI.disambig.fits'\n%run examples/test_fits_hdf5.py {fname}\nprint()\n!du -h {fname}\nprint()\n!du -h data/fits_*.np*\nprint()\n!du -h data/fits_*.fits\nprint()\n!du -h data/fits_h5py_*.hdf5\nprint()\n!du -h data/fits_pd_*.hdf5\n```\n\n    array: 32.0 M\n    \n    5.4M\tdata/hmi.B_720s.20150827_052400_TAI.disambig.fits\n    \n    33M\tdata/fits_np.npy\n    5.2M\tdata/fits_np.npz\n    \n    5.4M\tdata/fits_compimg.fits\n    33M\tdata/fits_prim.fits\n    \n    33M\tdata/fits_h5py_0.hdf5\n    5.3M\tdata/fits_h5py_gzip.hdf5\n    9.7M\tdata/fits_h5py_lzf.hdf5\n    \n    33M\tdata/fits_pd_0.hdf5\n    9.5M\tdata/fits_pd_blosc.hdf5\n    4.1M\tdata/fits_pd_bzip2.hdf5\n    7.6M\tdata/fits_pd_lzo.hdf5\n    4.8M\tdata/fits_pd_zlib.hdf5\n\n\n#### 读取 CDF 文件\n\n相关包 `cdflib`, 安装见 [Python 安装和配置#其他](installpy.html#其他)\n```python\nimport cdflib\nf = cdflib.CDF(\"<filename>.cdf\")\nf.cdf_info()  # 总体信息\nf.varinq('<key>')  # 变量信息\nf.varget('<key>')  # 值\nf.close()\n```\n\n### NumPy to VTK\n\n参考 <https://pyscience.wordpress.com/2014/09/06/numpy-to-vtk-converting-your-numpy-arrays-to-vtk-arrays-and-files/><br>\n以及 [Python 安装和配置](installpy.html#其他)\n<br><br>\ne.g.<br>\n运行 [examples/field2dvtk.py](examples/field2dvtk.py) ,<br>\n打开Paraview, 选择 state 文件 'field2d.pvsm', 再选择数据文件 'field2d.vtr'\n\n### Matlab mat 文件读写\n\n(未测试)\n```python\nimport scipy.io\nscipy.io.loadmat(\"<filename>\", mdict=None, appendmat=True, **kwargs)\n# 如果 appendmat=True，则文件名不需要'.mat'后缀)\nscipy.io.savemat(\"<filename>\", mdict, appendmat=True, format='5',\n                 long_field_names=False, do_compression=False, oned_as='row')\n```\n\n## 脚本相关\n\n### 脚本结构\n\n文件头:\n```python\n#!/usr/bin/env python\n# -*- coding: utf-8 -*-\n```\n\n脚本结构:\n```python\n#!/usr/bin/env python\n# -*- coding: utf-8 -*-\n\"\"\"\n假设这个文件的名称为 mymodule.py\n使用 `imort mymodule` 导入\n这些文字会出现在 `help(mymodule)` 或 `pydoc mymodule` 中\n\"\"\"\nc = 1\ndef func1(x, y, *args, **kwargs):\n    \"\"\"\n    这个注释必须缩进\n    args: a tuple - (arg1, arg2, ...)\n    kwargs: a dict - {key1 : val1, key2 : val2}\n    \"\"\"\n    global c\n    return x + y + c\ndef func2(x):\n    a = func1(x, x)\n    return a\ndef _func3(x):  # `from xxx import *` 将不会导入这个函数\n    pass\n    return  # return 不写时返回 None\ndef main():\n    # your code here\nif __name__ == \"__main__\":\n    main()\n```\n`import` 这个文档时, `__name__` 为模块名, 因此 `main()` 不执行\n\n`help()` 也可以查看模块内的函数文档:\n\n```python\nimport usr_sunpy\nhelp(usr_sunpy.plot_map)\n```\n\n### try ... except ... 语法\n\n```python\ntry:\n    ...\nexcept ValueError as e:\n    print('ValueError:', e)\nexcept ZeroDivisionError as e:\n    print('ZeroDivisionError:', e)\nelse:\n    print('no error!')\nfinally:\n    print('finally...')\n```\n见 [Paraview 的例子](#Paraview-脚本)\n\n### Paraview 脚本\n\n官方文档 <https://www.paraview.org/ParaView/Doc/Nightly/www/py-doc/index.html>\n<br><br>\n* 记录语句:\n 1. Tools -> Start Trace\n 2. 进行各种操作\n 3. Tools -> Stop Trace 之后得到一个包含刚才操作命令的脚本, 参考其中的语句就可以写自己的脚本了.\n<br><br>\n* 需要导入的模块:\n\n```sh\nfrom paraview.simple import *\n```\n<br>\n* 使用 pvpython (默认渲染) pvbatch (默认不渲染) 来执行脚本:\n\n```sh\npvbatch myscript.py\n```\n\n也可以使用文件头 `#!/usr/bin/env pvbatch`, 加执行权限后直接执行:\n```sh\n./myscript.py\n```\n注意: 打包的 paraview 所使用的 python 是 paraview 自带的 python2.7\n\n<img src='/advance/Screenshot_20180618-151438.png' width='700' />\n\n* 常用语句:\n\n```python\nview = GetActiveView()\nscene = GetAnimationScene()\n```\n`view.ViewTime` 修改时 `scene.AnimationTime` 不变\n`scene.AnimationTime` 修改时 `view.ViewTime` 也同时被改变\n\n注意: filter 必须是显示状态 (`Show(<filter>)`) 才能修改时间\n\n```python\n# e.g.\n!code -n examples/stat1.py\n```\n\n* 字体选择参考路径:<br>\n  - /usr/share/fonts/truetype/dejavu/DejaVuSans.ttf\n  - /home/<user>/miniconda3/lib/python3.6/site-packages/matplotlib/mpl-data/fonts/ttf/DejaVuSans.ttf\n\n\n* python 调用问题 (paraview 5.5.0+ 没有这个问题):\n\nparaview 某个版本之后就默认使用 python 2.7.11+.<br>\n运行之前先修改环境变量 ( `PYTHONPATH` 和 `PYTHONSTARTUP`), <br>\n运行结束结束后恢复这两个变量即可.<br><br>\n这个过程可以使用脚本 (而不用alias):\n```sh\n#!/bin/bash\nunset PYTHONSTARTUP  # 如果有的话\nexport PYTHONPATH=/<your_path>/ParaView/lib/python2.7/site-packages\n/<your_path>/ParaView/bin/paraview $@\n```\n用这个脚本替代原有 `paraview`, `pvpython` 和 `pvbatch` 命令.\n\n### Python 2 -> 3 的转换\n\n比较推荐的安全的检查方式:\n\n* 备份的原文件且自动生成转换过的文件\n```\n$ 2to3 -w filename\n```\n\n* 手动比较, 在需要的地方对照修改 filename.bak<br>\n主要查看 print, range, map 等函数.<br>\n添加<br>\n&emsp;`from __future__ import division, print_function`<br>\n在其他 import 前.\n```\n$ sudo apt-get install meld\n$ meld filename filename.bak\n```\n* 确认无误后, 将手动修改的文件复制回去\n```\n$ mv -v filename.bak filename\n```\n\npython 内查看版本的方法, 可用于 `if` 语句等 (更推荐用 `try...except...` 语法):\n\n```python\nimport sys\nprint(sys.version_info >= (3, 0))\nprint(sys.version_info.major >= 3)\n```\n\n### 执行 shell 命令\n\n<https://docs.python.org/3/library/subprocess.html>\n\n```python\nimport subprocess\n\nfname = 'installpy.ipynb'\n\n# 默认是以列表形式传递参数\nsubprocess.run([\"ls\", \"-l\", fname]) # doesn't capture output\n\n# 输出结果需要 `decode('ascii')` 转码\nprint(subprocess.run([\"ls\", \"-l\", fname], stdout=subprocess.PIPE)\n                    .stdout.decode('ascii'))\nprint(subprocess.check_output([\"ls\", \"-l\", fname]).decode('ascii'))\n```\n\n    -rw-rw-r-- 1 lydia lydia 142508 Jun 24 16:21 installpy.ipynb\n    \n    -rw-rw-r-- 1 lydia lydia 142508 Jun 24 16:21 installpy.ipynb\n    \n\n\n利用 bash 的特长来做一些字符串操作:\n\n```python\n# 使用整行命令需要 `shell=True`, 虽然并不是推荐的做法, 但偶尔使用无妨 (见官方文档)\n# `r`用来取消转义\n# `echo`使用`-n`来去掉输出的 '\\n'\nfname_head = subprocess.check_output(r\"echo -n %s | sed 's/\\.ipynb//'\"\n                                     % fname, shell=True).decode('ascii')\n# 或使用 strip 去掉 '\\n'\nfname_head = subprocess.check_output(r\"echo %s | sed 's/\\.ipynb//'\"\n             % fname, shell=True).strip().decode('ascii')  \nprint(fname_head)\n```\n\n    installpy\n\n\n字符串编码见 [廖雪峰的网站](https://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000/001431664106267f12e9bef7ee14cf6a8776a479bdec9b9000)\n\n* 得到命令执行的路径\n\n```python\nimport os\nos.getcwd()\n```\n\n\n\n\n    '/home/lydia/codes/zly/python/python-intro'\n\n\n\n* 得到脚本文件所在的路径(仅脚本中使用)\n\n```python\nos.path.split(os.path.abspath(__file__))[0]\n```\n或\n```python\nos.path.dirname(os.path.abspath(__file__))\n```\n\n其中 `os.path.split` 和 `os.path.dirname` 的用法:\n\n```python\nos.path.split('your/path/filename')\n```\n\n\n\n\n    ('your/path', 'filename')\n\n\n\n```python\nos.path.dirname('your/path/filename')\n```\n\n\n\n\n    'your/path'\n\n\n\n`os.path.dirname` 类似于 bash 的 `dirname`\n\n```python\n!dirname 'your/path/filename'\n```\n\n    your/path\n\n\n### 脚本选项\n\n推荐 `argparse`, 在过去的其他方法的基础上有所增强 <https://docs.python.org/3/library/argparse.html>\n\n脚本内:\n```python\nimport argparse\nparser = argparse.ArgumentParser(description='Process some integers.')\nparser.add_argument('integers', metavar='N', type=int, nargs='+',\n                    help='an integer for the accumulator')\nparser.add_argument('--sum', dest='accumulate', action='store_const',\n                    const=sum, default=max,\n                    help='sum the integers (default: find the max)')\nargs = parser.parse_args()\nprint(args.accumulate(args.integers))\n```\nShell:\n```\n$ python prog.py -h\nusage: prog.py [-h] [--sum] N [N ...]\nProcess some integers.\npositional arguments:\n N           an integer for the accumulator\noptional arguments:\n -h, --help  show this help message and exit\n --sum       sum the integers (default: find the max)\n```\n\n### 处理 warnings\n\n```python\n# Suppress warnings of NaNs:\nwith np.errstate(invalid='ignore'):\n    ...\n    ...\n# Suppress other warnings, e.g.\nimport warnings\nwith warnings.catch_warnings():\n    warnings.simplefilter(\"ignore\")\n    ...\n    ...\n# Or\nwarnings.simplefilter(\"ignore\", category=xxx)  # UserWarning, FutureWarning, etc.\n...\n...\n```\n\n## urllib, requests\n\n示例和文件来自 <http://python4astronomers.github.com>\n\n注意 python3 不再使用 `urllib2`\n\n```python\n# 方法1\nimport urllib\nurl = 'http://python4astronomers.github.com/_downloads/myidlfile.sav'\nurllib.request.urlretrieve(url, 'myidlfile.sav')\n# 方法2\nwith open('myidlfile.sav', 'wb') as f:\n    f.write(urllib.request.urlopen(url).read())\n# 方法3\nimport requests\nwith open('myidlfile.sav', 'wb') as f:\n    f.write(requests.get(url).content)\n# 分块下载\nimport requests\nr = requests.get(<url>)\nwith open(filename, 'wb') as f:\n    for chunk in r.iter_content(chunk_size=128):\n        f.write(chunk)\n```\n","slug":"advance","published":1,"updated":"2018-07-02T13:46:13.000Z","__permalink":"advance.html","comments":1,"layout":"post","photos":[],"link":"","_id":"cl5kegavj0001vxgv4b6o07o3","content":"<p><a\nhref=\"/downloads/notebooks/python-intro.zip\"><i class=\"fas fa-download\"></i>\nJupyter Notebook</a></p>\n<h2 id=\"anaconda\">Anaconda</h2>\n<blockquote>\n<p>A <strong>conda package</strong> is a compressed tarball file that\ncontains system-level libraries, Python or other modules, executable\nprograms and other components. <strong>Conda</strong> keeps track of the\ndependencies between packages and platforms.<br>\n(https://conda.io/docs/user-guide/concepts.html)</p>\n</blockquote>\n<ul>\n<li>凡使用 <span style=\"color:blue\">pip install</span>\n安装的包均为编译安装, <span style=\"color:blue\">conda install</span>\n安装的则为编译好的二进制包.</li>\n<li>conda 包可以打包其他语言, pip 包容易出现系统依赖问题</li>\n<li>conda 包的依赖管理更完善</li>\n<li>conda 环境下仍可使用 pip 进行安装, 但所使用的 pip 命令和系统中的 pip\n互不影响, 安装的包的位置也在 conda 本身的目录下.</li>\n<li>每个环境互不影响, 各环境下的包虽然必须分别安装 (也可以 clone\n一个现有环境),<br> 但如果有不同环境中有重复的包 conda 将默认使用\n<em>hard link</em>.</li>\n</ul>\n<p>(更多讨论参考 <a\nhref=\"http://jakevdp.github.io/blog/2016/08/25/conda-myths-and-misconceptions/)\"\nclass=\"uri\">http://jakevdp.github.io/blog/2016/08/25/conda-myths-and-misconceptions/)</a>\n<span id=\"more\"></span></p>\n<p><img src='/advance/Screenshot_20180617-181206.png' width='650'/></p>\n<ul>\n<li>python 位置 (未使用 conda 时)</li>\n</ul>\n<p>使用 <pre class=\"line-numbers language-none\"><code class=\"language-none\">$ python -m site<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre> 可以看到有哪些目录.</p>\n<p>三个部分:</p>\n<ul>\n<li><strong>root</strong>\n<pre>\n/<span style=\"color:#800080\"><b>usr</b></span>/lib/...\n/<span style=\"color:#800080\"><b>usr</b></span>/bin/...\n</pre></li>\n<li><strong>user</strong>\n<pre>\n/home/&lt;user&gt;/<span style=\"color:#800080\"><b>.local</b></span>/lib/...\n/home/&lt;user&gt;/<span style=\"color:#800080\"><b>.local</b></span>/bin/...\n</pre></li>\n<li><strong>anaconda/miniconda</strong>\n<pre>\n/home/&lt;user&gt;/<b><span style=\"color:#800080\">miniconda3</span></b>/</span>/lib/...\n/home/&lt;user&gt;/<b><span style=\"color:#800080\">miniconda3</span></b>/</span>/bin/...\n</pre></li>\n<li>conda 目录结构 (安装之后自动修改了软连接,\n修改环境变量后系统优先使用这个位置)</li>\n</ul>\n<pre>\n/home/&lt;user&gt;/<span style=\"color:#800080\"><b>miniconda3/</b></span>\n    ├── <span style=\"color:navy\"><b>pkgs/</b></span>\n    ├── <span style=\"color:dimgray\"><b>bin/</b></span>\n    │        ├── <span style=\"color:magenta\">python</span> -&gt; <span style=\"color:green\">python3.6</span>\n    │        ├── <span style=\"color:magenta\">python3</span> -&gt; <span style=\"color:green\">python3.6</span>\n    │        ├── <span style=\"color:green\">python3.6</span>\n    │        ├── <span style=\"color:green\">jupyter</span>\n    │        ├── <span style=\"color:green\">h5dump</span>\n    │        └── ...\n    ├── <span style=\"color:dimgray\"><b>include/</b></span>\n    ├── <span style=\"color:dimgray\"><b>lib/</b></span>\n    ├── <span style=\"color:dimgray\"><b>share/</b></span>\n    ├── <span style=\"color:navy\"><b>envs</b></span>\n    │        ├── <span style=\"color:blue\"><b>env1/</b></span>\n    │        │        ├── <span style=\"color:dimgray\"><b>bin/</b></span>\n    │        │        ├── <span style=\"color:dimgray\"><b>include/</b></span>\n    │        │        ├── <span style=\"color:dimgray\"><b>lib/</b></span>\n    │        │        ├── <span style=\"color:dimgray\"><b>share/</b></span>\n    │        │        └── ...\n    │        ├── <span style=\"color:blue\"><b>env2/</b></span>\n    │        └── ...\n    └── ...\n</pre>\n<h2 id=\"ipython-jupyter\">IPython &amp; Jupyter</h2>\n<p>参考文档 <a href=\"http://jupyter-notebook.readthedocs.io/en/stable/\"\nclass=\"uri\">http://jupyter-notebook.readthedocs.io/en/stable/</a></p>\n<ul>\n<li>配置文件路径</li>\n</ul>\n<p>一般用户配置文件在 <code>~/.jupyter</code></p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">!jupyter <span class=\"token operator\">-</span><span class=\"token operator\">-</span>paths<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>config:\n    /home/lydia/.jupyter\n    /home/lydia/miniconda3/etc/jupyter\n    /usr/local/etc/jupyter\n    /etc/jupyter\ndata:\n    /home/lydia/.local/share/jupyter\n    /home/lydia/miniconda3/share/jupyter\n    /usr/local/share/jupyter\n    /usr/share/jupyter\nruntime:\n    /run/user/1000/jupyter</code></pre>\n<ul>\n<li>列出所有 magic functions:</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">%</span>lsmagic<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<ul>\n<li>运行脚本:</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">%</span>run script<span class=\"token punctuation\">.</span>py\n<span class=\"token operator\">%</span>run script<span class=\"token punctuation\">.</span>ipynb<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<ul>\n<li>在单个 Cell 中调用其他语言 (子进程):</li>\n</ul>\n<pre class=\"line-numbers language-sh\" data-language=\"sh\"><code class=\"language-sh\">%%sh\ncd ~&#x2F;miniconda3&#x2F;\npwd<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<pre><code>/home/lydia/miniconda3</code></pre>\n<p>可以看到实际并未改变当前目录 (因为是子进程):</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">pwd<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>&#39;/home/lydia/codes/zly/python/python-intro&#39;</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">%</span><span class=\"token operator\">%</span>script idl\ncd<span class=\"token punctuation\">,</span> current<span class=\"token operator\">=</span>d\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">,</span> d<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<pre><code>/home/lydia/codes/zly/python/python-intro\n\n\nIDL Version 8.2.1 (linux x86_64 m64). (c) 2012, Exelis Visual Information Solutions, Inc.</code></pre>\n<ul>\n<li>逐行使用 bash 命令 (注意不加 '!' 的区别):</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">!idl <span class=\"token operator\">-</span>e field3dgui<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">!ls <span class=\"token punctuation\">.</span><span class=\"token operator\">/</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>得到的结果可以存入变量:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">current<span class=\"token punctuation\">,</span> <span class=\"token operator\">=</span> !pwd  <span class=\"token comment\"># returns a list</span>\ncurrent<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>&#39;/home/lydia/python-intro&#39;</code></pre>\n<p>下面这两句不能写在一个 Cell 中:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">cd <span class=\"token operator\">-</span>q <span class=\"token operator\">~</span><span class=\"token operator\">/</span>miniconda3<span class=\"token operator\">/</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">pwd<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>&#39;/home/lydia/miniconda3&#39;</code></pre>\n<p>用 <code>&#123;var&#125;</code> (推荐) 或 <code>$var</code> (不推荐) 调用当前\nipython 环境的变量:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">cd <span class=\"token punctuation\">&#123;</span>current<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>/home/lydia/codes/zly/python/python-intro</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">cd <span class=\"token string\">\"$current\"</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>/home/lydia/codes/zly/python/python-intro</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">cd $current<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>/home/lydia/codes/zly/python/python-intro</code></pre>\n<p>见 <a\nhref=\"http://mmcdan.github.io/posts/interacting-with-the-shell-via-jupyter-notebook/\"\nclass=\"uri\">http://mmcdan.github.io/posts/interacting-with-the-shell-via-jupyter-notebook/</a></p>\n<ul>\n<li>列出当前的变量信息</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\nb <span class=\"token operator\">=</span> <span class=\"token string\">'x'</span>\n\n<span class=\"token operator\">%</span>whos <span class=\"token builtin\">int</span> <span class=\"token builtin\">str</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code>Variable   Type    Data/Info\n----------------------------\na          int     1\nb          str     x</code></pre>\n<h2 id=\"语法细节\">语法细节</h2>\n<h3 id=\"python2-python3\">python2 &amp; python3</h3>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">%</span><span class=\"token operator\">%</span>python2\n<span class=\"token keyword\">print</span> <span class=\"token number\">1</span> <span class=\"token operator\">/</span> <span class=\"token number\">2</span>\n<span class=\"token keyword\">print</span> <span class=\"token number\">1</span> <span class=\"token operator\">//</span> <span class=\"token number\">2</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<pre><code>0\n0</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">%</span><span class=\"token operator\">%</span>python3\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token operator\">//</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<pre><code>0.5\n0</code></pre>\n<p>详见 <a href=\"#Python-2--%3E-3-的转换\">Python 2 -&gt; 3\n的转换</a></p>\n<h3 id=\"list-tuple\">list, tuple</h3>\n<ul>\n<li>对 list 或 tuple, 当只有一个元素时, 注意加逗号:</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">l <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>\n<span class=\"token builtin\">type</span><span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>list</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">l <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">]</span>\n<span class=\"token builtin\">type</span><span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>list</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">l <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n<span class=\"token builtin\">type</span><span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>int</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">l <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">)</span>\n<span class=\"token builtin\">type</span><span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>tuple</code></pre>\n<ul>\n<li>赋值, 星号 (<code>*</code>) 表达式用来展开 list/tuple, 双星号\n(<code>**</code>) 用来展开 dict (常用于函数参数表):</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> <span class=\"token operator\">*</span>c <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span>\na<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> c<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>(0, 1, [2, 3])</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a<span class=\"token punctuation\">,</span> <span class=\"token operator\">*</span>_ <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token comment\"># 或 a, = ...</span>\na<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>0</code></pre>\n<h3 id=\"dict\">dict</h3>\n<ul>\n<li>dict 改变某个 key 但 value 不变的方法</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">d <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token string\">'a'</span> <span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'b'</span> <span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">&#125;</span>\nd<span class=\"token punctuation\">[</span><span class=\"token string\">'c'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> d<span class=\"token punctuation\">.</span>pop<span class=\"token punctuation\">(</span><span class=\"token string\">'b'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 利用 `pop` 返回值, 更改 key 值</span>\nd<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<pre><code>&#123;&#39;a&#39;: 1, &#39;c&#39;: 2&#125;</code></pre>\n<ul>\n<li>dict 求并集</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">d1 <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token string\">'a'</span> <span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'b'</span> <span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">&#125;</span>\nd2 <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token string\">'a'</span> <span class=\"token punctuation\">:</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'c'</span> <span class=\"token punctuation\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'d'</span> <span class=\"token punctuation\">:</span> <span class=\"token number\">4</span><span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token builtin\">dict</span><span class=\"token punctuation\">(</span>d1<span class=\"token punctuation\">,</span> <span class=\"token operator\">**</span>d2<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 重复的 key 取后一个的值</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>&#123;&#39;a&#39;: -1, &#39;b&#39;: 2, &#39;c&#39;: 3, &#39;d&#39;: 4&#125;</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token builtin\">dict</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span>d1<span class=\"token punctuation\">.</span>items<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span>d2<span class=\"token punctuation\">.</span>items<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 注意其中的 list</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>&#123;&#39;a&#39;: -1, &#39;b&#39;: 2, &#39;c&#39;: 3, &#39;d&#39;: 4&#125;</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">d1<span class=\"token punctuation\">.</span>update<span class=\"token punctuation\">(</span>d2<span class=\"token punctuation\">)</span>\nd1<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>&#123;&#39;a&#39;: -1, &#39;b&#39;: 2, &#39;c&#39;: 3, &#39;d&#39;: 4&#125;</code></pre>\n<h3 id=\"set\">set</h3>\n<ul>\n<li>set 基本操作</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">s <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">s<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># one element only</span>\ns<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>&#123;1, 2, 3&#125;</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">s<span class=\"token punctuation\">.</span>update<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># iterable: list/tuple/set/...</span>\ns<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>&#123;1, 2, 3, 4, 5&#125;</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">s<span class=\"token punctuation\">.</span>remove<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\ns<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>&#123;2, 3, 4, 5&#125;</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">s<span class=\"token punctuation\">.</span>discard<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># No error if not exist</span>\ns<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>&#123;2, 3, 4, 5&#125;</code></pre>\n<ul>\n<li>set 求交集, 并集, 差集, 对称差集, 子集</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token punctuation\">&#123;</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">.</span>intersection<span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>&#123;2&#125;</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token punctuation\">&#123;</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">&amp;</span> <span class=\"token punctuation\">&#123;</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">&#125;</span>  <span class=\"token comment\"># 或用 and</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>&#123;2&#125;</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token punctuation\">&#123;</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">.</span>union<span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>&#123;1, 2, 3&#125;</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token punctuation\">&#123;</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">|</span> <span class=\"token punctuation\">&#123;</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">&#125;</span>  <span class=\"token comment\"># 或用 or</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>&#123;1, 2, 3&#125;</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token punctuation\">&#123;</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">.</span>difference<span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>&#123;1&#125;</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token punctuation\">&#123;</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">-</span> <span class=\"token punctuation\">&#123;</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">&#125;</span>  <span class=\"token comment\"># 在前不在后</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>&#123;1&#125;</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token punctuation\">&#123;</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">.</span>symmetric_difference<span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>&#123;1, 3&#125;</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token punctuation\">&#123;</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">^</span> <span class=\"token punctuation\">&#123;</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">&#125;</span>  <span class=\"token comment\"># 不同时在两边</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>&#123;1, 3&#125;</code></pre>\n<ul>\n<li>属于, 包含于(子集)</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token number\">2</span> <span class=\"token keyword\">in</span> <span class=\"token punctuation\">&#123;</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">&#125;</span>  <span class=\"token comment\"># list/tuple/set</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>True</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token number\">4</span> <span class=\"token keyword\">not</span> <span class=\"token keyword\">in</span> <span class=\"token punctuation\">&#123;</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">&#125;</span>  <span class=\"token comment\"># list/tuple/set</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>True</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token punctuation\">&#123;</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">.</span>issubset<span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>True</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token punctuation\">&#123;</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">&lt;=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>True</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token punctuation\">&#123;</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">.</span>issuperset<span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>True</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token punctuation\">&#123;</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">>=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>True</code></pre>\n<h3 id=\"一些特性的演示\">一些特性的演示</h3>\n<p>插件 <a href=\"https://github.com/lgpage/nbtutor\"\nclass=\"uri\">https://github.com/lgpage/nbtutor</a><br> 网页版 <a\nhref=\"http://pythontutor.com/\"\nclass=\"uri\">http://pythontutor.com/</a></p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">%</span>reload_ext nbtutor<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">%</span><span class=\"token operator\">%</span>nbtutor <span class=\"token operator\">-</span>r <span class=\"token operator\">-</span>f\nl1<span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\nl2 <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<p><a href=\"http://t.cn/Rg9J3bf\">网页版演示</a></p>\n<p><img src='/advance/nbtutor1.png' width='550'/></p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">%</span><span class=\"token operator\">%</span>nbtutor <span class=\"token operator\">-</span>r <span class=\"token operator\">-</span>f <span class=\"token operator\">-</span>i\na <span class=\"token operator\">=</span> <span class=\"token number\">3</span>\nb <span class=\"token operator\">=</span> <span class=\"token number\">4</span>\nt <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># list in tuple</span>\na <span class=\"token operator\">=</span> <span class=\"token string\">'x'</span> <span class=\"token comment\"># change element in list</span>\nt<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">'xx'</span> <span class=\"token comment\"># change element in tuple</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>(1, 2, [&#39;xx&#39;, 4])</code></pre>\n<p><a href=\"http://t.cn/Rg9idUn\">网页版演示</a></p>\n<p><img src='/advance/nbtutor2.png' width='550'/></p>\n<h3 id=\"包含判断的单行循环\">包含判断的单行循环</h3>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">l <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">[</span>i <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> l <span class=\"token keyword\">if</span> i <span class=\"token operator\">></span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>[3, 4, 5]</code></pre>\n<p>例如用 <code>globals()</code> 来得到字符串形式的变量名 (python\n的变量没有提供这个功能的关键字, 因为\"变量名\"存储在namespaces中)</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">namestr</span><span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">,</span> namespace<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span>name <span class=\"token keyword\">for</span> name <span class=\"token keyword\">in</span> namespace <span class=\"token keyword\">if</span> namespace<span class=\"token punctuation\">[</span>name<span class=\"token punctuation\">]</span> <span class=\"token keyword\">is</span> obj<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\na <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\nb <span class=\"token operator\">=</span> <span class=\"token number\">2</span>\n<span class=\"token keyword\">for</span> var <span class=\"token keyword\">in</span> <span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f'</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>namestr<span class=\"token punctuation\">(</span>var<span class=\"token punctuation\">,</span> <span class=\"token builtin\">globals</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\"> = </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>var<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">'</span></span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code>a = 1\nb = 2</code></pre>\n<h3 id=\"单行-if-三元关系运算\">单行 if (三元关系运算)</h3>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\nb <span class=\"token operator\">=</span> <span class=\"token string\">'y'</span> <span class=\"token keyword\">if</span> a <span class=\"token operator\">></span> <span class=\"token number\">0</span> <span class=\"token keyword\">else</span> <span class=\"token string\">'n'</span>\nb<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<pre><code>&#39;y&#39;</code></pre>\n<h3 id=\"循环-迭代器-生成器\">循环, 迭代器, 生成器</h3>\n<p>Python 的 for 循环不使用索引变量, 而使用遍历<strong>迭代器</strong>\n(iterator) 的方式处理<strong>可迭代对象</strong> (range, set 等):</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<p>遍历的方式是使用 <code>iter</code> 和 <code>next</code> 函数:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> <span class=\"token builtin\">iter</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 生成一个 range_iterator 对象</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token builtin\">next</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>0</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 转换为 list</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>[0, 1, 2, 3, 4]</code></pre>\n<p><code>enumerate</code> 函数适合需要同时使用索引和内容时使用:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">for</span> i<span class=\"token punctuation\">,</span> item <span class=\"token keyword\">in</span> <span class=\"token builtin\">enumerate</span><span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>  <span class=\"token comment\"># enumerate()是一个迭代器</span>\n    i <span class=\"token operator\">=</span> <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n    item <span class=\"token operator\">=</span> <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>  <span class=\"token comment\"># l[i] = ...</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<p>生成器:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>i<span class=\"token operator\">**</span><span class=\"token number\">2</span> <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 产生一个生成器, 可转化成 list, tuple</span>\na<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>&lt;generator object &lt;genexpr&gt; at 0x14da87e652b0&gt;</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token builtin\">next</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 生成器也是迭代器</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>4</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>i <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># 产生一个 list</span>\na<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>[0, 1, 2]</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># 转化成 tuple</span>\n<span class=\"token builtin\">tuple</span><span class=\"token punctuation\">(</span>i <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>(0, 1, 2)</code></pre>\n<h3 id=\"函数定义\">函数定义</h3>\n<ul>\n<li>一般的函数定义:</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">func</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> <span class=\"token operator\">*</span>args<span class=\"token punctuation\">,</span> <span class=\"token operator\">**</span>kwargs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># func1(x, y, arg1, arg2, ..., key1=val1, key2=val2, ...)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span> <span class=\"token comment\"># 没有 return 或为空 则返回 None</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<ul>\n<li>单行函数 lambda</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">f</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">return</span> x <span class=\"token operator\">+</span> y\nf<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<pre><code>3</code></pre>\n<p>用 <code>lambda</code> 语法来定义:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">f <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">:</span> x <span class=\"token operator\">+</span> y\nf<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>3</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token punctuation\">(</span><span class=\"token keyword\">lambda</span> x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">:</span> x <span class=\"token operator\">+</span> y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 不一定需要定义函数名称</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>3</code></pre>\n<h3 id=\"命名空间和变量作用域\">命名空间和变量作用域</h3>\n<p><a\nhref=\"https://sebastianraschka.com/Articles/2014_python_scope_and_namespaces.html\"\nclass=\"uri\">https://sebastianraschka.com/Articles/2014_python_scope_and_namespaces.html</a></p>\n<p><img src='/advance/scope_resolution_1.png' width='400' /></p>\n<ul>\n<li>Built-in Functions <a\nhref=\"https://docs.python.org/3/library/functions.html\"\nclass=\"uri\">https://docs.python.org/3/library/functions.html</a></li>\n<li>Built-in Constants <a\nhref=\"https://docs.python.org/3/library/constants.html\"\nclass=\"uri\">https://docs.python.org/3/library/constants.html</a></li>\n</ul>\n<p><code>globals()</code> 以 dict 形式返回当前所有全局变量,\n包括导入的包名, ipython/jupyter 的 <code>In</code>, <code>Out</code>\n等.<br> python 以 name -&gt; obj 的形式存储这些变量.</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\nb <span class=\"token operator\">=</span> <span class=\"token number\">2</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token builtin\">globals</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token string\">'a'</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">is</span> a<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>True</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">i <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">f</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    i <span class=\"token operator\">=</span> <span class=\"token number\">2</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">,</span> <span class=\"token string\">'local'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span>\nf<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">,</span> <span class=\"token string\">'global'</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code>2 local\n1 global</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">i <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">pass</span>\ni  <span class=\"token comment\"># 值被改变了 (“leaking”)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code>3</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">i <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n<span class=\"token punctuation\">[</span>i <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\ni  <span class=\"token comment\"># 用这种方式就不会发生“leaking”</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<pre><code>1</code></pre>\n<p>有关函数中的变量作用方式细节, 参考这里提到的例子: <a\nhref=\"https://stackoverflow.com/a/575887\">stackoverflow</a></p>\n<blockquote>\n<ul>\n<li><p>Any time you see <font color=blue><strong>varname\n=</strong></font>, you're <strong>creating a new name</strong> binding\nwithin the function's scope.<br>Whatever value <code>varname</code> was\nbound to before is lost within this scope.</p></li>\n<li><p>Any time you see\n<font color=blue><strong>varname.foo()</strong></font>, you're\n<strong>calling a method</strong> on <code>varname</code>. The method\nmay alter <code>varname</code> (e.g. <code>list.append</code>). <br>\n<code>varname</code> (or, rather, the object that <code>varname</code>\nnames) may exist in more than one scope, and since it's the same object,\n<br><strong>any changes will be visible in all scopes</strong>.</p></li>\n</ul>\n</blockquote>\n<h2 id=\"numpy\">NumPy</h2>\n<h3 id=\"numpy-的数据类型-dtype\">numpy 的数据类型 dtype</h3>\n<p><a href=\"https://www.tutorialspoint.com/numpy/numpy_data_types.htm\"\nclass=\"uri\">https://www.tutorialspoint.com/numpy/numpy_data_types.htm</a>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> np<span class=\"token punctuation\">.</span>dtype<span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>int64<span class=\"token punctuation\">)</span> <span class=\"token keyword\">is</span> np<span class=\"token punctuation\">.</span>dtype<span class=\"token punctuation\">(</span><span class=\"token string\">'i8'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">is</span> np<span class=\"token punctuation\">.</span>dtype<span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;i8'</span><span class=\"token punctuation\">)</span>\n<span class=\"token boolean\">True</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> np<span class=\"token punctuation\">.</span>dtype<span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>int64<span class=\"token punctuation\">)</span> <span class=\"token keyword\">is</span> np<span class=\"token punctuation\">.</span>dtype<span class=\"token punctuation\">(</span><span class=\"token string\">'int'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">is</span> np<span class=\"token punctuation\">.</span>dtype<span class=\"token punctuation\">(</span><span class=\"token string\">'int64'</span><span class=\"token punctuation\">)</span>\n<span class=\"token boolean\">True</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> np<span class=\"token punctuation\">.</span>dtype<span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>int64<span class=\"token punctuation\">)</span> <span class=\"token keyword\">is</span> np<span class=\"token punctuation\">.</span>dtype<span class=\"token punctuation\">(</span><span class=\"token string\">'>i8'</span><span class=\"token punctuation\">)</span>\n<span class=\"token boolean\">False</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre> <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> np<span class=\"token punctuation\">.</span>dtype<span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>float64<span class=\"token punctuation\">)</span> <span class=\"token keyword\">is</span> np<span class=\"token punctuation\">.</span>dtype<span class=\"token punctuation\">(</span><span class=\"token string\">'f8'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">is</span> np<span class=\"token punctuation\">.</span>dtype<span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;f8'</span><span class=\"token punctuation\">)</span>\n<span class=\"token boolean\">True</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> np<span class=\"token punctuation\">.</span>dtype<span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>float64<span class=\"token punctuation\">)</span> <span class=\"token keyword\">is</span> np<span class=\"token punctuation\">.</span>dtype<span class=\"token punctuation\">(</span><span class=\"token string\">'float'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">is</span> np<span class=\"token punctuation\">.</span>dtype<span class=\"token punctuation\">(</span><span class=\"token string\">'float64'</span><span class=\"token punctuation\">)</span>\n<span class=\"token boolean\">True</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre> 见 <a\nhref=\"#Fortran-二进制文件读写\">Fortran 二进制文件读写</a> 中的应用.</p>\n<h3 id=\"np.arange-参数为浮点数时要注意的细节\">np.arange\n参数为浮点数时要注意的细节</h3>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">np<span class=\"token punctuation\">.</span>arange<span class=\"token punctuation\">(</span><span class=\"token number\">0.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1.8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.3</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 默认不包含 `stop` 这个点</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>array([0. , 0.3, 0.6, 0.9, 1.2, 1.5])</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">np<span class=\"token punctuation\">.</span>arange<span class=\"token punctuation\">(</span><span class=\"token number\">0.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2.1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.3</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 这里却包括了, 为什么?</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>array([0. , 0.3, 0.6, 0.9, 1.2, 1.5, 1.8, 2.1])</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token string\">'%.16f'</span> <span class=\"token operator\">%</span> <span class=\"token number\">2.1</span>  <span class=\"token comment\"># 因为浮点数计算方式产生的精度问题</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>&#39;2.1000000000000001&#39;</code></pre>\n<p>看一个求和的例子中同样的问题 (用 <code>list</code> 和\n<code>numpy.ndarray</code> 效果一样):</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'%.17f'</span> <span class=\"token operator\">%</span> <span class=\"token number\">0.1</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># sum([0.1, ..., 0.1])</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'%.17f'</span> <span class=\"token operator\">%</span> <span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">0.1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 因为同样问题, 累积了误差</span>\n\n<span class=\"token keyword\">import</span> math\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'%.17f'</span> <span class=\"token operator\">%</span> math<span class=\"token punctuation\">.</span>fsum<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">0.1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code>0.10000000000000001\n0.99999999999999989\n1.00000000000000000</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">0.1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>False</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">math<span class=\"token punctuation\">.</span>fsum<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">0.1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>True</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">math<span class=\"token punctuation\">.</span>fsum<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">0.1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">1.0</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>True</code></pre>\n<p>参考 <a href=\"https://docs.python.org/3/tutorial/floatingpoint.html\"\nclass=\"uri\">https://docs.python.org/3/tutorial/floatingpoint.html</a></p>\n<p>建议是: 使用整数; 对浮点数的情况, stop 值设得略小一些\n(比如减去步长的一般) 以防止改点被包含, 或使用 <code>np.linspace</code>\n代替.</p>\n<h3 id=\"矩阵\">矩阵</h3>\n<p><code>np.matrix</code>(矩阵) 是 <code>np.ndarray</code>(数组)\n的一个子类, 继承了父级的方法, 也定义了新的方法 (例如矩阵运算).</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token builtin\">issubclass</span><span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>matrix<span class=\"token punctuation\">,</span> np<span class=\"token punctuation\">.</span>ndarray<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>True</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>matrix<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> a<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>matrix([[0, 1, 2],\n        [3, 4, 5]])</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>matrix<span class=\"token punctuation\">(</span><span class=\"token string\">\"0 1 2; 3 4 5\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> a<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>matrix([[0, 1, 2],\n        [3, 4, 5]])</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token builtin\">type</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>numpy.matrixlib.defmatrix.matrix</code></pre>\n<p><code>np.asmatrix</code> (或简写作 <code>np.mat</code>) 相当于\n<code>np.matrix(data, copy=False)</code></p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">x <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nm <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>matrix<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\nm<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">5</span>\nx<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code>array([[1, 2],\n       [3, 4]])</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">x <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nm <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>mat<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\nm<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">5</span>\nx<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code>array([[5, 2],\n       [3, 4]])</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">x<span class=\"token punctuation\">.</span>__array_interface__<span class=\"token punctuation\">[</span><span class=\"token string\">'data'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> m<span class=\"token punctuation\">.</span>__array_interface__<span class=\"token punctuation\">[</span><span class=\"token string\">'data'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>True</code></pre>\n<p>注意: <code>np.matrix</code> 既是一个类名也是一个函数名, 而\n<code>np.mat</code>, <code>np.asmatrix</code> 只是函数名.</p>\n<h3 id=\"数组和矩阵运算\">数组和矩阵运算</h3>\n<h4 id=\"数组运算\">数组运算</h4>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>arange<span class=\"token punctuation\">(</span><span class=\"token number\">12</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> a<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>array([[ 0,  1,  2,  3],\n       [ 4,  5,  6,  7],\n       [ 8,  9, 10, 11]])</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a<span class=\"token punctuation\">.</span><span class=\"token builtin\">max</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>11</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">*</span> a  <span class=\"token comment\"># 注意这是对应位置的元素间的运算</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>array([[  0,   1,   4,   9],\n       [ 16,  25,  36,  49],\n       [ 64,  81, 100, 121]])</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">**</span> <span class=\"token number\">2</span>  <span class=\"token comment\"># 注意这是对应位置的元素间的运算</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>array([[  0,   1,   4,   9],\n       [ 16,  25,  36,  49],\n       [ 64,  81, 100, 121]])</code></pre>\n<h4 id=\"使用数组进行矩阵运算\">使用数组进行矩阵运算</h4>\n<p><code>scipy.linalg</code> 与 <code>numpy.linalg</code> 的比较: <a\nhref=\"https://scipy.github.io/devdocs/tutorial/linalg.html\"\nclass=\"uri\">https://scipy.github.io/devdocs/tutorial/linalg.html</a>\n&gt;* <code>scipy.linalg</code> contains <strong>all</strong> the\nfunctions in <code>numpy.linalg</code> plus some other more\n<strong>advanced</strong> ones not contained in\n<code>numpy.linalg</code> * Despite its convenience, the use of the\n<code>numpy.matrix</code> class is <strong>discouraged</strong>. *\n<code>scipy.linalg</code> operations can be applied\n<strong>equally</strong> to <code>numpy.matrix</code> or to 2D\n<code>numpy.ndarray</code> objects.</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>diagflat<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">1.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3.</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> a<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>array([[1., 0., 0.],\n       [0., 2., 0.],\n       [0., 0., 3.]])</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">b <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">1.</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1.</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1.</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token number\">0.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> b<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>array([[-1., -1., -1.],\n       [ 0.,  0.,  0.]])</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> scipy<span class=\"token punctuation\">.</span>linalg <span class=\"token keyword\">import</span> inv\ninv<span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 求逆</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>array([[ 1.        ,  0.        , -0.        ],\n       [ 0.        ,  0.5       , -0.        ],\n       [ 0.        ,  0.        ,  0.33333333]])</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a<span class=\"token punctuation\">.</span>dot<span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">.</span>T<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 矩阵内积</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>array([[-1.,  0.],\n       [-2.,  0.],\n       [-3.,  0.]])</code></pre>\n<h4 id=\"直接使用矩阵类型进行运算\">直接使用矩阵类型进行运算</h4>\n<p>使用 numpy 的矩阵类型 <code>numpy.matrix</code></p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>mat<span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>diagflat<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">1.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3.</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> a<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>matrix([[1., 0., 0.],\n        [0., 2., 0.],\n        [0., 0., 3.]])</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">b <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>mat<span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">1.</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1.</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1.</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token number\">0.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> b<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>matrix([[-1., -1., -1.],\n        [ 0.,  0.,  0.]])</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">*</span> b<span class=\"token punctuation\">.</span>T  <span class=\"token comment\"># 矩阵内积, 注意与数组的运算符定义不同</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>matrix([[-1.,  0.],\n        [-2.,  0.],\n        [-3.,  0.]])</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a @ b<span class=\"token punctuation\">.</span>T  <span class=\"token comment\"># 矩阵内积的新写法, python 3.5+</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>matrix([[-1.,  0.],\n        [-2.,  0.],\n        [-3.,  0.]])</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a<span class=\"token punctuation\">.</span>I  <span class=\"token comment\"># 求逆</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>matrix([[ 1.        ,  0.        , -0.        ],\n        [ 0.        ,  0.5       , -0.        ],\n        [ 0.        ,  0.        ,  0.33333333]])</code></pre>\n<h3 id=\"用作坐标格点的数组的几种形式\">用作坐标格点的数组的几种形式</h3>\n<ul>\n<li><strong><code>np.meshgrid</code></strong></li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> x <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>linspace<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> x\narray<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span> <span class=\"token number\">0.</span><span class=\"token punctuation\">,</span>  <span class=\"token number\">1.</span><span class=\"token punctuation\">,</span>  <span class=\"token number\">2.</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> y <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>linspace<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> y\narray<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">3.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6.</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># X, Y 形状相同: N x M 矩阵, shape=(N, M)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> X<span class=\"token punctuation\">,</span> Y <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>meshgrid<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> X                         <span class=\"token comment\"># X[j, :] 表示同一层 y[j] 对应的不同 x 值</span>\narray<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">0.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2.</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>          <span class=\"token comment\">#  0_____x</span>\n       <span class=\"token punctuation\">[</span><span class=\"token number\">0.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2.</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>          <span class=\"token comment\">#  |</span>\n       <span class=\"token punctuation\">[</span><span class=\"token number\">0.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2.</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>          <span class=\"token comment\">#  |y</span>\n       <span class=\"token punctuation\">[</span><span class=\"token number\">0.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2.</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> Y\narray<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">3.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3.</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>          <span class=\"token comment\"># Y[:, i] 表示同一层 x[i] 对应的不同 y 值</span>\n       <span class=\"token punctuation\">[</span><span class=\"token number\">4.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4.</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n       <span class=\"token punctuation\">[</span><span class=\"token number\">5.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5.</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n       <span class=\"token punctuation\">[</span><span class=\"token number\">6.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6.</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>可用来计算坐标的函数 (例如磁场的表达式等等, 见 <a\nhref=\"examples/streamplot.py\">examples/streamplot.py</a> )\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">U <span class=\"token operator\">=</span>   <span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>cos<span class=\"token punctuation\">(</span>k1 <span class=\"token operator\">*</span> X<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> np<span class=\"token punctuation\">.</span>exp<span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>k1 <span class=\"token operator\">*</span> Y<span class=\"token punctuation\">)</span>\n     <span class=\"token operator\">-</span> np<span class=\"token punctuation\">.</span>cos<span class=\"token punctuation\">(</span>k2 <span class=\"token operator\">*</span> X<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> np<span class=\"token punctuation\">.</span>exp<span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>k2 <span class=\"token operator\">*</span> Y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nV <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">-</span> np<span class=\"token punctuation\">.</span>sin<span class=\"token punctuation\">(</span>k1 <span class=\"token operator\">*</span> X<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> np<span class=\"token punctuation\">.</span>exp<span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>k1 <span class=\"token operator\">*</span> Y<span class=\"token punctuation\">)</span>\n     <span class=\"token operator\">+</span> np<span class=\"token punctuation\">.</span>sin<span class=\"token punctuation\">(</span>k2 <span class=\"token operator\">*</span> X<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> np<span class=\"token punctuation\">.</span>exp<span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>k2 <span class=\"token operator\">*</span> Y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre></p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">x <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>linspace<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\ny <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>linspace<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span>\nX<span class=\"token punctuation\">,</span> Y <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>meshgrid<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> indexing<span class=\"token operator\">=</span><span class=\"token string\">'ij'</span><span class=\"token punctuation\">)</span>\nY<span class=\"token punctuation\">.</span>shape<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code>(3, 4)</code></pre>\n<ul>\n<li><strong><code>np.mgrid</code></strong></li>\n</ul>\n<p><code>j</code> 标记默认是虚数单位,\n但在这里表示前面的数字是格点数.<br> 格点数使用变量\n<em><code>n</code></em> 时, 可写成:\n<em><code>n</code></em><code>*1j + 1j</code>, 1不能省\n(否则j定义为变量)<br> 类似的 <code>np.ogrid</code> 可参见 numpy\n相关文档</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> x <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>linspace<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> y <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>linspace<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 下面三行等价</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> X<span class=\"token punctuation\">,</span> Y <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>mgrid<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">:</span><span class=\"token number\">2</span><span class=\"token punctuation\">:</span><span class=\"token number\">3j</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">:</span><span class=\"token number\">6</span><span class=\"token punctuation\">:</span><span class=\"token number\">4j</span><span class=\"token punctuation\">]</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> X<span class=\"token punctuation\">,</span> Y <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">.</span>astype<span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>float64<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> np<span class=\"token punctuation\">.</span>mgrid<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">:</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">:</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> X<span class=\"token punctuation\">,</span> Y <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>meshgrid<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> indexing<span class=\"token operator\">=</span><span class=\"token string\">'ij'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># np.mgrid[0:2:3j, 3:6:4j] 得到的数据类型为 'float64'</span>\n<span class=\"token comment\"># np.mgrid[0:3, 3:6] 得到的数据类型为 'int64'</span>\n<span class=\"token comment\"># np.meshgrid(x, y, indexing='ij') 得到一个 list, 数据格式同x, y</span>\n\n<span class=\"token comment\"># X, Y 形状相同: M x N 矩阵, shape=(M, N)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> X                      <span class=\"token comment\"># X[i, :] 表示 x[i]</span>\narray<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">0.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>   <span class=\"token comment\">#  0_____y</span>\n       <span class=\"token punctuation\">[</span><span class=\"token number\">1.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1.</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>   <span class=\"token comment\">#  |</span>\n       <span class=\"token punctuation\">[</span><span class=\"token number\">2.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2.</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\">#  |x</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> Y                      <span class=\"token comment\"># Y[:, j] 表示 y[j]</span>\narray<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">3.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6.</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n       <span class=\"token punctuation\">[</span><span class=\"token number\">3.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6.</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n       <span class=\"token punctuation\">[</span><span class=\"token number\">3.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6.</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h3 id=\"mask\">mask</h3>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>arange<span class=\"token punctuation\">(</span><span class=\"token number\">9</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> a<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>array([[0, 1, 2],\n       [3, 4, 5],\n       [6, 7, 8]])</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">></span> <span class=\"token number\">4</span>  <span class=\"token comment\"># mask</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>array([[False, False, False],\n       [False, False,  True],\n       [ True,  True,  True]])</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">np<span class=\"token punctuation\">.</span>where<span class=\"token punctuation\">(</span>a <span class=\"token operator\">></span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 得到 tuple(col_indexs, row_indexs)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>(array([1, 2, 2, 2]), array([2, 0, 1, 2]))</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">zip</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>np<span class=\"token punctuation\">.</span>where<span class=\"token punctuation\">(</span>a <span class=\"token operator\">></span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 也可以用 np.array(np.where(a > 4)).T</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>[(1, 2), (2, 0), (2, 1), (2, 2)]</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a<span class=\"token punctuation\">[</span>a <span class=\"token operator\">></span> <span class=\"token number\">4</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span> a  <span class=\"token comment\"># same as a[np.where(a > 4)]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>array([[ 0,  1,  2],\n       [ 3,  4, -1],\n       [-1, -1, -1]])</code></pre>\n<h3 id=\"其他对数组元素的处理\">其他对数组元素的处理</h3>\n<p>处理含有 NaN 的数据:</p>\n<p>e.g. 求最值可使用 <code>np.nanmin(...)</code> 和\n<code>np.nanmax(...)</code></p>\n<h2 id=\"matplotlib\">Matplotlib</h2>\n<ul>\n<li>官方教程 <a\nhref=\"https://matplotlib.org/tutorials/introductory/usage.html\"\nclass=\"uri\">https://matplotlib.org/tutorials/introductory/usage.html</a></li>\n</ul>\n<p><img src='/advance/anatomy.png' width='600' /></p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">fig <span class=\"token operator\">=</span> plt<span class=\"token punctuation\">.</span>gcf<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># current figure</span>\nax <span class=\"token operator\">=</span> plt<span class=\"token punctuation\">.</span>gca<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># current `Axes`</span>\nim <span class=\"token operator\">=</span> plt<span class=\"token punctuation\">.</span>gci<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># current artist(图像内容), 可由诸如 plt.imshow(...) 得到</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<ul>\n<li><p>得到当前 backend: <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token keyword\">import</span> matplotlib<span class=\"token punctuation\">.</span>pyplot <span class=\"token keyword\">as</span> plt\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> plt<span class=\"token punctuation\">.</span>get_backend<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre> 或 <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token keyword\">import</span> maplotlib <span class=\"token keyword\">as</span> mpl\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> mpl<span class=\"token punctuation\">.</span>get_backend<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre></p></li>\n<li><p>选择 backend (在导入其他 matplotlib 模块之前):\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token keyword\">import</span> matplotlib\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> matplotlib<span class=\"token punctuation\">.</span>use<span class=\"token punctuation\">(</span><span class=\"token string\">'TkAgg'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 'Qt5Agg', 'TkAgg', 'Agg', ...</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre></p></li>\n<li><p>用户配置文档 <code>matplotlibrc</code><br> 通常的位置:\n<code>~/.config/matplotlib/matplotlibrc</code> (Linux)</p></li>\n<li><p>用 <code>zorder</code> 来控制图层:</p></li>\n</ul>\n<p>这个例子中也展示了加入一个动态的竖线的方法,\n这条线在保存后的图像中不会显示.</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">%</span>matplotlib\n<span class=\"token operator\">%</span>run <span class=\"token operator\">-</span>e <span class=\"token string\">'examples/test_plot.py'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<ul>\n<li>使用 <a\nhref=\"https://github.com/joferkington/mpldatacursor\">这个工具</a>\n动态标注光标位置的值:</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">%</span>matplotlib\n<span class=\"token operator\">%</span>run <span class=\"token operator\">-</span>e <span class=\"token string\">'examples/test_imshow.py'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<ul>\n<li>点击图像后在命令行显示光标处信息的例子</li>\n</ul>\n<p>命令行脚本: <a\nhref=\"examples/test_imshow_click.py\">examples/test_imshow_click.py</a>\n(jupyter 中无法使用)</p>\n<ul>\n<li>布局问题 <a\nhref=\"https://matplotlib.org/tutorials/intermediate/constrainedlayout_guide.html\"\nclass=\"uri\">https://matplotlib.org/tutorials/intermediate/constrainedlayout_guide.html</a></li>\n<li>绘制平行投影的3D图 <a\nhref=\"https://matplotlib.org/mpl_toolkits/mplot3d/tutorial.html\"\nclass=\"uri\">https://matplotlib.org/mpl_toolkits/mplot3d/tutorial.html</a></li>\n<li>更复杂的 3D 可转存可视化数据用其他软件或使用 Mayavi\n(http://docs.enthought.com/mayavi/mayavi)</li>\n</ul>\n<h2 id=\"sunpy-示例\">SunPy 示例</h2>\n<h3 id=\"示例文件\">示例文件</h3>\n<ul>\n<li><p>读取 fits, submap, 作图 <a\nhref=\"https://lydiazly.coding.me/python-notes/example_plothmi.html\">example_plothmi</a></p></li>\n<li><p>投影 <a\nhref=\"https://lydiazly.coding.me/python-notes/example_projection.html\">example_projection</a></p></li>\n<li><p>下载数据 <a\nhref=\"https://lydiazly.coding.me/python-notes/fido.html\">fido</a>, <a\nhref=\"https://lydiazly.coding.me/python-notes/jsoc.html\">jsoc</a></p></li>\n</ul>\n<p>注意: 这些例子只是提供一个使用参考, 不一定是最优的.</p>\n<h3 id=\"示例中的-fits-读取方法\">示例中的 fits 读取方法</h3>\n<p>更多 FITS 的读取方法参见 <a href=\"main.html#FITS-文件读取\">Python\n简易教程#FITS-文件读取</a><br> 另见 <a\nhref=\"http://docs.astropy.org/en/stable/io/fits/usage/scripts.html\">Astropy\n的命令行工具</a></p>\n<p>读取<code>HMIMap</code> 的例子:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># 导入 `sunpy.map` 的时间会略有点长</span>\n<span class=\"token keyword\">import</span> sunpy<span class=\"token punctuation\">.</span><span class=\"token builtin\">map</span>\nsmap <span class=\"token operator\">=</span> sunpy<span class=\"token punctuation\">.</span><span class=\"token builtin\">map</span><span class=\"token punctuation\">.</span>Map<span class=\"token punctuation\">(</span><span class=\"token string\">'data/hmi.B_720s.20150827_052400_TAI.field.fits'</span><span class=\"token punctuation\">)</span>\n<span class=\"token builtin\">type</span><span class=\"token punctuation\">(</span>smap<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code>sunpy.map.sources.sdo.HMIMap</code></pre>\n<p>这是 <code>GenericMap</code> 的一个子类:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token builtin\">issubclass</span><span class=\"token punctuation\">(</span>sunpy<span class=\"token punctuation\">.</span><span class=\"token builtin\">map</span><span class=\"token punctuation\">.</span>sources<span class=\"token punctuation\">.</span>sdo<span class=\"token punctuation\">.</span>HMIMap<span class=\"token punctuation\">,</span> sunpy<span class=\"token punctuation\">.</span><span class=\"token builtin\">map</span><span class=\"token punctuation\">.</span>mapbase<span class=\"token punctuation\">.</span>GenericMap<span class=\"token punctuation\">)</span>\n<span class=\"token boolean\">True</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>True</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">smap<span class=\"token punctuation\">.</span>meta  <span class=\"token comment\"># headers</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token builtin\">type</span><span class=\"token punctuation\">(</span>smap<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 索引从 0 开始</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>numpy.ndarray</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">smap<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>shape  <span class=\"token comment\"># (dimy, dimx)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>(4096, 4096)</code></pre>\n<p><code>smap.data[i, j]</code> 中的 i 为 Y 轴, 单位为 pixel:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> matplotlib<span class=\"token punctuation\">.</span>pyplot <span class=\"token keyword\">as</span> plt\nplt<span class=\"token punctuation\">.</span>imshow<span class=\"token punctuation\">(</span>smap<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">:</span><span class=\"token number\">2000</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> origin<span class=\"token operator\">=</span><span class=\"token string\">'lower'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nplt<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<figure>\n<img src=\"/advance/advance_205_0.png\" alt=\"png\" />\n<figcaption aria-hidden=\"true\">png</figcaption>\n</figure>\n<h3 id=\"关于-scaled-image-data\">关于 Scaled Image Data</h3>\n<p>这一部分将更仔细地检查 Astropy 对示例中的 FITS 文件的处理.</p>\n<p>参见 <a\nhref=\"http://docs.astropy.org/en/stable/io/fits/usage/image.html#scaled-data\"\nclass=\"uri\">http://docs.astropy.org/en/stable/io/fits/usage/image.html#scaled-data</a></p>\n<blockquote>\n<p>Images are scaled only when either of the BSCALE/BZERO keywords are\npresent in the header and either of their values is not the default\nvalue (BSCALE=1, BZERO=0).</p>\n</blockquote>\n<p>由于 <code>astropy.io.fits</code> 的特性, 读取 'Scaled Image Data'\n时, 调用 <code>.data</code> 将自动对数据进行缩放: <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">physical value <span class=\"token operator\">=</span> BSCALE <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>storage value<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> BZERO<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<code>astropy.io.fits.open</code> 中使用\n<code>do_not_scale_image_data=True</code> 可禁用这一步骤.</p>\n<p>见 <a\nhref=\"http://docs.astropy.org/en/stable/io/fits/appendix/faq.html#why-is-an-image-containing-integer-data-being-converted-unexpectedly-to-floats\">astropy.io.fits\nFAQ</a></p>\n<p>数据类型:</p>\n<table>\n<thead>\n<tr class=\"header\">\n<th style=\"text-align: center;\">BITPIX</th>\n<th style=\"text-align: left;\">Numpy Data Type</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td style=\"text-align: center;\">8</td>\n<td style=\"text-align: left;\">numpy.uint8 (unsigned integer)</td>\n</tr>\n<tr class=\"even\">\n<td style=\"text-align: center;\">16</td>\n<td style=\"text-align: left;\">numpy.int16</td>\n</tr>\n<tr class=\"odd\">\n<td style=\"text-align: center;\">32</td>\n<td style=\"text-align: left;\">numpy.int32</td>\n</tr>\n<tr class=\"even\">\n<td style=\"text-align: center;\">-32</td>\n<td style=\"text-align: left;\">numpy.float32</td>\n</tr>\n<tr class=\"odd\">\n<td style=\"text-align: center;\">-64</td>\n<td style=\"text-align: left;\">numpy.float64</td>\n</tr>\n</tbody>\n</table>\n<p>可以使用 Astropy 的命令行工具在 shell 中查看信息:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">fname <span class=\"token operator\">=</span> <span class=\"token string\">'data/hmi.B_720s.20150827_052400_TAI.field.fits'</span>\n!fitsinfo <span class=\"token punctuation\">&#123;</span>fname<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>Filename: data/hmi.B_720s.20150827_052400_TAI.field.fits\nNo.    Name      Ver    Type      Cards   Dimensions   Format\n  0  PRIMARY       1 PrimaryHDU       6   ()      \n  1                1 CompImageHDU    155   (4096, 4096)   int32   </code></pre>\n<p>可以看到该文件存储的数据类型是整形.</p>\n<p>用命令行工具查看关键字 'BITPIX':</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">!fitsheader <span class=\"token operator\">-</span>e <span class=\"token number\">1</span> <span class=\"token operator\">-</span><span class=\"token operator\">-</span>keyword BITPIX <span class=\"token punctuation\">&#123;</span>fname<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code># HDU 1 in data/hmi.B_720s.20150827_052400_TAI.field.fits:\nBITPIX  =                   32 / data type of original image                    </code></pre>\n<p>使用 <code>astropy.io.fits</code>:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> astropy<span class=\"token punctuation\">.</span>io <span class=\"token keyword\">import</span> fits\nhdulist <span class=\"token operator\">=</span> fits<span class=\"token punctuation\">.</span><span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span>fname<span class=\"token punctuation\">)</span>\nhdu <span class=\"token operator\">=</span> hdulist<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">hdu<span class=\"token punctuation\">.</span>header<span class=\"token punctuation\">[</span><span class=\"token string\">'BITPIX'</span><span class=\"token punctuation\">]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>32</code></pre>\n<p>'BSCALE' 不为零则为 'scaled':</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">hdu<span class=\"token punctuation\">.</span>header<span class=\"token punctuation\">[</span><span class=\"token string\">'BSCALE'</span><span class=\"token punctuation\">]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>0.01</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">hdu<span class=\"token punctuation\">.</span>header<span class=\"token punctuation\">[</span><span class=\"token string\">'BZERO'</span><span class=\"token punctuation\">]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>0.0</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">hdulist<span class=\"token punctuation\">.</span>verify<span class=\"token punctuation\">(</span><span class=\"token string\">'silentfix+warn'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 调用 `.data` 时如果出错, 需要先进行这一步修复</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">hdu<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>dtype  <span class=\"token comment\"># 已自动变换为 'physical value', 同时 `.header` 将被修改</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>dtype(&#39;float64&#39;)</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">hdu<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">[</span><span class=\"token number\">1000</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>142.83</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">hdu<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># -2147483648 被转为 nan</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>nan</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">hdu<span class=\"token punctuation\">.</span>header<span class=\"token punctuation\">[</span><span class=\"token string\">'BITPIX'</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># 值被改变了. 同时 'BSCALE', 'BZERO' 被删除</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>-64</code></pre>\n<p>手动 scale:</p>\n<p>'BSCALE' 虽然之前已被删除, 但值仍存储在 <code>._orig_bscale</code>\n中. <code>.scale</code> 将使用这个值.</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">hdu<span class=\"token punctuation\">.</span>scale<span class=\"token punctuation\">(</span><span class=\"token string\">'int32'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 在此之后 `.data` 将变换回 'storage value'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">hdu<span class=\"token punctuation\">.</span>_orig_bscale<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>0.01</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">hdu<span class=\"token punctuation\">.</span>_orig_bzero<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>0</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">hdu<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">[</span><span class=\"token number\">1000</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>14283</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">hdu<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># nan 被转为 -2147483648</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>-2147483648</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">hdu<span class=\"token punctuation\">.</span>header<span class=\"token punctuation\">[</span><span class=\"token string\">'BITPIX'</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># 值再次被改变了</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>32</code></pre>\n<p>使用 SunPy 处理时, 'BITPIX', 'BSCALE', 'BZERO' 的值被保留,\n<code>.data</code> 仍进行了 scale 的过程.</p>\n<p>针对不同文件, 如果 SunPy 的程序内部使用 <code>astropy.io.fits</code>\n处理文件时调用了 <code>.data</code> 再返回 header, 即\n<code>astropy.io.fits</code> 已经如上所述改变了 header, 那么 SunPy\n所返回的 header 中 'BITPIX', 'BSCALE', 'BZERO' 可能已经被改变.</p>\n<p>下面的例子中得到的 header 是最初的值:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> sunpy<span class=\"token punctuation\">.</span><span class=\"token builtin\">map</span>\nsmap <span class=\"token operator\">=</span> sunpy<span class=\"token punctuation\">.</span><span class=\"token builtin\">map</span><span class=\"token punctuation\">.</span>Map<span class=\"token punctuation\">(</span><span class=\"token string\">'data/hmi.B_720s.20150827_052400_TAI.field.fits'</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">smap<span class=\"token punctuation\">.</span>meta<span class=\"token punctuation\">[</span><span class=\"token string\">'BITPIX'</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># 得到的是未被改变的 header</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>32</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">smap<span class=\"token punctuation\">.</span>meta<span class=\"token punctuation\">[</span><span class=\"token string\">'BSCALE'</span><span class=\"token punctuation\">]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>0.01</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">smap<span class=\"token punctuation\">.</span>meta<span class=\"token punctuation\">[</span><span class=\"token string\">'BZERO'</span><span class=\"token punctuation\">]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>0.0</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">smap<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">[</span><span class=\"token number\">1000</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># 这一步并不改变 `.meta` 的值</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>142.83</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">smap<span class=\"token punctuation\">.</span>meta<span class=\"token punctuation\">[</span><span class=\"token string\">'BITPIX'</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># 不变</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>32</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">smap<span class=\"token punctuation\">.</span>meta<span class=\"token punctuation\">[</span><span class=\"token string\">'BSCALE'</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># 不变</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>0.01</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">smap<span class=\"token punctuation\">.</span>meta<span class=\"token punctuation\">[</span><span class=\"token string\">'BZERO'</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># 不变</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>0.0</code></pre>\n<h3 id=\"坐标和单位\">坐标和单位</h3>\n<p><strong>SunPy map</strong> <a\nhref=\"http://docs.sunpy.org/en/stable/code_ref/map.html#using-map-objects\"\nclass=\"uri\">http://docs.sunpy.org/en/stable/code_ref/map.html#using-map-objects</a>\n&gt;A number of the <strong>properties</strong> of this class are\nreturned as <strong>two-value named tuples</strong> that can either be -\nindexed by\nposition: <strong><font color=blue>[0]</font>, <font color=blue>[1]</font></strong>\n- be accessed by the names: - pixel\naxes: <strong><font color=blue>.x</font>, <font color=blue>.y</font></strong><br>\nx and y refer to the FITS axes (x for columns y for rows) - spatial\naxes: <strong><font color=blue>.axis1</font>, <font color=blue>.axis2</font></strong><br>\naxis1 corresponds to the coordinate axis for x and axis2 corresponds to\ny.</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">smap<span class=\"token punctuation\">.</span>dimensions<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>PixelPair(x=&lt;Quantity 4096. pix&gt;, y=&lt;Quantity 4096. pix&gt;)</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">smap<span class=\"token punctuation\">.</span>dimensions<span class=\"token punctuation\">.</span>x  <span class=\"token comment\"># 得到一个 `astropy.units.quantity.Quantity`, 包含 value 和 unit</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>(4096 ; )</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">smap<span class=\"token punctuation\">.</span>dimensions<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">.</span>unit<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>()</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">smap<span class=\"token punctuation\">.</span>dimensions<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">.</span>value<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>4096.0</code></pre>\n<p><code>astropy.units</code> 的使用方法:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> astropy<span class=\"token punctuation\">.</span>units <span class=\"token keyword\">as</span> u<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">u<span class=\"token punctuation\">.</span>AA<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>()</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token number\">4096</span> <span class=\"token operator\">*</span> u<span class=\"token punctuation\">.</span>pix  <span class=\"token comment\"># same as `u.pixel`</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>(4096 ; )</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token punctuation\">(</span><span class=\"token number\">4096</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4096</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> u<span class=\"token punctuation\">.</span>pix  <span class=\"token comment\"># 注意这里是 `astropy.units` 的运算, 和 list 运算规则不同</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>([4096,~4096] ; )</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">smap<span class=\"token punctuation\">.</span>dimensions<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">.</span>unit <span class=\"token keyword\">is</span> u<span class=\"token punctuation\">.</span>pix  <span class=\"token comment\"># 说明 x 是单位是 u.pix</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>True</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token builtin\">type</span><span class=\"token punctuation\">(</span>smap<span class=\"token punctuation\">.</span>center<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>/home/lydia/miniconda3/lib/python3.6/site-packages/sunpy/map/mapbase.py:669: Warning: Missing metadata for heliographic longitude: assuming longitude of 0 degrees\n  lon=self.heliographic_longitude,\n\n\n\n\n\nastropy.coordinates.sky_coordinate.SkyCoord</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> u<span class=\"token punctuation\">.</span>pix<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>[&lt;Quantity 0. pix&gt;, &lt;Quantity 0. pix&gt;]</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">smap<span class=\"token punctuation\">.</span>pixel_to_world<span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token number\">4096</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4096</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> u<span class=\"token punctuation\">.</span>pix<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>&lt;SkyCoord (Helioprojective: obstime=2015-08-27 05:22:21.800000, rsun=696000000.0 m, observer=&lt;HeliographicStonyhurst Coordinate (obstime=2015-08-27 05:22:21.800000): (lon, lat, radius) in (deg, deg, m)\n    (0., 7.089004, 1.51196988e+11)&gt;): (Tx, Ty) in arcsec\n    (-1040.36199634, -1030.86554911)&gt;</code></pre>\n<p>查看 <code>SkyCoord</code> 的帮助:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> astropy<span class=\"token punctuation\">.</span>coordinates\n<span class=\"token builtin\">help</span><span class=\"token punctuation\">(</span>astropy<span class=\"token punctuation\">.</span>coordinates<span class=\"token punctuation\">.</span>sky_coordinate<span class=\"token punctuation\">.</span>SkyCoord<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">smap<span class=\"token punctuation\">.</span>center<span class=\"token punctuation\">.</span>Tx<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>()</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">smap<span class=\"token punctuation\">.</span>pixel_to_world<span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token number\">2000</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2000</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> u<span class=\"token punctuation\">.</span>pix<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>&lt;SkyCoord (Helioprojective: obstime=2015-08-27 05:22:21.800000, rsun=696000000.0 m, observer=&lt;HeliographicStonyhurst Coordinate (obstime=2015-08-27 05:22:21.800000): (lon, lat, radius) in (deg, deg, m)\n    (0., 7.089004, 1.51196988e+11)&gt;): (Tx, Ty) in arcsec\n    (16.55031204, 26.53575639)&gt;</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">smap<span class=\"token punctuation\">.</span>pixel_to_world<span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token number\">2000</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2000</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> u<span class=\"token punctuation\">.</span>pix<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>transform_to<span class=\"token punctuation\">(</span><span class=\"token string\">'heliographic_stonyhurst'</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>&lt;SkyCoord (HeliographicStonyhurst: obstime=2015-08-27 05:22:21.800000): (lon, lat, radius) in (deg, deg, km)\n    (1.00568591, 8.68202918, 696000.0000022)&gt;</code></pre>\n<p>查看坐标信息:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">smap<span class=\"token punctuation\">.</span>coordinate_frame<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>/home/lydia/miniconda3/lib/python3.6/site-packages/sunpy/map/mapbase.py:669: Warning: Missing metadata for heliographic longitude: assuming longitude of 0 degrees\n  lon=self.heliographic_longitude,\n\n\n\n\n\n&lt;Helioprojective Frame (obstime=2015-08-27 05:22:21.800000, rsun=696000000.0 m, observer=&lt;HeliographicStonyhurst Coordinate (obstime=2015-08-27 05:22:21.800000): (lon, lat, radius) in (deg, deg, m)\n    (0., 7.089004, 1.51196988e+11)&gt;)&gt;</code></pre>\n<p>出现这个 Warning 时:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">smap<span class=\"token punctuation\">.</span>meta<span class=\"token punctuation\">[</span><span class=\"token string\">'hgln_obs'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0.</span><span class=\"token punctuation\">;</span> smap<span class=\"token punctuation\">.</span>meta<span class=\"token punctuation\">[</span><span class=\"token string\">'hgln_obs'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0.</span><span class=\"token punctuation\">;</span> smap<span class=\"token punctuation\">.</span>meta<span class=\"token punctuation\">[</span><span class=\"token string\">'hgln_obs'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0.</span>\nsmap<span class=\"token punctuation\">.</span>coordinate_frame<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>&lt;Helioprojective Frame (obstime=2015-08-27 05:22:21.800000, rsun=696000000.0 m, observer=&lt;HeliographicStonyhurst Coordinate (obstime=2015-08-27 05:22:21.800000): (lon, lat, radius) in (deg, deg, m)\n    (0., 7.089004, 1.51196988e+11)&gt;)&gt;</code></pre>\n<h3 id=\"语法对比\">语法对比</h3>\n<p>比较 <code>plothmi.py</code> 与对应 IDL 程序的语法:</p>\n<p>下面的语句中, 为了简便和方便对比, 使用了自定义的一些函数. 导入方法:\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> usr_sunpy <span class=\"token keyword\">import</span> read_sdo<span class=\"token punctuation\">,</span> plot_map<span class=\"token punctuation\">,</span> plot_vmap<span class=\"token punctuation\">,</span> image_to_helio<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p>读取数据 <pre class=\"line-numbers language-idl\" data-language=\"idl\"><code class=\"language-idl\">; IDL\nread_sdo,&lt;fname&gt;,index,data\nindex2map,index,data,mapa<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre> <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># Python</span>\n<span class=\"token comment\"># 为简化过程而自定义的函数, 读入时打印文件名和数组大小</span>\nmapa <span class=\"token operator\">=</span> read_sdo<span class=\"token punctuation\">(</span><span class=\"token operator\">&lt;</span>fname<span class=\"token operator\">></span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre></p>\n<p>旋转 <pre class=\"line-numbers language-idl\" data-language=\"idl\"><code class=\"language-idl\">; IDL\n; 2 表示180°\nmapbx.data &#x3D; rotate(mapbx,2)\nmapby.data &#x3D; rotate(mapbx,2)\nmapbz.data &#x3D; rotate(mapbx,2)<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre> <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># Python</span>\n<span class=\"token comment\"># 利用 'crota2' 的值确定角度</span>\nmapbx <span class=\"token operator\">=</span> mapbx<span class=\"token punctuation\">.</span>rotate<span class=\"token punctuation\">(</span>order<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\nmapby <span class=\"token operator\">=</span> mapby<span class=\"token punctuation\">.</span>rotate<span class=\"token punctuation\">(</span>order<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\nmapbz <span class=\"token operator\">=</span> mapbz<span class=\"token punctuation\">.</span>rotate<span class=\"token punctuation\">(</span>order<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>截取 <pre class=\"line-numbers language-idl\" data-language=\"idl\"><code class=\"language-idl\">; IDL\nsub_map,mapbx,smapbx,xrange&#x3D;[500,800.0],yrange&#x3D;[-500,-100.0]\nsub_map,mapby,smapby,ref_map&#x3D;smapbx\nsub_map,mapbz,smapbz,ref_map&#x3D;smapbx<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre> <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># Python</span>\n<span class=\"token comment\"># 左下到右上</span>\nbl <span class=\"token operator\">=</span> SkyCoord<span class=\"token punctuation\">(</span><span class=\"token number\">500</span><span class=\"token operator\">*</span>u<span class=\"token punctuation\">.</span>arcsec<span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">500</span><span class=\"token operator\">*</span>u<span class=\"token punctuation\">.</span>arcsec<span class=\"token punctuation\">,</span> frame<span class=\"token operator\">=</span>mapbz<span class=\"token punctuation\">.</span>coordinate_frame<span class=\"token punctuation\">)</span>\ntr <span class=\"token operator\">=</span> SkyCoord<span class=\"token punctuation\">(</span><span class=\"token number\">800</span><span class=\"token operator\">*</span>u<span class=\"token punctuation\">.</span>arcsec<span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">100.</span><span class=\"token operator\">*</span>u<span class=\"token punctuation\">.</span>arcsec<span class=\"token punctuation\">,</span> frame<span class=\"token operator\">=</span>mapbz<span class=\"token punctuation\">.</span>coordinate_frame<span class=\"token punctuation\">)</span>\nsmapbx <span class=\"token operator\">=</span> mapbx<span class=\"token punctuation\">.</span>submap<span class=\"token punctuation\">(</span>bl<span class=\"token punctuation\">,</span> tr<span class=\"token punctuation\">)</span>\nsmapby <span class=\"token operator\">=</span> mapby<span class=\"token punctuation\">.</span>submap<span class=\"token punctuation\">(</span>bl<span class=\"token punctuation\">,</span> tr<span class=\"token punctuation\">)</span>\nsmapbz <span class=\"token operator\">=</span> mapbz<span class=\"token punctuation\">.</span>submap<span class=\"token punctuation\">(</span>bl<span class=\"token punctuation\">,</span> tr<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>绘图 <pre class=\"line-numbers language-idl\" data-language=\"idl\"><code class=\"language-idl\">; IDL\nplot_map,smapbz,dmax&#x3D;2000,dmin&#x3D;-2000,color&#x3D;0,charsize&#x3D;1.8,...\nplot_vmap,&#x2F;over,smapbx,smapby,mapbz&#x3D;smapbz,limit&#x3D;180,scale&#x3D;0.012,iskip&#x3D;15,jskip&#x3D;15,...<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre> <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># Python</span>\n<span class=\"token comment\"># 主要调用的是 matplotlib</span>\nfig <span class=\"token operator\">=</span> plt<span class=\"token punctuation\">.</span>figure<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nax <span class=\"token operator\">=</span> fig<span class=\"token punctuation\">.</span>add_subplot<span class=\"token punctuation\">(</span><span class=\"token number\">111</span><span class=\"token punctuation\">,</span> projection<span class=\"token operator\">=</span>smapbz<span class=\"token punctuation\">)</span> <span class=\"token comment\"># 使用 smapbz 中定义的坐标系统</span>\nplot_map<span class=\"token punctuation\">(</span>ax<span class=\"token punctuation\">,</span> smapbz<span class=\"token punctuation\">)</span>\nplot_vmap<span class=\"token punctuation\">(</span>ax<span class=\"token punctuation\">,</span> smapbx<span class=\"token punctuation\">,</span> smapby<span class=\"token punctuation\">,</span> smapbz<span class=\"token punctuation\">,</span> iskip<span class=\"token operator\">=</span>iskip<span class=\"token punctuation\">,</span> jskip<span class=\"token operator\">=</span>jskip<span class=\"token punctuation\">,</span> cmin<span class=\"token operator\">=</span><span class=\"token number\">100.</span><span class=\"token punctuation\">,</span> vmax<span class=\"token operator\">=</span><span class=\"token number\">500.</span><span class=\"token punctuation\">,</span> cmap<span class=\"token operator\">=</span><span class=\"token string\">'binary'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>坐标变换 <pre class=\"line-numbers language-idl\" data-language=\"idl\"><code class=\"language-idl\">; IDL\n; magnetic_modeling_codes&#x2F;...&#x2F;05projection_modified_version.pro<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre> <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># Python</span>\n<span class=\"token comment\"># `image_to_helio`(变换为 Helioprojective(Cartesian) system)</span>\n<span class=\"token comment\"># 调用自定义的旋转矩阵函数 `proj_matrix`, 参考文献与原IDL程序相同</span>\nhx<span class=\"token punctuation\">,</span> hy <span class=\"token operator\">=</span> image_to_helio<span class=\"token punctuation\">(</span>smapbz<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># numpy 数组</span>\nsmapbx_h<span class=\"token punctuation\">,</span> smapby_h<span class=\"token punctuation\">,</span> smapbz_h <span class=\"token operator\">=</span> image_to_helio<span class=\"token punctuation\">(</span>smapbx<span class=\"token punctuation\">,</span> smapby<span class=\"token punctuation\">,</span> smapbz<span class=\"token punctuation\">)</span> <span class=\"token comment\"># sunpy `Map`</span>\n\nplot_map<span class=\"token punctuation\">(</span>ax<span class=\"token punctuation\">,</span> smapbz_h<span class=\"token punctuation\">,</span> coords<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>hx<span class=\"token punctuation\">,</span> hy<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nplot_vmap<span class=\"token punctuation\">(</span>ax<span class=\"token punctuation\">,</span> smapbx_h<span class=\"token punctuation\">,</span> smapby_h<span class=\"token punctuation\">,</span> smapbz_h<span class=\"token punctuation\">,</span> coords<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>hx<span class=\"token punctuation\">,</span> hy<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<h2 id=\"插值-拟合\">插值, 拟合</h2>\n<p>选择不限于这里列举的包, 以后也可能会有更合适的方法出现.</p>\n<p>相关安装见 <a href=\"installpy.html#其他\">Python 安装和配置</a></p>\n<h3 id=\"插值\">插值</h3>\n<ul>\n<li><p>numpy <pre class=\"line-numbers language-none\"><code class=\"language-none\">f &#x3D; interp1d(x, y, kind&#x3D;&#39;cubic&#39;[, fill_value&#x3D;&#39;extrapolate&#39;])\nx2 &#x3D; np.linspace(...)\ny2 &#x3D; f(x2)<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre> 见 <a\nhref=\"examples/test_plot.py\">examples/test_plot.py</a></p></li>\n<li><p>scipy <a\nhref=\"https://docs.scipy.org/doc/scipy/reference/tutorial/interpolate.html\"\nclass=\"uri\">https://docs.scipy.org/doc/scipy/reference/tutorial/interpolate.html</a></p></li>\n</ul>\n<h3 id=\"求极值\">求极值</h3>\n<ul>\n<li>PeakUtils <a href=\"http://peakutils.readthedocs.io/en/latest/\"\nclass=\"uri\">http://peakutils.readthedocs.io/en/latest/</a></li>\n</ul>\n<p>官方例图\n(http://peakutils.readthedocs.io/en/latest/tutorial_a.html):</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> peakutils\nindexes <span class=\"token operator\">=</span> peakutils<span class=\"token punctuation\">.</span>indexes<span class=\"token punctuation\">(</span>y<span class=\"token punctuation\">,</span> thres<span class=\"token operator\">=</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">,</span> min_dist<span class=\"token operator\">=</span><span class=\"token number\">30</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<p><img src='/advance/tut_a_2.png' width='500' /></p>\n<p>Enhancing the resolution by interpolation: <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">peaks_x <span class=\"token operator\">=</span> peakutils<span class=\"token punctuation\">.</span>interpolate<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> ind<span class=\"token operator\">=</span>indexes<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<h3 id=\"拟合\">拟合</h3>\n<ul>\n<li>LMFIT (Non-Linear Least-Squares Minimization and Curve-Fitting)</li>\n</ul>\n<p>下载 <a href=\"https://github.com/lmfit/lmfit-py\"\nclass=\"uri\">https://github.com/lmfit/lmfit-py</a></p>\n<p>文档 <a href=\"http://lmfit.github.io/lmfit-py/\"\nclass=\"uri\">http://lmfit.github.io/lmfit-py/</a></p>\n<p>有现成模型, 也可以自定义模型.<br>\n可以方便地叠加不同拟合模型(比如多个高斯, 线性加高斯, 等等).<br> 例子见\n<a href=\"examples/lmfits.zip\">examples/lmfits</a> (来自 <a\nhref=\"http://lmfit.github.io/lmfit-py/builtin_models.html#example-1-fit-peak-data-to-gaussian-lorentzian-and-voigt-profiles\">LMFIT网站示例</a>\n)</p>\n<p>使用内置模型:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> lmfit<span class=\"token punctuation\">.</span>models <span class=\"token keyword\">import</span> GaussianModel  <span class=\"token comment\"># 内置的模型</span>\n\ndata <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>loadtxt<span class=\"token punctuation\">(</span><span class=\"token string\">'test_peak.dat'</span><span class=\"token punctuation\">)</span>\nx <span class=\"token operator\">=</span> data<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\ny <span class=\"token operator\">=</span> data<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span>\n\nmod <span class=\"token operator\">=</span> GaussianModel<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 实例化一个模型</span>\npars <span class=\"token operator\">=</span> mod<span class=\"token punctuation\">.</span>guess<span class=\"token punctuation\">(</span>y<span class=\"token punctuation\">,</span> x<span class=\"token operator\">=</span>x<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 给初值</span>\nout <span class=\"token operator\">=</span> mod<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>y<span class=\"token punctuation\">,</span> pars<span class=\"token punctuation\">,</span> x<span class=\"token operator\">=</span>x<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 拟合结果</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>out<span class=\"token punctuation\">.</span>fit_report<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 拟合结果的详细信息</span>\nplt<span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> out<span class=\"token punctuation\">.</span>init_fit<span class=\"token punctuation\">,</span> <span class=\"token string\">'k--'</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> out<span class=\"token punctuation\">.</span>best_fit<span class=\"token punctuation\">,</span> <span class=\"token string\">'r-'</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">%</span>matplotlib inline\n<span class=\"token operator\">%</span>run examples<span class=\"token operator\">/</span>lmfits<span class=\"token operator\">/</span>fit_peak<span class=\"token punctuation\">.</span>py<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>[[Model]]\n    Model(voigt)\n[[Fit Statistics]]\n    # fitting method   = leastsq\n    # function evals   = 21\n    # data points      = 401\n    # variables        = 4\n    chi-square         = 10.9301767\n    reduced chi-square = 0.02753193\n    Akaike info crit   = -1436.57602\n    Bayesian info crit = -1420.60017\n[[Variables]]\n    sigma:      0.89518909 +/- 0.01415450 (1.58%) (init = 0.8775)\n    center:     9.24374847 +/- 0.00441903 (0.05%) (init = 9.25)\n    amplitude:  34.1914737 +/- 0.17946860 (0.52%) (init = 65.43358)\n    gamma:      0.52540198 +/- 0.01857955 (3.54%) (init = 0.7)\n    fwhm:       3.22385343 +/- 0.05097475 (1.58%) == &#39;3.6013100*sigma&#39;\n    height:     10.0872204 +/- 0.03482130 (0.35%) == &#39;amplitude*wofz((1j*gamma)/(sigma*sqrt(2))).real/(sigma*sqrt(2*pi))&#39;\n[[Correlations]] (unreported correlations are &lt; 0.100)\n    C(sigma, gamma)     = -0.928\n    C(amplitude, gamma) =  0.821\n    C(sigma, amplitude) = -0.651</code></pre>\n<figure>\n<img src=\"/advance/advance_279_1.png\" alt=\"png\" />\n<figcaption aria-hidden=\"true\">png</figcaption>\n</figure>\n<p>多个模型叠加:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> lmfit<span class=\"token punctuation\">.</span>models <span class=\"token keyword\">import</span> ExponentialModel<span class=\"token punctuation\">,</span> GaussianModel\n\ndata <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>loadtxt<span class=\"token punctuation\">(</span><span class=\"token string\">'NIST_Gauss2.dat'</span><span class=\"token punctuation\">)</span>\nx <span class=\"token operator\">=</span> data<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\ny <span class=\"token operator\">=</span> data<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span>\n\nexp_mod <span class=\"token operator\">=</span> ExponentialModel<span class=\"token punctuation\">(</span>prefix<span class=\"token operator\">=</span><span class=\"token string\">'exp_'</span><span class=\"token punctuation\">)</span>\ngauss1 <span class=\"token operator\">=</span> GaussianModel<span class=\"token punctuation\">(</span>prefix<span class=\"token operator\">=</span><span class=\"token string\">'g1_'</span><span class=\"token punctuation\">)</span>\ngauss2 <span class=\"token operator\">=</span> GaussianModel<span class=\"token punctuation\">(</span>prefix<span class=\"token operator\">=</span><span class=\"token string\">'g2_'</span><span class=\"token punctuation\">)</span>\n\npars1 <span class=\"token operator\">=</span> exp_mod<span class=\"token punctuation\">.</span>guess<span class=\"token punctuation\">(</span>y<span class=\"token punctuation\">,</span> x<span class=\"token operator\">=</span>x<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 分段设参数的方法见下面的脚本文件</span>\npars2 <span class=\"token operator\">=</span> gauss1<span class=\"token punctuation\">.</span>guess<span class=\"token punctuation\">(</span>y<span class=\"token punctuation\">,</span> x<span class=\"token operator\">=</span>x<span class=\"token punctuation\">)</span>\npars3 <span class=\"token operator\">=</span> gauss2<span class=\"token punctuation\">.</span>guess<span class=\"token punctuation\">(</span>y<span class=\"token punctuation\">,</span> x<span class=\"token operator\">=</span>x<span class=\"token punctuation\">)</span>\n\npars <span class=\"token operator\">=</span> pars1 <span class=\"token operator\">+</span> pars2 <span class=\"token operator\">+</span> pars3  <span class=\"token comment\"># 叠加参数</span>\nmod <span class=\"token operator\">=</span> gauss1 <span class=\"token operator\">+</span> gauss2 <span class=\"token operator\">+</span> exp_mod  <span class=\"token comment\"># 叠加模型</span>\n\nout <span class=\"token operator\">=</span> mod<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>y<span class=\"token punctuation\">,</span> pars<span class=\"token punctuation\">,</span> x<span class=\"token operator\">=</span>x<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>out<span class=\"token punctuation\">.</span>fit_report<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> <span class=\"token string\">'b'</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> out<span class=\"token punctuation\">.</span>init_fit<span class=\"token punctuation\">,</span> <span class=\"token string\">'k--'</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> out<span class=\"token punctuation\">.</span>best_fit<span class=\"token punctuation\">,</span> <span class=\"token string\">'r-'</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">%</span><span class=\"token operator\">%</span>capture output\n<span class=\"token operator\">%</span>matplotlib inline\n<span class=\"token operator\">%</span>run examples<span class=\"token operator\">/</span>lmfits<span class=\"token operator\">/</span>fit_peaks<span class=\"token punctuation\">.</span>py<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">output<span class=\"token punctuation\">.</span>outputs<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<figure>\n<img src=\"/advance/advance_283_0.png\" alt=\"png\" />\n<figcaption aria-hidden=\"true\">png</figcaption>\n</figure>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">%</span><span class=\"token operator\">%</span>capture output\n<span class=\"token operator\">%</span>matplotlib inline\n<span class=\"token operator\">%</span>run examples<span class=\"token operator\">/</span>lmfits<span class=\"token operator\">/</span>fit_peaks_components<span class=\"token punctuation\">.</span>py<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">output<span class=\"token punctuation\">.</span>outputs<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<figure>\n<img src=\"/advance/advance_285_0.png\" alt=\"png\" />\n<figcaption aria-hidden=\"true\">png</figcaption>\n</figure>\n<p>自定义模型的方法见 <a\nhref=\"http://lmfit.github.io/lmfit-py/builtin_models.html#user-defined-models\">LMFIT网站示例</a></p>\n<h3 id=\"其他\">其他</h3>\n<ul>\n<li>Sherpa(Modeling and Fitting) <a\nhref=\"http://cxc.cfa.harvard.edu/contrib/sherpa/\"\nclass=\"uri\">http://cxc.cfa.harvard.edu/contrib/sherpa/</a><br></li>\n<li>2-D Fitting in Sherpa <a\nhref=\"https://python4astronomers.github.io/fitting/image.html\"\nclass=\"uri\">https://python4astronomers.github.io/fitting/image.html</a><br></li>\n<li><em>etc.</em></li>\n</ul>\n<h2 id=\"copy-注意事项\">copy 注意事项</h2>\n<p><strong>\"shallow copy\"</strong> vs <strong>\"deep copy\"</strong></p>\n<ul>\n<li>对于 list 的情况</li>\n</ul>\n<p>演示插件 <a href=\"https://github.com/lgpage/nbtutor\"\nclass=\"uri\">https://github.com/lgpage/nbtutor</a></p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">%</span><span class=\"token operator\">%</span>nbtutor <span class=\"token operator\">-</span>r <span class=\"token operator\">-</span>f <span class=\"token operator\">-</span>i\n<span class=\"token keyword\">from</span> copy <span class=\"token keyword\">import</span> deepcopy\na <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span>\nb <span class=\"token operator\">=</span> a\nc <span class=\"token operator\">=</span> deepcopy<span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span>\nd <span class=\"token operator\">=</span> a<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span> <span class=\"token comment\"># 列表的切片是深拷贝</span>\nb<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span>\nc<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span>\nd<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">id</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">id</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">id</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">id</span><span class=\"token punctuation\">(</span>d<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>23284866388232 23284866388232 23284855519880 23284856061064</code></pre>\n<p><a href=\"http://t.cn/RgK1OHf\">网页版演示</a></p>\n<p><img src='/advance/nbtutor3.png' width='550'/></p>\n<ul>\n<li>对于 dict 的情况</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">%</span><span class=\"token operator\">%</span>nbtutor <span class=\"token operator\">-</span>r <span class=\"token operator\">-</span>f <span class=\"token operator\">-</span>i\n<span class=\"token keyword\">from</span> copy <span class=\"token keyword\">import</span> deepcopy\na <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token number\">1</span><span class=\"token punctuation\">:</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">:</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">:</span><span class=\"token number\">3</span><span class=\"token punctuation\">&#125;</span>\nb <span class=\"token operator\">=</span> a\nc <span class=\"token operator\">=</span> a<span class=\"token punctuation\">.</span>copy<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 深拷贝</span>\nd <span class=\"token operator\">=</span> deepcopy<span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span>\nb<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span>\nc<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span>\nd<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">id</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">id</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">id</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">id</span><span class=\"token punctuation\">(</span>d<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>22492371132064 22492371132064 22492397510376 22492397507280</code></pre>\n<p><a href=\"http://t.cn/RgKrHOx\">网页版演示</a></p>\n<p><img src='/advance/nbtutor4.png' width='550'/></p>\n<ul>\n<li>对于 set 的情况</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">%</span><span class=\"token operator\">%</span>nbtutor <span class=\"token operator\">-</span>r <span class=\"token operator\">-</span>f <span class=\"token operator\">-</span>i\n<span class=\"token keyword\">from</span> copy <span class=\"token keyword\">import</span> deepcopy\na <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">&#125;</span>\nb <span class=\"token operator\">=</span> a\nc <span class=\"token operator\">=</span> a<span class=\"token punctuation\">.</span>copy<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 深拷贝</span>\nd <span class=\"token operator\">=</span> deepcopy<span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span>\nb<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span>\nc<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span>\nd<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">id</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">id</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">id</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">id</span><span class=\"token punctuation\">(</span>d<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>22492476895528 22492476895528 22492476895304 22492374233384</code></pre>\n<p><a href=\"http://t.cn/RgKd3E7\">网页版演示</a></p>\n<p><img src='/advance/nbtutor5.png' width='550'/></p>\n<ul>\n<li>对于 numpy 的情况</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">%</span><span class=\"token operator\">%</span>nbtutor <span class=\"token operator\">-</span>r <span class=\"token operator\">-</span>f <span class=\"token operator\">-</span>i\n<span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np\na <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>arange<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span>\nb <span class=\"token operator\">=</span> a<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span> <span class=\"token comment\"># 浅拷贝!</span>\nc <span class=\"token operator\">=</span> a<span class=\"token punctuation\">.</span>copy<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 深拷贝, 同 deepcopy(a)</span>\nd <span class=\"token operator\">=</span> a<span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># 花式切片是深拷贝</span>\nb<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span>\nc<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span>\nd<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># id 虽各不同, 但 .__array_interface__['data'][0] 可能相同</span>\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">id</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">.</span>__array_interface__<span class=\"token punctuation\">[</span><span class=\"token string\">'data'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<pre><code>22928831926400 93879086511872\n22928831928960 93879086511872\n22928829201984 93879072448320\n22928829199344 93879078700736</code></pre>\n<p><a href=\"http://t.cn/Rg9hST6\">网页版演示</a> (<strong>Site\nError</strong>: Ruby and Python+Anaconda backends are permanently\nunavailable)</p>\n<p>参见之前的 <a href=\"#矩阵\">np.matrix, np.asmatrix</a></p>\n<h2 id=\"其他格式文件读写\">其他格式文件读写</h2>\n<h3 id=\"用-pandas-读-csv\">用 pandas 读 csv</h3>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd\ndata <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>read_csv<span class=\"token punctuation\">(</span><span class=\"token string\">\"data/data.csv\"</span><span class=\"token punctuation\">)</span>\ndata<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n<thead>\n<tr style=\"text-align: right;\">\n<th>\n</th>\n<th>\ncol1\n</th>\n<th>\ncol2\n</th>\n<th>\ncol3\n</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<th>\n0\n</th>\n<td>\nrow1\n</td>\n<td>\n1\n</td>\n<td>\n10.0\n</td>\n</tr>\n<tr>\n<th>\n1\n</th>\n<td>\nrow2\n</td>\n<td>\n2\n</td>\n<td>\n0.2\n</td>\n</tr>\n<tr>\n<th>\n2\n</th>\n<td>\nrow3\n</td>\n<td>\n3\n</td>\n<td>\n300.0\n</td>\n</tr>\n</tbody>\n</table>\n</div>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">data<span class=\"token punctuation\">.</span>columns<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>Index([&#39;col1&#39;, &#39;col2&#39;, &#39;col3&#39;], dtype=&#39;object&#39;)</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">data<span class=\"token punctuation\">.</span>col1<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>0    row1\n1    row2\n2    row3\nName: col1, dtype: object</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">data<span class=\"token punctuation\">[</span><span class=\"token string\">'col1'</span><span class=\"token punctuation\">]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>0    row1\n1    row2\n2    row3\nName: col1, dtype: object</code></pre>\n<p>只取一部分:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">data <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>read_csv<span class=\"token punctuation\">(</span><span class=\"token string\">\"data/data.csv\"</span><span class=\"token punctuation\">,</span> nrows<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> usecols<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\ndata<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n<thead>\n<tr style=\"text-align: right;\">\n<th>\n</th>\n<th>\ncol1\n</th>\n<th>\ncol3\n</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<th>\n0\n</th>\n<td>\nrow1\n</td>\n<td>\n10.0\n</td>\n</tr>\n<tr>\n<th>\n1\n</th>\n<td>\nrow2\n</td>\n<td>\n0.2\n</td>\n</tr>\n</tbody>\n</table>\n</div>\n<p>对于超大文件, 参见: <a\nhref=\"https://www.dataquest.io/blog/pandas-big-data/\"\nclass=\"uri\">https://www.dataquest.io/blog/pandas-big-data/</a></p>\n<h3 id=\"fortran-二进制文件读写\">Fortran 二进制文件读写</h3>\n<h4 id=\"unformatted-sequential\">Unformatted (sequential)</h4>\n<p>使用 <code>scipy.io.FortranFile</code><br> 参考: <a\nhref=\"https://docs.scipy.org/doc/scipy-0.15.1/reference/generated/scipy.io.FortranFile.read_record.html\"\nclass=\"uri\">https://docs.scipy.org/doc/scipy-0.15.1/reference/generated/scipy.io.FortranFile.read_record.html</a></p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># python (write)</span>\n<span class=\"token keyword\">from</span> scipy<span class=\"token punctuation\">.</span>io <span class=\"token keyword\">import</span> FortranFile\nvar1 <span class=\"token operator\">=</span> <span class=\"token number\">1.1</span>  <span class=\"token comment\"># '&lt;f8'</span>\nvar2 <span class=\"token operator\">=</span> <span class=\"token number\">0</span>  <span class=\"token comment\"># '&lt;i8'</span>\narr <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>arange<span class=\"token punctuation\">(</span><span class=\"token number\">6.</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># '(2, 3)&lt;f8'</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>var1<span class=\"token punctuation\">,</span> var2<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>arr<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f'arr[0, 1] = </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>arr<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">'</span></span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 多行存入</span>\n<span class=\"token keyword\">with</span> FortranFile<span class=\"token punctuation\">(</span><span class=\"token string\">'data/data_fortran1-1.dat'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'w'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span>\n    f<span class=\"token punctuation\">.</span>write_record<span class=\"token punctuation\">(</span>var1<span class=\"token punctuation\">)</span>\n    f<span class=\"token punctuation\">.</span>write_record<span class=\"token punctuation\">(</span>var2<span class=\"token punctuation\">)</span>\n    f<span class=\"token punctuation\">.</span>write_record<span class=\"token punctuation\">(</span>arr<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 单行存入</span>\n<span class=\"token keyword\">with</span> FortranFile<span class=\"token punctuation\">(</span><span class=\"token string\">'data/data_fortran1-2.dat'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'w'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span>\n    f<span class=\"token punctuation\">.</span>write_record<span class=\"token punctuation\">(</span>var1<span class=\"token punctuation\">,</span> var2<span class=\"token punctuation\">,</span> arr<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code>1.1 0\n[[0. 1. 2.]\n [3. 4. 5.]]\narr[0, 1] = 1.0</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># python (read)</span>\n<span class=\"token keyword\">from</span> scipy<span class=\"token punctuation\">.</span>io <span class=\"token keyword\">import</span> FortranFile\n<span class=\"token comment\"># 多行存入的情况</span>\n<span class=\"token keyword\">with</span> FortranFile<span class=\"token punctuation\">(</span><span class=\"token string\">'data/data_fortran1-1.dat'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'r'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span>\n    var1 <span class=\"token operator\">=</span> <span class=\"token builtin\">float</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">.</span>read_record<span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;f8'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    var2 <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">.</span>read_record<span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;i8'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 注意精度(上面python存入的是默认'int64')</span>\n    arr <span class=\"token operator\">=</span> f<span class=\"token punctuation\">.</span>read_record<span class=\"token punctuation\">(</span><span class=\"token string\">'(2, 3)&lt;f8'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'data_fortran1-1.dat'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>var1<span class=\"token punctuation\">,</span> var2<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>arr<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 单行存入的情况</span>\n<span class=\"token keyword\">with</span> FortranFile<span class=\"token punctuation\">(</span><span class=\"token string\">'data/data_fortran1-2.dat'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'r'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span>\n<span class=\"token comment\">#     data = f.read_record('&lt;f8, &lt;i8, (2, 3)&lt;f8')  # 不指定名称</span>\n    data <span class=\"token operator\">=</span> f<span class=\"token punctuation\">.</span>read_record<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token string\">'var1'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'&lt;f8'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'var2'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'&lt;i8'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                         <span class=\"token punctuation\">(</span><span class=\"token string\">'arr'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'(2, 3)&lt;f8'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 指定名称: (name, dtype)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\ndata_fortran1-2.dat'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f'keys = </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>data<span class=\"token punctuation\">.</span>dtype<span class=\"token punctuation\">.</span>names<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">'</span></span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 如读取时未指定名称则为 ['f0', 'f1', ...]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">float</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">[</span><span class=\"token string\">'var1'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">[</span><span class=\"token string\">'var2'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">[</span><span class=\"token string\">'arr'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code>data_fortran1-1.dat\n1.1 0\n[[0. 1. 2.]\n [3. 4. 5.]]\n\ndata_fortran1-2.dat\nkeys = (&#39;var1&#39;, &#39;var2&#39;, &#39;arr&#39;)\n1.1 0\n[[[0. 1. 2.]\n  [3. 4. 5.]]]</code></pre>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">%%bash\n<span class=\"token builtin class-name\">cd</span> examples/\nifort -o test_read_seq test_read_seq.f90\n./test_read_seq<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code> data_fortran1-1.dat\n   1.1  0.0\n   0.0  1.0  2.0\n   3.0  4.0  5.0\n arr(2, 1) =   1.0\n\n data_fortran1-2.dat\n   1.1  0.0\n   0.0  1.0  2.0\n   3.0  4.0  5.0\n arr(2, 1) =   1.0</code></pre>\n<p>见 Structured arrays: <a\nhref=\"https://docs.scipy.org/doc/numpy/user/basics.rec.html\"\nclass=\"uri\">https://docs.scipy.org/doc/numpy/user/basics.rec.html</a></p>\n<h4 id=\"unformatted-stream\">Unformatted (stream)</h4>\n<p><code>struct</code> 参考 <a\nhref=\"https://docs.python.org/3/library/struct.html\"\nclass=\"uri\">https://docs.python.org/3/library/struct.html</a></p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># python (write)</span>\n<span class=\"token keyword\">import</span> struct\nvar1 <span class=\"token operator\">=</span> <span class=\"token number\">1.1</span>  <span class=\"token comment\"># '&lt;f8'</span>\nvar2 <span class=\"token operator\">=</span> <span class=\"token number\">0</span>  <span class=\"token comment\"># '&lt;i8'</span>\narr <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>arange<span class=\"token punctuation\">(</span><span class=\"token number\">6.</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># '(2, 3)&lt;f8'</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>var1<span class=\"token punctuation\">,</span> var2<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>arr<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f'arr[0, 1] = </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>arr<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">'</span></span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'data/data_fortran2.dat'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'wb'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span>\n    f<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span>struct<span class=\"token punctuation\">.</span>pack<span class=\"token punctuation\">(</span><span class=\"token string\">'d'</span><span class=\"token punctuation\">,</span> var1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    f<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span>struct<span class=\"token punctuation\">.</span>pack<span class=\"token punctuation\">(</span><span class=\"token string\">'i'</span><span class=\"token punctuation\">,</span> var2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 注意 `struct` 的 'i' 是 '&lt;i4'</span>\n    arr<span class=\"token punctuation\">.</span>tofile<span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code>1.1 0\n[[0. 1. 2.]\n [3. 4. 5.]]\narr[0, 1] = 1.0</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># python (read)</span>\n<span class=\"token comment\"># 使用 `np.fromfile`, 读入的是 `ndarray`</span>\n<span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'data/data_fortran2.dat'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'rb'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span>\n    var1 <span class=\"token operator\">=</span> <span class=\"token builtin\">float</span><span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>fromfile<span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">,</span> dtype<span class=\"token operator\">=</span><span class=\"token string\">'&lt;f8'</span><span class=\"token punctuation\">,</span> count<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    var2 <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>fromfile<span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">,</span> dtype<span class=\"token operator\">=</span><span class=\"token string\">'&lt;i4'</span><span class=\"token punctuation\">,</span> count<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    arr <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>fromfile<span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">,</span> dtype<span class=\"token operator\">=</span><span class=\"token string\">'&lt;f8'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>var1<span class=\"token punctuation\">,</span> var2<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>arr<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code>1.1 0\n[[0. 1. 2.]\n [3. 4. 5.]]</code></pre>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">%%bash\n<span class=\"token builtin class-name\">cd</span> examples/\nifort -o test_read_stream test_read_stream.f90\n./test_read_stream<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code>  1.1 0.0\n  0.0 1.0 2.0\n  3.0 4.0 5.0\n arr(2, 1) =  1.0</code></pre>\n<h3 id=\"hdf5-文件读写-ncdf-cdf-文件读取\">HDF5 文件读写, NCDF, CDF\n文件读取</h3>\n<h4 id=\"读写-hdf5-文件-读-ncdf-文件\">读写 HDF5 文件, 读 NCDF 文件</h4>\n<p>HDF5 格式介绍 <a\nhref=\"https://portal.hdfgroup.org/display/HDF5/Introduction+to+HDF5\"\nclass=\"uri\">https://portal.hdfgroup.org/display/HDF5/Introduction+to+HDF5</a></p>\n<p>相关包: <code>h5py</code> 或 <code>pandas</code> +\n<code>pytables</code>\n(http://www.pytables.org/usersguide/datatypes.html)</p>\n<p>安装见 <a href=\"installpy.html#其他\">Python 安装和配置</a></p>\n<ul>\n<li>查看</li>\n</ul>\n<pre class=\"line-numbers language-sh\" data-language=\"sh\"><code class=\"language-sh\">$ h5dump -H &lt;filename&gt;.hdf5\n$ ncdump -h &lt;filename&gt;.ncdf<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<ul>\n<li>用 <code>h5py</code> 读写:</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> h5py\narr <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>arange<span class=\"token punctuation\">(</span><span class=\"token number\">10000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">,</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">with</span> h5py<span class=\"token punctuation\">.</span>File<span class=\"token punctuation\">(</span><span class=\"token string\">'test.hdf5'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'w'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span>\n    f<span class=\"token punctuation\">[</span><span class=\"token string\">'data'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> arr\n    <span class=\"token comment\"># 或</span>\n    <span class=\"token comment\"># f.create_dataset('data', data=arr)</span>\n    <span class=\"token comment\"># 其中 compression='gzip', compression_opts=[0-9], 可分条目用不同压缩</span>\n    f<span class=\"token punctuation\">[</span><span class=\"token string\">'lb'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p> 读纯 HDF5/NCDF 文件: <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">f <span class=\"token operator\">=</span> h5py<span class=\"token punctuation\">.</span>File<span class=\"token punctuation\">(</span><span class=\"token string\">'test.hdf5'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'r'</span><span class=\"token punctuation\">)</span>\nkeys <span class=\"token operator\">=</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">.</span>keys<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># ['data', 'lb']</span>\nitems <span class=\"token operator\">=</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">.</span>items<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\na <span class=\"token operator\">=</span> f<span class=\"token punctuation\">[</span><span class=\"token string\">'data'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>value<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>  读 pandas 存的文件:\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> f<span class=\"token punctuation\">[</span><span class=\"token string\">'data'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'block0_values'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>value\nf<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># f['&lt;key>'] 得到的是 Dataset 或 Group 的引用</span>\n<span class=\"token comment\"># 用 f['&lt;key>'].value 或切片 f['&lt;key>'][:] 得到原来的格式</span>\n<span class=\"token comment\"># f['&lt;key>'] 可替代为f.get('&lt;key>')</span>\n<span class=\"token comment\"># 关闭之后 f['data'] 的引用失效, 因此存出数据要加上.value或[:]保存数据, 或使用 deepcopy</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>  打印读取的信息: <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> pprint <span class=\"token keyword\">import</span> pprint\npprint<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f'</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>k<span class=\"token punctuation\">:</span><span class=\"token format-spec\">>20</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">'</span></span><span class=\"token punctuation\">,</span> <span class=\"token string-interpolation\"><span class=\"token string\">f'</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span><span class=\"token format-spec\">>20</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">'</span></span><span class=\"token punctuation\">,</span> <span class=\"token string-interpolation\"><span class=\"token string\">f'</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>dtype<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span><span class=\"token format-spec\">>20</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">'</span></span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> k <span class=\"token keyword\">in</span> f<span class=\"token punctuation\">.</span>keys<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\npprint<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f'</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>k<span class=\"token punctuation\">:</span><span class=\"token format-spec\">>20</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">'</span></span><span class=\"token punctuation\">,</span> <span class=\"token string-interpolation\"><span class=\"token string\">f\"</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'block0_values'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span><span class=\"token format-spec\">>20</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">,</span> <span class=\"token string-interpolation\"><span class=\"token string\">f\"</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'block0_values'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>dtype<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span><span class=\"token format-spec\">>20</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> k <span class=\"token keyword\">in</span> f<span class=\"token punctuation\">.</span>keys<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre></p>\n<ul>\n<li>用pandas读写:</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p> 写: <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">arr2 <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>DataFrame<span class=\"token punctuation\">(</span>arr<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># complevel=[0-9], complib=&#123;'zlib', 'lzo', 'bzip2', 'blosc'&#125;</span>\n<span class=\"token keyword\">with</span> pd<span class=\"token punctuation\">.</span>HDFStore<span class=\"token punctuation\">(</span><span class=\"token string\">'test2.hdf5'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'w'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span>\n    f<span class=\"token punctuation\">[</span><span class=\"token string\">'data'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> arr2\n    f<span class=\"token punctuation\">[</span><span class=\"token string\">'lb'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>DataFrame<span class=\"token punctuation\">(</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>  读 pandas 写的文件: <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">f <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>HDFStore<span class=\"token punctuation\">(</span><span class=\"token string\">'test2.hdf5'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'r'</span><span class=\"token punctuation\">)</span>\nkeys <span class=\"token operator\">=</span> f<span class=\"token punctuation\">.</span>keys<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># ['/data', '/lb'], 存在子目录</span>\nitems <span class=\"token operator\">=</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">.</span>items<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\na <span class=\"token operator\">=</span> f<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>values  <span class=\"token comment\"># a = f.&lt;key> 得到的是 DataFrame 的引用, f.&lt;key>.values 得到原来的格式</span>\nf<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<ul>\n<li>读纯 HDF5/NCDF 文件:<br> 比如 h5py 写的文件, 目录结构和 pandas\n写的不同, 要用<code>.root</code><br> 其他软件生成的文件可能不能读</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">f <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>HDFStore<span class=\"token punctuation\">(</span><span class=\"token string\">'test.hdf5'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'r'</span><span class=\"token punctuation\">)</span>\nkeys <span class=\"token operator\">=</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">.</span>root<span class=\"token punctuation\">.</span>_v_children<span class=\"token punctuation\">.</span>keys<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># ['data', 'lb']</span>\nitems <span class=\"token operator\">=</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">.</span>root<span class=\"token punctuation\">.</span>_v_children<span class=\"token punctuation\">.</span>items<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># ['data', 'lb'], 有些文件没有.items</span>\na <span class=\"token operator\">=</span> f<span class=\"token punctuation\">.</span>root<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># f.root 得到 tables.group.RootGroup, f.root.&lt;key> 得到tables.group.CArray</span>\n<span class=\"token comment\"># f.get_node('&lt;key>') 得到 tables.group.CArray</span>\n<span class=\"token comment\"># f.root.&lt;key> 可替代为 f['&lt;key>'] (有些文件不行)</span>\nf<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p> 打印 (以免数据有 None, 用 <code>np.shape</code>): <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">pprint<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f'</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>k<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">'</span></span>                      <span class=\"token punctuation\">.</span>rjust<span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string-interpolation\"><span class=\"token string\">f'</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>np<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">.</span>get_node<span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">'</span></span><span class=\"token punctuation\">.</span>rjust<span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string-interpolation\"><span class=\"token string\">f'</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>np<span class=\"token punctuation\">.</span>dtype<span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">.</span>get_node<span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">'</span></span><span class=\"token punctuation\">.</span>rjust<span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n         <span class=\"token keyword\">for</span> k <span class=\"token keyword\">in</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">.</span>root<span class=\"token punctuation\">.</span>_v_children<span class=\"token punctuation\">.</span>keys<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n Bug: 无法读出 <code>H5T_STRING</code></p>\n<h4 id=\"大小比较\">大小比较</h4>\n<p>用于比较的文件名说明:</p>\n<table>\n<thead>\n<tr class=\"header\">\n<th style=\"text-align: left;\">Filename</th>\n<th style=\"text-align: left;\">Method</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td style=\"text-align: left;\"><em>xxx</em>_np.npy</td>\n<td style=\"text-align: left;\"><strong><code>np.save</code></strong></td>\n</tr>\n<tr class=\"even\">\n<td style=\"text-align: left;\"><em>xxx</em>_np.npz</td>\n<td\nstyle=\"text-align: left;\"><strong><code>np.savez_compressed</code></strong></td>\n</tr>\n<tr class=\"odd\">\n<td style=\"text-align: left;\"><em>xxx</em>_compimg.fits</td>\n<td style=\"text-align: left;\"><strong>FITS</strong> CompImageHDU\n(compressed)</td>\n</tr>\n<tr class=\"even\">\n<td style=\"text-align: left;\"><em>xxx</em>_prim.fits</td>\n<td style=\"text-align: left;\"><strong>FITS</strong> PrimaryHDU</td>\n</tr>\n<tr class=\"odd\">\n<td style=\"text-align: left;\"><em>xxx</em>_h5py_0.hdf5</td>\n<td style=\"text-align: left;\"><strong><code>h5py</code></strong> no\ncompression</td>\n</tr>\n<tr class=\"even\">\n<td style=\"text-align: left;\"><em>xxx</em>_h5py_gzip.hdf5</td>\n<td style=\"text-align: left;\"><strong><code>h5py</code></strong>\ncompression='gzip', compression_opts=9</td>\n</tr>\n<tr class=\"odd\">\n<td style=\"text-align: left;\"><em>xxx</em>_h5py_lzf.hdf5</td>\n<td style=\"text-align: left;\"><strong><code>h5py</code></strong>\ncompression='lzf'</td>\n</tr>\n<tr class=\"even\">\n<td style=\"text-align: left;\"><em>xxx</em>_pd_0.hdf5</td>\n<td style=\"text-align: left;\"><strong><code>pandas</code></strong> no\ncompression</td>\n</tr>\n<tr class=\"odd\">\n<td style=\"text-align: left;\"><em>xxx</em>_pd_blosc.hdf5</td>\n<td style=\"text-align: left;\"><strong><code>pandas</code></strong>\ncomplib='blosc', complevel=9</td>\n</tr>\n<tr class=\"even\">\n<td style=\"text-align: left;\"><em>xxx</em>_pd_bzip2.hdf5</td>\n<td style=\"text-align: left;\"><strong><code>pandas</code></strong>\ncomplib='bzip2', complevel=9</td>\n</tr>\n<tr class=\"odd\">\n<td style=\"text-align: left;\"><em>xxx</em>_pd_lzo.hdf5</td>\n<td style=\"text-align: left;\"><strong><code>pandas</code></strong>\ncomplib='lzo', complevel=9</td>\n</tr>\n<tr class=\"even\">\n<td style=\"text-align: left;\"><em>xxx</em>_pd_zlib.hdf5</td>\n<td style=\"text-align: left;\"><strong><code>pandas</code></strong>\ncomplib='zlib', complevel=9</td>\n</tr>\n</tbody>\n</table>\n<ul>\n<li>对于相关性强的数组</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">%</span>run examples<span class=\"token operator\">/</span>test_hdf5<span class=\"token punctuation\">.</span>py\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n!du <span class=\"token operator\">-</span>h data<span class=\"token operator\">/</span>test_<span class=\"token operator\">*</span><span class=\"token punctuation\">.</span>np<span class=\"token operator\">*</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n!du <span class=\"token operator\">-</span>h data<span class=\"token operator\">/</span>test_h5py_<span class=\"token operator\">*</span><span class=\"token punctuation\">.</span>hdf5\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n!du <span class=\"token operator\">-</span>h data<span class=\"token operator\">/</span>test_pd_<span class=\"token operator\">*</span><span class=\"token punctuation\">.</span>hdf5<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code>array: 15.3 M\n\n7.7M    data/test_np.npy\n1.3M    data/test_np.npz\n\n16M data/test_h5py_0.hdf5\n2.9M    data/test_h5py_gzip.hdf5\n7.7M    data/test_h5py_lzf.hdf5\n\n16M data/test_pd_0.hdf5\n272K    data/test_pd_blosc.hdf5\n248K    data/test_pd_bzip2.hdf5\n256K    data/test_pd_lzo.hdf5\n172K    data/test_pd_zlib.hdf5</code></pre>\n<ul>\n<li>随机数数组</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">%</span>run examples<span class=\"token operator\">/</span>test_hdf5_2<span class=\"token punctuation\">.</span>py\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n!du <span class=\"token operator\">-</span>h data<span class=\"token operator\">/</span>test_<span class=\"token operator\">*</span><span class=\"token punctuation\">.</span>np<span class=\"token operator\">*</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n!du <span class=\"token operator\">-</span>h data<span class=\"token operator\">/</span>test_h5py_<span class=\"token operator\">*</span><span class=\"token punctuation\">.</span>hdf5\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n!du <span class=\"token operator\">-</span>h data<span class=\"token operator\">/</span>test_pd_<span class=\"token operator\">*</span><span class=\"token punctuation\">.</span>hdf5<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code>array: 15.3 M\n\n7.7M    data/test_np.npy\n7.2M    data/test_np.npz\n\n16M data/test_h5py_0.hdf5\n8.0M    data/test_h5py_gzip.hdf5\n9.5M    data/test_h5py_lzf.hdf5\n\n16M data/test_pd_0.hdf5\n7.7M    data/test_pd_blosc.hdf5\n7.2M    data/test_pd_bzip2.hdf5\n7.7M    data/test_pd_lzo.hdf5\n7.1M    data/test_pd_zlib.hdf5</code></pre>\n<ul>\n<li>从 FITS 文件读取再转存</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">fname <span class=\"token operator\">=</span> <span class=\"token string\">'data/hmi.B_720s.20150827_052400_TAI.field.fits'</span>\n<span class=\"token operator\">%</span>run examples<span class=\"token operator\">/</span>test_fits_hdf5<span class=\"token punctuation\">.</span>py <span class=\"token punctuation\">&#123;</span>fname<span class=\"token punctuation\">&#125;</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n!du <span class=\"token operator\">-</span>h <span class=\"token punctuation\">&#123;</span>fname<span class=\"token punctuation\">&#125;</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n!du <span class=\"token operator\">-</span>h data<span class=\"token operator\">/</span>fits_<span class=\"token operator\">*</span><span class=\"token punctuation\">.</span>np<span class=\"token operator\">*</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n!du <span class=\"token operator\">-</span>h data<span class=\"token operator\">/</span>fits_<span class=\"token operator\">*</span><span class=\"token punctuation\">.</span>fits\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n!du <span class=\"token operator\">-</span>h data<span class=\"token operator\">/</span>fits_h5py_<span class=\"token operator\">*</span><span class=\"token punctuation\">.</span>hdf5\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n!du <span class=\"token operator\">-</span>h data<span class=\"token operator\">/</span>fits_pd_<span class=\"token operator\">*</span><span class=\"token punctuation\">.</span>hdf5<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code>array: 64.0 M\n\n21M data/hmi.B_720s.20150827_052400_TAI.field.fits\n\n65M data/fits_np.npy\n27M data/fits_np.npz\n\n21M data/fits_compimg.fits\n65M data/fits_prim.fits\n\n65M data/fits_h5py_0.hdf5\n27M data/fits_h5py_gzip.hdf5\n40M data/fits_h5py_lzf.hdf5\n\n65M data/fits_pd_0.hdf5\n23M data/fits_pd_blosc.hdf5\n21M data/fits_pd_bzip2.hdf5\n23M data/fits_pd_lzo.hdf5\n20M data/fits_pd_zlib.hdf5</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">fname <span class=\"token operator\">=</span> <span class=\"token string\">'data/hmi.B_720s.20150827_052400_TAI.disambig.fits'</span>\n<span class=\"token operator\">%</span>run examples<span class=\"token operator\">/</span>test_fits_hdf5<span class=\"token punctuation\">.</span>py <span class=\"token punctuation\">&#123;</span>fname<span class=\"token punctuation\">&#125;</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n!du <span class=\"token operator\">-</span>h <span class=\"token punctuation\">&#123;</span>fname<span class=\"token punctuation\">&#125;</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n!du <span class=\"token operator\">-</span>h data<span class=\"token operator\">/</span>fits_<span class=\"token operator\">*</span><span class=\"token punctuation\">.</span>np<span class=\"token operator\">*</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n!du <span class=\"token operator\">-</span>h data<span class=\"token operator\">/</span>fits_<span class=\"token operator\">*</span><span class=\"token punctuation\">.</span>fits\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n!du <span class=\"token operator\">-</span>h data<span class=\"token operator\">/</span>fits_h5py_<span class=\"token operator\">*</span><span class=\"token punctuation\">.</span>hdf5\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n!du <span class=\"token operator\">-</span>h data<span class=\"token operator\">/</span>fits_pd_<span class=\"token operator\">*</span><span class=\"token punctuation\">.</span>hdf5<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code>array: 32.0 M\n\n5.4M    data/hmi.B_720s.20150827_052400_TAI.disambig.fits\n\n33M data/fits_np.npy\n5.2M    data/fits_np.npz\n\n5.4M    data/fits_compimg.fits\n33M data/fits_prim.fits\n\n33M data/fits_h5py_0.hdf5\n5.3M    data/fits_h5py_gzip.hdf5\n9.7M    data/fits_h5py_lzf.hdf5\n\n33M data/fits_pd_0.hdf5\n9.5M    data/fits_pd_blosc.hdf5\n4.1M    data/fits_pd_bzip2.hdf5\n7.6M    data/fits_pd_lzo.hdf5\n4.8M    data/fits_pd_zlib.hdf5</code></pre>\n<h4 id=\"读取-cdf-文件\">读取 CDF 文件</h4>\n<p>相关包 <code>cdflib</code>, 安装见 <a\nhref=\"installpy.html#其他\">Python 安装和配置#其他</a>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> cdflib\nf <span class=\"token operator\">=</span> cdflib<span class=\"token punctuation\">.</span>CDF<span class=\"token punctuation\">(</span><span class=\"token string\">\"&lt;filename>.cdf\"</span><span class=\"token punctuation\">)</span>\nf<span class=\"token punctuation\">.</span>cdf_info<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 总体信息</span>\nf<span class=\"token punctuation\">.</span>varinq<span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;key>'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 变量信息</span>\nf<span class=\"token punctuation\">.</span>varget<span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;key>'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 值</span>\nf<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<h3 id=\"numpy-to-vtk\">NumPy to VTK</h3>\n<p>参考 <a\nhref=\"https://pyscience.wordpress.com/2014/09/06/numpy-to-vtk-converting-your-numpy-arrays-to-vtk-arrays-and-files/\"\nclass=\"uri\">https://pyscience.wordpress.com/2014/09/06/numpy-to-vtk-converting-your-numpy-arrays-to-vtk-arrays-and-files/</a><br>\n以及 <a href=\"installpy.html#其他\">Python 安装和配置</a> <br><br>\ne.g.<br> 运行 <a\nhref=\"examples/field2dvtk.py\">examples/field2dvtk.py</a> ,<br>\n打开Paraview, 选择 state 文件 'field2d.pvsm', 再选择数据文件\n'field2d.vtr'</p>\n<h3 id=\"matlab-mat-文件读写\">Matlab mat 文件读写</h3>\n<p>(未测试) <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> scipy<span class=\"token punctuation\">.</span>io\nscipy<span class=\"token punctuation\">.</span>io<span class=\"token punctuation\">.</span>loadmat<span class=\"token punctuation\">(</span><span class=\"token string\">\"&lt;filename>\"</span><span class=\"token punctuation\">,</span> mdict<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> appendmat<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">**</span>kwargs<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 如果 appendmat=True，则文件名不需要'.mat'后缀)</span>\nscipy<span class=\"token punctuation\">.</span>io<span class=\"token punctuation\">.</span>savemat<span class=\"token punctuation\">(</span><span class=\"token string\">\"&lt;filename>\"</span><span class=\"token punctuation\">,</span> mdict<span class=\"token punctuation\">,</span> appendmat<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">format</span><span class=\"token operator\">=</span><span class=\"token string\">'5'</span><span class=\"token punctuation\">,</span>\n                 long_field_names<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span> do_compression<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span> oned_as<span class=\"token operator\">=</span><span class=\"token string\">'row'</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<h2 id=\"脚本相关\">脚本相关</h2>\n<h3 id=\"脚本结构\">脚本结构</h3>\n<p>文件头: <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\">#!/usr/bin/env python</span>\n<span class=\"token comment\"># -*- coding: utf-8 -*-</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre></p>\n<p>脚本结构: <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\">#!/usr/bin/env python</span>\n<span class=\"token comment\"># -*- coding: utf-8 -*-</span>\n<span class=\"token triple-quoted-string string\">\"\"\"\n假设这个文件的名称为 mymodule.py\n使用 `imort mymodule` 导入\n这些文字会出现在 `help(mymodule)` 或 `pydoc mymodule` 中\n\"\"\"</span>\nc <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">func1</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> <span class=\"token operator\">*</span>args<span class=\"token punctuation\">,</span> <span class=\"token operator\">**</span>kwargs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token triple-quoted-string string\">\"\"\"\n    这个注释必须缩进\n    args: a tuple - (arg1, arg2, ...)\n    kwargs: a dict - &#123;key1 : val1, key2 : val2&#125;\n    \"\"\"</span>\n    <span class=\"token keyword\">global</span> c\n    <span class=\"token keyword\">return</span> x <span class=\"token operator\">+</span> y <span class=\"token operator\">+</span> c\n<span class=\"token keyword\">def</span> <span class=\"token function\">func2</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    a <span class=\"token operator\">=</span> func1<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> a\n<span class=\"token keyword\">def</span> <span class=\"token function\">_func3</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>  <span class=\"token comment\"># `from xxx import *` 将不会导入这个函数</span>\n    <span class=\"token keyword\">pass</span>\n    <span class=\"token keyword\">return</span>  <span class=\"token comment\"># return 不写时返回 None</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># your code here</span>\n<span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">\"__main__\"</span><span class=\"token punctuation\">:</span>\n    main<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre> <code>import</code> 这个文档时,\n<code>__name__</code> 为模块名, 因此 <code>main()</code> 不执行</p>\n<p><code>help()</code> 也可以查看模块内的函数文档:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> usr_sunpy\n<span class=\"token builtin\">help</span><span class=\"token punctuation\">(</span>usr_sunpy<span class=\"token punctuation\">.</span>plot_map<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<h3 id=\"try-...-except-...-语法\">try ... except ... 语法</h3>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token keyword\">except</span> ValueError <span class=\"token keyword\">as</span> e<span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'ValueError:'</span><span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">except</span> ZeroDivisionError <span class=\"token keyword\">as</span> e<span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'ZeroDivisionError:'</span><span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'no error!'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">finally</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'finally...'</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>见 <a href=\"#Paraview-脚本\">Paraview 的例子</a></p>\n<h3 id=\"paraview-脚本\">Paraview 脚本</h3>\n<p>官方文档 <a\nhref=\"https://www.paraview.org/ParaView/Doc/Nightly/www/py-doc/index.html\"\nclass=\"uri\">https://www.paraview.org/ParaView/Doc/Nightly/www/py-doc/index.html</a>\n<br><br> * 记录语句: 1. Tools -&gt; Start Trace 2. 进行各种操作 3. Tools\n-&gt; Stop Trace 之后得到一个包含刚才操作命令的脚本,\n参考其中的语句就可以写自己的脚本了. <br><br> * 需要导入的模块:</p>\n<pre class=\"line-numbers language-sh\" data-language=\"sh\"><code class=\"language-sh\">from paraview.simple import *<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p><br> * 使用 pvpython (默认渲染) pvbatch (默认不渲染) 来执行脚本:</p>\n<pre class=\"line-numbers language-sh\" data-language=\"sh\"><code class=\"language-sh\">pvbatch myscript.py<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>也可以使用文件头 <code>#!/usr/bin/env pvbatch</code>,\n加执行权限后直接执行: <pre class=\"line-numbers language-sh\" data-language=\"sh\"><code class=\"language-sh\">.&#x2F;myscript.py<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre> 注意: 打包的 paraview 所使用的\npython 是 paraview 自带的 python2.7</p>\n<p><img src='/advance/Screenshot_20180618-151438.png' width='700' /></p>\n<ul>\n<li>常用语句:</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">view <span class=\"token operator\">=</span> GetActiveView<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nscene <span class=\"token operator\">=</span> GetAnimationScene<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<p><code>view.ViewTime</code> 修改时 <code>scene.AnimationTime</code>\n不变 <code>scene.AnimationTime</code> 修改时 <code>view.ViewTime</code>\n也同时被改变</p>\n<p>注意: filter 必须是显示状态 (<code>Show(&lt;filter&gt;)</code>)\n才能修改时间</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># e.g.</span>\n!code <span class=\"token operator\">-</span>n examples<span class=\"token operator\">/</span>stat1<span class=\"token punctuation\">.</span>py<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<ul>\n<li>字体选择参考路径:<br>\n<ul>\n<li>/usr/share/fonts/truetype/dejavu/DejaVuSans.ttf</li>\n<li>/home/<user>/miniconda3/lib/python3.6/site-packages/matplotlib/mpl-data/fonts/ttf/DejaVuSans.ttf</li>\n</ul></li>\n<li>python 调用问题 (paraview 5.5.0+ 没有这个问题):</li>\n</ul>\n<p>paraview 某个版本之后就默认使用 python 2.7.11+.<br>\n运行之前先修改环境变量 ( <code>PYTHONPATH</code> 和\n<code>PYTHONSTARTUP</code>), <br>\n运行结束结束后恢复这两个变量即可.<br><br> 这个过程可以使用脚本\n(而不用alias): <pre class=\"line-numbers language-sh\" data-language=\"sh\"><code class=\"language-sh\">#!&#x2F;bin&#x2F;bash\nunset PYTHONSTARTUP  # 如果有的话\nexport PYTHONPATH&#x3D;&#x2F;&lt;your_path&gt;&#x2F;ParaView&#x2F;lib&#x2F;python2.7&#x2F;site-packages\n&#x2F;&lt;your_path&gt;&#x2F;ParaView&#x2F;bin&#x2F;paraview $@<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre> 用这个脚本替代原有 <code>paraview</code>,\n<code>pvpython</code> 和 <code>pvbatch</code> 命令.</p>\n<h3 id=\"python-2---3-的转换\">Python 2 -&gt; 3 的转换</h3>\n<p>比较推荐的安全的检查方式:</p>\n<ul>\n<li><p>备份的原文件且自动生成转换过的文件 <pre class=\"line-numbers language-none\"><code class=\"language-none\">$ 2to3 -w filename<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p></li>\n<li><p>手动比较, 在需要的地方对照修改 filename.bak<br> 主要查看 print,\nrange, map 等函数.<br> 添加<br>\n <code>from __future__ import division, print_function</code><br> 在其他\nimport 前. <pre class=\"line-numbers language-none\"><code class=\"language-none\">$ sudo apt-get install meld\n$ meld filename filename.bak<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre></p></li>\n<li><p>确认无误后, 将手动修改的文件复制回去 <pre class=\"line-numbers language-none\"><code class=\"language-none\">$ mv -v filename.bak filename<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p></li>\n</ul>\n<p>python 内查看版本的方法, 可用于 <code>if</code> 语句等 (更推荐用\n<code>try...except...</code> 语法):</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> sys\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>sys<span class=\"token punctuation\">.</span>version_info <span class=\"token operator\">>=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>sys<span class=\"token punctuation\">.</span>version_info<span class=\"token punctuation\">.</span>major <span class=\"token operator\">>=</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<h3 id=\"执行-shell-命令\">执行 shell 命令</h3>\n<p><a href=\"https://docs.python.org/3/library/subprocess.html\"\nclass=\"uri\">https://docs.python.org/3/library/subprocess.html</a></p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> subprocess\n\nfname <span class=\"token operator\">=</span> <span class=\"token string\">'installpy.ipynb'</span>\n\n<span class=\"token comment\"># 默认是以列表形式传递参数</span>\nsubprocess<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"ls\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"-l\"</span><span class=\"token punctuation\">,</span> fname<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># doesn't capture output</span>\n\n<span class=\"token comment\"># 输出结果需要 `decode('ascii')` 转码</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>subprocess<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"ls\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"-l\"</span><span class=\"token punctuation\">,</span> fname<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> stdout<span class=\"token operator\">=</span>subprocess<span class=\"token punctuation\">.</span>PIPE<span class=\"token punctuation\">)</span>\n                    <span class=\"token punctuation\">.</span>stdout<span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token string\">'ascii'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>subprocess<span class=\"token punctuation\">.</span>check_output<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"ls\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"-l\"</span><span class=\"token punctuation\">,</span> fname<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token string\">'ascii'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code>-rw-rw-r-- 1 lydia lydia 142508 Jun 24 16:21 installpy.ipynb\n\n-rw-rw-r-- 1 lydia lydia 142508 Jun 24 16:21 installpy.ipynb</code></pre>\n<p>利用 bash 的特长来做一些字符串操作:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># 使用整行命令需要 `shell=True`, 虽然并不是推荐的做法, 但偶尔使用无妨 (见官方文档)</span>\n<span class=\"token comment\"># `r`用来取消转义</span>\n<span class=\"token comment\"># `echo`使用`-n`来去掉输出的 '\\n'</span>\nfname_head <span class=\"token operator\">=</span> subprocess<span class=\"token punctuation\">.</span>check_output<span class=\"token punctuation\">(</span><span class=\"token string\">r\"echo -n %s | sed 's/\\.ipynb//'\"</span>\n                                     <span class=\"token operator\">%</span> fname<span class=\"token punctuation\">,</span> shell<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token string\">'ascii'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 或使用 strip 去掉 '\\n'</span>\nfname_head <span class=\"token operator\">=</span> subprocess<span class=\"token punctuation\">.</span>check_output<span class=\"token punctuation\">(</span><span class=\"token string\">r\"echo %s | sed 's/\\.ipynb//'\"</span>\n             <span class=\"token operator\">%</span> fname<span class=\"token punctuation\">,</span> shell<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>strip<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token string\">'ascii'</span><span class=\"token punctuation\">)</span>  \n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>fname_head<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code>installpy</code></pre>\n<p>字符串编码见 <a\nhref=\"https://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000/001431664106267f12e9bef7ee14cf6a8776a479bdec9b9000\">廖雪峰的网站</a></p>\n<ul>\n<li>得到命令执行的路径</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> os\nos<span class=\"token punctuation\">.</span>getcwd<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>&#39;/home/lydia/codes/zly/python/python-intro&#39;</code></pre>\n<ul>\n<li>得到脚本文件所在的路径(仅脚本中使用)</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span>os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>abspath<span class=\"token punctuation\">(</span>__file__<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>或 <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>dirname<span class=\"token punctuation\">(</span>os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>abspath<span class=\"token punctuation\">(</span>__file__<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p>其中 <code>os.path.split</code> 和 <code>os.path.dirname</code>\n的用法:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token string\">'your/path/filename'</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>(&#39;your/path&#39;, &#39;filename&#39;)</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>dirname<span class=\"token punctuation\">(</span><span class=\"token string\">'your/path/filename'</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>&#39;your/path&#39;</code></pre>\n<p><code>os.path.dirname</code> 类似于 bash 的 <code>dirname</code></p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">!dirname <span class=\"token string\">'your/path/filename'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>your/path</code></pre>\n<h3 id=\"脚本选项\">脚本选项</h3>\n<p>推荐 <code>argparse</code>, 在过去的其他方法的基础上有所增强 <a\nhref=\"https://docs.python.org/3/library/argparse.html\"\nclass=\"uri\">https://docs.python.org/3/library/argparse.html</a></p>\n<p>脚本内: <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> argparse\nparser <span class=\"token operator\">=</span> argparse<span class=\"token punctuation\">.</span>ArgumentParser<span class=\"token punctuation\">(</span>description<span class=\"token operator\">=</span><span class=\"token string\">'Process some integers.'</span><span class=\"token punctuation\">)</span>\nparser<span class=\"token punctuation\">.</span>add_argument<span class=\"token punctuation\">(</span><span class=\"token string\">'integers'</span><span class=\"token punctuation\">,</span> metavar<span class=\"token operator\">=</span><span class=\"token string\">'N'</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">type</span><span class=\"token operator\">=</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">,</span> nargs<span class=\"token operator\">=</span><span class=\"token string\">'+'</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token builtin\">help</span><span class=\"token operator\">=</span><span class=\"token string\">'an integer for the accumulator'</span><span class=\"token punctuation\">)</span>\nparser<span class=\"token punctuation\">.</span>add_argument<span class=\"token punctuation\">(</span><span class=\"token string\">'--sum'</span><span class=\"token punctuation\">,</span> dest<span class=\"token operator\">=</span><span class=\"token string\">'accumulate'</span><span class=\"token punctuation\">,</span> action<span class=\"token operator\">=</span><span class=\"token string\">'store_const'</span><span class=\"token punctuation\">,</span>\n                    const<span class=\"token operator\">=</span><span class=\"token builtin\">sum</span><span class=\"token punctuation\">,</span> default<span class=\"token operator\">=</span><span class=\"token builtin\">max</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token builtin\">help</span><span class=\"token operator\">=</span><span class=\"token string\">'sum the integers (default: find the max)'</span><span class=\"token punctuation\">)</span>\nargs <span class=\"token operator\">=</span> parser<span class=\"token punctuation\">.</span>parse_args<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>args<span class=\"token punctuation\">.</span>accumulate<span class=\"token punctuation\">(</span>args<span class=\"token punctuation\">.</span>integers<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre> Shell: <pre class=\"line-numbers language-none\"><code class=\"language-none\">$ python prog.py -h\nusage: prog.py [-h] [--sum] N [N ...]\nProcess some integers.\npositional arguments:\n N           an integer for the accumulator\noptional arguments:\n -h, --help  show this help message and exit\n --sum       sum the integers (default: find the max)<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<h3 id=\"处理-warnings\">处理 warnings</h3>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># Suppress warnings of NaNs:</span>\n<span class=\"token keyword\">with</span> np<span class=\"token punctuation\">.</span>errstate<span class=\"token punctuation\">(</span>invalid<span class=\"token operator\">=</span><span class=\"token string\">'ignore'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token comment\"># Suppress other warnings, e.g.</span>\n<span class=\"token keyword\">import</span> warnings\n<span class=\"token keyword\">with</span> warnings<span class=\"token punctuation\">.</span>catch_warnings<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    warnings<span class=\"token punctuation\">.</span>simplefilter<span class=\"token punctuation\">(</span><span class=\"token string\">\"ignore\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token comment\"># Or</span>\nwarnings<span class=\"token punctuation\">.</span>simplefilter<span class=\"token punctuation\">(</span><span class=\"token string\">\"ignore\"</span><span class=\"token punctuation\">,</span> category<span class=\"token operator\">=</span>xxx<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># UserWarning, FutureWarning, etc.</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h2 id=\"urllib-requests\">urllib, requests</h2>\n<p>示例和文件来自 <a href=\"http://python4astronomers.github.com\"\nclass=\"uri\">http://python4astronomers.github.com</a></p>\n<p>注意 python3 不再使用 <code>urllib2</code></p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># 方法1</span>\n<span class=\"token keyword\">import</span> urllib\nurl <span class=\"token operator\">=</span> <span class=\"token string\">'http://python4astronomers.github.com/_downloads/myidlfile.sav'</span>\nurllib<span class=\"token punctuation\">.</span>request<span class=\"token punctuation\">.</span>urlretrieve<span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">,</span> <span class=\"token string\">'myidlfile.sav'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 方法2</span>\n<span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'myidlfile.sav'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'wb'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span>\n    f<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span>urllib<span class=\"token punctuation\">.</span>request<span class=\"token punctuation\">.</span>urlopen<span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 方法3</span>\n<span class=\"token keyword\">import</span> requests\n<span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'myidlfile.sav'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'wb'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span>\n    f<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span>requests<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>content<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 分块下载</span>\n<span class=\"token keyword\">import</span> requests\nr <span class=\"token operator\">=</span> requests<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token operator\">&lt;</span>url<span class=\"token operator\">></span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span>filename<span class=\"token punctuation\">,</span> <span class=\"token string\">'wb'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">for</span> chunk <span class=\"token keyword\">in</span> r<span class=\"token punctuation\">.</span>iter_content<span class=\"token punctuation\">(</span>chunk_size<span class=\"token operator\">=</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        f<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span>chunk<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n","site":{"data":{}},"excerpt":"<p><a\nhref=\"/downloads/notebooks/python-intro.zip\"><i class=\"fas fa-download\"></i>\nJupyter Notebook</a></p>\n<h2 id=\"anaconda\">Anaconda</h2>\n<blockquote>\n<p>A <strong>conda package</strong> is a compressed tarball file that\ncontains system-level libraries, Python or other modules, executable\nprograms and other components. <strong>Conda</strong> keeps track of the\ndependencies between packages and platforms.<br>\n(https://conda.io/docs/user-guide/concepts.html)</p>\n</blockquote>\n<ul>\n<li>凡使用 <span style=\"color:blue\">pip install</span>\n安装的包均为编译安装, <span style=\"color:blue\">conda install</span>\n安装的则为编译好的二进制包.</li>\n<li>conda 包可以打包其他语言, pip 包容易出现系统依赖问题</li>\n<li>conda 包的依赖管理更完善</li>\n<li>conda 环境下仍可使用 pip 进行安装, 但所使用的 pip 命令和系统中的 pip\n互不影响, 安装的包的位置也在 conda 本身的目录下.</li>\n<li>每个环境互不影响, 各环境下的包虽然必须分别安装 (也可以 clone\n一个现有环境),<br> 但如果有不同环境中有重复的包 conda 将默认使用\n<em>hard link</em>.</li>\n</ul>\n<p>(更多讨论参考 <a\nhref=\"http://jakevdp.github.io/blog/2016/08/25/conda-myths-and-misconceptions/)\"\nclass=\"uri\">http://jakevdp.github.io/blog/2016/08/25/conda-myths-and-misconceptions/)</a>","more":"</p>\n<p><img src='/advance/Screenshot_20180617-181206.png' width='650'/></p>\n<ul>\n<li>python 位置 (未使用 conda 时)</li>\n</ul>\n<p>使用 <pre class=\"line-numbers language-none\"><code class=\"language-none\">$ python -m site<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre> 可以看到有哪些目录.</p>\n<p>三个部分:</p>\n<ul>\n<li><strong>root</strong>\n<pre>\n/<span style=\"color:#800080\"><b>usr</b></span>/lib/...\n/<span style=\"color:#800080\"><b>usr</b></span>/bin/...\n</pre></li>\n<li><strong>user</strong>\n<pre>\n/home/&lt;user&gt;/<span style=\"color:#800080\"><b>.local</b></span>/lib/...\n/home/&lt;user&gt;/<span style=\"color:#800080\"><b>.local</b></span>/bin/...\n</pre></li>\n<li><strong>anaconda/miniconda</strong>\n<pre>\n/home/&lt;user&gt;/<b><span style=\"color:#800080\">miniconda3</span></b>/</span>/lib/...\n/home/&lt;user&gt;/<b><span style=\"color:#800080\">miniconda3</span></b>/</span>/bin/...\n</pre></li>\n<li>conda 目录结构 (安装之后自动修改了软连接,\n修改环境变量后系统优先使用这个位置)</li>\n</ul>\n<pre>\n/home/&lt;user&gt;/<span style=\"color:#800080\"><b>miniconda3/</b></span>\n    ├── <span style=\"color:navy\"><b>pkgs/</b></span>\n    ├── <span style=\"color:dimgray\"><b>bin/</b></span>\n    │        ├── <span style=\"color:magenta\">python</span> -&gt; <span style=\"color:green\">python3.6</span>\n    │        ├── <span style=\"color:magenta\">python3</span> -&gt; <span style=\"color:green\">python3.6</span>\n    │        ├── <span style=\"color:green\">python3.6</span>\n    │        ├── <span style=\"color:green\">jupyter</span>\n    │        ├── <span style=\"color:green\">h5dump</span>\n    │        └── ...\n    ├── <span style=\"color:dimgray\"><b>include/</b></span>\n    ├── <span style=\"color:dimgray\"><b>lib/</b></span>\n    ├── <span style=\"color:dimgray\"><b>share/</b></span>\n    ├── <span style=\"color:navy\"><b>envs</b></span>\n    │        ├── <span style=\"color:blue\"><b>env1/</b></span>\n    │        │        ├── <span style=\"color:dimgray\"><b>bin/</b></span>\n    │        │        ├── <span style=\"color:dimgray\"><b>include/</b></span>\n    │        │        ├── <span style=\"color:dimgray\"><b>lib/</b></span>\n    │        │        ├── <span style=\"color:dimgray\"><b>share/</b></span>\n    │        │        └── ...\n    │        ├── <span style=\"color:blue\"><b>env2/</b></span>\n    │        └── ...\n    └── ...\n</pre>\n<h2 id=\"ipython-jupyter\">IPython &amp; Jupyter</h2>\n<p>参考文档 <a href=\"http://jupyter-notebook.readthedocs.io/en/stable/\"\nclass=\"uri\">http://jupyter-notebook.readthedocs.io/en/stable/</a></p>\n<ul>\n<li>配置文件路径</li>\n</ul>\n<p>一般用户配置文件在 <code>~/.jupyter</code></p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">!jupyter <span class=\"token operator\">-</span><span class=\"token operator\">-</span>paths<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>config:\n    /home/lydia/.jupyter\n    /home/lydia/miniconda3/etc/jupyter\n    /usr/local/etc/jupyter\n    /etc/jupyter\ndata:\n    /home/lydia/.local/share/jupyter\n    /home/lydia/miniconda3/share/jupyter\n    /usr/local/share/jupyter\n    /usr/share/jupyter\nruntime:\n    /run/user/1000/jupyter</code></pre>\n<ul>\n<li>列出所有 magic functions:</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">%</span>lsmagic<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<ul>\n<li>运行脚本:</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">%</span>run script<span class=\"token punctuation\">.</span>py\n<span class=\"token operator\">%</span>run script<span class=\"token punctuation\">.</span>ipynb<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<ul>\n<li>在单个 Cell 中调用其他语言 (子进程):</li>\n</ul>\n<pre class=\"line-numbers language-sh\" data-language=\"sh\"><code class=\"language-sh\">%%sh\ncd ~&#x2F;miniconda3&#x2F;\npwd<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<pre><code>/home/lydia/miniconda3</code></pre>\n<p>可以看到实际并未改变当前目录 (因为是子进程):</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">pwd<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>&#39;/home/lydia/codes/zly/python/python-intro&#39;</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">%</span><span class=\"token operator\">%</span>script idl\ncd<span class=\"token punctuation\">,</span> current<span class=\"token operator\">=</span>d\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">,</span> d<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<pre><code>/home/lydia/codes/zly/python/python-intro\n\n\nIDL Version 8.2.1 (linux x86_64 m64). (c) 2012, Exelis Visual Information Solutions, Inc.</code></pre>\n<ul>\n<li>逐行使用 bash 命令 (注意不加 '!' 的区别):</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">!idl <span class=\"token operator\">-</span>e field3dgui<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">!ls <span class=\"token punctuation\">.</span><span class=\"token operator\">/</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>得到的结果可以存入变量:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">current<span class=\"token punctuation\">,</span> <span class=\"token operator\">=</span> !pwd  <span class=\"token comment\"># returns a list</span>\ncurrent<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>&#39;/home/lydia/python-intro&#39;</code></pre>\n<p>下面这两句不能写在一个 Cell 中:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">cd <span class=\"token operator\">-</span>q <span class=\"token operator\">~</span><span class=\"token operator\">/</span>miniconda3<span class=\"token operator\">/</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">pwd<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>&#39;/home/lydia/miniconda3&#39;</code></pre>\n<p>用 <code>&#123;var&#125;</code> (推荐) 或 <code>$var</code> (不推荐) 调用当前\nipython 环境的变量:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">cd <span class=\"token punctuation\">&#123;</span>current<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>/home/lydia/codes/zly/python/python-intro</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">cd <span class=\"token string\">\"$current\"</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>/home/lydia/codes/zly/python/python-intro</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">cd $current<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>/home/lydia/codes/zly/python/python-intro</code></pre>\n<p>见 <a\nhref=\"http://mmcdan.github.io/posts/interacting-with-the-shell-via-jupyter-notebook/\"\nclass=\"uri\">http://mmcdan.github.io/posts/interacting-with-the-shell-via-jupyter-notebook/</a></p>\n<ul>\n<li>列出当前的变量信息</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\nb <span class=\"token operator\">=</span> <span class=\"token string\">'x'</span>\n\n<span class=\"token operator\">%</span>whos <span class=\"token builtin\">int</span> <span class=\"token builtin\">str</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code>Variable   Type    Data/Info\n----------------------------\na          int     1\nb          str     x</code></pre>\n<h2 id=\"语法细节\">语法细节</h2>\n<h3 id=\"python2-python3\">python2 &amp; python3</h3>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">%</span><span class=\"token operator\">%</span>python2\n<span class=\"token keyword\">print</span> <span class=\"token number\">1</span> <span class=\"token operator\">/</span> <span class=\"token number\">2</span>\n<span class=\"token keyword\">print</span> <span class=\"token number\">1</span> <span class=\"token operator\">//</span> <span class=\"token number\">2</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<pre><code>0\n0</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">%</span><span class=\"token operator\">%</span>python3\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token operator\">//</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<pre><code>0.5\n0</code></pre>\n<p>详见 <a href=\"#Python-2--%3E-3-的转换\">Python 2 -&gt; 3\n的转换</a></p>\n<h3 id=\"list-tuple\">list, tuple</h3>\n<ul>\n<li>对 list 或 tuple, 当只有一个元素时, 注意加逗号:</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">l <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>\n<span class=\"token builtin\">type</span><span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>list</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">l <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">]</span>\n<span class=\"token builtin\">type</span><span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>list</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">l <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n<span class=\"token builtin\">type</span><span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>int</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">l <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">)</span>\n<span class=\"token builtin\">type</span><span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>tuple</code></pre>\n<ul>\n<li>赋值, 星号 (<code>*</code>) 表达式用来展开 list/tuple, 双星号\n(<code>**</code>) 用来展开 dict (常用于函数参数表):</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> <span class=\"token operator\">*</span>c <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span>\na<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> c<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>(0, 1, [2, 3])</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a<span class=\"token punctuation\">,</span> <span class=\"token operator\">*</span>_ <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token comment\"># 或 a, = ...</span>\na<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>0</code></pre>\n<h3 id=\"dict\">dict</h3>\n<ul>\n<li>dict 改变某个 key 但 value 不变的方法</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">d <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token string\">'a'</span> <span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'b'</span> <span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">&#125;</span>\nd<span class=\"token punctuation\">[</span><span class=\"token string\">'c'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> d<span class=\"token punctuation\">.</span>pop<span class=\"token punctuation\">(</span><span class=\"token string\">'b'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 利用 `pop` 返回值, 更改 key 值</span>\nd<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<pre><code>&#123;&#39;a&#39;: 1, &#39;c&#39;: 2&#125;</code></pre>\n<ul>\n<li>dict 求并集</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">d1 <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token string\">'a'</span> <span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'b'</span> <span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">&#125;</span>\nd2 <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token string\">'a'</span> <span class=\"token punctuation\">:</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'c'</span> <span class=\"token punctuation\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'d'</span> <span class=\"token punctuation\">:</span> <span class=\"token number\">4</span><span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token builtin\">dict</span><span class=\"token punctuation\">(</span>d1<span class=\"token punctuation\">,</span> <span class=\"token operator\">**</span>d2<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 重复的 key 取后一个的值</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>&#123;&#39;a&#39;: -1, &#39;b&#39;: 2, &#39;c&#39;: 3, &#39;d&#39;: 4&#125;</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token builtin\">dict</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span>d1<span class=\"token punctuation\">.</span>items<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span>d2<span class=\"token punctuation\">.</span>items<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 注意其中的 list</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>&#123;&#39;a&#39;: -1, &#39;b&#39;: 2, &#39;c&#39;: 3, &#39;d&#39;: 4&#125;</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">d1<span class=\"token punctuation\">.</span>update<span class=\"token punctuation\">(</span>d2<span class=\"token punctuation\">)</span>\nd1<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>&#123;&#39;a&#39;: -1, &#39;b&#39;: 2, &#39;c&#39;: 3, &#39;d&#39;: 4&#125;</code></pre>\n<h3 id=\"set\">set</h3>\n<ul>\n<li>set 基本操作</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">s <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">s<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># one element only</span>\ns<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>&#123;1, 2, 3&#125;</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">s<span class=\"token punctuation\">.</span>update<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># iterable: list/tuple/set/...</span>\ns<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>&#123;1, 2, 3, 4, 5&#125;</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">s<span class=\"token punctuation\">.</span>remove<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\ns<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>&#123;2, 3, 4, 5&#125;</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">s<span class=\"token punctuation\">.</span>discard<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># No error if not exist</span>\ns<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>&#123;2, 3, 4, 5&#125;</code></pre>\n<ul>\n<li>set 求交集, 并集, 差集, 对称差集, 子集</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token punctuation\">&#123;</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">.</span>intersection<span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>&#123;2&#125;</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token punctuation\">&#123;</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">&amp;</span> <span class=\"token punctuation\">&#123;</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">&#125;</span>  <span class=\"token comment\"># 或用 and</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>&#123;2&#125;</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token punctuation\">&#123;</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">.</span>union<span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>&#123;1, 2, 3&#125;</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token punctuation\">&#123;</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">|</span> <span class=\"token punctuation\">&#123;</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">&#125;</span>  <span class=\"token comment\"># 或用 or</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>&#123;1, 2, 3&#125;</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token punctuation\">&#123;</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">.</span>difference<span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>&#123;1&#125;</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token punctuation\">&#123;</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">-</span> <span class=\"token punctuation\">&#123;</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">&#125;</span>  <span class=\"token comment\"># 在前不在后</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>&#123;1&#125;</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token punctuation\">&#123;</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">.</span>symmetric_difference<span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>&#123;1, 3&#125;</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token punctuation\">&#123;</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">^</span> <span class=\"token punctuation\">&#123;</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">&#125;</span>  <span class=\"token comment\"># 不同时在两边</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>&#123;1, 3&#125;</code></pre>\n<ul>\n<li>属于, 包含于(子集)</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token number\">2</span> <span class=\"token keyword\">in</span> <span class=\"token punctuation\">&#123;</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">&#125;</span>  <span class=\"token comment\"># list/tuple/set</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>True</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token number\">4</span> <span class=\"token keyword\">not</span> <span class=\"token keyword\">in</span> <span class=\"token punctuation\">&#123;</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">&#125;</span>  <span class=\"token comment\"># list/tuple/set</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>True</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token punctuation\">&#123;</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">.</span>issubset<span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>True</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token punctuation\">&#123;</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">&lt;=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>True</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token punctuation\">&#123;</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">.</span>issuperset<span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>True</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token punctuation\">&#123;</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">>=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>True</code></pre>\n<h3 id=\"一些特性的演示\">一些特性的演示</h3>\n<p>插件 <a href=\"https://github.com/lgpage/nbtutor\"\nclass=\"uri\">https://github.com/lgpage/nbtutor</a><br> 网页版 <a\nhref=\"http://pythontutor.com/\"\nclass=\"uri\">http://pythontutor.com/</a></p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">%</span>reload_ext nbtutor<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">%</span><span class=\"token operator\">%</span>nbtutor <span class=\"token operator\">-</span>r <span class=\"token operator\">-</span>f\nl1<span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\nl2 <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<p><a href=\"http://t.cn/Rg9J3bf\">网页版演示</a></p>\n<p><img src='/advance/nbtutor1.png' width='550'/></p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">%</span><span class=\"token operator\">%</span>nbtutor <span class=\"token operator\">-</span>r <span class=\"token operator\">-</span>f <span class=\"token operator\">-</span>i\na <span class=\"token operator\">=</span> <span class=\"token number\">3</span>\nb <span class=\"token operator\">=</span> <span class=\"token number\">4</span>\nt <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># list in tuple</span>\na <span class=\"token operator\">=</span> <span class=\"token string\">'x'</span> <span class=\"token comment\"># change element in list</span>\nt<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">'xx'</span> <span class=\"token comment\"># change element in tuple</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>(1, 2, [&#39;xx&#39;, 4])</code></pre>\n<p><a href=\"http://t.cn/Rg9idUn\">网页版演示</a></p>\n<p><img src='/advance/nbtutor2.png' width='550'/></p>\n<h3 id=\"包含判断的单行循环\">包含判断的单行循环</h3>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">l <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">[</span>i <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> l <span class=\"token keyword\">if</span> i <span class=\"token operator\">></span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>[3, 4, 5]</code></pre>\n<p>例如用 <code>globals()</code> 来得到字符串形式的变量名 (python\n的变量没有提供这个功能的关键字, 因为\"变量名\"存储在namespaces中)</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">namestr</span><span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">,</span> namespace<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span>name <span class=\"token keyword\">for</span> name <span class=\"token keyword\">in</span> namespace <span class=\"token keyword\">if</span> namespace<span class=\"token punctuation\">[</span>name<span class=\"token punctuation\">]</span> <span class=\"token keyword\">is</span> obj<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\na <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\nb <span class=\"token operator\">=</span> <span class=\"token number\">2</span>\n<span class=\"token keyword\">for</span> var <span class=\"token keyword\">in</span> <span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f'</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>namestr<span class=\"token punctuation\">(</span>var<span class=\"token punctuation\">,</span> <span class=\"token builtin\">globals</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\"> = </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>var<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">'</span></span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code>a = 1\nb = 2</code></pre>\n<h3 id=\"单行-if-三元关系运算\">单行 if (三元关系运算)</h3>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\nb <span class=\"token operator\">=</span> <span class=\"token string\">'y'</span> <span class=\"token keyword\">if</span> a <span class=\"token operator\">></span> <span class=\"token number\">0</span> <span class=\"token keyword\">else</span> <span class=\"token string\">'n'</span>\nb<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<pre><code>&#39;y&#39;</code></pre>\n<h3 id=\"循环-迭代器-生成器\">循环, 迭代器, 生成器</h3>\n<p>Python 的 for 循环不使用索引变量, 而使用遍历<strong>迭代器</strong>\n(iterator) 的方式处理<strong>可迭代对象</strong> (range, set 等):</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<p>遍历的方式是使用 <code>iter</code> 和 <code>next</code> 函数:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> <span class=\"token builtin\">iter</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 生成一个 range_iterator 对象</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token builtin\">next</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>0</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 转换为 list</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>[0, 1, 2, 3, 4]</code></pre>\n<p><code>enumerate</code> 函数适合需要同时使用索引和内容时使用:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">for</span> i<span class=\"token punctuation\">,</span> item <span class=\"token keyword\">in</span> <span class=\"token builtin\">enumerate</span><span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>  <span class=\"token comment\"># enumerate()是一个迭代器</span>\n    i <span class=\"token operator\">=</span> <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n    item <span class=\"token operator\">=</span> <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>  <span class=\"token comment\"># l[i] = ...</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<p>生成器:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>i<span class=\"token operator\">**</span><span class=\"token number\">2</span> <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 产生一个生成器, 可转化成 list, tuple</span>\na<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>&lt;generator object &lt;genexpr&gt; at 0x14da87e652b0&gt;</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token builtin\">next</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 生成器也是迭代器</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>4</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>i <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># 产生一个 list</span>\na<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>[0, 1, 2]</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># 转化成 tuple</span>\n<span class=\"token builtin\">tuple</span><span class=\"token punctuation\">(</span>i <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>(0, 1, 2)</code></pre>\n<h3 id=\"函数定义\">函数定义</h3>\n<ul>\n<li>一般的函数定义:</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">func</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> <span class=\"token operator\">*</span>args<span class=\"token punctuation\">,</span> <span class=\"token operator\">**</span>kwargs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># func1(x, y, arg1, arg2, ..., key1=val1, key2=val2, ...)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span> <span class=\"token comment\"># 没有 return 或为空 则返回 None</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<ul>\n<li>单行函数 lambda</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">f</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">return</span> x <span class=\"token operator\">+</span> y\nf<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<pre><code>3</code></pre>\n<p>用 <code>lambda</code> 语法来定义:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">f <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">:</span> x <span class=\"token operator\">+</span> y\nf<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>3</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token punctuation\">(</span><span class=\"token keyword\">lambda</span> x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">:</span> x <span class=\"token operator\">+</span> y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 不一定需要定义函数名称</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>3</code></pre>\n<h3 id=\"命名空间和变量作用域\">命名空间和变量作用域</h3>\n<p><a\nhref=\"https://sebastianraschka.com/Articles/2014_python_scope_and_namespaces.html\"\nclass=\"uri\">https://sebastianraschka.com/Articles/2014_python_scope_and_namespaces.html</a></p>\n<p><img src='/advance/scope_resolution_1.png' width='400' /></p>\n<ul>\n<li>Built-in Functions <a\nhref=\"https://docs.python.org/3/library/functions.html\"\nclass=\"uri\">https://docs.python.org/3/library/functions.html</a></li>\n<li>Built-in Constants <a\nhref=\"https://docs.python.org/3/library/constants.html\"\nclass=\"uri\">https://docs.python.org/3/library/constants.html</a></li>\n</ul>\n<p><code>globals()</code> 以 dict 形式返回当前所有全局变量,\n包括导入的包名, ipython/jupyter 的 <code>In</code>, <code>Out</code>\n等.<br> python 以 name -&gt; obj 的形式存储这些变量.</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\nb <span class=\"token operator\">=</span> <span class=\"token number\">2</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token builtin\">globals</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token string\">'a'</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">is</span> a<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>True</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">i <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">f</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    i <span class=\"token operator\">=</span> <span class=\"token number\">2</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">,</span> <span class=\"token string\">'local'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span>\nf<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">,</span> <span class=\"token string\">'global'</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code>2 local\n1 global</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">i <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">pass</span>\ni  <span class=\"token comment\"># 值被改变了 (“leaking”)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code>3</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">i <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n<span class=\"token punctuation\">[</span>i <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\ni  <span class=\"token comment\"># 用这种方式就不会发生“leaking”</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<pre><code>1</code></pre>\n<p>有关函数中的变量作用方式细节, 参考这里提到的例子: <a\nhref=\"https://stackoverflow.com/a/575887\">stackoverflow</a></p>\n<blockquote>\n<ul>\n<li><p>Any time you see <font color=blue><strong>varname\n=</strong></font>, you're <strong>creating a new name</strong> binding\nwithin the function's scope.<br>Whatever value <code>varname</code> was\nbound to before is lost within this scope.</p></li>\n<li><p>Any time you see\n<font color=blue><strong>varname.foo()</strong></font>, you're\n<strong>calling a method</strong> on <code>varname</code>. The method\nmay alter <code>varname</code> (e.g. <code>list.append</code>). <br>\n<code>varname</code> (or, rather, the object that <code>varname</code>\nnames) may exist in more than one scope, and since it's the same object,\n<br><strong>any changes will be visible in all scopes</strong>.</p></li>\n</ul>\n</blockquote>\n<h2 id=\"numpy\">NumPy</h2>\n<h3 id=\"numpy-的数据类型-dtype\">numpy 的数据类型 dtype</h3>\n<p><a href=\"https://www.tutorialspoint.com/numpy/numpy_data_types.htm\"\nclass=\"uri\">https://www.tutorialspoint.com/numpy/numpy_data_types.htm</a>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> np<span class=\"token punctuation\">.</span>dtype<span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>int64<span class=\"token punctuation\">)</span> <span class=\"token keyword\">is</span> np<span class=\"token punctuation\">.</span>dtype<span class=\"token punctuation\">(</span><span class=\"token string\">'i8'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">is</span> np<span class=\"token punctuation\">.</span>dtype<span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;i8'</span><span class=\"token punctuation\">)</span>\n<span class=\"token boolean\">True</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> np<span class=\"token punctuation\">.</span>dtype<span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>int64<span class=\"token punctuation\">)</span> <span class=\"token keyword\">is</span> np<span class=\"token punctuation\">.</span>dtype<span class=\"token punctuation\">(</span><span class=\"token string\">'int'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">is</span> np<span class=\"token punctuation\">.</span>dtype<span class=\"token punctuation\">(</span><span class=\"token string\">'int64'</span><span class=\"token punctuation\">)</span>\n<span class=\"token boolean\">True</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> np<span class=\"token punctuation\">.</span>dtype<span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>int64<span class=\"token punctuation\">)</span> <span class=\"token keyword\">is</span> np<span class=\"token punctuation\">.</span>dtype<span class=\"token punctuation\">(</span><span class=\"token string\">'>i8'</span><span class=\"token punctuation\">)</span>\n<span class=\"token boolean\">False</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre> <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> np<span class=\"token punctuation\">.</span>dtype<span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>float64<span class=\"token punctuation\">)</span> <span class=\"token keyword\">is</span> np<span class=\"token punctuation\">.</span>dtype<span class=\"token punctuation\">(</span><span class=\"token string\">'f8'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">is</span> np<span class=\"token punctuation\">.</span>dtype<span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;f8'</span><span class=\"token punctuation\">)</span>\n<span class=\"token boolean\">True</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> np<span class=\"token punctuation\">.</span>dtype<span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>float64<span class=\"token punctuation\">)</span> <span class=\"token keyword\">is</span> np<span class=\"token punctuation\">.</span>dtype<span class=\"token punctuation\">(</span><span class=\"token string\">'float'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">is</span> np<span class=\"token punctuation\">.</span>dtype<span class=\"token punctuation\">(</span><span class=\"token string\">'float64'</span><span class=\"token punctuation\">)</span>\n<span class=\"token boolean\">True</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre> 见 <a\nhref=\"#Fortran-二进制文件读写\">Fortran 二进制文件读写</a> 中的应用.</p>\n<h3 id=\"np.arange-参数为浮点数时要注意的细节\">np.arange\n参数为浮点数时要注意的细节</h3>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">np<span class=\"token punctuation\">.</span>arange<span class=\"token punctuation\">(</span><span class=\"token number\">0.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1.8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.3</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 默认不包含 `stop` 这个点</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>array([0. , 0.3, 0.6, 0.9, 1.2, 1.5])</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">np<span class=\"token punctuation\">.</span>arange<span class=\"token punctuation\">(</span><span class=\"token number\">0.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2.1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.3</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 这里却包括了, 为什么?</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>array([0. , 0.3, 0.6, 0.9, 1.2, 1.5, 1.8, 2.1])</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token string\">'%.16f'</span> <span class=\"token operator\">%</span> <span class=\"token number\">2.1</span>  <span class=\"token comment\"># 因为浮点数计算方式产生的精度问题</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>&#39;2.1000000000000001&#39;</code></pre>\n<p>看一个求和的例子中同样的问题 (用 <code>list</code> 和\n<code>numpy.ndarray</code> 效果一样):</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'%.17f'</span> <span class=\"token operator\">%</span> <span class=\"token number\">0.1</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># sum([0.1, ..., 0.1])</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'%.17f'</span> <span class=\"token operator\">%</span> <span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">0.1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 因为同样问题, 累积了误差</span>\n\n<span class=\"token keyword\">import</span> math\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'%.17f'</span> <span class=\"token operator\">%</span> math<span class=\"token punctuation\">.</span>fsum<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">0.1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code>0.10000000000000001\n0.99999999999999989\n1.00000000000000000</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">0.1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>False</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">math<span class=\"token punctuation\">.</span>fsum<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">0.1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>True</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">math<span class=\"token punctuation\">.</span>fsum<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">0.1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">1.0</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>True</code></pre>\n<p>参考 <a href=\"https://docs.python.org/3/tutorial/floatingpoint.html\"\nclass=\"uri\">https://docs.python.org/3/tutorial/floatingpoint.html</a></p>\n<p>建议是: 使用整数; 对浮点数的情况, stop 值设得略小一些\n(比如减去步长的一般) 以防止改点被包含, 或使用 <code>np.linspace</code>\n代替.</p>\n<h3 id=\"矩阵\">矩阵</h3>\n<p><code>np.matrix</code>(矩阵) 是 <code>np.ndarray</code>(数组)\n的一个子类, 继承了父级的方法, 也定义了新的方法 (例如矩阵运算).</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token builtin\">issubclass</span><span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>matrix<span class=\"token punctuation\">,</span> np<span class=\"token punctuation\">.</span>ndarray<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>True</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>matrix<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> a<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>matrix([[0, 1, 2],\n        [3, 4, 5]])</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>matrix<span class=\"token punctuation\">(</span><span class=\"token string\">\"0 1 2; 3 4 5\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> a<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>matrix([[0, 1, 2],\n        [3, 4, 5]])</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token builtin\">type</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>numpy.matrixlib.defmatrix.matrix</code></pre>\n<p><code>np.asmatrix</code> (或简写作 <code>np.mat</code>) 相当于\n<code>np.matrix(data, copy=False)</code></p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">x <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nm <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>matrix<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\nm<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">5</span>\nx<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code>array([[1, 2],\n       [3, 4]])</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">x <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nm <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>mat<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\nm<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">5</span>\nx<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code>array([[5, 2],\n       [3, 4]])</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">x<span class=\"token punctuation\">.</span>__array_interface__<span class=\"token punctuation\">[</span><span class=\"token string\">'data'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> m<span class=\"token punctuation\">.</span>__array_interface__<span class=\"token punctuation\">[</span><span class=\"token string\">'data'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>True</code></pre>\n<p>注意: <code>np.matrix</code> 既是一个类名也是一个函数名, 而\n<code>np.mat</code>, <code>np.asmatrix</code> 只是函数名.</p>\n<h3 id=\"数组和矩阵运算\">数组和矩阵运算</h3>\n<h4 id=\"数组运算\">数组运算</h4>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>arange<span class=\"token punctuation\">(</span><span class=\"token number\">12</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> a<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>array([[ 0,  1,  2,  3],\n       [ 4,  5,  6,  7],\n       [ 8,  9, 10, 11]])</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a<span class=\"token punctuation\">.</span><span class=\"token builtin\">max</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>11</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">*</span> a  <span class=\"token comment\"># 注意这是对应位置的元素间的运算</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>array([[  0,   1,   4,   9],\n       [ 16,  25,  36,  49],\n       [ 64,  81, 100, 121]])</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">**</span> <span class=\"token number\">2</span>  <span class=\"token comment\"># 注意这是对应位置的元素间的运算</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>array([[  0,   1,   4,   9],\n       [ 16,  25,  36,  49],\n       [ 64,  81, 100, 121]])</code></pre>\n<h4 id=\"使用数组进行矩阵运算\">使用数组进行矩阵运算</h4>\n<p><code>scipy.linalg</code> 与 <code>numpy.linalg</code> 的比较: <a\nhref=\"https://scipy.github.io/devdocs/tutorial/linalg.html\"\nclass=\"uri\">https://scipy.github.io/devdocs/tutorial/linalg.html</a>\n&gt;* <code>scipy.linalg</code> contains <strong>all</strong> the\nfunctions in <code>numpy.linalg</code> plus some other more\n<strong>advanced</strong> ones not contained in\n<code>numpy.linalg</code> * Despite its convenience, the use of the\n<code>numpy.matrix</code> class is <strong>discouraged</strong>. *\n<code>scipy.linalg</code> operations can be applied\n<strong>equally</strong> to <code>numpy.matrix</code> or to 2D\n<code>numpy.ndarray</code> objects.</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>diagflat<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">1.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3.</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> a<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>array([[1., 0., 0.],\n       [0., 2., 0.],\n       [0., 0., 3.]])</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">b <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">1.</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1.</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1.</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token number\">0.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> b<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>array([[-1., -1., -1.],\n       [ 0.,  0.,  0.]])</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> scipy<span class=\"token punctuation\">.</span>linalg <span class=\"token keyword\">import</span> inv\ninv<span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 求逆</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>array([[ 1.        ,  0.        , -0.        ],\n       [ 0.        ,  0.5       , -0.        ],\n       [ 0.        ,  0.        ,  0.33333333]])</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a<span class=\"token punctuation\">.</span>dot<span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">.</span>T<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 矩阵内积</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>array([[-1.,  0.],\n       [-2.,  0.],\n       [-3.,  0.]])</code></pre>\n<h4 id=\"直接使用矩阵类型进行运算\">直接使用矩阵类型进行运算</h4>\n<p>使用 numpy 的矩阵类型 <code>numpy.matrix</code></p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>mat<span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>diagflat<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">1.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3.</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> a<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>matrix([[1., 0., 0.],\n        [0., 2., 0.],\n        [0., 0., 3.]])</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">b <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>mat<span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">1.</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1.</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1.</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token number\">0.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> b<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>matrix([[-1., -1., -1.],\n        [ 0.,  0.,  0.]])</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">*</span> b<span class=\"token punctuation\">.</span>T  <span class=\"token comment\"># 矩阵内积, 注意与数组的运算符定义不同</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>matrix([[-1.,  0.],\n        [-2.,  0.],\n        [-3.,  0.]])</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a @ b<span class=\"token punctuation\">.</span>T  <span class=\"token comment\"># 矩阵内积的新写法, python 3.5+</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>matrix([[-1.,  0.],\n        [-2.,  0.],\n        [-3.,  0.]])</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a<span class=\"token punctuation\">.</span>I  <span class=\"token comment\"># 求逆</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>matrix([[ 1.        ,  0.        , -0.        ],\n        [ 0.        ,  0.5       , -0.        ],\n        [ 0.        ,  0.        ,  0.33333333]])</code></pre>\n<h3 id=\"用作坐标格点的数组的几种形式\">用作坐标格点的数组的几种形式</h3>\n<ul>\n<li><strong><code>np.meshgrid</code></strong></li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> x <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>linspace<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> x\narray<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span> <span class=\"token number\">0.</span><span class=\"token punctuation\">,</span>  <span class=\"token number\">1.</span><span class=\"token punctuation\">,</span>  <span class=\"token number\">2.</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> y <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>linspace<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> y\narray<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">3.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6.</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># X, Y 形状相同: N x M 矩阵, shape=(N, M)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> X<span class=\"token punctuation\">,</span> Y <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>meshgrid<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> X                         <span class=\"token comment\"># X[j, :] 表示同一层 y[j] 对应的不同 x 值</span>\narray<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">0.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2.</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>          <span class=\"token comment\">#  0_____x</span>\n       <span class=\"token punctuation\">[</span><span class=\"token number\">0.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2.</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>          <span class=\"token comment\">#  |</span>\n       <span class=\"token punctuation\">[</span><span class=\"token number\">0.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2.</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>          <span class=\"token comment\">#  |y</span>\n       <span class=\"token punctuation\">[</span><span class=\"token number\">0.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2.</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> Y\narray<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">3.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3.</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>          <span class=\"token comment\"># Y[:, i] 表示同一层 x[i] 对应的不同 y 值</span>\n       <span class=\"token punctuation\">[</span><span class=\"token number\">4.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4.</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n       <span class=\"token punctuation\">[</span><span class=\"token number\">5.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5.</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n       <span class=\"token punctuation\">[</span><span class=\"token number\">6.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6.</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>可用来计算坐标的函数 (例如磁场的表达式等等, 见 <a\nhref=\"examples/streamplot.py\">examples/streamplot.py</a> )\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">U <span class=\"token operator\">=</span>   <span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>cos<span class=\"token punctuation\">(</span>k1 <span class=\"token operator\">*</span> X<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> np<span class=\"token punctuation\">.</span>exp<span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>k1 <span class=\"token operator\">*</span> Y<span class=\"token punctuation\">)</span>\n     <span class=\"token operator\">-</span> np<span class=\"token punctuation\">.</span>cos<span class=\"token punctuation\">(</span>k2 <span class=\"token operator\">*</span> X<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> np<span class=\"token punctuation\">.</span>exp<span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>k2 <span class=\"token operator\">*</span> Y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nV <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">-</span> np<span class=\"token punctuation\">.</span>sin<span class=\"token punctuation\">(</span>k1 <span class=\"token operator\">*</span> X<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> np<span class=\"token punctuation\">.</span>exp<span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>k1 <span class=\"token operator\">*</span> Y<span class=\"token punctuation\">)</span>\n     <span class=\"token operator\">+</span> np<span class=\"token punctuation\">.</span>sin<span class=\"token punctuation\">(</span>k2 <span class=\"token operator\">*</span> X<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> np<span class=\"token punctuation\">.</span>exp<span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>k2 <span class=\"token operator\">*</span> Y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre></p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">x <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>linspace<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\ny <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>linspace<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span>\nX<span class=\"token punctuation\">,</span> Y <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>meshgrid<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> indexing<span class=\"token operator\">=</span><span class=\"token string\">'ij'</span><span class=\"token punctuation\">)</span>\nY<span class=\"token punctuation\">.</span>shape<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code>(3, 4)</code></pre>\n<ul>\n<li><strong><code>np.mgrid</code></strong></li>\n</ul>\n<p><code>j</code> 标记默认是虚数单位,\n但在这里表示前面的数字是格点数.<br> 格点数使用变量\n<em><code>n</code></em> 时, 可写成:\n<em><code>n</code></em><code>*1j + 1j</code>, 1不能省\n(否则j定义为变量)<br> 类似的 <code>np.ogrid</code> 可参见 numpy\n相关文档</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> x <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>linspace<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> y <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>linspace<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 下面三行等价</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> X<span class=\"token punctuation\">,</span> Y <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>mgrid<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">:</span><span class=\"token number\">2</span><span class=\"token punctuation\">:</span><span class=\"token number\">3j</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">:</span><span class=\"token number\">6</span><span class=\"token punctuation\">:</span><span class=\"token number\">4j</span><span class=\"token punctuation\">]</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> X<span class=\"token punctuation\">,</span> Y <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">.</span>astype<span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>float64<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> np<span class=\"token punctuation\">.</span>mgrid<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">:</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">:</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> X<span class=\"token punctuation\">,</span> Y <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>meshgrid<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> indexing<span class=\"token operator\">=</span><span class=\"token string\">'ij'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># np.mgrid[0:2:3j, 3:6:4j] 得到的数据类型为 'float64'</span>\n<span class=\"token comment\"># np.mgrid[0:3, 3:6] 得到的数据类型为 'int64'</span>\n<span class=\"token comment\"># np.meshgrid(x, y, indexing='ij') 得到一个 list, 数据格式同x, y</span>\n\n<span class=\"token comment\"># X, Y 形状相同: M x N 矩阵, shape=(M, N)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> X                      <span class=\"token comment\"># X[i, :] 表示 x[i]</span>\narray<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">0.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>   <span class=\"token comment\">#  0_____y</span>\n       <span class=\"token punctuation\">[</span><span class=\"token number\">1.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1.</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>   <span class=\"token comment\">#  |</span>\n       <span class=\"token punctuation\">[</span><span class=\"token number\">2.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2.</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\">#  |x</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> Y                      <span class=\"token comment\"># Y[:, j] 表示 y[j]</span>\narray<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">3.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6.</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n       <span class=\"token punctuation\">[</span><span class=\"token number\">3.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6.</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n       <span class=\"token punctuation\">[</span><span class=\"token number\">3.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5.</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6.</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h3 id=\"mask\">mask</h3>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>arange<span class=\"token punctuation\">(</span><span class=\"token number\">9</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> a<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>array([[0, 1, 2],\n       [3, 4, 5],\n       [6, 7, 8]])</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">></span> <span class=\"token number\">4</span>  <span class=\"token comment\"># mask</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>array([[False, False, False],\n       [False, False,  True],\n       [ True,  True,  True]])</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">np<span class=\"token punctuation\">.</span>where<span class=\"token punctuation\">(</span>a <span class=\"token operator\">></span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 得到 tuple(col_indexs, row_indexs)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>(array([1, 2, 2, 2]), array([2, 0, 1, 2]))</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">zip</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>np<span class=\"token punctuation\">.</span>where<span class=\"token punctuation\">(</span>a <span class=\"token operator\">></span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 也可以用 np.array(np.where(a > 4)).T</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>[(1, 2), (2, 0), (2, 1), (2, 2)]</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a<span class=\"token punctuation\">[</span>a <span class=\"token operator\">></span> <span class=\"token number\">4</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span> a  <span class=\"token comment\"># same as a[np.where(a > 4)]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>array([[ 0,  1,  2],\n       [ 3,  4, -1],\n       [-1, -1, -1]])</code></pre>\n<h3 id=\"其他对数组元素的处理\">其他对数组元素的处理</h3>\n<p>处理含有 NaN 的数据:</p>\n<p>e.g. 求最值可使用 <code>np.nanmin(...)</code> 和\n<code>np.nanmax(...)</code></p>\n<h2 id=\"matplotlib\">Matplotlib</h2>\n<ul>\n<li>官方教程 <a\nhref=\"https://matplotlib.org/tutorials/introductory/usage.html\"\nclass=\"uri\">https://matplotlib.org/tutorials/introductory/usage.html</a></li>\n</ul>\n<p><img src='/advance/anatomy.png' width='600' /></p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">fig <span class=\"token operator\">=</span> plt<span class=\"token punctuation\">.</span>gcf<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># current figure</span>\nax <span class=\"token operator\">=</span> plt<span class=\"token punctuation\">.</span>gca<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># current `Axes`</span>\nim <span class=\"token operator\">=</span> plt<span class=\"token punctuation\">.</span>gci<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># current artist(图像内容), 可由诸如 plt.imshow(...) 得到</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<ul>\n<li><p>得到当前 backend: <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token keyword\">import</span> matplotlib<span class=\"token punctuation\">.</span>pyplot <span class=\"token keyword\">as</span> plt\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> plt<span class=\"token punctuation\">.</span>get_backend<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre> 或 <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token keyword\">import</span> maplotlib <span class=\"token keyword\">as</span> mpl\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> mpl<span class=\"token punctuation\">.</span>get_backend<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre></p></li>\n<li><p>选择 backend (在导入其他 matplotlib 模块之前):\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token keyword\">import</span> matplotlib\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> matplotlib<span class=\"token punctuation\">.</span>use<span class=\"token punctuation\">(</span><span class=\"token string\">'TkAgg'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 'Qt5Agg', 'TkAgg', 'Agg', ...</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre></p></li>\n<li><p>用户配置文档 <code>matplotlibrc</code><br> 通常的位置:\n<code>~/.config/matplotlib/matplotlibrc</code> (Linux)</p></li>\n<li><p>用 <code>zorder</code> 来控制图层:</p></li>\n</ul>\n<p>这个例子中也展示了加入一个动态的竖线的方法,\n这条线在保存后的图像中不会显示.</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">%</span>matplotlib\n<span class=\"token operator\">%</span>run <span class=\"token operator\">-</span>e <span class=\"token string\">'examples/test_plot.py'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<ul>\n<li>使用 <a\nhref=\"https://github.com/joferkington/mpldatacursor\">这个工具</a>\n动态标注光标位置的值:</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">%</span>matplotlib\n<span class=\"token operator\">%</span>run <span class=\"token operator\">-</span>e <span class=\"token string\">'examples/test_imshow.py'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<ul>\n<li>点击图像后在命令行显示光标处信息的例子</li>\n</ul>\n<p>命令行脚本: <a\nhref=\"examples/test_imshow_click.py\">examples/test_imshow_click.py</a>\n(jupyter 中无法使用)</p>\n<ul>\n<li>布局问题 <a\nhref=\"https://matplotlib.org/tutorials/intermediate/constrainedlayout_guide.html\"\nclass=\"uri\">https://matplotlib.org/tutorials/intermediate/constrainedlayout_guide.html</a></li>\n<li>绘制平行投影的3D图 <a\nhref=\"https://matplotlib.org/mpl_toolkits/mplot3d/tutorial.html\"\nclass=\"uri\">https://matplotlib.org/mpl_toolkits/mplot3d/tutorial.html</a></li>\n<li>更复杂的 3D 可转存可视化数据用其他软件或使用 Mayavi\n(http://docs.enthought.com/mayavi/mayavi)</li>\n</ul>\n<h2 id=\"sunpy-示例\">SunPy 示例</h2>\n<h3 id=\"示例文件\">示例文件</h3>\n<ul>\n<li><p>读取 fits, submap, 作图 <a\nhref=\"https://lydiazly.coding.me/python-notes/example_plothmi.html\">example_plothmi</a></p></li>\n<li><p>投影 <a\nhref=\"https://lydiazly.coding.me/python-notes/example_projection.html\">example_projection</a></p></li>\n<li><p>下载数据 <a\nhref=\"https://lydiazly.coding.me/python-notes/fido.html\">fido</a>, <a\nhref=\"https://lydiazly.coding.me/python-notes/jsoc.html\">jsoc</a></p></li>\n</ul>\n<p>注意: 这些例子只是提供一个使用参考, 不一定是最优的.</p>\n<h3 id=\"示例中的-fits-读取方法\">示例中的 fits 读取方法</h3>\n<p>更多 FITS 的读取方法参见 <a href=\"main.html#FITS-文件读取\">Python\n简易教程#FITS-文件读取</a><br> 另见 <a\nhref=\"http://docs.astropy.org/en/stable/io/fits/usage/scripts.html\">Astropy\n的命令行工具</a></p>\n<p>读取<code>HMIMap</code> 的例子:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># 导入 `sunpy.map` 的时间会略有点长</span>\n<span class=\"token keyword\">import</span> sunpy<span class=\"token punctuation\">.</span><span class=\"token builtin\">map</span>\nsmap <span class=\"token operator\">=</span> sunpy<span class=\"token punctuation\">.</span><span class=\"token builtin\">map</span><span class=\"token punctuation\">.</span>Map<span class=\"token punctuation\">(</span><span class=\"token string\">'data/hmi.B_720s.20150827_052400_TAI.field.fits'</span><span class=\"token punctuation\">)</span>\n<span class=\"token builtin\">type</span><span class=\"token punctuation\">(</span>smap<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code>sunpy.map.sources.sdo.HMIMap</code></pre>\n<p>这是 <code>GenericMap</code> 的一个子类:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token builtin\">issubclass</span><span class=\"token punctuation\">(</span>sunpy<span class=\"token punctuation\">.</span><span class=\"token builtin\">map</span><span class=\"token punctuation\">.</span>sources<span class=\"token punctuation\">.</span>sdo<span class=\"token punctuation\">.</span>HMIMap<span class=\"token punctuation\">,</span> sunpy<span class=\"token punctuation\">.</span><span class=\"token builtin\">map</span><span class=\"token punctuation\">.</span>mapbase<span class=\"token punctuation\">.</span>GenericMap<span class=\"token punctuation\">)</span>\n<span class=\"token boolean\">True</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>True</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">smap<span class=\"token punctuation\">.</span>meta  <span class=\"token comment\"># headers</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token builtin\">type</span><span class=\"token punctuation\">(</span>smap<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 索引从 0 开始</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>numpy.ndarray</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">smap<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>shape  <span class=\"token comment\"># (dimy, dimx)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>(4096, 4096)</code></pre>\n<p><code>smap.data[i, j]</code> 中的 i 为 Y 轴, 单位为 pixel:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> matplotlib<span class=\"token punctuation\">.</span>pyplot <span class=\"token keyword\">as</span> plt\nplt<span class=\"token punctuation\">.</span>imshow<span class=\"token punctuation\">(</span>smap<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">:</span><span class=\"token number\">2000</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> origin<span class=\"token operator\">=</span><span class=\"token string\">'lower'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nplt<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<figure>\n<img src=\"/advance/advance_205_0.png\" alt=\"png\" />\n<figcaption aria-hidden=\"true\">png</figcaption>\n</figure>\n<h3 id=\"关于-scaled-image-data\">关于 Scaled Image Data</h3>\n<p>这一部分将更仔细地检查 Astropy 对示例中的 FITS 文件的处理.</p>\n<p>参见 <a\nhref=\"http://docs.astropy.org/en/stable/io/fits/usage/image.html#scaled-data\"\nclass=\"uri\">http://docs.astropy.org/en/stable/io/fits/usage/image.html#scaled-data</a></p>\n<blockquote>\n<p>Images are scaled only when either of the BSCALE/BZERO keywords are\npresent in the header and either of their values is not the default\nvalue (BSCALE=1, BZERO=0).</p>\n</blockquote>\n<p>由于 <code>astropy.io.fits</code> 的特性, 读取 'Scaled Image Data'\n时, 调用 <code>.data</code> 将自动对数据进行缩放: <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">physical value <span class=\"token operator\">=</span> BSCALE <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>storage value<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> BZERO<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<code>astropy.io.fits.open</code> 中使用\n<code>do_not_scale_image_data=True</code> 可禁用这一步骤.</p>\n<p>见 <a\nhref=\"http://docs.astropy.org/en/stable/io/fits/appendix/faq.html#why-is-an-image-containing-integer-data-being-converted-unexpectedly-to-floats\">astropy.io.fits\nFAQ</a></p>\n<p>数据类型:</p>\n<table>\n<thead>\n<tr class=\"header\">\n<th style=\"text-align: center;\">BITPIX</th>\n<th style=\"text-align: left;\">Numpy Data Type</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td style=\"text-align: center;\">8</td>\n<td style=\"text-align: left;\">numpy.uint8 (unsigned integer)</td>\n</tr>\n<tr class=\"even\">\n<td style=\"text-align: center;\">16</td>\n<td style=\"text-align: left;\">numpy.int16</td>\n</tr>\n<tr class=\"odd\">\n<td style=\"text-align: center;\">32</td>\n<td style=\"text-align: left;\">numpy.int32</td>\n</tr>\n<tr class=\"even\">\n<td style=\"text-align: center;\">-32</td>\n<td style=\"text-align: left;\">numpy.float32</td>\n</tr>\n<tr class=\"odd\">\n<td style=\"text-align: center;\">-64</td>\n<td style=\"text-align: left;\">numpy.float64</td>\n</tr>\n</tbody>\n</table>\n<p>可以使用 Astropy 的命令行工具在 shell 中查看信息:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">fname <span class=\"token operator\">=</span> <span class=\"token string\">'data/hmi.B_720s.20150827_052400_TAI.field.fits'</span>\n!fitsinfo <span class=\"token punctuation\">&#123;</span>fname<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>Filename: data/hmi.B_720s.20150827_052400_TAI.field.fits\nNo.    Name      Ver    Type      Cards   Dimensions   Format\n  0  PRIMARY       1 PrimaryHDU       6   ()      \n  1                1 CompImageHDU    155   (4096, 4096)   int32   </code></pre>\n<p>可以看到该文件存储的数据类型是整形.</p>\n<p>用命令行工具查看关键字 'BITPIX':</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">!fitsheader <span class=\"token operator\">-</span>e <span class=\"token number\">1</span> <span class=\"token operator\">-</span><span class=\"token operator\">-</span>keyword BITPIX <span class=\"token punctuation\">&#123;</span>fname<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code># HDU 1 in data/hmi.B_720s.20150827_052400_TAI.field.fits:\nBITPIX  =                   32 / data type of original image                    </code></pre>\n<p>使用 <code>astropy.io.fits</code>:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> astropy<span class=\"token punctuation\">.</span>io <span class=\"token keyword\">import</span> fits\nhdulist <span class=\"token operator\">=</span> fits<span class=\"token punctuation\">.</span><span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span>fname<span class=\"token punctuation\">)</span>\nhdu <span class=\"token operator\">=</span> hdulist<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">hdu<span class=\"token punctuation\">.</span>header<span class=\"token punctuation\">[</span><span class=\"token string\">'BITPIX'</span><span class=\"token punctuation\">]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>32</code></pre>\n<p>'BSCALE' 不为零则为 'scaled':</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">hdu<span class=\"token punctuation\">.</span>header<span class=\"token punctuation\">[</span><span class=\"token string\">'BSCALE'</span><span class=\"token punctuation\">]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>0.01</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">hdu<span class=\"token punctuation\">.</span>header<span class=\"token punctuation\">[</span><span class=\"token string\">'BZERO'</span><span class=\"token punctuation\">]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>0.0</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">hdulist<span class=\"token punctuation\">.</span>verify<span class=\"token punctuation\">(</span><span class=\"token string\">'silentfix+warn'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 调用 `.data` 时如果出错, 需要先进行这一步修复</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">hdu<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>dtype  <span class=\"token comment\"># 已自动变换为 'physical value', 同时 `.header` 将被修改</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>dtype(&#39;float64&#39;)</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">hdu<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">[</span><span class=\"token number\">1000</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>142.83</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">hdu<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># -2147483648 被转为 nan</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>nan</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">hdu<span class=\"token punctuation\">.</span>header<span class=\"token punctuation\">[</span><span class=\"token string\">'BITPIX'</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># 值被改变了. 同时 'BSCALE', 'BZERO' 被删除</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>-64</code></pre>\n<p>手动 scale:</p>\n<p>'BSCALE' 虽然之前已被删除, 但值仍存储在 <code>._orig_bscale</code>\n中. <code>.scale</code> 将使用这个值.</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">hdu<span class=\"token punctuation\">.</span>scale<span class=\"token punctuation\">(</span><span class=\"token string\">'int32'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 在此之后 `.data` 将变换回 'storage value'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">hdu<span class=\"token punctuation\">.</span>_orig_bscale<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>0.01</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">hdu<span class=\"token punctuation\">.</span>_orig_bzero<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>0</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">hdu<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">[</span><span class=\"token number\">1000</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>14283</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">hdu<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># nan 被转为 -2147483648</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>-2147483648</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">hdu<span class=\"token punctuation\">.</span>header<span class=\"token punctuation\">[</span><span class=\"token string\">'BITPIX'</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># 值再次被改变了</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>32</code></pre>\n<p>使用 SunPy 处理时, 'BITPIX', 'BSCALE', 'BZERO' 的值被保留,\n<code>.data</code> 仍进行了 scale 的过程.</p>\n<p>针对不同文件, 如果 SunPy 的程序内部使用 <code>astropy.io.fits</code>\n处理文件时调用了 <code>.data</code> 再返回 header, 即\n<code>astropy.io.fits</code> 已经如上所述改变了 header, 那么 SunPy\n所返回的 header 中 'BITPIX', 'BSCALE', 'BZERO' 可能已经被改变.</p>\n<p>下面的例子中得到的 header 是最初的值:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> sunpy<span class=\"token punctuation\">.</span><span class=\"token builtin\">map</span>\nsmap <span class=\"token operator\">=</span> sunpy<span class=\"token punctuation\">.</span><span class=\"token builtin\">map</span><span class=\"token punctuation\">.</span>Map<span class=\"token punctuation\">(</span><span class=\"token string\">'data/hmi.B_720s.20150827_052400_TAI.field.fits'</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">smap<span class=\"token punctuation\">.</span>meta<span class=\"token punctuation\">[</span><span class=\"token string\">'BITPIX'</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># 得到的是未被改变的 header</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>32</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">smap<span class=\"token punctuation\">.</span>meta<span class=\"token punctuation\">[</span><span class=\"token string\">'BSCALE'</span><span class=\"token punctuation\">]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>0.01</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">smap<span class=\"token punctuation\">.</span>meta<span class=\"token punctuation\">[</span><span class=\"token string\">'BZERO'</span><span class=\"token punctuation\">]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>0.0</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">smap<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">[</span><span class=\"token number\">1000</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># 这一步并不改变 `.meta` 的值</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>142.83</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">smap<span class=\"token punctuation\">.</span>meta<span class=\"token punctuation\">[</span><span class=\"token string\">'BITPIX'</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># 不变</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>32</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">smap<span class=\"token punctuation\">.</span>meta<span class=\"token punctuation\">[</span><span class=\"token string\">'BSCALE'</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># 不变</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>0.01</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">smap<span class=\"token punctuation\">.</span>meta<span class=\"token punctuation\">[</span><span class=\"token string\">'BZERO'</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># 不变</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>0.0</code></pre>\n<h3 id=\"坐标和单位\">坐标和单位</h3>\n<p><strong>SunPy map</strong> <a\nhref=\"http://docs.sunpy.org/en/stable/code_ref/map.html#using-map-objects\"\nclass=\"uri\">http://docs.sunpy.org/en/stable/code_ref/map.html#using-map-objects</a>\n&gt;A number of the <strong>properties</strong> of this class are\nreturned as <strong>two-value named tuples</strong> that can either be -\nindexed by\nposition: <strong><font color=blue>[0]</font>, <font color=blue>[1]</font></strong>\n- be accessed by the names: - pixel\naxes: <strong><font color=blue>.x</font>, <font color=blue>.y</font></strong><br>\nx and y refer to the FITS axes (x for columns y for rows) - spatial\naxes: <strong><font color=blue>.axis1</font>, <font color=blue>.axis2</font></strong><br>\naxis1 corresponds to the coordinate axis for x and axis2 corresponds to\ny.</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">smap<span class=\"token punctuation\">.</span>dimensions<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>PixelPair(x=&lt;Quantity 4096. pix&gt;, y=&lt;Quantity 4096. pix&gt;)</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">smap<span class=\"token punctuation\">.</span>dimensions<span class=\"token punctuation\">.</span>x  <span class=\"token comment\"># 得到一个 `astropy.units.quantity.Quantity`, 包含 value 和 unit</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>(4096 ; )</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">smap<span class=\"token punctuation\">.</span>dimensions<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">.</span>unit<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>()</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">smap<span class=\"token punctuation\">.</span>dimensions<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">.</span>value<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>4096.0</code></pre>\n<p><code>astropy.units</code> 的使用方法:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> astropy<span class=\"token punctuation\">.</span>units <span class=\"token keyword\">as</span> u<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">u<span class=\"token punctuation\">.</span>AA<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>()</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token number\">4096</span> <span class=\"token operator\">*</span> u<span class=\"token punctuation\">.</span>pix  <span class=\"token comment\"># same as `u.pixel`</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>(4096 ; )</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token punctuation\">(</span><span class=\"token number\">4096</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4096</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> u<span class=\"token punctuation\">.</span>pix  <span class=\"token comment\"># 注意这里是 `astropy.units` 的运算, 和 list 运算规则不同</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>([4096,~4096] ; )</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">smap<span class=\"token punctuation\">.</span>dimensions<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">.</span>unit <span class=\"token keyword\">is</span> u<span class=\"token punctuation\">.</span>pix  <span class=\"token comment\"># 说明 x 是单位是 u.pix</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>True</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token builtin\">type</span><span class=\"token punctuation\">(</span>smap<span class=\"token punctuation\">.</span>center<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>/home/lydia/miniconda3/lib/python3.6/site-packages/sunpy/map/mapbase.py:669: Warning: Missing metadata for heliographic longitude: assuming longitude of 0 degrees\n  lon=self.heliographic_longitude,\n\n\n\n\n\nastropy.coordinates.sky_coordinate.SkyCoord</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> u<span class=\"token punctuation\">.</span>pix<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>[&lt;Quantity 0. pix&gt;, &lt;Quantity 0. pix&gt;]</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">smap<span class=\"token punctuation\">.</span>pixel_to_world<span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token number\">4096</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4096</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> u<span class=\"token punctuation\">.</span>pix<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>&lt;SkyCoord (Helioprojective: obstime=2015-08-27 05:22:21.800000, rsun=696000000.0 m, observer=&lt;HeliographicStonyhurst Coordinate (obstime=2015-08-27 05:22:21.800000): (lon, lat, radius) in (deg, deg, m)\n    (0., 7.089004, 1.51196988e+11)&gt;): (Tx, Ty) in arcsec\n    (-1040.36199634, -1030.86554911)&gt;</code></pre>\n<p>查看 <code>SkyCoord</code> 的帮助:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> astropy<span class=\"token punctuation\">.</span>coordinates\n<span class=\"token builtin\">help</span><span class=\"token punctuation\">(</span>astropy<span class=\"token punctuation\">.</span>coordinates<span class=\"token punctuation\">.</span>sky_coordinate<span class=\"token punctuation\">.</span>SkyCoord<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">smap<span class=\"token punctuation\">.</span>center<span class=\"token punctuation\">.</span>Tx<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>()</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">smap<span class=\"token punctuation\">.</span>pixel_to_world<span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token number\">2000</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2000</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> u<span class=\"token punctuation\">.</span>pix<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>&lt;SkyCoord (Helioprojective: obstime=2015-08-27 05:22:21.800000, rsun=696000000.0 m, observer=&lt;HeliographicStonyhurst Coordinate (obstime=2015-08-27 05:22:21.800000): (lon, lat, radius) in (deg, deg, m)\n    (0., 7.089004, 1.51196988e+11)&gt;): (Tx, Ty) in arcsec\n    (16.55031204, 26.53575639)&gt;</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">smap<span class=\"token punctuation\">.</span>pixel_to_world<span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token number\">2000</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2000</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> u<span class=\"token punctuation\">.</span>pix<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>transform_to<span class=\"token punctuation\">(</span><span class=\"token string\">'heliographic_stonyhurst'</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>&lt;SkyCoord (HeliographicStonyhurst: obstime=2015-08-27 05:22:21.800000): (lon, lat, radius) in (deg, deg, km)\n    (1.00568591, 8.68202918, 696000.0000022)&gt;</code></pre>\n<p>查看坐标信息:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">smap<span class=\"token punctuation\">.</span>coordinate_frame<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>/home/lydia/miniconda3/lib/python3.6/site-packages/sunpy/map/mapbase.py:669: Warning: Missing metadata for heliographic longitude: assuming longitude of 0 degrees\n  lon=self.heliographic_longitude,\n\n\n\n\n\n&lt;Helioprojective Frame (obstime=2015-08-27 05:22:21.800000, rsun=696000000.0 m, observer=&lt;HeliographicStonyhurst Coordinate (obstime=2015-08-27 05:22:21.800000): (lon, lat, radius) in (deg, deg, m)\n    (0., 7.089004, 1.51196988e+11)&gt;)&gt;</code></pre>\n<p>出现这个 Warning 时:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">smap<span class=\"token punctuation\">.</span>meta<span class=\"token punctuation\">[</span><span class=\"token string\">'hgln_obs'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0.</span><span class=\"token punctuation\">;</span> smap<span class=\"token punctuation\">.</span>meta<span class=\"token punctuation\">[</span><span class=\"token string\">'hgln_obs'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0.</span><span class=\"token punctuation\">;</span> smap<span class=\"token punctuation\">.</span>meta<span class=\"token punctuation\">[</span><span class=\"token string\">'hgln_obs'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0.</span>\nsmap<span class=\"token punctuation\">.</span>coordinate_frame<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>&lt;Helioprojective Frame (obstime=2015-08-27 05:22:21.800000, rsun=696000000.0 m, observer=&lt;HeliographicStonyhurst Coordinate (obstime=2015-08-27 05:22:21.800000): (lon, lat, radius) in (deg, deg, m)\n    (0., 7.089004, 1.51196988e+11)&gt;)&gt;</code></pre>\n<h3 id=\"语法对比\">语法对比</h3>\n<p>比较 <code>plothmi.py</code> 与对应 IDL 程序的语法:</p>\n<p>下面的语句中, 为了简便和方便对比, 使用了自定义的一些函数. 导入方法:\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> usr_sunpy <span class=\"token keyword\">import</span> read_sdo<span class=\"token punctuation\">,</span> plot_map<span class=\"token punctuation\">,</span> plot_vmap<span class=\"token punctuation\">,</span> image_to_helio<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p>读取数据 <pre class=\"line-numbers language-idl\" data-language=\"idl\"><code class=\"language-idl\">; IDL\nread_sdo,&lt;fname&gt;,index,data\nindex2map,index,data,mapa<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre> <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># Python</span>\n<span class=\"token comment\"># 为简化过程而自定义的函数, 读入时打印文件名和数组大小</span>\nmapa <span class=\"token operator\">=</span> read_sdo<span class=\"token punctuation\">(</span><span class=\"token operator\">&lt;</span>fname<span class=\"token operator\">></span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre></p>\n<p>旋转 <pre class=\"line-numbers language-idl\" data-language=\"idl\"><code class=\"language-idl\">; IDL\n; 2 表示180°\nmapbx.data &#x3D; rotate(mapbx,2)\nmapby.data &#x3D; rotate(mapbx,2)\nmapbz.data &#x3D; rotate(mapbx,2)<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre> <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># Python</span>\n<span class=\"token comment\"># 利用 'crota2' 的值确定角度</span>\nmapbx <span class=\"token operator\">=</span> mapbx<span class=\"token punctuation\">.</span>rotate<span class=\"token punctuation\">(</span>order<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\nmapby <span class=\"token operator\">=</span> mapby<span class=\"token punctuation\">.</span>rotate<span class=\"token punctuation\">(</span>order<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\nmapbz <span class=\"token operator\">=</span> mapbz<span class=\"token punctuation\">.</span>rotate<span class=\"token punctuation\">(</span>order<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>截取 <pre class=\"line-numbers language-idl\" data-language=\"idl\"><code class=\"language-idl\">; IDL\nsub_map,mapbx,smapbx,xrange&#x3D;[500,800.0],yrange&#x3D;[-500,-100.0]\nsub_map,mapby,smapby,ref_map&#x3D;smapbx\nsub_map,mapbz,smapbz,ref_map&#x3D;smapbx<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre> <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># Python</span>\n<span class=\"token comment\"># 左下到右上</span>\nbl <span class=\"token operator\">=</span> SkyCoord<span class=\"token punctuation\">(</span><span class=\"token number\">500</span><span class=\"token operator\">*</span>u<span class=\"token punctuation\">.</span>arcsec<span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">500</span><span class=\"token operator\">*</span>u<span class=\"token punctuation\">.</span>arcsec<span class=\"token punctuation\">,</span> frame<span class=\"token operator\">=</span>mapbz<span class=\"token punctuation\">.</span>coordinate_frame<span class=\"token punctuation\">)</span>\ntr <span class=\"token operator\">=</span> SkyCoord<span class=\"token punctuation\">(</span><span class=\"token number\">800</span><span class=\"token operator\">*</span>u<span class=\"token punctuation\">.</span>arcsec<span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">100.</span><span class=\"token operator\">*</span>u<span class=\"token punctuation\">.</span>arcsec<span class=\"token punctuation\">,</span> frame<span class=\"token operator\">=</span>mapbz<span class=\"token punctuation\">.</span>coordinate_frame<span class=\"token punctuation\">)</span>\nsmapbx <span class=\"token operator\">=</span> mapbx<span class=\"token punctuation\">.</span>submap<span class=\"token punctuation\">(</span>bl<span class=\"token punctuation\">,</span> tr<span class=\"token punctuation\">)</span>\nsmapby <span class=\"token operator\">=</span> mapby<span class=\"token punctuation\">.</span>submap<span class=\"token punctuation\">(</span>bl<span class=\"token punctuation\">,</span> tr<span class=\"token punctuation\">)</span>\nsmapbz <span class=\"token operator\">=</span> mapbz<span class=\"token punctuation\">.</span>submap<span class=\"token punctuation\">(</span>bl<span class=\"token punctuation\">,</span> tr<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>绘图 <pre class=\"line-numbers language-idl\" data-language=\"idl\"><code class=\"language-idl\">; IDL\nplot_map,smapbz,dmax&#x3D;2000,dmin&#x3D;-2000,color&#x3D;0,charsize&#x3D;1.8,...\nplot_vmap,&#x2F;over,smapbx,smapby,mapbz&#x3D;smapbz,limit&#x3D;180,scale&#x3D;0.012,iskip&#x3D;15,jskip&#x3D;15,...<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre> <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># Python</span>\n<span class=\"token comment\"># 主要调用的是 matplotlib</span>\nfig <span class=\"token operator\">=</span> plt<span class=\"token punctuation\">.</span>figure<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nax <span class=\"token operator\">=</span> fig<span class=\"token punctuation\">.</span>add_subplot<span class=\"token punctuation\">(</span><span class=\"token number\">111</span><span class=\"token punctuation\">,</span> projection<span class=\"token operator\">=</span>smapbz<span class=\"token punctuation\">)</span> <span class=\"token comment\"># 使用 smapbz 中定义的坐标系统</span>\nplot_map<span class=\"token punctuation\">(</span>ax<span class=\"token punctuation\">,</span> smapbz<span class=\"token punctuation\">)</span>\nplot_vmap<span class=\"token punctuation\">(</span>ax<span class=\"token punctuation\">,</span> smapbx<span class=\"token punctuation\">,</span> smapby<span class=\"token punctuation\">,</span> smapbz<span class=\"token punctuation\">,</span> iskip<span class=\"token operator\">=</span>iskip<span class=\"token punctuation\">,</span> jskip<span class=\"token operator\">=</span>jskip<span class=\"token punctuation\">,</span> cmin<span class=\"token operator\">=</span><span class=\"token number\">100.</span><span class=\"token punctuation\">,</span> vmax<span class=\"token operator\">=</span><span class=\"token number\">500.</span><span class=\"token punctuation\">,</span> cmap<span class=\"token operator\">=</span><span class=\"token string\">'binary'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>坐标变换 <pre class=\"line-numbers language-idl\" data-language=\"idl\"><code class=\"language-idl\">; IDL\n; magnetic_modeling_codes&#x2F;...&#x2F;05projection_modified_version.pro<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre> <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># Python</span>\n<span class=\"token comment\"># `image_to_helio`(变换为 Helioprojective(Cartesian) system)</span>\n<span class=\"token comment\"># 调用自定义的旋转矩阵函数 `proj_matrix`, 参考文献与原IDL程序相同</span>\nhx<span class=\"token punctuation\">,</span> hy <span class=\"token operator\">=</span> image_to_helio<span class=\"token punctuation\">(</span>smapbz<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># numpy 数组</span>\nsmapbx_h<span class=\"token punctuation\">,</span> smapby_h<span class=\"token punctuation\">,</span> smapbz_h <span class=\"token operator\">=</span> image_to_helio<span class=\"token punctuation\">(</span>smapbx<span class=\"token punctuation\">,</span> smapby<span class=\"token punctuation\">,</span> smapbz<span class=\"token punctuation\">)</span> <span class=\"token comment\"># sunpy `Map`</span>\n\nplot_map<span class=\"token punctuation\">(</span>ax<span class=\"token punctuation\">,</span> smapbz_h<span class=\"token punctuation\">,</span> coords<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>hx<span class=\"token punctuation\">,</span> hy<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nplot_vmap<span class=\"token punctuation\">(</span>ax<span class=\"token punctuation\">,</span> smapbx_h<span class=\"token punctuation\">,</span> smapby_h<span class=\"token punctuation\">,</span> smapbz_h<span class=\"token punctuation\">,</span> coords<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>hx<span class=\"token punctuation\">,</span> hy<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<h2 id=\"插值-拟合\">插值, 拟合</h2>\n<p>选择不限于这里列举的包, 以后也可能会有更合适的方法出现.</p>\n<p>相关安装见 <a href=\"installpy.html#其他\">Python 安装和配置</a></p>\n<h3 id=\"插值\">插值</h3>\n<ul>\n<li><p>numpy <pre class=\"line-numbers language-none\"><code class=\"language-none\">f &#x3D; interp1d(x, y, kind&#x3D;&#39;cubic&#39;[, fill_value&#x3D;&#39;extrapolate&#39;])\nx2 &#x3D; np.linspace(...)\ny2 &#x3D; f(x2)<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre> 见 <a\nhref=\"examples/test_plot.py\">examples/test_plot.py</a></p></li>\n<li><p>scipy <a\nhref=\"https://docs.scipy.org/doc/scipy/reference/tutorial/interpolate.html\"\nclass=\"uri\">https://docs.scipy.org/doc/scipy/reference/tutorial/interpolate.html</a></p></li>\n</ul>\n<h3 id=\"求极值\">求极值</h3>\n<ul>\n<li>PeakUtils <a href=\"http://peakutils.readthedocs.io/en/latest/\"\nclass=\"uri\">http://peakutils.readthedocs.io/en/latest/</a></li>\n</ul>\n<p>官方例图\n(http://peakutils.readthedocs.io/en/latest/tutorial_a.html):</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> peakutils\nindexes <span class=\"token operator\">=</span> peakutils<span class=\"token punctuation\">.</span>indexes<span class=\"token punctuation\">(</span>y<span class=\"token punctuation\">,</span> thres<span class=\"token operator\">=</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">,</span> min_dist<span class=\"token operator\">=</span><span class=\"token number\">30</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<p><img src='/advance/tut_a_2.png' width='500' /></p>\n<p>Enhancing the resolution by interpolation: <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">peaks_x <span class=\"token operator\">=</span> peakutils<span class=\"token punctuation\">.</span>interpolate<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> ind<span class=\"token operator\">=</span>indexes<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<h3 id=\"拟合\">拟合</h3>\n<ul>\n<li>LMFIT (Non-Linear Least-Squares Minimization and Curve-Fitting)</li>\n</ul>\n<p>下载 <a href=\"https://github.com/lmfit/lmfit-py\"\nclass=\"uri\">https://github.com/lmfit/lmfit-py</a></p>\n<p>文档 <a href=\"http://lmfit.github.io/lmfit-py/\"\nclass=\"uri\">http://lmfit.github.io/lmfit-py/</a></p>\n<p>有现成模型, 也可以自定义模型.<br>\n可以方便地叠加不同拟合模型(比如多个高斯, 线性加高斯, 等等).<br> 例子见\n<a href=\"examples/lmfits.zip\">examples/lmfits</a> (来自 <a\nhref=\"http://lmfit.github.io/lmfit-py/builtin_models.html#example-1-fit-peak-data-to-gaussian-lorentzian-and-voigt-profiles\">LMFIT网站示例</a>\n)</p>\n<p>使用内置模型:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> lmfit<span class=\"token punctuation\">.</span>models <span class=\"token keyword\">import</span> GaussianModel  <span class=\"token comment\"># 内置的模型</span>\n\ndata <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>loadtxt<span class=\"token punctuation\">(</span><span class=\"token string\">'test_peak.dat'</span><span class=\"token punctuation\">)</span>\nx <span class=\"token operator\">=</span> data<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\ny <span class=\"token operator\">=</span> data<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span>\n\nmod <span class=\"token operator\">=</span> GaussianModel<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 实例化一个模型</span>\npars <span class=\"token operator\">=</span> mod<span class=\"token punctuation\">.</span>guess<span class=\"token punctuation\">(</span>y<span class=\"token punctuation\">,</span> x<span class=\"token operator\">=</span>x<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 给初值</span>\nout <span class=\"token operator\">=</span> mod<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>y<span class=\"token punctuation\">,</span> pars<span class=\"token punctuation\">,</span> x<span class=\"token operator\">=</span>x<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 拟合结果</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>out<span class=\"token punctuation\">.</span>fit_report<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 拟合结果的详细信息</span>\nplt<span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> out<span class=\"token punctuation\">.</span>init_fit<span class=\"token punctuation\">,</span> <span class=\"token string\">'k--'</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> out<span class=\"token punctuation\">.</span>best_fit<span class=\"token punctuation\">,</span> <span class=\"token string\">'r-'</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">%</span>matplotlib inline\n<span class=\"token operator\">%</span>run examples<span class=\"token operator\">/</span>lmfits<span class=\"token operator\">/</span>fit_peak<span class=\"token punctuation\">.</span>py<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>[[Model]]\n    Model(voigt)\n[[Fit Statistics]]\n    # fitting method   = leastsq\n    # function evals   = 21\n    # data points      = 401\n    # variables        = 4\n    chi-square         = 10.9301767\n    reduced chi-square = 0.02753193\n    Akaike info crit   = -1436.57602\n    Bayesian info crit = -1420.60017\n[[Variables]]\n    sigma:      0.89518909 +/- 0.01415450 (1.58%) (init = 0.8775)\n    center:     9.24374847 +/- 0.00441903 (0.05%) (init = 9.25)\n    amplitude:  34.1914737 +/- 0.17946860 (0.52%) (init = 65.43358)\n    gamma:      0.52540198 +/- 0.01857955 (3.54%) (init = 0.7)\n    fwhm:       3.22385343 +/- 0.05097475 (1.58%) == &#39;3.6013100*sigma&#39;\n    height:     10.0872204 +/- 0.03482130 (0.35%) == &#39;amplitude*wofz((1j*gamma)/(sigma*sqrt(2))).real/(sigma*sqrt(2*pi))&#39;\n[[Correlations]] (unreported correlations are &lt; 0.100)\n    C(sigma, gamma)     = -0.928\n    C(amplitude, gamma) =  0.821\n    C(sigma, amplitude) = -0.651</code></pre>\n<figure>\n<img src=\"/advance/advance_279_1.png\" alt=\"png\" />\n<figcaption aria-hidden=\"true\">png</figcaption>\n</figure>\n<p>多个模型叠加:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> lmfit<span class=\"token punctuation\">.</span>models <span class=\"token keyword\">import</span> ExponentialModel<span class=\"token punctuation\">,</span> GaussianModel\n\ndata <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>loadtxt<span class=\"token punctuation\">(</span><span class=\"token string\">'NIST_Gauss2.dat'</span><span class=\"token punctuation\">)</span>\nx <span class=\"token operator\">=</span> data<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\ny <span class=\"token operator\">=</span> data<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span>\n\nexp_mod <span class=\"token operator\">=</span> ExponentialModel<span class=\"token punctuation\">(</span>prefix<span class=\"token operator\">=</span><span class=\"token string\">'exp_'</span><span class=\"token punctuation\">)</span>\ngauss1 <span class=\"token operator\">=</span> GaussianModel<span class=\"token punctuation\">(</span>prefix<span class=\"token operator\">=</span><span class=\"token string\">'g1_'</span><span class=\"token punctuation\">)</span>\ngauss2 <span class=\"token operator\">=</span> GaussianModel<span class=\"token punctuation\">(</span>prefix<span class=\"token operator\">=</span><span class=\"token string\">'g2_'</span><span class=\"token punctuation\">)</span>\n\npars1 <span class=\"token operator\">=</span> exp_mod<span class=\"token punctuation\">.</span>guess<span class=\"token punctuation\">(</span>y<span class=\"token punctuation\">,</span> x<span class=\"token operator\">=</span>x<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 分段设参数的方法见下面的脚本文件</span>\npars2 <span class=\"token operator\">=</span> gauss1<span class=\"token punctuation\">.</span>guess<span class=\"token punctuation\">(</span>y<span class=\"token punctuation\">,</span> x<span class=\"token operator\">=</span>x<span class=\"token punctuation\">)</span>\npars3 <span class=\"token operator\">=</span> gauss2<span class=\"token punctuation\">.</span>guess<span class=\"token punctuation\">(</span>y<span class=\"token punctuation\">,</span> x<span class=\"token operator\">=</span>x<span class=\"token punctuation\">)</span>\n\npars <span class=\"token operator\">=</span> pars1 <span class=\"token operator\">+</span> pars2 <span class=\"token operator\">+</span> pars3  <span class=\"token comment\"># 叠加参数</span>\nmod <span class=\"token operator\">=</span> gauss1 <span class=\"token operator\">+</span> gauss2 <span class=\"token operator\">+</span> exp_mod  <span class=\"token comment\"># 叠加模型</span>\n\nout <span class=\"token operator\">=</span> mod<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>y<span class=\"token punctuation\">,</span> pars<span class=\"token punctuation\">,</span> x<span class=\"token operator\">=</span>x<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>out<span class=\"token punctuation\">.</span>fit_report<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> <span class=\"token string\">'b'</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> out<span class=\"token punctuation\">.</span>init_fit<span class=\"token punctuation\">,</span> <span class=\"token string\">'k--'</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> out<span class=\"token punctuation\">.</span>best_fit<span class=\"token punctuation\">,</span> <span class=\"token string\">'r-'</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">%</span><span class=\"token operator\">%</span>capture output\n<span class=\"token operator\">%</span>matplotlib inline\n<span class=\"token operator\">%</span>run examples<span class=\"token operator\">/</span>lmfits<span class=\"token operator\">/</span>fit_peaks<span class=\"token punctuation\">.</span>py<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">output<span class=\"token punctuation\">.</span>outputs<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<figure>\n<img src=\"/advance/advance_283_0.png\" alt=\"png\" />\n<figcaption aria-hidden=\"true\">png</figcaption>\n</figure>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">%</span><span class=\"token operator\">%</span>capture output\n<span class=\"token operator\">%</span>matplotlib inline\n<span class=\"token operator\">%</span>run examples<span class=\"token operator\">/</span>lmfits<span class=\"token operator\">/</span>fit_peaks_components<span class=\"token punctuation\">.</span>py<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">output<span class=\"token punctuation\">.</span>outputs<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<figure>\n<img src=\"/advance/advance_285_0.png\" alt=\"png\" />\n<figcaption aria-hidden=\"true\">png</figcaption>\n</figure>\n<p>自定义模型的方法见 <a\nhref=\"http://lmfit.github.io/lmfit-py/builtin_models.html#user-defined-models\">LMFIT网站示例</a></p>\n<h3 id=\"其他\">其他</h3>\n<ul>\n<li>Sherpa(Modeling and Fitting) <a\nhref=\"http://cxc.cfa.harvard.edu/contrib/sherpa/\"\nclass=\"uri\">http://cxc.cfa.harvard.edu/contrib/sherpa/</a><br></li>\n<li>2-D Fitting in Sherpa <a\nhref=\"https://python4astronomers.github.io/fitting/image.html\"\nclass=\"uri\">https://python4astronomers.github.io/fitting/image.html</a><br></li>\n<li><em>etc.</em></li>\n</ul>\n<h2 id=\"copy-注意事项\">copy 注意事项</h2>\n<p><strong>\"shallow copy\"</strong> vs <strong>\"deep copy\"</strong></p>\n<ul>\n<li>对于 list 的情况</li>\n</ul>\n<p>演示插件 <a href=\"https://github.com/lgpage/nbtutor\"\nclass=\"uri\">https://github.com/lgpage/nbtutor</a></p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">%</span><span class=\"token operator\">%</span>nbtutor <span class=\"token operator\">-</span>r <span class=\"token operator\">-</span>f <span class=\"token operator\">-</span>i\n<span class=\"token keyword\">from</span> copy <span class=\"token keyword\">import</span> deepcopy\na <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span>\nb <span class=\"token operator\">=</span> a\nc <span class=\"token operator\">=</span> deepcopy<span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span>\nd <span class=\"token operator\">=</span> a<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span> <span class=\"token comment\"># 列表的切片是深拷贝</span>\nb<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span>\nc<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span>\nd<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">id</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">id</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">id</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">id</span><span class=\"token punctuation\">(</span>d<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>23284866388232 23284866388232 23284855519880 23284856061064</code></pre>\n<p><a href=\"http://t.cn/RgK1OHf\">网页版演示</a></p>\n<p><img src='/advance/nbtutor3.png' width='550'/></p>\n<ul>\n<li>对于 dict 的情况</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">%</span><span class=\"token operator\">%</span>nbtutor <span class=\"token operator\">-</span>r <span class=\"token operator\">-</span>f <span class=\"token operator\">-</span>i\n<span class=\"token keyword\">from</span> copy <span class=\"token keyword\">import</span> deepcopy\na <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token number\">1</span><span class=\"token punctuation\">:</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">:</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">:</span><span class=\"token number\">3</span><span class=\"token punctuation\">&#125;</span>\nb <span class=\"token operator\">=</span> a\nc <span class=\"token operator\">=</span> a<span class=\"token punctuation\">.</span>copy<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 深拷贝</span>\nd <span class=\"token operator\">=</span> deepcopy<span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span>\nb<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span>\nc<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span>\nd<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">id</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">id</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">id</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">id</span><span class=\"token punctuation\">(</span>d<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>22492371132064 22492371132064 22492397510376 22492397507280</code></pre>\n<p><a href=\"http://t.cn/RgKrHOx\">网页版演示</a></p>\n<p><img src='/advance/nbtutor4.png' width='550'/></p>\n<ul>\n<li>对于 set 的情况</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">%</span><span class=\"token operator\">%</span>nbtutor <span class=\"token operator\">-</span>r <span class=\"token operator\">-</span>f <span class=\"token operator\">-</span>i\n<span class=\"token keyword\">from</span> copy <span class=\"token keyword\">import</span> deepcopy\na <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">&#125;</span>\nb <span class=\"token operator\">=</span> a\nc <span class=\"token operator\">=</span> a<span class=\"token punctuation\">.</span>copy<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 深拷贝</span>\nd <span class=\"token operator\">=</span> deepcopy<span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span>\nb<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span>\nc<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span>\nd<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">id</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">id</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">id</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">id</span><span class=\"token punctuation\">(</span>d<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>22492476895528 22492476895528 22492476895304 22492374233384</code></pre>\n<p><a href=\"http://t.cn/RgKd3E7\">网页版演示</a></p>\n<p><img src='/advance/nbtutor5.png' width='550'/></p>\n<ul>\n<li>对于 numpy 的情况</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">%</span><span class=\"token operator\">%</span>nbtutor <span class=\"token operator\">-</span>r <span class=\"token operator\">-</span>f <span class=\"token operator\">-</span>i\n<span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np\na <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>arange<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span>\nb <span class=\"token operator\">=</span> a<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span> <span class=\"token comment\"># 浅拷贝!</span>\nc <span class=\"token operator\">=</span> a<span class=\"token punctuation\">.</span>copy<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 深拷贝, 同 deepcopy(a)</span>\nd <span class=\"token operator\">=</span> a<span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># 花式切片是深拷贝</span>\nb<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span>\nc<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span>\nd<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># id 虽各不同, 但 .__array_interface__['data'][0] 可能相同</span>\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">id</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">.</span>__array_interface__<span class=\"token punctuation\">[</span><span class=\"token string\">'data'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<pre><code>22928831926400 93879086511872\n22928831928960 93879086511872\n22928829201984 93879072448320\n22928829199344 93879078700736</code></pre>\n<p><a href=\"http://t.cn/Rg9hST6\">网页版演示</a> (<strong>Site\nError</strong>: Ruby and Python+Anaconda backends are permanently\nunavailable)</p>\n<p>参见之前的 <a href=\"#矩阵\">np.matrix, np.asmatrix</a></p>\n<h2 id=\"其他格式文件读写\">其他格式文件读写</h2>\n<h3 id=\"用-pandas-读-csv\">用 pandas 读 csv</h3>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd\ndata <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>read_csv<span class=\"token punctuation\">(</span><span class=\"token string\">\"data/data.csv\"</span><span class=\"token punctuation\">)</span>\ndata<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n<thead>\n<tr style=\"text-align: right;\">\n<th>\n</th>\n<th>\ncol1\n</th>\n<th>\ncol2\n</th>\n<th>\ncol3\n</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<th>\n0\n</th>\n<td>\nrow1\n</td>\n<td>\n1\n</td>\n<td>\n10.0\n</td>\n</tr>\n<tr>\n<th>\n1\n</th>\n<td>\nrow2\n</td>\n<td>\n2\n</td>\n<td>\n0.2\n</td>\n</tr>\n<tr>\n<th>\n2\n</th>\n<td>\nrow3\n</td>\n<td>\n3\n</td>\n<td>\n300.0\n</td>\n</tr>\n</tbody>\n</table>\n</div>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">data<span class=\"token punctuation\">.</span>columns<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>Index([&#39;col1&#39;, &#39;col2&#39;, &#39;col3&#39;], dtype=&#39;object&#39;)</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">data<span class=\"token punctuation\">.</span>col1<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>0    row1\n1    row2\n2    row3\nName: col1, dtype: object</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">data<span class=\"token punctuation\">[</span><span class=\"token string\">'col1'</span><span class=\"token punctuation\">]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>0    row1\n1    row2\n2    row3\nName: col1, dtype: object</code></pre>\n<p>只取一部分:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">data <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>read_csv<span class=\"token punctuation\">(</span><span class=\"token string\">\"data/data.csv\"</span><span class=\"token punctuation\">,</span> nrows<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> usecols<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\ndata<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n<thead>\n<tr style=\"text-align: right;\">\n<th>\n</th>\n<th>\ncol1\n</th>\n<th>\ncol3\n</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<th>\n0\n</th>\n<td>\nrow1\n</td>\n<td>\n10.0\n</td>\n</tr>\n<tr>\n<th>\n1\n</th>\n<td>\nrow2\n</td>\n<td>\n0.2\n</td>\n</tr>\n</tbody>\n</table>\n</div>\n<p>对于超大文件, 参见: <a\nhref=\"https://www.dataquest.io/blog/pandas-big-data/\"\nclass=\"uri\">https://www.dataquest.io/blog/pandas-big-data/</a></p>\n<h3 id=\"fortran-二进制文件读写\">Fortran 二进制文件读写</h3>\n<h4 id=\"unformatted-sequential\">Unformatted (sequential)</h4>\n<p>使用 <code>scipy.io.FortranFile</code><br> 参考: <a\nhref=\"https://docs.scipy.org/doc/scipy-0.15.1/reference/generated/scipy.io.FortranFile.read_record.html\"\nclass=\"uri\">https://docs.scipy.org/doc/scipy-0.15.1/reference/generated/scipy.io.FortranFile.read_record.html</a></p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># python (write)</span>\n<span class=\"token keyword\">from</span> scipy<span class=\"token punctuation\">.</span>io <span class=\"token keyword\">import</span> FortranFile\nvar1 <span class=\"token operator\">=</span> <span class=\"token number\">1.1</span>  <span class=\"token comment\"># '&lt;f8'</span>\nvar2 <span class=\"token operator\">=</span> <span class=\"token number\">0</span>  <span class=\"token comment\"># '&lt;i8'</span>\narr <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>arange<span class=\"token punctuation\">(</span><span class=\"token number\">6.</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># '(2, 3)&lt;f8'</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>var1<span class=\"token punctuation\">,</span> var2<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>arr<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f'arr[0, 1] = </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>arr<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">'</span></span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 多行存入</span>\n<span class=\"token keyword\">with</span> FortranFile<span class=\"token punctuation\">(</span><span class=\"token string\">'data/data_fortran1-1.dat'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'w'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span>\n    f<span class=\"token punctuation\">.</span>write_record<span class=\"token punctuation\">(</span>var1<span class=\"token punctuation\">)</span>\n    f<span class=\"token punctuation\">.</span>write_record<span class=\"token punctuation\">(</span>var2<span class=\"token punctuation\">)</span>\n    f<span class=\"token punctuation\">.</span>write_record<span class=\"token punctuation\">(</span>arr<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 单行存入</span>\n<span class=\"token keyword\">with</span> FortranFile<span class=\"token punctuation\">(</span><span class=\"token string\">'data/data_fortran1-2.dat'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'w'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span>\n    f<span class=\"token punctuation\">.</span>write_record<span class=\"token punctuation\">(</span>var1<span class=\"token punctuation\">,</span> var2<span class=\"token punctuation\">,</span> arr<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code>1.1 0\n[[0. 1. 2.]\n [3. 4. 5.]]\narr[0, 1] = 1.0</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># python (read)</span>\n<span class=\"token keyword\">from</span> scipy<span class=\"token punctuation\">.</span>io <span class=\"token keyword\">import</span> FortranFile\n<span class=\"token comment\"># 多行存入的情况</span>\n<span class=\"token keyword\">with</span> FortranFile<span class=\"token punctuation\">(</span><span class=\"token string\">'data/data_fortran1-1.dat'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'r'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span>\n    var1 <span class=\"token operator\">=</span> <span class=\"token builtin\">float</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">.</span>read_record<span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;f8'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    var2 <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">.</span>read_record<span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;i8'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 注意精度(上面python存入的是默认'int64')</span>\n    arr <span class=\"token operator\">=</span> f<span class=\"token punctuation\">.</span>read_record<span class=\"token punctuation\">(</span><span class=\"token string\">'(2, 3)&lt;f8'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'data_fortran1-1.dat'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>var1<span class=\"token punctuation\">,</span> var2<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>arr<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 单行存入的情况</span>\n<span class=\"token keyword\">with</span> FortranFile<span class=\"token punctuation\">(</span><span class=\"token string\">'data/data_fortran1-2.dat'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'r'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span>\n<span class=\"token comment\">#     data = f.read_record('&lt;f8, &lt;i8, (2, 3)&lt;f8')  # 不指定名称</span>\n    data <span class=\"token operator\">=</span> f<span class=\"token punctuation\">.</span>read_record<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token string\">'var1'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'&lt;f8'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'var2'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'&lt;i8'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                         <span class=\"token punctuation\">(</span><span class=\"token string\">'arr'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'(2, 3)&lt;f8'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 指定名称: (name, dtype)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\ndata_fortran1-2.dat'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f'keys = </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>data<span class=\"token punctuation\">.</span>dtype<span class=\"token punctuation\">.</span>names<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">'</span></span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 如读取时未指定名称则为 ['f0', 'f1', ...]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">float</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">[</span><span class=\"token string\">'var1'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">[</span><span class=\"token string\">'var2'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">[</span><span class=\"token string\">'arr'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code>data_fortran1-1.dat\n1.1 0\n[[0. 1. 2.]\n [3. 4. 5.]]\n\ndata_fortran1-2.dat\nkeys = (&#39;var1&#39;, &#39;var2&#39;, &#39;arr&#39;)\n1.1 0\n[[[0. 1. 2.]\n  [3. 4. 5.]]]</code></pre>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">%%bash\n<span class=\"token builtin class-name\">cd</span> examples/\nifort -o test_read_seq test_read_seq.f90\n./test_read_seq<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code> data_fortran1-1.dat\n   1.1  0.0\n   0.0  1.0  2.0\n   3.0  4.0  5.0\n arr(2, 1) =   1.0\n\n data_fortran1-2.dat\n   1.1  0.0\n   0.0  1.0  2.0\n   3.0  4.0  5.0\n arr(2, 1) =   1.0</code></pre>\n<p>见 Structured arrays: <a\nhref=\"https://docs.scipy.org/doc/numpy/user/basics.rec.html\"\nclass=\"uri\">https://docs.scipy.org/doc/numpy/user/basics.rec.html</a></p>\n<h4 id=\"unformatted-stream\">Unformatted (stream)</h4>\n<p><code>struct</code> 参考 <a\nhref=\"https://docs.python.org/3/library/struct.html\"\nclass=\"uri\">https://docs.python.org/3/library/struct.html</a></p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># python (write)</span>\n<span class=\"token keyword\">import</span> struct\nvar1 <span class=\"token operator\">=</span> <span class=\"token number\">1.1</span>  <span class=\"token comment\"># '&lt;f8'</span>\nvar2 <span class=\"token operator\">=</span> <span class=\"token number\">0</span>  <span class=\"token comment\"># '&lt;i8'</span>\narr <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>arange<span class=\"token punctuation\">(</span><span class=\"token number\">6.</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># '(2, 3)&lt;f8'</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>var1<span class=\"token punctuation\">,</span> var2<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>arr<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f'arr[0, 1] = </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>arr<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">'</span></span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'data/data_fortran2.dat'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'wb'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span>\n    f<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span>struct<span class=\"token punctuation\">.</span>pack<span class=\"token punctuation\">(</span><span class=\"token string\">'d'</span><span class=\"token punctuation\">,</span> var1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    f<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span>struct<span class=\"token punctuation\">.</span>pack<span class=\"token punctuation\">(</span><span class=\"token string\">'i'</span><span class=\"token punctuation\">,</span> var2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 注意 `struct` 的 'i' 是 '&lt;i4'</span>\n    arr<span class=\"token punctuation\">.</span>tofile<span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code>1.1 0\n[[0. 1. 2.]\n [3. 4. 5.]]\narr[0, 1] = 1.0</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># python (read)</span>\n<span class=\"token comment\"># 使用 `np.fromfile`, 读入的是 `ndarray`</span>\n<span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'data/data_fortran2.dat'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'rb'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span>\n    var1 <span class=\"token operator\">=</span> <span class=\"token builtin\">float</span><span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>fromfile<span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">,</span> dtype<span class=\"token operator\">=</span><span class=\"token string\">'&lt;f8'</span><span class=\"token punctuation\">,</span> count<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    var2 <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>fromfile<span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">,</span> dtype<span class=\"token operator\">=</span><span class=\"token string\">'&lt;i4'</span><span class=\"token punctuation\">,</span> count<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    arr <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>fromfile<span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">,</span> dtype<span class=\"token operator\">=</span><span class=\"token string\">'&lt;f8'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>var1<span class=\"token punctuation\">,</span> var2<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>arr<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code>1.1 0\n[[0. 1. 2.]\n [3. 4. 5.]]</code></pre>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">%%bash\n<span class=\"token builtin class-name\">cd</span> examples/\nifort -o test_read_stream test_read_stream.f90\n./test_read_stream<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code>  1.1 0.0\n  0.0 1.0 2.0\n  3.0 4.0 5.0\n arr(2, 1) =  1.0</code></pre>\n<h3 id=\"hdf5-文件读写-ncdf-cdf-文件读取\">HDF5 文件读写, NCDF, CDF\n文件读取</h3>\n<h4 id=\"读写-hdf5-文件-读-ncdf-文件\">读写 HDF5 文件, 读 NCDF 文件</h4>\n<p>HDF5 格式介绍 <a\nhref=\"https://portal.hdfgroup.org/display/HDF5/Introduction+to+HDF5\"\nclass=\"uri\">https://portal.hdfgroup.org/display/HDF5/Introduction+to+HDF5</a></p>\n<p>相关包: <code>h5py</code> 或 <code>pandas</code> +\n<code>pytables</code>\n(http://www.pytables.org/usersguide/datatypes.html)</p>\n<p>安装见 <a href=\"installpy.html#其他\">Python 安装和配置</a></p>\n<ul>\n<li>查看</li>\n</ul>\n<pre class=\"line-numbers language-sh\" data-language=\"sh\"><code class=\"language-sh\">$ h5dump -H &lt;filename&gt;.hdf5\n$ ncdump -h &lt;filename&gt;.ncdf<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<ul>\n<li>用 <code>h5py</code> 读写:</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> h5py\narr <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>arange<span class=\"token punctuation\">(</span><span class=\"token number\">10000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">,</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">with</span> h5py<span class=\"token punctuation\">.</span>File<span class=\"token punctuation\">(</span><span class=\"token string\">'test.hdf5'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'w'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span>\n    f<span class=\"token punctuation\">[</span><span class=\"token string\">'data'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> arr\n    <span class=\"token comment\"># 或</span>\n    <span class=\"token comment\"># f.create_dataset('data', data=arr)</span>\n    <span class=\"token comment\"># 其中 compression='gzip', compression_opts=[0-9], 可分条目用不同压缩</span>\n    f<span class=\"token punctuation\">[</span><span class=\"token string\">'lb'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p> 读纯 HDF5/NCDF 文件: <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">f <span class=\"token operator\">=</span> h5py<span class=\"token punctuation\">.</span>File<span class=\"token punctuation\">(</span><span class=\"token string\">'test.hdf5'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'r'</span><span class=\"token punctuation\">)</span>\nkeys <span class=\"token operator\">=</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">.</span>keys<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># ['data', 'lb']</span>\nitems <span class=\"token operator\">=</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">.</span>items<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\na <span class=\"token operator\">=</span> f<span class=\"token punctuation\">[</span><span class=\"token string\">'data'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>value<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>  读 pandas 存的文件:\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> f<span class=\"token punctuation\">[</span><span class=\"token string\">'data'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'block0_values'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>value\nf<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># f['&lt;key>'] 得到的是 Dataset 或 Group 的引用</span>\n<span class=\"token comment\"># 用 f['&lt;key>'].value 或切片 f['&lt;key>'][:] 得到原来的格式</span>\n<span class=\"token comment\"># f['&lt;key>'] 可替代为f.get('&lt;key>')</span>\n<span class=\"token comment\"># 关闭之后 f['data'] 的引用失效, 因此存出数据要加上.value或[:]保存数据, 或使用 deepcopy</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>  打印读取的信息: <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> pprint <span class=\"token keyword\">import</span> pprint\npprint<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f'</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>k<span class=\"token punctuation\">:</span><span class=\"token format-spec\">>20</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">'</span></span><span class=\"token punctuation\">,</span> <span class=\"token string-interpolation\"><span class=\"token string\">f'</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span><span class=\"token format-spec\">>20</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">'</span></span><span class=\"token punctuation\">,</span> <span class=\"token string-interpolation\"><span class=\"token string\">f'</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>dtype<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span><span class=\"token format-spec\">>20</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">'</span></span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> k <span class=\"token keyword\">in</span> f<span class=\"token punctuation\">.</span>keys<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\npprint<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f'</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>k<span class=\"token punctuation\">:</span><span class=\"token format-spec\">>20</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">'</span></span><span class=\"token punctuation\">,</span> <span class=\"token string-interpolation\"><span class=\"token string\">f\"</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'block0_values'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span><span class=\"token format-spec\">>20</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">,</span> <span class=\"token string-interpolation\"><span class=\"token string\">f\"</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'block0_values'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>dtype<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span><span class=\"token format-spec\">>20</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> k <span class=\"token keyword\">in</span> f<span class=\"token punctuation\">.</span>keys<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre></p>\n<ul>\n<li>用pandas读写:</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p> 写: <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">arr2 <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>DataFrame<span class=\"token punctuation\">(</span>arr<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># complevel=[0-9], complib=&#123;'zlib', 'lzo', 'bzip2', 'blosc'&#125;</span>\n<span class=\"token keyword\">with</span> pd<span class=\"token punctuation\">.</span>HDFStore<span class=\"token punctuation\">(</span><span class=\"token string\">'test2.hdf5'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'w'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span>\n    f<span class=\"token punctuation\">[</span><span class=\"token string\">'data'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> arr2\n    f<span class=\"token punctuation\">[</span><span class=\"token string\">'lb'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>DataFrame<span class=\"token punctuation\">(</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>  读 pandas 写的文件: <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">f <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>HDFStore<span class=\"token punctuation\">(</span><span class=\"token string\">'test2.hdf5'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'r'</span><span class=\"token punctuation\">)</span>\nkeys <span class=\"token operator\">=</span> f<span class=\"token punctuation\">.</span>keys<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># ['/data', '/lb'], 存在子目录</span>\nitems <span class=\"token operator\">=</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">.</span>items<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\na <span class=\"token operator\">=</span> f<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>values  <span class=\"token comment\"># a = f.&lt;key> 得到的是 DataFrame 的引用, f.&lt;key>.values 得到原来的格式</span>\nf<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<ul>\n<li>读纯 HDF5/NCDF 文件:<br> 比如 h5py 写的文件, 目录结构和 pandas\n写的不同, 要用<code>.root</code><br> 其他软件生成的文件可能不能读</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">f <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>HDFStore<span class=\"token punctuation\">(</span><span class=\"token string\">'test.hdf5'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'r'</span><span class=\"token punctuation\">)</span>\nkeys <span class=\"token operator\">=</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">.</span>root<span class=\"token punctuation\">.</span>_v_children<span class=\"token punctuation\">.</span>keys<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># ['data', 'lb']</span>\nitems <span class=\"token operator\">=</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">.</span>root<span class=\"token punctuation\">.</span>_v_children<span class=\"token punctuation\">.</span>items<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># ['data', 'lb'], 有些文件没有.items</span>\na <span class=\"token operator\">=</span> f<span class=\"token punctuation\">.</span>root<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># f.root 得到 tables.group.RootGroup, f.root.&lt;key> 得到tables.group.CArray</span>\n<span class=\"token comment\"># f.get_node('&lt;key>') 得到 tables.group.CArray</span>\n<span class=\"token comment\"># f.root.&lt;key> 可替代为 f['&lt;key>'] (有些文件不行)</span>\nf<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p> 打印 (以免数据有 None, 用 <code>np.shape</code>): <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">pprint<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f'</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>k<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">'</span></span>                      <span class=\"token punctuation\">.</span>rjust<span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string-interpolation\"><span class=\"token string\">f'</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>np<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">.</span>get_node<span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">'</span></span><span class=\"token punctuation\">.</span>rjust<span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n         <span class=\"token string-interpolation\"><span class=\"token string\">f'</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>np<span class=\"token punctuation\">.</span>dtype<span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">.</span>get_node<span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">'</span></span><span class=\"token punctuation\">.</span>rjust<span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n         <span class=\"token keyword\">for</span> k <span class=\"token keyword\">in</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">.</span>root<span class=\"token punctuation\">.</span>_v_children<span class=\"token punctuation\">.</span>keys<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n Bug: 无法读出 <code>H5T_STRING</code></p>\n<h4 id=\"大小比较\">大小比较</h4>\n<p>用于比较的文件名说明:</p>\n<table>\n<thead>\n<tr class=\"header\">\n<th style=\"text-align: left;\">Filename</th>\n<th style=\"text-align: left;\">Method</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td style=\"text-align: left;\"><em>xxx</em>_np.npy</td>\n<td style=\"text-align: left;\"><strong><code>np.save</code></strong></td>\n</tr>\n<tr class=\"even\">\n<td style=\"text-align: left;\"><em>xxx</em>_np.npz</td>\n<td\nstyle=\"text-align: left;\"><strong><code>np.savez_compressed</code></strong></td>\n</tr>\n<tr class=\"odd\">\n<td style=\"text-align: left;\"><em>xxx</em>_compimg.fits</td>\n<td style=\"text-align: left;\"><strong>FITS</strong> CompImageHDU\n(compressed)</td>\n</tr>\n<tr class=\"even\">\n<td style=\"text-align: left;\"><em>xxx</em>_prim.fits</td>\n<td style=\"text-align: left;\"><strong>FITS</strong> PrimaryHDU</td>\n</tr>\n<tr class=\"odd\">\n<td style=\"text-align: left;\"><em>xxx</em>_h5py_0.hdf5</td>\n<td style=\"text-align: left;\"><strong><code>h5py</code></strong> no\ncompression</td>\n</tr>\n<tr class=\"even\">\n<td style=\"text-align: left;\"><em>xxx</em>_h5py_gzip.hdf5</td>\n<td style=\"text-align: left;\"><strong><code>h5py</code></strong>\ncompression='gzip', compression_opts=9</td>\n</tr>\n<tr class=\"odd\">\n<td style=\"text-align: left;\"><em>xxx</em>_h5py_lzf.hdf5</td>\n<td style=\"text-align: left;\"><strong><code>h5py</code></strong>\ncompression='lzf'</td>\n</tr>\n<tr class=\"even\">\n<td style=\"text-align: left;\"><em>xxx</em>_pd_0.hdf5</td>\n<td style=\"text-align: left;\"><strong><code>pandas</code></strong> no\ncompression</td>\n</tr>\n<tr class=\"odd\">\n<td style=\"text-align: left;\"><em>xxx</em>_pd_blosc.hdf5</td>\n<td style=\"text-align: left;\"><strong><code>pandas</code></strong>\ncomplib='blosc', complevel=9</td>\n</tr>\n<tr class=\"even\">\n<td style=\"text-align: left;\"><em>xxx</em>_pd_bzip2.hdf5</td>\n<td style=\"text-align: left;\"><strong><code>pandas</code></strong>\ncomplib='bzip2', complevel=9</td>\n</tr>\n<tr class=\"odd\">\n<td style=\"text-align: left;\"><em>xxx</em>_pd_lzo.hdf5</td>\n<td style=\"text-align: left;\"><strong><code>pandas</code></strong>\ncomplib='lzo', complevel=9</td>\n</tr>\n<tr class=\"even\">\n<td style=\"text-align: left;\"><em>xxx</em>_pd_zlib.hdf5</td>\n<td style=\"text-align: left;\"><strong><code>pandas</code></strong>\ncomplib='zlib', complevel=9</td>\n</tr>\n</tbody>\n</table>\n<ul>\n<li>对于相关性强的数组</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">%</span>run examples<span class=\"token operator\">/</span>test_hdf5<span class=\"token punctuation\">.</span>py\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n!du <span class=\"token operator\">-</span>h data<span class=\"token operator\">/</span>test_<span class=\"token operator\">*</span><span class=\"token punctuation\">.</span>np<span class=\"token operator\">*</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n!du <span class=\"token operator\">-</span>h data<span class=\"token operator\">/</span>test_h5py_<span class=\"token operator\">*</span><span class=\"token punctuation\">.</span>hdf5\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n!du <span class=\"token operator\">-</span>h data<span class=\"token operator\">/</span>test_pd_<span class=\"token operator\">*</span><span class=\"token punctuation\">.</span>hdf5<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code>array: 15.3 M\n\n7.7M    data/test_np.npy\n1.3M    data/test_np.npz\n\n16M data/test_h5py_0.hdf5\n2.9M    data/test_h5py_gzip.hdf5\n7.7M    data/test_h5py_lzf.hdf5\n\n16M data/test_pd_0.hdf5\n272K    data/test_pd_blosc.hdf5\n248K    data/test_pd_bzip2.hdf5\n256K    data/test_pd_lzo.hdf5\n172K    data/test_pd_zlib.hdf5</code></pre>\n<ul>\n<li>随机数数组</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">%</span>run examples<span class=\"token operator\">/</span>test_hdf5_2<span class=\"token punctuation\">.</span>py\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n!du <span class=\"token operator\">-</span>h data<span class=\"token operator\">/</span>test_<span class=\"token operator\">*</span><span class=\"token punctuation\">.</span>np<span class=\"token operator\">*</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n!du <span class=\"token operator\">-</span>h data<span class=\"token operator\">/</span>test_h5py_<span class=\"token operator\">*</span><span class=\"token punctuation\">.</span>hdf5\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n!du <span class=\"token operator\">-</span>h data<span class=\"token operator\">/</span>test_pd_<span class=\"token operator\">*</span><span class=\"token punctuation\">.</span>hdf5<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code>array: 15.3 M\n\n7.7M    data/test_np.npy\n7.2M    data/test_np.npz\n\n16M data/test_h5py_0.hdf5\n8.0M    data/test_h5py_gzip.hdf5\n9.5M    data/test_h5py_lzf.hdf5\n\n16M data/test_pd_0.hdf5\n7.7M    data/test_pd_blosc.hdf5\n7.2M    data/test_pd_bzip2.hdf5\n7.7M    data/test_pd_lzo.hdf5\n7.1M    data/test_pd_zlib.hdf5</code></pre>\n<ul>\n<li>从 FITS 文件读取再转存</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">fname <span class=\"token operator\">=</span> <span class=\"token string\">'data/hmi.B_720s.20150827_052400_TAI.field.fits'</span>\n<span class=\"token operator\">%</span>run examples<span class=\"token operator\">/</span>test_fits_hdf5<span class=\"token punctuation\">.</span>py <span class=\"token punctuation\">&#123;</span>fname<span class=\"token punctuation\">&#125;</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n!du <span class=\"token operator\">-</span>h <span class=\"token punctuation\">&#123;</span>fname<span class=\"token punctuation\">&#125;</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n!du <span class=\"token operator\">-</span>h data<span class=\"token operator\">/</span>fits_<span class=\"token operator\">*</span><span class=\"token punctuation\">.</span>np<span class=\"token operator\">*</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n!du <span class=\"token operator\">-</span>h data<span class=\"token operator\">/</span>fits_<span class=\"token operator\">*</span><span class=\"token punctuation\">.</span>fits\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n!du <span class=\"token operator\">-</span>h data<span class=\"token operator\">/</span>fits_h5py_<span class=\"token operator\">*</span><span class=\"token punctuation\">.</span>hdf5\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n!du <span class=\"token operator\">-</span>h data<span class=\"token operator\">/</span>fits_pd_<span class=\"token operator\">*</span><span class=\"token punctuation\">.</span>hdf5<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code>array: 64.0 M\n\n21M data/hmi.B_720s.20150827_052400_TAI.field.fits\n\n65M data/fits_np.npy\n27M data/fits_np.npz\n\n21M data/fits_compimg.fits\n65M data/fits_prim.fits\n\n65M data/fits_h5py_0.hdf5\n27M data/fits_h5py_gzip.hdf5\n40M data/fits_h5py_lzf.hdf5\n\n65M data/fits_pd_0.hdf5\n23M data/fits_pd_blosc.hdf5\n21M data/fits_pd_bzip2.hdf5\n23M data/fits_pd_lzo.hdf5\n20M data/fits_pd_zlib.hdf5</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">fname <span class=\"token operator\">=</span> <span class=\"token string\">'data/hmi.B_720s.20150827_052400_TAI.disambig.fits'</span>\n<span class=\"token operator\">%</span>run examples<span class=\"token operator\">/</span>test_fits_hdf5<span class=\"token punctuation\">.</span>py <span class=\"token punctuation\">&#123;</span>fname<span class=\"token punctuation\">&#125;</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n!du <span class=\"token operator\">-</span>h <span class=\"token punctuation\">&#123;</span>fname<span class=\"token punctuation\">&#125;</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n!du <span class=\"token operator\">-</span>h data<span class=\"token operator\">/</span>fits_<span class=\"token operator\">*</span><span class=\"token punctuation\">.</span>np<span class=\"token operator\">*</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n!du <span class=\"token operator\">-</span>h data<span class=\"token operator\">/</span>fits_<span class=\"token operator\">*</span><span class=\"token punctuation\">.</span>fits\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n!du <span class=\"token operator\">-</span>h data<span class=\"token operator\">/</span>fits_h5py_<span class=\"token operator\">*</span><span class=\"token punctuation\">.</span>hdf5\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n!du <span class=\"token operator\">-</span>h data<span class=\"token operator\">/</span>fits_pd_<span class=\"token operator\">*</span><span class=\"token punctuation\">.</span>hdf5<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code>array: 32.0 M\n\n5.4M    data/hmi.B_720s.20150827_052400_TAI.disambig.fits\n\n33M data/fits_np.npy\n5.2M    data/fits_np.npz\n\n5.4M    data/fits_compimg.fits\n33M data/fits_prim.fits\n\n33M data/fits_h5py_0.hdf5\n5.3M    data/fits_h5py_gzip.hdf5\n9.7M    data/fits_h5py_lzf.hdf5\n\n33M data/fits_pd_0.hdf5\n9.5M    data/fits_pd_blosc.hdf5\n4.1M    data/fits_pd_bzip2.hdf5\n7.6M    data/fits_pd_lzo.hdf5\n4.8M    data/fits_pd_zlib.hdf5</code></pre>\n<h4 id=\"读取-cdf-文件\">读取 CDF 文件</h4>\n<p>相关包 <code>cdflib</code>, 安装见 <a\nhref=\"installpy.html#其他\">Python 安装和配置#其他</a>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> cdflib\nf <span class=\"token operator\">=</span> cdflib<span class=\"token punctuation\">.</span>CDF<span class=\"token punctuation\">(</span><span class=\"token string\">\"&lt;filename>.cdf\"</span><span class=\"token punctuation\">)</span>\nf<span class=\"token punctuation\">.</span>cdf_info<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 总体信息</span>\nf<span class=\"token punctuation\">.</span>varinq<span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;key>'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 变量信息</span>\nf<span class=\"token punctuation\">.</span>varget<span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;key>'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 值</span>\nf<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<h3 id=\"numpy-to-vtk\">NumPy to VTK</h3>\n<p>参考 <a\nhref=\"https://pyscience.wordpress.com/2014/09/06/numpy-to-vtk-converting-your-numpy-arrays-to-vtk-arrays-and-files/\"\nclass=\"uri\">https://pyscience.wordpress.com/2014/09/06/numpy-to-vtk-converting-your-numpy-arrays-to-vtk-arrays-and-files/</a><br>\n以及 <a href=\"installpy.html#其他\">Python 安装和配置</a> <br><br>\ne.g.<br> 运行 <a\nhref=\"examples/field2dvtk.py\">examples/field2dvtk.py</a> ,<br>\n打开Paraview, 选择 state 文件 'field2d.pvsm', 再选择数据文件\n'field2d.vtr'</p>\n<h3 id=\"matlab-mat-文件读写\">Matlab mat 文件读写</h3>\n<p>(未测试) <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> scipy<span class=\"token punctuation\">.</span>io\nscipy<span class=\"token punctuation\">.</span>io<span class=\"token punctuation\">.</span>loadmat<span class=\"token punctuation\">(</span><span class=\"token string\">\"&lt;filename>\"</span><span class=\"token punctuation\">,</span> mdict<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> appendmat<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">**</span>kwargs<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 如果 appendmat=True，则文件名不需要'.mat'后缀)</span>\nscipy<span class=\"token punctuation\">.</span>io<span class=\"token punctuation\">.</span>savemat<span class=\"token punctuation\">(</span><span class=\"token string\">\"&lt;filename>\"</span><span class=\"token punctuation\">,</span> mdict<span class=\"token punctuation\">,</span> appendmat<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">format</span><span class=\"token operator\">=</span><span class=\"token string\">'5'</span><span class=\"token punctuation\">,</span>\n                 long_field_names<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span> do_compression<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span> oned_as<span class=\"token operator\">=</span><span class=\"token string\">'row'</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<h2 id=\"脚本相关\">脚本相关</h2>\n<h3 id=\"脚本结构\">脚本结构</h3>\n<p>文件头: <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\">#!/usr/bin/env python</span>\n<span class=\"token comment\"># -*- coding: utf-8 -*-</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre></p>\n<p>脚本结构: <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\">#!/usr/bin/env python</span>\n<span class=\"token comment\"># -*- coding: utf-8 -*-</span>\n<span class=\"token triple-quoted-string string\">\"\"\"\n假设这个文件的名称为 mymodule.py\n使用 `imort mymodule` 导入\n这些文字会出现在 `help(mymodule)` 或 `pydoc mymodule` 中\n\"\"\"</span>\nc <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">func1</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> <span class=\"token operator\">*</span>args<span class=\"token punctuation\">,</span> <span class=\"token operator\">**</span>kwargs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token triple-quoted-string string\">\"\"\"\n    这个注释必须缩进\n    args: a tuple - (arg1, arg2, ...)\n    kwargs: a dict - &#123;key1 : val1, key2 : val2&#125;\n    \"\"\"</span>\n    <span class=\"token keyword\">global</span> c\n    <span class=\"token keyword\">return</span> x <span class=\"token operator\">+</span> y <span class=\"token operator\">+</span> c\n<span class=\"token keyword\">def</span> <span class=\"token function\">func2</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    a <span class=\"token operator\">=</span> func1<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> a\n<span class=\"token keyword\">def</span> <span class=\"token function\">_func3</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>  <span class=\"token comment\"># `from xxx import *` 将不会导入这个函数</span>\n    <span class=\"token keyword\">pass</span>\n    <span class=\"token keyword\">return</span>  <span class=\"token comment\"># return 不写时返回 None</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># your code here</span>\n<span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">\"__main__\"</span><span class=\"token punctuation\">:</span>\n    main<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre> <code>import</code> 这个文档时,\n<code>__name__</code> 为模块名, 因此 <code>main()</code> 不执行</p>\n<p><code>help()</code> 也可以查看模块内的函数文档:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> usr_sunpy\n<span class=\"token builtin\">help</span><span class=\"token punctuation\">(</span>usr_sunpy<span class=\"token punctuation\">.</span>plot_map<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<h3 id=\"try-...-except-...-语法\">try ... except ... 语法</h3>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token keyword\">except</span> ValueError <span class=\"token keyword\">as</span> e<span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'ValueError:'</span><span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">except</span> ZeroDivisionError <span class=\"token keyword\">as</span> e<span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'ZeroDivisionError:'</span><span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'no error!'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">finally</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'finally...'</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>见 <a href=\"#Paraview-脚本\">Paraview 的例子</a></p>\n<h3 id=\"paraview-脚本\">Paraview 脚本</h3>\n<p>官方文档 <a\nhref=\"https://www.paraview.org/ParaView/Doc/Nightly/www/py-doc/index.html\"\nclass=\"uri\">https://www.paraview.org/ParaView/Doc/Nightly/www/py-doc/index.html</a>\n<br><br> * 记录语句: 1. Tools -&gt; Start Trace 2. 进行各种操作 3. Tools\n-&gt; Stop Trace 之后得到一个包含刚才操作命令的脚本,\n参考其中的语句就可以写自己的脚本了. <br><br> * 需要导入的模块:</p>\n<pre class=\"line-numbers language-sh\" data-language=\"sh\"><code class=\"language-sh\">from paraview.simple import *<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p><br> * 使用 pvpython (默认渲染) pvbatch (默认不渲染) 来执行脚本:</p>\n<pre class=\"line-numbers language-sh\" data-language=\"sh\"><code class=\"language-sh\">pvbatch myscript.py<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>也可以使用文件头 <code>#!/usr/bin/env pvbatch</code>,\n加执行权限后直接执行: <pre class=\"line-numbers language-sh\" data-language=\"sh\"><code class=\"language-sh\">.&#x2F;myscript.py<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre> 注意: 打包的 paraview 所使用的\npython 是 paraview 自带的 python2.7</p>\n<p><img src='/advance/Screenshot_20180618-151438.png' width='700' /></p>\n<ul>\n<li>常用语句:</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">view <span class=\"token operator\">=</span> GetActiveView<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nscene <span class=\"token operator\">=</span> GetAnimationScene<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<p><code>view.ViewTime</code> 修改时 <code>scene.AnimationTime</code>\n不变 <code>scene.AnimationTime</code> 修改时 <code>view.ViewTime</code>\n也同时被改变</p>\n<p>注意: filter 必须是显示状态 (<code>Show(&lt;filter&gt;)</code>)\n才能修改时间</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># e.g.</span>\n!code <span class=\"token operator\">-</span>n examples<span class=\"token operator\">/</span>stat1<span class=\"token punctuation\">.</span>py<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<ul>\n<li>字体选择参考路径:<br>\n<ul>\n<li>/usr/share/fonts/truetype/dejavu/DejaVuSans.ttf</li>\n<li>/home/<user>/miniconda3/lib/python3.6/site-packages/matplotlib/mpl-data/fonts/ttf/DejaVuSans.ttf</li>\n</ul></li>\n<li>python 调用问题 (paraview 5.5.0+ 没有这个问题):</li>\n</ul>\n<p>paraview 某个版本之后就默认使用 python 2.7.11+.<br>\n运行之前先修改环境变量 ( <code>PYTHONPATH</code> 和\n<code>PYTHONSTARTUP</code>), <br>\n运行结束结束后恢复这两个变量即可.<br><br> 这个过程可以使用脚本\n(而不用alias): <pre class=\"line-numbers language-sh\" data-language=\"sh\"><code class=\"language-sh\">#!&#x2F;bin&#x2F;bash\nunset PYTHONSTARTUP  # 如果有的话\nexport PYTHONPATH&#x3D;&#x2F;&lt;your_path&gt;&#x2F;ParaView&#x2F;lib&#x2F;python2.7&#x2F;site-packages\n&#x2F;&lt;your_path&gt;&#x2F;ParaView&#x2F;bin&#x2F;paraview $@<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre> 用这个脚本替代原有 <code>paraview</code>,\n<code>pvpython</code> 和 <code>pvbatch</code> 命令.</p>\n<h3 id=\"python-2---3-的转换\">Python 2 -&gt; 3 的转换</h3>\n<p>比较推荐的安全的检查方式:</p>\n<ul>\n<li><p>备份的原文件且自动生成转换过的文件 <pre class=\"line-numbers language-none\"><code class=\"language-none\">$ 2to3 -w filename<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p></li>\n<li><p>手动比较, 在需要的地方对照修改 filename.bak<br> 主要查看 print,\nrange, map 等函数.<br> 添加<br>\n <code>from __future__ import division, print_function</code><br> 在其他\nimport 前. <pre class=\"line-numbers language-none\"><code class=\"language-none\">$ sudo apt-get install meld\n$ meld filename filename.bak<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre></p></li>\n<li><p>确认无误后, 将手动修改的文件复制回去 <pre class=\"line-numbers language-none\"><code class=\"language-none\">$ mv -v filename.bak filename<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p></li>\n</ul>\n<p>python 内查看版本的方法, 可用于 <code>if</code> 语句等 (更推荐用\n<code>try...except...</code> 语法):</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> sys\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>sys<span class=\"token punctuation\">.</span>version_info <span class=\"token operator\">>=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>sys<span class=\"token punctuation\">.</span>version_info<span class=\"token punctuation\">.</span>major <span class=\"token operator\">>=</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<h3 id=\"执行-shell-命令\">执行 shell 命令</h3>\n<p><a href=\"https://docs.python.org/3/library/subprocess.html\"\nclass=\"uri\">https://docs.python.org/3/library/subprocess.html</a></p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> subprocess\n\nfname <span class=\"token operator\">=</span> <span class=\"token string\">'installpy.ipynb'</span>\n\n<span class=\"token comment\"># 默认是以列表形式传递参数</span>\nsubprocess<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"ls\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"-l\"</span><span class=\"token punctuation\">,</span> fname<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># doesn't capture output</span>\n\n<span class=\"token comment\"># 输出结果需要 `decode('ascii')` 转码</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>subprocess<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"ls\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"-l\"</span><span class=\"token punctuation\">,</span> fname<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> stdout<span class=\"token operator\">=</span>subprocess<span class=\"token punctuation\">.</span>PIPE<span class=\"token punctuation\">)</span>\n                    <span class=\"token punctuation\">.</span>stdout<span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token string\">'ascii'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>subprocess<span class=\"token punctuation\">.</span>check_output<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"ls\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"-l\"</span><span class=\"token punctuation\">,</span> fname<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token string\">'ascii'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code>-rw-rw-r-- 1 lydia lydia 142508 Jun 24 16:21 installpy.ipynb\n\n-rw-rw-r-- 1 lydia lydia 142508 Jun 24 16:21 installpy.ipynb</code></pre>\n<p>利用 bash 的特长来做一些字符串操作:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># 使用整行命令需要 `shell=True`, 虽然并不是推荐的做法, 但偶尔使用无妨 (见官方文档)</span>\n<span class=\"token comment\"># `r`用来取消转义</span>\n<span class=\"token comment\"># `echo`使用`-n`来去掉输出的 '\\n'</span>\nfname_head <span class=\"token operator\">=</span> subprocess<span class=\"token punctuation\">.</span>check_output<span class=\"token punctuation\">(</span><span class=\"token string\">r\"echo -n %s | sed 's/\\.ipynb//'\"</span>\n                                     <span class=\"token operator\">%</span> fname<span class=\"token punctuation\">,</span> shell<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token string\">'ascii'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 或使用 strip 去掉 '\\n'</span>\nfname_head <span class=\"token operator\">=</span> subprocess<span class=\"token punctuation\">.</span>check_output<span class=\"token punctuation\">(</span><span class=\"token string\">r\"echo %s | sed 's/\\.ipynb//'\"</span>\n             <span class=\"token operator\">%</span> fname<span class=\"token punctuation\">,</span> shell<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>strip<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token string\">'ascii'</span><span class=\"token punctuation\">)</span>  \n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>fname_head<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code>installpy</code></pre>\n<p>字符串编码见 <a\nhref=\"https://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000/001431664106267f12e9bef7ee14cf6a8776a479bdec9b9000\">廖雪峰的网站</a></p>\n<ul>\n<li>得到命令执行的路径</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> os\nos<span class=\"token punctuation\">.</span>getcwd<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>&#39;/home/lydia/codes/zly/python/python-intro&#39;</code></pre>\n<ul>\n<li>得到脚本文件所在的路径(仅脚本中使用)</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span>os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>abspath<span class=\"token punctuation\">(</span>__file__<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>或 <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>dirname<span class=\"token punctuation\">(</span>os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>abspath<span class=\"token punctuation\">(</span>__file__<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<p>其中 <code>os.path.split</code> 和 <code>os.path.dirname</code>\n的用法:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token string\">'your/path/filename'</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>(&#39;your/path&#39;, &#39;filename&#39;)</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>dirname<span class=\"token punctuation\">(</span><span class=\"token string\">'your/path/filename'</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>&#39;your/path&#39;</code></pre>\n<p><code>os.path.dirname</code> 类似于 bash 的 <code>dirname</code></p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">!dirname <span class=\"token string\">'your/path/filename'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>your/path</code></pre>\n<h3 id=\"脚本选项\">脚本选项</h3>\n<p>推荐 <code>argparse</code>, 在过去的其他方法的基础上有所增强 <a\nhref=\"https://docs.python.org/3/library/argparse.html\"\nclass=\"uri\">https://docs.python.org/3/library/argparse.html</a></p>\n<p>脚本内: <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> argparse\nparser <span class=\"token operator\">=</span> argparse<span class=\"token punctuation\">.</span>ArgumentParser<span class=\"token punctuation\">(</span>description<span class=\"token operator\">=</span><span class=\"token string\">'Process some integers.'</span><span class=\"token punctuation\">)</span>\nparser<span class=\"token punctuation\">.</span>add_argument<span class=\"token punctuation\">(</span><span class=\"token string\">'integers'</span><span class=\"token punctuation\">,</span> metavar<span class=\"token operator\">=</span><span class=\"token string\">'N'</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">type</span><span class=\"token operator\">=</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">,</span> nargs<span class=\"token operator\">=</span><span class=\"token string\">'+'</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token builtin\">help</span><span class=\"token operator\">=</span><span class=\"token string\">'an integer for the accumulator'</span><span class=\"token punctuation\">)</span>\nparser<span class=\"token punctuation\">.</span>add_argument<span class=\"token punctuation\">(</span><span class=\"token string\">'--sum'</span><span class=\"token punctuation\">,</span> dest<span class=\"token operator\">=</span><span class=\"token string\">'accumulate'</span><span class=\"token punctuation\">,</span> action<span class=\"token operator\">=</span><span class=\"token string\">'store_const'</span><span class=\"token punctuation\">,</span>\n                    const<span class=\"token operator\">=</span><span class=\"token builtin\">sum</span><span class=\"token punctuation\">,</span> default<span class=\"token operator\">=</span><span class=\"token builtin\">max</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token builtin\">help</span><span class=\"token operator\">=</span><span class=\"token string\">'sum the integers (default: find the max)'</span><span class=\"token punctuation\">)</span>\nargs <span class=\"token operator\">=</span> parser<span class=\"token punctuation\">.</span>parse_args<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>args<span class=\"token punctuation\">.</span>accumulate<span class=\"token punctuation\">(</span>args<span class=\"token punctuation\">.</span>integers<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre> Shell: <pre class=\"line-numbers language-none\"><code class=\"language-none\">$ python prog.py -h\nusage: prog.py [-h] [--sum] N [N ...]\nProcess some integers.\npositional arguments:\n N           an integer for the accumulator\noptional arguments:\n -h, --help  show this help message and exit\n --sum       sum the integers (default: find the max)<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<h3 id=\"处理-warnings\">处理 warnings</h3>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># Suppress warnings of NaNs:</span>\n<span class=\"token keyword\">with</span> np<span class=\"token punctuation\">.</span>errstate<span class=\"token punctuation\">(</span>invalid<span class=\"token operator\">=</span><span class=\"token string\">'ignore'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token comment\"># Suppress other warnings, e.g.</span>\n<span class=\"token keyword\">import</span> warnings\n<span class=\"token keyword\">with</span> warnings<span class=\"token punctuation\">.</span>catch_warnings<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    warnings<span class=\"token punctuation\">.</span>simplefilter<span class=\"token punctuation\">(</span><span class=\"token string\">\"ignore\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token comment\"># Or</span>\nwarnings<span class=\"token punctuation\">.</span>simplefilter<span class=\"token punctuation\">(</span><span class=\"token string\">\"ignore\"</span><span class=\"token punctuation\">,</span> category<span class=\"token operator\">=</span>xxx<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># UserWarning, FutureWarning, etc.</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h2 id=\"urllib-requests\">urllib, requests</h2>\n<p>示例和文件来自 <a href=\"http://python4astronomers.github.com\"\nclass=\"uri\">http://python4astronomers.github.com</a></p>\n<p>注意 python3 不再使用 <code>urllib2</code></p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># 方法1</span>\n<span class=\"token keyword\">import</span> urllib\nurl <span class=\"token operator\">=</span> <span class=\"token string\">'http://python4astronomers.github.com/_downloads/myidlfile.sav'</span>\nurllib<span class=\"token punctuation\">.</span>request<span class=\"token punctuation\">.</span>urlretrieve<span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">,</span> <span class=\"token string\">'myidlfile.sav'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 方法2</span>\n<span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'myidlfile.sav'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'wb'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span>\n    f<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span>urllib<span class=\"token punctuation\">.</span>request<span class=\"token punctuation\">.</span>urlopen<span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 方法3</span>\n<span class=\"token keyword\">import</span> requests\n<span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'myidlfile.sav'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'wb'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span>\n    f<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span>requests<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>content<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 分块下载</span>\n<span class=\"token keyword\">import</span> requests\nr <span class=\"token operator\">=</span> requests<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token operator\">&lt;</span>url<span class=\"token operator\">></span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span>filename<span class=\"token punctuation\">,</span> <span class=\"token string\">'wb'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">for</span> chunk <span class=\"token keyword\">in</span> r<span class=\"token punctuation\">.</span>iter_content<span class=\"token punctuation\">(</span>chunk_size<span class=\"token operator\">=</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        f<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span>chunk<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>"},{"title":"Python 安装和配置","date":"2018-07-02T12:45:13.000Z","_content":"[<i class=\"fas fa-download\"></i> Jupyter Notebook](/downloads/notebooks/installpy.zip)\n\n<small><font color=gray>[Update 2022-07-12] Some outputs are updated with python 3.10.</font></small>\n\n<!-- more -->\n\n## 安装 python\n\n### 安装 python 3\n\n* 检查系统自带的版本:\n\n```python\nimport sys\nprint(sys.version)\n!{sys.executable} --version\n```\n\n    3.10.5 | packaged by conda-forge | (main, Jun 14 2022, 07:04:59) [GCC 10.3.0]\n    Python 3.10.5\n\n\n```bash\n%%bash\npython --version\npython3 --version\n```\n\n    Python 3.10.5\n    Python 3.10.5\n\n\n### pip\n\n#### 安装 pip\n\n检查 pip 是否安装以及版本\n\n```bash\n%%bash\npip --version\n```\n\n    pip 22.1.2 from /home/lydia/miniconda3/lib/python3.10/site-packages/pip (python 3.10)\n\n\n```bash\n%%bash\npython -m pip --version\n```\n\n    pip 22.1.2 from /home/lydia/miniconda3/lib/python3.10/site-packages/pip (python 3.10)\n\n\n安装 (Ubuntu):\n\n```bash\nsudo apt-get install python3-pip\n```\n\n#### 用 pip 安装 python 包\n\n```bash\npip install <package>\npip install --upgrade <package>\npip uninstall <package>\npip list\npip list --outdated\npip show <package>\n```\n\n安装到根目录 (不推荐!)\n\n```bash\nsudo -H pip install <package>\n```\n\n[选项]\n\n| | |\n|:---|:---|\n| -U, --upgrade  | 升级, 配合 install 使用 |\n| --force-reinstall  | 强制重新安装依赖 |\n| -I, --ignore-installed | 强制安装 (无论是否已安装) |\n| --no-cache-dir | 不生成cache |\n| -i <font color=blue>*url*</font> | 使用指定源 (更改配置见 [pip 镜像源](#pip-镜像源)) |\n| <font color=blue>*package*</font>==x.x.x | 指定版本, 错误版本号 (或为空) 将返回可用版本号 |\n| \"<font color=blue>*package*</font><x.x.x\" | 指定小于某版本的最新版本, 必须有引号 |\n\n\n检查包 (尝试导入, 查看包版本):\n\n```bash\npython -c \"import <package>\"\npython -c \"import <package>; print(<package>.__version__)\"  # 版本号\npython -c \"import <package>; print(<package>.version)\"  # 安装位置\n```\n\n#### 使 pip 安装 python 包到用户路径\n\n```bash\n%%bash\npython -m site | grep 'USER_SITE'\n```\n\n    USER_SITE: '/home/lydia/.local/lib/python3.10/site-packages' (doesn't exist)\n    ENABLE_USER_SITE: True\n\n\n* 确认已创建用户包安装路径.<br>\n* 在 `~/.bashrc` 中设置 `PATH` 变量:\n\n```bash\nexport PATH=$HOME/.local/bin:$PATH\n```\n\n* 使用 `install` 或 `list` 时加上选项 <font color=red>--user</font> (注意: `uninstall` 不用)\n\n> <font color=#b32425>*使用 Anaconda 路径下的 pip 时不需要这个选项*</font>\n\n```bash\npip install --user <pkg_name>\npip list --user\npip list --outdated --user\n```\n\n### Anaconda\n\n#### 安装 Anaconda 或 Miniconda (推荐)\n\n* 安装 miniconda 64位 (默认安装到 <font color=blue>~/miniconda3/</font>)\n\n  下载 <https://conda.io/miniconda.html>\n\n```bash\nbash Miniconda3-latest-Linux-x86_64.sh\n```\n\n* 在 `~/.bashrc` 加入如下语句:\n\n```bash\nexport PATH=$HOME/miniconda3/bin:$PATH\n. $HOME/miniconda3/etc/profile.d/conda.sh\n```\n\n&ensp;完成后执行:\n\n```bash\nsource ~/.bashrc\n```\n\n* 安装好后先更新 conda 和 pip:\n\n```bash\nconda update conda pip\n```\n\n* 帮助\n\n```bash\nconda [cmd] --help\n```\n\nminiconda 下载 <https://conda.io/miniconda.html><br>\n安装参考 <https://conda.io/docs/user-guide/install/index.html>\n\n#### environment\n\n默认环境为 base<br>\n`-n, --name <env_name>` 指定环境\n\n```bash\nconda create --name <env_name> [<packages>] python=3.6\nconda create --name <env_name> --clone base\n\n# e.g.\nconda create --name intel intelpython3_core python=3\n```\n\n```bash\n# 删除环境\nconda-env remove --name <env_name>\n*\n# 列出信息\nconda info -e/--envs\nconda-env list\n\n# 进入环境\nsource activate <env_name>\nconda activate <env_name>\n\n# 离开环境\nsource deactivate\nconda deactivate\n\n# 在某环境中执行操作\nconda <commands> --name <env_name>\n```\n\n#### 使用 conda 命令\n\n```bash\nconda info\nconda list [<packages>]\nconda search <package>\nconda search <package> --info\nconda install <packages>\nconda update/upgrade <packages>\nconda remove/uninstall <packages>\nconda clean --all\n```\n见 `conda --help` 或 `conda cmd --help`, `conda search` 语法见 <https://github.com/conda/conda/blob/master/conda/models/match_spec.py>\n\n配置:\n```bash\n# 安装确认时显示源的 url, 默认已开启\nconda config --set show_channel_urls True\n\n# 禁止每次更新自动检查 conda 的更新, 默认True\nconda config --set auto_update_conda False\n\n# 禁止源优先而使用版本优先, 默认True\nconda config --set channel_priority False\n\n# 增加设置, 例如增加源 (可使用 url 或别名)\nconda config --add channels <channel>\n\n# 删除某项设置的所有值, 例如删除所有自定义源\nconda config --remove-key channels\n\n# 删除某项设置的某个值, 例如删除某个源\nconda config --remove channels <channel>\n```\n\n用户配置文件 `~/.condarc` (见 [conda 镜像源](#conda-镜像源))<br>\n参考链接 <https://conda.io/docs/user-guide/configuration/use-condarc.html>\n\n也可以在不同的环境用不同的配置文件: `~/miniconda3/envs/<env_name>/.condarc`\n\n### 镜像源\n\n#### pip 镜像源\n\n用户配置文件:\n\n```bash\n%%bash\ncat ~/.pip/pip.conf\n```\n\n    [global]\n    index-url = <https://pypi.douban.com/simple>\n    trusted-host = pypi.doubanio.com\n\n#### conda 镜像源\n\n```bash\nconda config --add/--prepend channels <new_channel>\nconda config --append channels <new_channel>\n```\n\n清华源:<br>\n<https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/><br>\n<https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/><br>\n<https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge/><br>\n\nchannels 的默认的优先级为: 前排优先<br>\n镜像源中 `pkgs/main` 通常比 `pkgs/free` 新, 因此将其放在最前.<br>\n或使用 `channel_priority: false`, 见上一节 [conda 设置](#使用-conda-命令).\n\ne.g.\n\n```bash\nconda config --add channels <https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge/>\n```\n\n此时 `~/.condarc` 的内容:\n\n> channels:<br>\n&emsp;- <https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge/><br>\n&emsp;- defaults\n\n### Troubleshooting\n\n#### conda 安装时指定源且禁用其他源\n\n```bash\nconda install <packages> -c <channel> --override-channels\n```\n\n#### Astropy 新版不再支持旧版 Python\n\n```bash\npip install \"astropy<3.0\" # for python < 3.5\n```\n\n## 安装常用包\n\n### numpy, scipy, matplotlib\n\n```bash\nconda install numpy\nconda install scipy\nconda install matplotlib\n```\n&ensp;Or\n```bash\npip install numpy\npip install scipy\npip install matplotlib\n```\n\n配置启动文件 (Ubuntu), 在 `~/.bashrc` 中添加:\n```bash\nexport PYTHONSTARTUP=$HOME/.pythonrc\n```\n\n```python\ncat ~/.pythonrc\n```\n\n    # Python startup file\n    # ~/.pythonrc\n    import matplotlib.pyplot as plt\n    from matplotlib import cm\n    import numpy as np\n    import os\n    \n    print(\">>> import matplotlib.pyplot as plt\")\n    print(\">>> from matplotlib import cm\")\n    print(\">>> import numpy as np\")\n    print(\">>> import os\")\n    \n    try:\n        from pprint import pprint\n    except ImportError:\n        pass\n    else:\n        print(\">>> from pprint import pprint\")\n    \n    # Tab completion & history\n    try:\n        import atexit, readline, rlcompleter\n    except ImportError:\n        pass\n    else:\n        readline.parse_and_bind('tab: complete') # Tab completion\n        readline.parse_and_bind('''control-l:\"    \"''') # Indent, since TAB is occupied\n        histfile = os.path.join(os.environ['HOME'], '.pyhistory') # History file\n        try:\n            readline.read_history_file(histfile)\n        except IOError:\n            pass\n        atexit.register(readline.write_history_file, histfile)\n        del histfile, readline, rlcompleter\n        print(\"--- Tab completion: [ON] ---\")\n        print(\"--- History: [ON] ---\")\n        print(\"--- [Tab] -> [Ctrl+L] ---\")\n\n\n### Astropy, SunPy\n\n```bash\nconda install astropy\nconda install sunpy -c conda-forge\n```\n&ensp;Or\n```bash\npip install astropy\npip install sunpy[all] pytest\n```\n\n测试:\n\n```python\n>>> import astropy\n>>> astropy.test()\n```\n\n```python\n>>> import sunpy\n>>> sunpy.self_test(online=False)\n```\n\n如果出错: '$USER'权限问题, 见下面修改 `~/.sunpy/sunpyrc` 说明.\n\n查看包信息:\n\n```bash\n%%bash\nconda search \"conda-forge::sunpy>=4.0\"\n```\n\n    Loading channels: ...working... done\n    # Name                       Version           Build  Channel             \n    sunpy                          4.0.0 py310hde88566_0  conda-forge         \n    sunpy                          4.0.0  py38h71d37f0_0  conda-forge         \n    sunpy                          4.0.0  py39hd257fcd_0  conda-forge         \n    sunpy                          4.0.1 py310hde88566_0  conda-forge         \n    sunpy                          4.0.1  py38h71d37f0_0  conda-forge         \n    sunpy                          4.0.1  py39hd257fcd_0  conda-forge         \n    sunpy                          4.0.2 py310hde88566_0  conda-forge         \n    sunpy                          4.0.2  py38h71d37f0_0  conda-forge         \n    sunpy                          4.0.2  py39hd257fcd_0  conda-forge         \n    sunpy                          4.0.3 py310hde88566_0  conda-forge         \n    sunpy                          4.0.3  py38h71d37f0_0  conda-forge         \n    sunpy                          4.0.3  py39hd257fcd_0  conda-forge         \n\n\n```bash\n%%bash\nconda search \"sunpy 4.0.3 py310hde88566_0\" --info\n```\n\n    Loading channels: ...working... done\n    sunpy 4.0.3 py310hde88566_0\n    ---------------------------\n    file name   : sunpy-4.0.3-py310hde88566_0.tar.bz2\n    name        : sunpy\n    version     : 4.0.3\n    build       : py310hde88566_0\n    build number: 0\n    size        : 5.7 MB\n    license     : BSD-2-Clause\n    subdir      : linux-64\n    url         : <https://conda.anaconda.org/conda-forge/linux-64/sunpy-4.0.3-py310hde88566_0.tar.bz2>\n    md5         : 5831b8fde0edd2aa0ff9f42b237b7ba2\n    timestamp   : 2022-07-08 16:21:32 UTC\n    dependencies: \n      - asdf >=2.8.0\n      - asdf-astropy >=0.1.1\n      - astropy >=4.1.0\n      - beautifulsoup4 >=4.8.0\n      - cdflib >=0.3.19,!=0.4.0\n      - drms >=0.6.1\n      - glymur >=0.8.18,!=0.9.0,!=0.9.5\n      - h5netcdf >=0.8.1\n      - h5py >=3.1.0\n      - libgcc-ng >=12\n      - matplotlib-base >=3.2.0\n      - mpl_animators >=1.0.0\n      - numpy >=1.21.6,<2.0a0\n      - pandas >=1.0.0\n      - parfive >=1.2.0\n      - python >=3.10,<3.11.0a0\n      - python-dateutil >=2.8.0\n      - python_abi 3.10.* *_cp310\n      - reproject\n      - scikit-image >=0.16.0\n      - scipy >=1.3.0\n      - setuptools\n      - sqlalchemy >=1.3.4\n      - tqdm >=4.32.1\n      - zeep >=3.4.0\n    \n    \n\n\n用户文件位置: `~/.sunpy/sunpyrc`\n\n```python\ncat ~/.sunpy/sunpyrc\n```\n\n    [general]\n    time_format = %Y-%m-%d %H:%M:%S\n    working_dir = /home/lydia/sunpy-downloads\n    \n    [downloads]\n    download_dir = /home/lydia/sunpy-downloads/data\n    sample_dir = /home/lydia/sunpy-downloads/data/sample_data\n    \n    [database]\n    url = sqlite:////home/lydia/sunpy-downloads/sunpydb.sqlite\n\n```python\nimport sunpy\nsunpy.util.system_info()\n```\n\n    ==============================\n    sunpy Installation Information\n    ==============================\n    \n    General\n    #######\n    OS: Ubuntu (18.04, Linux 4.19.128-microsoft-standard)\n    Arch: 64bit, (x86_64)\n    sunpy: 4.0.3\n    Installation path: /home/lydia/miniconda3/lib/python3.10/site-packages/sunpy-4.0.3.dist-info\n    \n    Required Dependencies\n    #####################\n    astropy: 5.1\n    numpy: 1.23.1\n    packaging: 21.3\n    parfive: 1.5.1\n    \n    Optional Dependencies\n    #####################\n    asdf: 2.12.0\n    asdf-astropy: 0.2.1\n    beautifulsoup4: 4.11.1\n    cdflib: 0.4.4\n    dask: 2022.7.0\n    drms: 0.6.2\n    glymur: 0.10.1\n    h5netcdf: 0.0.0\n    h5py: 3.7.0\n    matplotlib: 3.5.2\n    mpl-animators: 1.0.1\n    pandas: 1.4.1\n    python-dateutil: 2.8.2\n    reproject: 0.8\n    scikit-image: 0.19.3\n    scipy: 1.8.1\n    sqlalchemy: 1.4.39\n    tqdm: 4.64.0\n    zeep: 4.1.0\n\n\n设置下载位置:<br>\n(参考 <http://docs.sunpy.org/en/stable/guide/customization.html?highlight=sunpy.config.set)>\n\ne.g.\n> [downloads]<br>\n&emsp;download_dir = ...\n\n```python\n>>> import sunpy\n>>> sunpy.config.set('downloads', 'download_dir',\n                 '/home/<user>/<your_path>/sunpy-downloads/data')\n```\n\n退出后再进入 python 如果发现没有修改成功, 则需要手动修改 ~/.sunpy/sunpyrc 文件.<br>\n不能用 '$USER' 代替具体的用户名 '<user\\>'\n\n### Jupyter\n\n```bash\nconda install jupyter -c conda-forge\n```\n&ensp;Or\n```bash\npip install jupyter\n```\n\n```bash\n%%bash\njupyter --path\n```\n\n    config:\n        /home/lydia/.jupyter\n        /home/lydia/.local/etc/jupyter\n        /home/lydia/miniconda3/etc/jupyter\n        /usr/local/etc/jupyter\n        /etc/jupyter\n    data:\n        /home/lydia/.local/share/jupyter\n        /home/lydia/miniconda3/share/jupyter\n        /usr/local/share/jupyter\n        /usr/share/jupyter\n    runtime:\n        /home/lydia/.local/share/jupyter/runtime\n\n\n* 设置双击打开 \\*.ipynb 文件\n\n\n```bash\npip install nbopen\n```\n\n再执行:\n\nLinux/BSD: <br>\n```bash\npython3 -m nbopen.install_xdg<br>\n ```   \n\nWindows: <br>\n```bash\npython3 -m nbopen.install_win<br>\n```\n\nMac: <br>\n&ensp;Clone the repository (https://github.com/takluyver/nbopen.git)<br>\n&ensp;and run `./osx-install.sh`<br><br>\n之后即可在文件浏览器中选择文件的打开方式为 `Jupyter Notebook`.\n\n> 注意可能会更改 bash 脚本的默认打开方式.\n\n* Jupyter 插件集合<br>(https://github.com/ipython-contrib/jupyter_contrib_nbextensions)\n\n\n```bash\nconda install jupyter_contrib_nbextensions -c conda-forge\n```\n&ensp;Or\n```bash\npip install jupyter_contrib_nbextensions\n```\n> This also automatically installs the Javascript and CSS files:<br>\n`jupyter contrib nbextension install --sys-prefix`\n\n安装好后将同时启用 `Nbextensions` 选项卡, 手动选择需要的插件, \n或者在命令行启用和禁用:\n\n```bash\njupyter nbextension list # 查看\njupyter nbextension enable <path> # <path> 为上述 list 中的 <extension>/main\njupyter nbextension disable <path>\n```\n\n注意用如果 jupyter 安装在 conda 路径, 手动安装插件 (`jupyter nbextension install`) 时需要指定 <font color=red>--sys-prefix</font>\n\n* notebook 主题 (https://github.com/dunovank/jupyter-themes)\n\n\n```bash\npip install jupyterthemes\n```\n\n* 演示代码过程的插件 (https://github.com/lgpage/nbtutor)\n\n\n```bash\nconda install nbtutor -c conda-forge\n```\n&ensp;Or\n```bash\npip install nbtutor\njupyter nbextension install --overwrite --py nbtutor\njupyter nbextension enable --py nbtutor\n```\n\n载入:\n\n```python\n# ipython/jupyter\n%load_ext nbtutor\n```\n使用:<br>\nCodeCell 中首行加入下面语句, 然后执行 Cell (numpy 等需要在 Cell 内导入)\n```python\n# ipython/jupyter\n%%nbtutor -r -f\n# 或\n%%nbtutor -r -f -i  # 缩减显示\n```\n\n### 其他\n\n* PeakUtils (http://peakutils.readthedocs.io/en/latest/)\n\n\n```bash\ngit clone <https://bitbucket.org/lucashnegri/peakutils.git>\ncd peakutils\npython setup.py install\n```\n\n```python\n>>> import peakutils\n```\n\n* LMfit-py (https://github.com/lmfit/lmfit-py)\n\n\n```bash\nconda install lmfit -c conda-forge\n# 或\npip install lmfit\n```\n\n```python\n>>> import lmfit\n```\n\n* HDF5包 (http://docs.h5py.org/en/latest/index.html)<br>\n\n\n**pandas**\n```bash\nconda install pytables pandas\n```\n&ensp;Or\n```bash\npip install tables pandas\n```\n<br><br>\n**h5py** (http://docs.h5py.org/en/latest/index.html)\n```bash\nconda install h5py  # 推荐. 将同时安装 hdf5, 并得到 h5dump 等命令\n```\n&ensp;Or\n```bash\npip install h5py  # 需要 sudo apt-get install libhdf5-dev\n```\n\n* CDF包<br>\n\n安装 spacepy (https://pythonhosted.org/SpacePy)\n\n或\n\n```bash\npip install cdflib # <https://github.com/MAVENSDC/cdflib>\n```\n\n* EVTK (https://bitbucket.org/pauloh/pyevtk)\n\n\n```bash\nsudo apt-get install mercurial  # 得到 hg 命令\n\nhg clone <https://bitbucket.org/pauloh/pyevtk>\ncd pyevtk\npython setup.py build --debug install\n```\n\n```bash\nhg pull && hg update default # 更新\n```\n\n```python\n>>> from evtk.hl import gridToVTK\n```\n\n* Mayavi (http://docs.enthought.com/mayavi/mayavi)\n\n&emsp;需要先安装 cython (conda 或 pip)\n\n```bash\npip install mayavi  # 将同时安装 vtk. (pip 是目前 mayavi 最保险的安装方式)\n```\n```bash\n# shell\nmayavi2\n```\n","source":"_posts/2018-07-02-installpy.md","raw":"---\ntitle: \"Python 安装和配置\"\npermalink: installpy.html\ncategories: 'Solar Physics'\ntags: [python, conda, jupyter, astropy, sunpy, install]\ndate: 2018-07-02 20:45:13\n---\n[<i class=\"fas fa-download\"></i> Jupyter Notebook](/downloads/notebooks/installpy.zip)\n\n<small><font color=gray>[Update 2022-07-12] Some outputs are updated with python 3.10.</font></small>\n\n<!-- more -->\n\n## 安装 python\n\n### 安装 python 3\n\n* 检查系统自带的版本:\n\n```python\nimport sys\nprint(sys.version)\n!{sys.executable} --version\n```\n\n    3.10.5 | packaged by conda-forge | (main, Jun 14 2022, 07:04:59) [GCC 10.3.0]\n    Python 3.10.5\n\n\n```bash\n%%bash\npython --version\npython3 --version\n```\n\n    Python 3.10.5\n    Python 3.10.5\n\n\n### pip\n\n#### 安装 pip\n\n检查 pip 是否安装以及版本\n\n```bash\n%%bash\npip --version\n```\n\n    pip 22.1.2 from /home/lydia/miniconda3/lib/python3.10/site-packages/pip (python 3.10)\n\n\n```bash\n%%bash\npython -m pip --version\n```\n\n    pip 22.1.2 from /home/lydia/miniconda3/lib/python3.10/site-packages/pip (python 3.10)\n\n\n安装 (Ubuntu):\n\n```bash\nsudo apt-get install python3-pip\n```\n\n#### 用 pip 安装 python 包\n\n```bash\npip install <package>\npip install --upgrade <package>\npip uninstall <package>\npip list\npip list --outdated\npip show <package>\n```\n\n安装到根目录 (不推荐!)\n\n```bash\nsudo -H pip install <package>\n```\n\n[选项]\n\n| | |\n|:---|:---|\n| -U, --upgrade  | 升级, 配合 install 使用 |\n| --force-reinstall  | 强制重新安装依赖 |\n| -I, --ignore-installed | 强制安装 (无论是否已安装) |\n| --no-cache-dir | 不生成cache |\n| -i <font color=blue>*url*</font> | 使用指定源 (更改配置见 [pip 镜像源](#pip-镜像源)) |\n| <font color=blue>*package*</font>==x.x.x | 指定版本, 错误版本号 (或为空) 将返回可用版本号 |\n| \"<font color=blue>*package*</font><x.x.x\" | 指定小于某版本的最新版本, 必须有引号 |\n\n\n检查包 (尝试导入, 查看包版本):\n\n```bash\npython -c \"import <package>\"\npython -c \"import <package>; print(<package>.__version__)\"  # 版本号\npython -c \"import <package>; print(<package>.version)\"  # 安装位置\n```\n\n#### 使 pip 安装 python 包到用户路径\n\n```bash\n%%bash\npython -m site | grep 'USER_SITE'\n```\n\n    USER_SITE: '/home/lydia/.local/lib/python3.10/site-packages' (doesn't exist)\n    ENABLE_USER_SITE: True\n\n\n* 确认已创建用户包安装路径.<br>\n* 在 `~/.bashrc` 中设置 `PATH` 变量:\n\n```bash\nexport PATH=$HOME/.local/bin:$PATH\n```\n\n* 使用 `install` 或 `list` 时加上选项 <font color=red>--user</font> (注意: `uninstall` 不用)\n\n> <font color=#b32425>*使用 Anaconda 路径下的 pip 时不需要这个选项*</font>\n\n```bash\npip install --user <pkg_name>\npip list --user\npip list --outdated --user\n```\n\n### Anaconda\n\n#### 安装 Anaconda 或 Miniconda (推荐)\n\n* 安装 miniconda 64位 (默认安装到 <font color=blue>~/miniconda3/</font>)\n\n  下载 <https://conda.io/miniconda.html>\n\n```bash\nbash Miniconda3-latest-Linux-x86_64.sh\n```\n\n* 在 `~/.bashrc` 加入如下语句:\n\n```bash\nexport PATH=$HOME/miniconda3/bin:$PATH\n. $HOME/miniconda3/etc/profile.d/conda.sh\n```\n\n&ensp;完成后执行:\n\n```bash\nsource ~/.bashrc\n```\n\n* 安装好后先更新 conda 和 pip:\n\n```bash\nconda update conda pip\n```\n\n* 帮助\n\n```bash\nconda [cmd] --help\n```\n\nminiconda 下载 <https://conda.io/miniconda.html><br>\n安装参考 <https://conda.io/docs/user-guide/install/index.html>\n\n#### environment\n\n默认环境为 base<br>\n`-n, --name <env_name>` 指定环境\n\n```bash\nconda create --name <env_name> [<packages>] python=3.6\nconda create --name <env_name> --clone base\n\n# e.g.\nconda create --name intel intelpython3_core python=3\n```\n\n```bash\n# 删除环境\nconda-env remove --name <env_name>\n*\n# 列出信息\nconda info -e/--envs\nconda-env list\n\n# 进入环境\nsource activate <env_name>\nconda activate <env_name>\n\n# 离开环境\nsource deactivate\nconda deactivate\n\n# 在某环境中执行操作\nconda <commands> --name <env_name>\n```\n\n#### 使用 conda 命令\n\n```bash\nconda info\nconda list [<packages>]\nconda search <package>\nconda search <package> --info\nconda install <packages>\nconda update/upgrade <packages>\nconda remove/uninstall <packages>\nconda clean --all\n```\n见 `conda --help` 或 `conda cmd --help`, `conda search` 语法见 <https://github.com/conda/conda/blob/master/conda/models/match_spec.py>\n\n配置:\n```bash\n# 安装确认时显示源的 url, 默认已开启\nconda config --set show_channel_urls True\n\n# 禁止每次更新自动检查 conda 的更新, 默认True\nconda config --set auto_update_conda False\n\n# 禁止源优先而使用版本优先, 默认True\nconda config --set channel_priority False\n\n# 增加设置, 例如增加源 (可使用 url 或别名)\nconda config --add channels <channel>\n\n# 删除某项设置的所有值, 例如删除所有自定义源\nconda config --remove-key channels\n\n# 删除某项设置的某个值, 例如删除某个源\nconda config --remove channels <channel>\n```\n\n用户配置文件 `~/.condarc` (见 [conda 镜像源](#conda-镜像源))<br>\n参考链接 <https://conda.io/docs/user-guide/configuration/use-condarc.html>\n\n也可以在不同的环境用不同的配置文件: `~/miniconda3/envs/<env_name>/.condarc`\n\n### 镜像源\n\n#### pip 镜像源\n\n用户配置文件:\n\n```bash\n%%bash\ncat ~/.pip/pip.conf\n```\n\n    [global]\n    index-url = <https://pypi.douban.com/simple>\n    trusted-host = pypi.doubanio.com\n\n#### conda 镜像源\n\n```bash\nconda config --add/--prepend channels <new_channel>\nconda config --append channels <new_channel>\n```\n\n清华源:<br>\n<https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/><br>\n<https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/><br>\n<https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge/><br>\n\nchannels 的默认的优先级为: 前排优先<br>\n镜像源中 `pkgs/main` 通常比 `pkgs/free` 新, 因此将其放在最前.<br>\n或使用 `channel_priority: false`, 见上一节 [conda 设置](#使用-conda-命令).\n\ne.g.\n\n```bash\nconda config --add channels <https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge/>\n```\n\n此时 `~/.condarc` 的内容:\n\n> channels:<br>\n&emsp;- <https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge/><br>\n&emsp;- defaults\n\n### Troubleshooting\n\n#### conda 安装时指定源且禁用其他源\n\n```bash\nconda install <packages> -c <channel> --override-channels\n```\n\n#### Astropy 新版不再支持旧版 Python\n\n```bash\npip install \"astropy<3.0\" # for python < 3.5\n```\n\n## 安装常用包\n\n### numpy, scipy, matplotlib\n\n```bash\nconda install numpy\nconda install scipy\nconda install matplotlib\n```\n&ensp;Or\n```bash\npip install numpy\npip install scipy\npip install matplotlib\n```\n\n配置启动文件 (Ubuntu), 在 `~/.bashrc` 中添加:\n```bash\nexport PYTHONSTARTUP=$HOME/.pythonrc\n```\n\n```python\ncat ~/.pythonrc\n```\n\n    # Python startup file\n    # ~/.pythonrc\n    import matplotlib.pyplot as plt\n    from matplotlib import cm\n    import numpy as np\n    import os\n    \n    print(\">>> import matplotlib.pyplot as plt\")\n    print(\">>> from matplotlib import cm\")\n    print(\">>> import numpy as np\")\n    print(\">>> import os\")\n    \n    try:\n        from pprint import pprint\n    except ImportError:\n        pass\n    else:\n        print(\">>> from pprint import pprint\")\n    \n    # Tab completion & history\n    try:\n        import atexit, readline, rlcompleter\n    except ImportError:\n        pass\n    else:\n        readline.parse_and_bind('tab: complete') # Tab completion\n        readline.parse_and_bind('''control-l:\"    \"''') # Indent, since TAB is occupied\n        histfile = os.path.join(os.environ['HOME'], '.pyhistory') # History file\n        try:\n            readline.read_history_file(histfile)\n        except IOError:\n            pass\n        atexit.register(readline.write_history_file, histfile)\n        del histfile, readline, rlcompleter\n        print(\"--- Tab completion: [ON] ---\")\n        print(\"--- History: [ON] ---\")\n        print(\"--- [Tab] -> [Ctrl+L] ---\")\n\n\n### Astropy, SunPy\n\n```bash\nconda install astropy\nconda install sunpy -c conda-forge\n```\n&ensp;Or\n```bash\npip install astropy\npip install sunpy[all] pytest\n```\n\n测试:\n\n```python\n>>> import astropy\n>>> astropy.test()\n```\n\n```python\n>>> import sunpy\n>>> sunpy.self_test(online=False)\n```\n\n如果出错: '$USER'权限问题, 见下面修改 `~/.sunpy/sunpyrc` 说明.\n\n查看包信息:\n\n```bash\n%%bash\nconda search \"conda-forge::sunpy>=4.0\"\n```\n\n    Loading channels: ...working... done\n    # Name                       Version           Build  Channel             \n    sunpy                          4.0.0 py310hde88566_0  conda-forge         \n    sunpy                          4.0.0  py38h71d37f0_0  conda-forge         \n    sunpy                          4.0.0  py39hd257fcd_0  conda-forge         \n    sunpy                          4.0.1 py310hde88566_0  conda-forge         \n    sunpy                          4.0.1  py38h71d37f0_0  conda-forge         \n    sunpy                          4.0.1  py39hd257fcd_0  conda-forge         \n    sunpy                          4.0.2 py310hde88566_0  conda-forge         \n    sunpy                          4.0.2  py38h71d37f0_0  conda-forge         \n    sunpy                          4.0.2  py39hd257fcd_0  conda-forge         \n    sunpy                          4.0.3 py310hde88566_0  conda-forge         \n    sunpy                          4.0.3  py38h71d37f0_0  conda-forge         \n    sunpy                          4.0.3  py39hd257fcd_0  conda-forge         \n\n\n```bash\n%%bash\nconda search \"sunpy 4.0.3 py310hde88566_0\" --info\n```\n\n    Loading channels: ...working... done\n    sunpy 4.0.3 py310hde88566_0\n    ---------------------------\n    file name   : sunpy-4.0.3-py310hde88566_0.tar.bz2\n    name        : sunpy\n    version     : 4.0.3\n    build       : py310hde88566_0\n    build number: 0\n    size        : 5.7 MB\n    license     : BSD-2-Clause\n    subdir      : linux-64\n    url         : <https://conda.anaconda.org/conda-forge/linux-64/sunpy-4.0.3-py310hde88566_0.tar.bz2>\n    md5         : 5831b8fde0edd2aa0ff9f42b237b7ba2\n    timestamp   : 2022-07-08 16:21:32 UTC\n    dependencies: \n      - asdf >=2.8.0\n      - asdf-astropy >=0.1.1\n      - astropy >=4.1.0\n      - beautifulsoup4 >=4.8.0\n      - cdflib >=0.3.19,!=0.4.0\n      - drms >=0.6.1\n      - glymur >=0.8.18,!=0.9.0,!=0.9.5\n      - h5netcdf >=0.8.1\n      - h5py >=3.1.0\n      - libgcc-ng >=12\n      - matplotlib-base >=3.2.0\n      - mpl_animators >=1.0.0\n      - numpy >=1.21.6,<2.0a0\n      - pandas >=1.0.0\n      - parfive >=1.2.0\n      - python >=3.10,<3.11.0a0\n      - python-dateutil >=2.8.0\n      - python_abi 3.10.* *_cp310\n      - reproject\n      - scikit-image >=0.16.0\n      - scipy >=1.3.0\n      - setuptools\n      - sqlalchemy >=1.3.4\n      - tqdm >=4.32.1\n      - zeep >=3.4.0\n    \n    \n\n\n用户文件位置: `~/.sunpy/sunpyrc`\n\n```python\ncat ~/.sunpy/sunpyrc\n```\n\n    [general]\n    time_format = %Y-%m-%d %H:%M:%S\n    working_dir = /home/lydia/sunpy-downloads\n    \n    [downloads]\n    download_dir = /home/lydia/sunpy-downloads/data\n    sample_dir = /home/lydia/sunpy-downloads/data/sample_data\n    \n    [database]\n    url = sqlite:////home/lydia/sunpy-downloads/sunpydb.sqlite\n\n```python\nimport sunpy\nsunpy.util.system_info()\n```\n\n    ==============================\n    sunpy Installation Information\n    ==============================\n    \n    General\n    #######\n    OS: Ubuntu (18.04, Linux 4.19.128-microsoft-standard)\n    Arch: 64bit, (x86_64)\n    sunpy: 4.0.3\n    Installation path: /home/lydia/miniconda3/lib/python3.10/site-packages/sunpy-4.0.3.dist-info\n    \n    Required Dependencies\n    #####################\n    astropy: 5.1\n    numpy: 1.23.1\n    packaging: 21.3\n    parfive: 1.5.1\n    \n    Optional Dependencies\n    #####################\n    asdf: 2.12.0\n    asdf-astropy: 0.2.1\n    beautifulsoup4: 4.11.1\n    cdflib: 0.4.4\n    dask: 2022.7.0\n    drms: 0.6.2\n    glymur: 0.10.1\n    h5netcdf: 0.0.0\n    h5py: 3.7.0\n    matplotlib: 3.5.2\n    mpl-animators: 1.0.1\n    pandas: 1.4.1\n    python-dateutil: 2.8.2\n    reproject: 0.8\n    scikit-image: 0.19.3\n    scipy: 1.8.1\n    sqlalchemy: 1.4.39\n    tqdm: 4.64.0\n    zeep: 4.1.0\n\n\n设置下载位置:<br>\n(参考 <http://docs.sunpy.org/en/stable/guide/customization.html?highlight=sunpy.config.set)>\n\ne.g.\n> [downloads]<br>\n&emsp;download_dir = ...\n\n```python\n>>> import sunpy\n>>> sunpy.config.set('downloads', 'download_dir',\n                 '/home/<user>/<your_path>/sunpy-downloads/data')\n```\n\n退出后再进入 python 如果发现没有修改成功, 则需要手动修改 ~/.sunpy/sunpyrc 文件.<br>\n不能用 '$USER' 代替具体的用户名 '<user\\>'\n\n### Jupyter\n\n```bash\nconda install jupyter -c conda-forge\n```\n&ensp;Or\n```bash\npip install jupyter\n```\n\n```bash\n%%bash\njupyter --path\n```\n\n    config:\n        /home/lydia/.jupyter\n        /home/lydia/.local/etc/jupyter\n        /home/lydia/miniconda3/etc/jupyter\n        /usr/local/etc/jupyter\n        /etc/jupyter\n    data:\n        /home/lydia/.local/share/jupyter\n        /home/lydia/miniconda3/share/jupyter\n        /usr/local/share/jupyter\n        /usr/share/jupyter\n    runtime:\n        /home/lydia/.local/share/jupyter/runtime\n\n\n* 设置双击打开 \\*.ipynb 文件\n\n\n```bash\npip install nbopen\n```\n\n再执行:\n\nLinux/BSD: <br>\n```bash\npython3 -m nbopen.install_xdg<br>\n ```   \n\nWindows: <br>\n```bash\npython3 -m nbopen.install_win<br>\n```\n\nMac: <br>\n&ensp;Clone the repository (https://github.com/takluyver/nbopen.git)<br>\n&ensp;and run `./osx-install.sh`<br><br>\n之后即可在文件浏览器中选择文件的打开方式为 `Jupyter Notebook`.\n\n> 注意可能会更改 bash 脚本的默认打开方式.\n\n* Jupyter 插件集合<br>(https://github.com/ipython-contrib/jupyter_contrib_nbextensions)\n\n\n```bash\nconda install jupyter_contrib_nbextensions -c conda-forge\n```\n&ensp;Or\n```bash\npip install jupyter_contrib_nbextensions\n```\n> This also automatically installs the Javascript and CSS files:<br>\n`jupyter contrib nbextension install --sys-prefix`\n\n安装好后将同时启用 `Nbextensions` 选项卡, 手动选择需要的插件, \n或者在命令行启用和禁用:\n\n```bash\njupyter nbextension list # 查看\njupyter nbextension enable <path> # <path> 为上述 list 中的 <extension>/main\njupyter nbextension disable <path>\n```\n\n注意用如果 jupyter 安装在 conda 路径, 手动安装插件 (`jupyter nbextension install`) 时需要指定 <font color=red>--sys-prefix</font>\n\n* notebook 主题 (https://github.com/dunovank/jupyter-themes)\n\n\n```bash\npip install jupyterthemes\n```\n\n* 演示代码过程的插件 (https://github.com/lgpage/nbtutor)\n\n\n```bash\nconda install nbtutor -c conda-forge\n```\n&ensp;Or\n```bash\npip install nbtutor\njupyter nbextension install --overwrite --py nbtutor\njupyter nbextension enable --py nbtutor\n```\n\n载入:\n\n```python\n# ipython/jupyter\n%load_ext nbtutor\n```\n使用:<br>\nCodeCell 中首行加入下面语句, 然后执行 Cell (numpy 等需要在 Cell 内导入)\n```python\n# ipython/jupyter\n%%nbtutor -r -f\n# 或\n%%nbtutor -r -f -i  # 缩减显示\n```\n\n### 其他\n\n* PeakUtils (http://peakutils.readthedocs.io/en/latest/)\n\n\n```bash\ngit clone <https://bitbucket.org/lucashnegri/peakutils.git>\ncd peakutils\npython setup.py install\n```\n\n```python\n>>> import peakutils\n```\n\n* LMfit-py (https://github.com/lmfit/lmfit-py)\n\n\n```bash\nconda install lmfit -c conda-forge\n# 或\npip install lmfit\n```\n\n```python\n>>> import lmfit\n```\n\n* HDF5包 (http://docs.h5py.org/en/latest/index.html)<br>\n\n\n**pandas**\n```bash\nconda install pytables pandas\n```\n&ensp;Or\n```bash\npip install tables pandas\n```\n<br><br>\n**h5py** (http://docs.h5py.org/en/latest/index.html)\n```bash\nconda install h5py  # 推荐. 将同时安装 hdf5, 并得到 h5dump 等命令\n```\n&ensp;Or\n```bash\npip install h5py  # 需要 sudo apt-get install libhdf5-dev\n```\n\n* CDF包<br>\n\n安装 spacepy (https://pythonhosted.org/SpacePy)\n\n或\n\n```bash\npip install cdflib # <https://github.com/MAVENSDC/cdflib>\n```\n\n* EVTK (https://bitbucket.org/pauloh/pyevtk)\n\n\n```bash\nsudo apt-get install mercurial  # 得到 hg 命令\n\nhg clone <https://bitbucket.org/pauloh/pyevtk>\ncd pyevtk\npython setup.py build --debug install\n```\n\n```bash\nhg pull && hg update default # 更新\n```\n\n```python\n>>> from evtk.hl import gridToVTK\n```\n\n* Mayavi (http://docs.enthought.com/mayavi/mayavi)\n\n&emsp;需要先安装 cython (conda 或 pip)\n\n```bash\npip install mayavi  # 将同时安装 vtk. (pip 是目前 mayavi 最保险的安装方式)\n```\n```bash\n# shell\nmayavi2\n```\n","slug":"installpy","published":1,"updated":"2018-07-02T12:45:13.000Z","__permalink":"installpy.html","comments":1,"layout":"post","photos":[],"link":"","_id":"cl5kegavm0003vxgv2lqjf5w9","content":"<p><a\nhref=\"/downloads/notebooks/installpy.zip\"><i class=\"fas fa-download\"></i>\nJupyter Notebook</a></p>\n<p><small><font color=gray>[Update 2022-07-12] Some outputs are updated\nwith python 3.10.</font></small></p>\n<span id=\"more\"></span>\n<h2 id=\"安装-python\">安装 python</h2>\n<h3 id=\"安装-python-3\">安装 python 3</h3>\n<ul>\n<li>检查系统自带的版本:</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> sys\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>sys<span class=\"token punctuation\">.</span>version<span class=\"token punctuation\">)</span>\n!<span class=\"token punctuation\">&#123;</span>sys<span class=\"token punctuation\">.</span>executable<span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">-</span><span class=\"token operator\">-</span>version<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<pre><code>3.10.5 | packaged by conda-forge | (main, Jun 14 2022, 07:04:59) [GCC 10.3.0]\nPython 3.10.5</code></pre>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">%%bash\npython --version\npython3 --version<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<pre><code>Python 3.10.5\nPython 3.10.5</code></pre>\n<h3 id=\"pip\">pip</h3>\n<h4 id=\"安装-pip\">安装 pip</h4>\n<p>检查 pip 是否安装以及版本</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">%%bash\npip --version<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>pip 22.1.2 from /home/lydia/miniconda3/lib/python3.10/site-packages/pip (python 3.10)</code></pre>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">%%bash\npython -m pip --version<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>pip 22.1.2 from /home/lydia/miniconda3/lib/python3.10/site-packages/pip (python 3.10)</code></pre>\n<p>安装 (Ubuntu):</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> python3-pip<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<h4 id=\"用-pip-安装-python-包\">用 pip 安装 python 包</h4>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">pip <span class=\"token function\">install</span> <span class=\"token operator\">&lt;</span>package<span class=\"token operator\">></span>\npip <span class=\"token function\">install</span> --upgrade <span class=\"token operator\">&lt;</span>package<span class=\"token operator\">></span>\npip uninstall <span class=\"token operator\">&lt;</span>package<span class=\"token operator\">></span>\npip list\npip list --outdated\npip show <span class=\"token operator\">&lt;</span>package<span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>安装到根目录 (不推荐!)</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> -H pip <span class=\"token function\">install</span> <span class=\"token operator\">&lt;</span>package<span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>[选项]</p>\n<table>\n<colgroup>\n<col style=\"width: 50%\" />\n<col style=\"width: 50%\" />\n</colgroup>\n<tbody>\n<tr class=\"odd\">\n<td style=\"text-align: left;\">-U, --upgrade</td>\n<td style=\"text-align: left;\">升级, 配合 install 使用</td>\n</tr>\n<tr class=\"even\">\n<td style=\"text-align: left;\">--force-reinstall</td>\n<td style=\"text-align: left;\">强制重新安装依赖</td>\n</tr>\n<tr class=\"odd\">\n<td style=\"text-align: left;\">-I, --ignore-installed</td>\n<td style=\"text-align: left;\">强制安装 (无论是否已安装)</td>\n</tr>\n<tr class=\"even\">\n<td style=\"text-align: left;\">--no-cache-dir</td>\n<td style=\"text-align: left;\">不生成cache</td>\n</tr>\n<tr class=\"odd\">\n<td style=\"text-align: left;\">-i\n<font color=blue><em>url</em></font></td>\n<td style=\"text-align: left;\">使用指定源 (更改配置见 <a\nhref=\"#pip-镜像源\">pip 镜像源</a>)</td>\n</tr>\n<tr class=\"even\">\n<td\nstyle=\"text-align: left;\"><font color=blue><em>package</em></font>==x.x.x</td>\n<td style=\"text-align: left;\">指定版本, 错误版本号 (或为空)\n将返回可用版本号</td>\n</tr>\n<tr class=\"odd\">\n<td\nstyle=\"text-align: left;\">\"<font color=blue><em>package</em></font>&lt;x.x.x\"</td>\n<td style=\"text-align: left;\">指定小于某版本的最新版本, 必须有引号</td>\n</tr>\n</tbody>\n</table>\n<p>检查包 (尝试导入, 查看包版本):</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">python -c <span class=\"token string\">\"import &lt;package>\"</span>\npython -c <span class=\"token string\">\"import &lt;package>; print(&lt;package>.__version__)\"</span>  <span class=\"token comment\"># 版本号</span>\npython -c <span class=\"token string\">\"import &lt;package>; print(&lt;package>.version)\"</span>  <span class=\"token comment\"># 安装位置</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<h4 id=\"使-pip-安装-python-包到用户路径\">使 pip 安装 python\n包到用户路径</h4>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">%%bash\npython -m site <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> <span class=\"token string\">'USER_SITE'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>USER_SITE: &#39;/home/lydia/.local/lib/python3.10/site-packages&#39; (doesn&#39;t exist)\nENABLE_USER_SITE: True</code></pre>\n<ul>\n<li>确认已创建用户包安装路径.<br></li>\n<li>在 <code>~/.bashrc</code> 中设置 <code>PATH</code> 变量:</li>\n</ul>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\"><span class=\"token environment constant\">PATH</span></span><span class=\"token operator\">=</span><span class=\"token environment constant\">$HOME</span>/.local/bin:<span class=\"token environment constant\">$PATH</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<ul>\n<li>使用 <code>install</code> 或 <code>list</code> 时加上选项\n<font color=red>--user</font> (注意: <code>uninstall</code> 不用)</li>\n</ul>\n<blockquote>\n<p><font color=#b32425><em>使用 Anaconda 路径下的 pip\n时不需要这个选项</em></font></p>\n</blockquote>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">pip <span class=\"token function\">install</span> --user <span class=\"token operator\">&lt;</span>pkg_name<span class=\"token operator\">></span>\npip list --user\npip list --outdated --user<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<h3 id=\"anaconda\">Anaconda</h3>\n<h4 id=\"安装-anaconda-或-miniconda-推荐\">安装 Anaconda 或 Miniconda\n(推荐)</h4>\n<ul>\n<li><p>安装 miniconda 64位 (默认安装到\n<font color=blue>~/miniconda3/</font>)</p>\n<p>下载 <a href=\"https://conda.io/miniconda.html\"\nclass=\"uri\">https://conda.io/miniconda.html</a></p></li>\n</ul>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">bash</span> Miniconda3-latest-Linux-x86_64.sh<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<ul>\n<li>在 <code>~/.bashrc</code> 加入如下语句:</li>\n</ul>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\"><span class=\"token environment constant\">PATH</span></span><span class=\"token operator\">=</span><span class=\"token environment constant\">$HOME</span>/miniconda3/bin:<span class=\"token environment constant\">$PATH</span>\n<span class=\"token builtin class-name\">.</span> <span class=\"token environment constant\">$HOME</span>/miniconda3/etc/profile.d/conda.sh<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<p> 完成后执行:</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token builtin class-name\">source</span> ~/.bashrc<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<ul>\n<li>安装好后先更新 conda 和 pip:</li>\n</ul>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">conda update conda pip<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<ul>\n<li>帮助</li>\n</ul>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">conda <span class=\"token punctuation\">[</span>cmd<span class=\"token punctuation\">]</span> --help<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>miniconda 下载 <a href=\"https://conda.io/miniconda.html\"\nclass=\"uri\">https://conda.io/miniconda.html</a><br> 安装参考 <a\nhref=\"https://conda.io/docs/user-guide/install/index.html\"\nclass=\"uri\">https://conda.io/docs/user-guide/install/index.html</a></p>\n<h4 id=\"environment\">environment</h4>\n<p>默认环境为 base<br> <code>-n, --name &lt;env_name&gt;</code>\n指定环境</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">conda create --name <span class=\"token operator\">&lt;</span>env_name<span class=\"token operator\">></span> <span class=\"token punctuation\">[</span><span class=\"token operator\">&lt;</span>packages<span class=\"token operator\">></span><span class=\"token punctuation\">]</span> <span class=\"token assign-left variable\">python</span><span class=\"token operator\">=</span><span class=\"token number\">3.6</span>\nconda create --name <span class=\"token operator\">&lt;</span>env_name<span class=\"token operator\">></span> --clone base\n\n<span class=\"token comment\"># e.g.</span>\nconda create --name intel intelpython3_core <span class=\"token assign-left variable\">python</span><span class=\"token operator\">=</span><span class=\"token number\">3</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token comment\"># 删除环境</span>\nconda-env remove --name <span class=\"token operator\">&lt;</span>env_name<span class=\"token operator\">></span>\n*\n<span class=\"token comment\"># 列出信息</span>\nconda info -e/--envs\nconda-env list\n\n<span class=\"token comment\"># 进入环境</span>\n<span class=\"token builtin class-name\">source</span> activate <span class=\"token operator\">&lt;</span>env_name<span class=\"token operator\">></span>\nconda activate <span class=\"token operator\">&lt;</span>env_name<span class=\"token operator\">></span>\n\n<span class=\"token comment\"># 离开环境</span>\n<span class=\"token builtin class-name\">source</span> deactivate\nconda deactivate\n\n<span class=\"token comment\"># 在某环境中执行操作</span>\nconda <span class=\"token operator\">&lt;</span>commands<span class=\"token operator\">></span> --name <span class=\"token operator\">&lt;</span>env_name<span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h4 id=\"使用-conda-命令\">使用 conda 命令</h4>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">conda info\nconda list <span class=\"token punctuation\">[</span><span class=\"token operator\">&lt;</span>packages<span class=\"token operator\">></span><span class=\"token punctuation\">]</span>\nconda search <span class=\"token operator\">&lt;</span>package<span class=\"token operator\">></span>\nconda search <span class=\"token operator\">&lt;</span>package<span class=\"token operator\">></span> --info\nconda <span class=\"token function\">install</span> <span class=\"token operator\">&lt;</span>packages<span class=\"token operator\">></span>\nconda update/upgrade <span class=\"token operator\">&lt;</span>packages<span class=\"token operator\">></span>\nconda remove/uninstall <span class=\"token operator\">&lt;</span>packages<span class=\"token operator\">></span>\nconda clean --all<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>见 <code>conda --help</code> 或 <code>conda cmd --help</code>,\n<code>conda search</code> 语法见 <a\nhref=\"https://github.com/conda/conda/blob/master/conda/models/match_spec.py\"\nclass=\"uri\">https://github.com/conda/conda/blob/master/conda/models/match_spec.py</a></p>\n<p>配置: <pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token comment\"># 安装确认时显示源的 url, 默认已开启</span>\nconda config --set show_channel_urls True\n\n<span class=\"token comment\"># 禁止每次更新自动检查 conda 的更新, 默认True</span>\nconda config --set auto_update_conda False\n\n<span class=\"token comment\"># 禁止源优先而使用版本优先, 默认True</span>\nconda config --set channel_priority False\n\n<span class=\"token comment\"># 增加设置, 例如增加源 (可使用 url 或别名)</span>\nconda config --add channels <span class=\"token operator\">&lt;</span>channel<span class=\"token operator\">></span>\n\n<span class=\"token comment\"># 删除某项设置的所有值, 例如删除所有自定义源</span>\nconda config --remove-key channels\n\n<span class=\"token comment\"># 删除某项设置的某个值, 例如删除某个源</span>\nconda config --remove channels <span class=\"token operator\">&lt;</span>channel<span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>用户配置文件 <code>~/.condarc</code> (见 <a\nhref=\"#conda-镜像源\">conda 镜像源</a>)<br> 参考链接 <a\nhref=\"https://conda.io/docs/user-guide/configuration/use-condarc.html\"\nclass=\"uri\">https://conda.io/docs/user-guide/configuration/use-condarc.html</a></p>\n<p>也可以在不同的环境用不同的配置文件:\n<code>~/miniconda3/envs/&lt;env_name&gt;/.condarc</code></p>\n<h3 id=\"镜像源\">镜像源</h3>\n<h4 id=\"pip-镜像源\">pip 镜像源</h4>\n<p>用户配置文件:</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">%%bash\n<span class=\"token function\">cat</span> ~/.pip/pip.conf<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>[global]\nindex-url = &lt;https://pypi.douban.com/simple&gt;\ntrusted-host = pypi.doubanio.com</code></pre>\n<h4 id=\"conda-镜像源\">conda 镜像源</h4>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">conda config --add/--prepend channels <span class=\"token operator\">&lt;</span>new_channel<span class=\"token operator\">></span>\nconda config --append channels <span class=\"token operator\">&lt;</span>new_channel<span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<p>清华源:<br> <a\nhref=\"https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/\"\nclass=\"uri\">https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/</a><br>\n<a href=\"https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/\"\nclass=\"uri\">https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/</a><br>\n<a\nhref=\"https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge/\"\nclass=\"uri\">https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge/</a><br></p>\n<p>channels 的默认的优先级为: 前排优先<br> 镜像源中\n<code>pkgs/main</code> 通常比 <code>pkgs/free</code> 新,\n因此将其放在最前.<br> 或使用 <code>channel_priority: false</code>,\n见上一节 <a href=\"#使用-conda-命令\">conda 设置</a>.</p>\n<p>e.g.</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">conda config --add channels <span class=\"token operator\">&lt;</span>https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge/<span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>此时 <code>~/.condarc</code> 的内容:</p>\n<blockquote>\n<p>channels:<br>  - <a\nhref=\"https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge/\"\nclass=\"uri\">https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge/</a><br>\n - defaults</p>\n</blockquote>\n<h3 id=\"troubleshooting\">Troubleshooting</h3>\n<h4 id=\"conda-安装时指定源且禁用其他源\">conda\n安装时指定源且禁用其他源</h4>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">conda <span class=\"token function\">install</span> <span class=\"token operator\">&lt;</span>packages<span class=\"token operator\">></span> -c <span class=\"token operator\">&lt;</span>channel<span class=\"token operator\">></span> --override-channels<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<h4 id=\"astropy-新版不再支持旧版-python\">Astropy 新版不再支持旧版\nPython</h4>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">pip <span class=\"token function\">install</span> <span class=\"token string\">\"astropy&lt;3.0\"</span> <span class=\"token comment\"># for python &lt; 3.5</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<h2 id=\"安装常用包\">安装常用包</h2>\n<h3 id=\"numpy-scipy-matplotlib\">numpy, scipy, matplotlib</h3>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">conda <span class=\"token function\">install</span> numpy\nconda <span class=\"token function\">install</span> scipy\nconda <span class=\"token function\">install</span> matplotlib<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<p> Or <pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">pip <span class=\"token function\">install</span> numpy\npip <span class=\"token function\">install</span> scipy\npip <span class=\"token function\">install</span> matplotlib<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre></p>\n<p>配置启动文件 (Ubuntu), 在 <code>~/.bashrc</code> 中添加:\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">PYTHONSTARTUP</span><span class=\"token operator\">=</span><span class=\"token environment constant\">$HOME</span>/.pythonrc<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">cat <span class=\"token operator\">~</span><span class=\"token operator\">/</span><span class=\"token punctuation\">.</span>pythonrc<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code># Python startup file\n# ~/.pythonrc\nimport matplotlib.pyplot as plt\nfrom matplotlib import cm\nimport numpy as np\nimport os\n\nprint(&quot;&gt;&gt;&gt; import matplotlib.pyplot as plt&quot;)\nprint(&quot;&gt;&gt;&gt; from matplotlib import cm&quot;)\nprint(&quot;&gt;&gt;&gt; import numpy as np&quot;)\nprint(&quot;&gt;&gt;&gt; import os&quot;)\n\ntry:\n    from pprint import pprint\nexcept ImportError:\n    pass\nelse:\n    print(&quot;&gt;&gt;&gt; from pprint import pprint&quot;)\n\n# Tab completion &amp; history\ntry:\n    import atexit, readline, rlcompleter\nexcept ImportError:\n    pass\nelse:\n    readline.parse_and_bind(&#39;tab: complete&#39;) # Tab completion\n    readline.parse_and_bind(&#39;&#39;&#39;control-l:&quot;    &quot;&#39;&#39;&#39;) # Indent, since TAB is occupied\n    histfile = os.path.join(os.environ[&#39;HOME&#39;], &#39;.pyhistory&#39;) # History file\n    try:\n        readline.read_history_file(histfile)\n    except IOError:\n        pass\n    atexit.register(readline.write_history_file, histfile)\n    del histfile, readline, rlcompleter\n    print(&quot;--- Tab completion: [ON] ---&quot;)\n    print(&quot;--- History: [ON] ---&quot;)\n    print(&quot;--- [Tab] -&gt; [Ctrl+L] ---&quot;)</code></pre>\n<h3 id=\"astropy-sunpy\">Astropy, SunPy</h3>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">conda <span class=\"token function\">install</span> astropy\nconda <span class=\"token function\">install</span> sunpy -c conda-forge<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<p> Or <pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">pip <span class=\"token function\">install</span> astropy\npip <span class=\"token function\">install</span> sunpy<span class=\"token punctuation\">[</span>all<span class=\"token punctuation\">]</span> pytest<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre></p>\n<p>测试:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token keyword\">import</span> astropy\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> astropy<span class=\"token punctuation\">.</span>test<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token keyword\">import</span> sunpy\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> sunpy<span class=\"token punctuation\">.</span>self_test<span class=\"token punctuation\">(</span>online<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<p>如果出错: '$USER'权限问题, 见下面修改 <code>~/.sunpy/sunpyrc</code>\n说明.</p>\n<p>查看包信息:</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">%%bash\nconda search <span class=\"token string\">\"conda-forge::sunpy>=4.0\"</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>Loading channels: ...working... done\n# Name                       Version           Build  Channel             \nsunpy                          4.0.0 py310hde88566_0  conda-forge         \nsunpy                          4.0.0  py38h71d37f0_0  conda-forge         \nsunpy                          4.0.0  py39hd257fcd_0  conda-forge         \nsunpy                          4.0.1 py310hde88566_0  conda-forge         \nsunpy                          4.0.1  py38h71d37f0_0  conda-forge         \nsunpy                          4.0.1  py39hd257fcd_0  conda-forge         \nsunpy                          4.0.2 py310hde88566_0  conda-forge         \nsunpy                          4.0.2  py38h71d37f0_0  conda-forge         \nsunpy                          4.0.2  py39hd257fcd_0  conda-forge         \nsunpy                          4.0.3 py310hde88566_0  conda-forge         \nsunpy                          4.0.3  py38h71d37f0_0  conda-forge         \nsunpy                          4.0.3  py39hd257fcd_0  conda-forge         </code></pre>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">%%bash\nconda search <span class=\"token string\">\"sunpy 4.0.3 py310hde88566_0\"</span> --info<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>Loading channels: ...working... done\nsunpy 4.0.3 py310hde88566_0\n---------------------------\nfile name   : sunpy-4.0.3-py310hde88566_0.tar.bz2\nname        : sunpy\nversion     : 4.0.3\nbuild       : py310hde88566_0\nbuild number: 0\nsize        : 5.7 MB\nlicense     : BSD-2-Clause\nsubdir      : linux-64\nurl         : &lt;https://conda.anaconda.org/conda-forge/linux-64/sunpy-4.0.3-py310hde88566_0.tar.bz2&gt;\nmd5         : 5831b8fde0edd2aa0ff9f42b237b7ba2\ntimestamp   : 2022-07-08 16:21:32 UTC\ndependencies: \n  - asdf &gt;=2.8.0\n  - asdf-astropy &gt;=0.1.1\n  - astropy &gt;=4.1.0\n  - beautifulsoup4 &gt;=4.8.0\n  - cdflib &gt;=0.3.19,!=0.4.0\n  - drms &gt;=0.6.1\n  - glymur &gt;=0.8.18,!=0.9.0,!=0.9.5\n  - h5netcdf &gt;=0.8.1\n  - h5py &gt;=3.1.0\n  - libgcc-ng &gt;=12\n  - matplotlib-base &gt;=3.2.0\n  - mpl_animators &gt;=1.0.0\n  - numpy &gt;=1.21.6,&lt;2.0a0\n  - pandas &gt;=1.0.0\n  - parfive &gt;=1.2.0\n  - python &gt;=3.10,&lt;3.11.0a0\n  - python-dateutil &gt;=2.8.0\n  - python_abi 3.10.* *_cp310\n  - reproject\n  - scikit-image &gt;=0.16.0\n  - scipy &gt;=1.3.0\n  - setuptools\n  - sqlalchemy &gt;=1.3.4\n  - tqdm &gt;=4.32.1\n  - zeep &gt;=3.4.0</code></pre>\n<p>用户文件位置: <code>~/.sunpy/sunpyrc</code></p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">cat <span class=\"token operator\">~</span><span class=\"token operator\">/</span><span class=\"token punctuation\">.</span>sunpy<span class=\"token operator\">/</span>sunpyrc<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>[general]\ntime_format = %Y-%m-%d %H:%M:%S\nworking_dir = /home/lydia/sunpy-downloads\n\n[downloads]\ndownload_dir = /home/lydia/sunpy-downloads/data\nsample_dir = /home/lydia/sunpy-downloads/data/sample_data\n\n[database]\nurl = sqlite:////home/lydia/sunpy-downloads/sunpydb.sqlite</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> sunpy\nsunpy<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>system_info<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>==============================\nsunpy Installation Information\n==============================\n\nGeneral\n#######\nOS: Ubuntu (18.04, Linux 4.19.128-microsoft-standard)\nArch: 64bit, (x86_64)\nsunpy: 4.0.3\nInstallation path: /home/lydia/miniconda3/lib/python3.10/site-packages/sunpy-4.0.3.dist-info\n\nRequired Dependencies\n#####################\nastropy: 5.1\nnumpy: 1.23.1\npackaging: 21.3\nparfive: 1.5.1\n\nOptional Dependencies\n#####################\nasdf: 2.12.0\nasdf-astropy: 0.2.1\nbeautifulsoup4: 4.11.1\ncdflib: 0.4.4\ndask: 2022.7.0\ndrms: 0.6.2\nglymur: 0.10.1\nh5netcdf: 0.0.0\nh5py: 3.7.0\nmatplotlib: 3.5.2\nmpl-animators: 1.0.1\npandas: 1.4.1\npython-dateutil: 2.8.2\nreproject: 0.8\nscikit-image: 0.19.3\nscipy: 1.8.1\nsqlalchemy: 1.4.39\ntqdm: 4.64.0\nzeep: 4.1.0</code></pre>\n<p>设置下载位置:<br> (参考 <a\nhref=\"http://docs.sunpy.org/en/stable/guide/customization.html?highlight=sunpy.config.set)\"\nclass=\"uri\">http://docs.sunpy.org/en/stable/guide/customization.html?highlight=sunpy.config.set)</a></p>\n<p>e.g. &gt; [downloads]<br>  download_dir = ...</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token keyword\">import</span> sunpy\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> sunpy<span class=\"token punctuation\">.</span>config<span class=\"token punctuation\">.</span><span class=\"token builtin\">set</span><span class=\"token punctuation\">(</span><span class=\"token string\">'downloads'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'download_dir'</span><span class=\"token punctuation\">,</span>\n                 <span class=\"token string\">'/home/&lt;user>/&lt;your_path>/sunpy-downloads/data'</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<p>退出后再进入 python 如果发现没有修改成功, 则需要手动修改\n~/.sunpy/sunpyrc 文件.<br> 不能用 '$USER' 代替具体的用户名\n'&lt;user&gt;'</p>\n<h3 id=\"jupyter\">Jupyter</h3>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">conda <span class=\"token function\">install</span> jupyter -c conda-forge<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p> Or <pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">pip <span class=\"token function\">install</span> jupyter<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">%%bash\njupyter --path<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>config:\n    /home/lydia/.jupyter\n    /home/lydia/.local/etc/jupyter\n    /home/lydia/miniconda3/etc/jupyter\n    /usr/local/etc/jupyter\n    /etc/jupyter\ndata:\n    /home/lydia/.local/share/jupyter\n    /home/lydia/miniconda3/share/jupyter\n    /usr/local/share/jupyter\n    /usr/share/jupyter\nruntime:\n    /home/lydia/.local/share/jupyter/runtime</code></pre>\n<ul>\n<li>设置双击打开 *.ipynb 文件</li>\n</ul>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">pip <span class=\"token function\">install</span> nbopen<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>再执行:</p>\n<p>Linux/BSD: <br> <pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">python3 -m nbopen.install_xdg<span class=\"token operator\">&lt;</span>br<span class=\"token operator\">></span>\n ``<span class=\"token variable\"><span class=\"token variable\">`</span>   \n\nWindows: <span class=\"token operator\">&lt;</span>br<span class=\"token operator\">></span>\n<span class=\"token variable\">`</span></span>``bash\npython3 -m nbopen.install_win<span class=\"token operator\">&lt;</span>br<span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>Mac: <br>  Clone the repository\n(https://github.com/takluyver/nbopen.git)<br>  and run\n<code>./osx-install.sh</code><br><br>\n之后即可在文件浏览器中选择文件的打开方式为\n<code>Jupyter Notebook</code>.</p>\n<blockquote>\n<p>注意可能会更改 bash 脚本的默认打开方式.</p>\n</blockquote>\n<ul>\n<li>Jupyter\n插件集合<br>(https://github.com/ipython-contrib/jupyter_contrib_nbextensions)</li>\n</ul>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">conda <span class=\"token function\">install</span> jupyter_contrib_nbextensions -c conda-forge<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p> Or <pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">pip <span class=\"token function\">install</span> jupyter_contrib_nbextensions<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre> &gt; This also automatically installs the\nJavascript and CSS files:<br>\n<code>jupyter contrib nbextension install --sys-prefix</code></p>\n<p>安装好后将同时启用 <code>Nbextensions</code> 选项卡,\n手动选择需要的插件, 或者在命令行启用和禁用:</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">jupyter nbextension list <span class=\"token comment\"># 查看</span>\njupyter nbextension <span class=\"token builtin class-name\">enable</span> <span class=\"token operator\">&lt;</span>path<span class=\"token operator\">></span> <span class=\"token comment\"># &lt;path> 为上述 list 中的 &lt;extension>/main</span>\njupyter nbextension disable <span class=\"token operator\">&lt;</span>path<span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<p>注意用如果 jupyter 安装在 conda 路径, 手动安装插件\n(<code>jupyter nbextension install</code>) 时需要指定\n<font color=red>--sys-prefix</font></p>\n<ul>\n<li>notebook 主题 (https://github.com/dunovank/jupyter-themes)</li>\n</ul>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">pip <span class=\"token function\">install</span> jupyterthemes<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<ul>\n<li>演示代码过程的插件 (https://github.com/lgpage/nbtutor)</li>\n</ul>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">conda <span class=\"token function\">install</span> nbtutor -c conda-forge<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p> Or <pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">pip <span class=\"token function\">install</span> nbtutor\njupyter nbextension <span class=\"token function\">install</span> --overwrite --py nbtutor\njupyter nbextension <span class=\"token builtin class-name\">enable</span> --py nbtutor<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre></p>\n<p>载入:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># ipython/jupyter</span>\n<span class=\"token operator\">%</span>load_ext nbtutor<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<p>使用:<br> CodeCell 中首行加入下面语句, 然后执行 Cell (numpy 等需要在\nCell 内导入) <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># ipython/jupyter</span>\n<span class=\"token operator\">%</span><span class=\"token operator\">%</span>nbtutor <span class=\"token operator\">-</span>r <span class=\"token operator\">-</span>f\n<span class=\"token comment\"># 或</span>\n<span class=\"token operator\">%</span><span class=\"token operator\">%</span>nbtutor <span class=\"token operator\">-</span>r <span class=\"token operator\">-</span>f <span class=\"token operator\">-</span>i  <span class=\"token comment\"># 缩减显示</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre></p>\n<h3 id=\"其他\">其他</h3>\n<ul>\n<li>PeakUtils (http://peakutils.readthedocs.io/en/latest/)</li>\n</ul>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> clone <span class=\"token operator\">&lt;</span>https://bitbucket.org/lucashnegri/peakutils.git<span class=\"token operator\">></span>\n<span class=\"token builtin class-name\">cd</span> peakutils\npython setup.py <span class=\"token function\">install</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token keyword\">import</span> peakutils<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<ul>\n<li>LMfit-py (https://github.com/lmfit/lmfit-py)</li>\n</ul>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">conda <span class=\"token function\">install</span> lmfit -c conda-forge\n<span class=\"token comment\"># 或</span>\npip <span class=\"token function\">install</span> lmfit<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token keyword\">import</span> lmfit<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<ul>\n<li>HDF5包 (http://docs.h5py.org/en/latest/index.html)<br></li>\n</ul>\n<p><strong>pandas</strong> <pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">conda <span class=\"token function\">install</span> pytables pandas<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>  Or <pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">pip <span class=\"token function\">install</span> tables pandas<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre> <br><br>\n<strong>h5py</strong> (http://docs.h5py.org/en/latest/index.html)\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">conda <span class=\"token function\">install</span> h5py  <span class=\"token comment\"># 推荐. 将同时安装 hdf5, 并得到 h5dump 等命令</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>  Or <pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">pip <span class=\"token function\">install</span> h5py  <span class=\"token comment\"># 需要 sudo apt-get install libhdf5-dev</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<ul>\n<li>CDF包<br></li>\n</ul>\n<p>安装 spacepy (https://pythonhosted.org/SpacePy)</p>\n<p>或</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">pip <span class=\"token function\">install</span> cdflib <span class=\"token comment\"># &lt;https://github.com/MAVENSDC/cdflib></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<ul>\n<li>EVTK (https://bitbucket.org/pauloh/pyevtk)</li>\n</ul>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> mercurial  <span class=\"token comment\"># 得到 hg 命令</span>\n\n<span class=\"token function\">hg</span> clone <span class=\"token operator\">&lt;</span>https://bitbucket.org/pauloh/pyevtk<span class=\"token operator\">></span>\n<span class=\"token builtin class-name\">cd</span> pyevtk\npython setup.py build --debug <span class=\"token function\">install</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">hg</span> pull <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">hg</span> update default <span class=\"token comment\"># 更新</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token keyword\">from</span> evtk<span class=\"token punctuation\">.</span>hl <span class=\"token keyword\">import</span> gridToVTK<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<ul>\n<li>Mayavi (http://docs.enthought.com/mayavi/mayavi)</li>\n</ul>\n<p> 需要先安装 cython (conda 或 pip)</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">pip <span class=\"token function\">install</span> mayavi  <span class=\"token comment\"># 将同时安装 vtk. (pip 是目前 mayavi 最保险的安装方式)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token comment\"># shell</span>\nmayavi2<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n","site":{"data":{}},"excerpt":"<p><a\nhref=\"/downloads/notebooks/installpy.zip\"><i class=\"fas fa-download\"></i>\nJupyter Notebook</a></p>\n<p><small><font color=gray>[Update 2022-07-12] Some outputs are updated\nwith python 3.10.</font></small></p>","more":"<h2 id=\"安装-python\">安装 python</h2>\n<h3 id=\"安装-python-3\">安装 python 3</h3>\n<ul>\n<li>检查系统自带的版本:</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> sys\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>sys<span class=\"token punctuation\">.</span>version<span class=\"token punctuation\">)</span>\n!<span class=\"token punctuation\">&#123;</span>sys<span class=\"token punctuation\">.</span>executable<span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">-</span><span class=\"token operator\">-</span>version<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<pre><code>3.10.5 | packaged by conda-forge | (main, Jun 14 2022, 07:04:59) [GCC 10.3.0]\nPython 3.10.5</code></pre>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">%%bash\npython --version\npython3 --version<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<pre><code>Python 3.10.5\nPython 3.10.5</code></pre>\n<h3 id=\"pip\">pip</h3>\n<h4 id=\"安装-pip\">安装 pip</h4>\n<p>检查 pip 是否安装以及版本</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">%%bash\npip --version<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>pip 22.1.2 from /home/lydia/miniconda3/lib/python3.10/site-packages/pip (python 3.10)</code></pre>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">%%bash\npython -m pip --version<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>pip 22.1.2 from /home/lydia/miniconda3/lib/python3.10/site-packages/pip (python 3.10)</code></pre>\n<p>安装 (Ubuntu):</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> python3-pip<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<h4 id=\"用-pip-安装-python-包\">用 pip 安装 python 包</h4>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">pip <span class=\"token function\">install</span> <span class=\"token operator\">&lt;</span>package<span class=\"token operator\">></span>\npip <span class=\"token function\">install</span> --upgrade <span class=\"token operator\">&lt;</span>package<span class=\"token operator\">></span>\npip uninstall <span class=\"token operator\">&lt;</span>package<span class=\"token operator\">></span>\npip list\npip list --outdated\npip show <span class=\"token operator\">&lt;</span>package<span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>安装到根目录 (不推荐!)</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> -H pip <span class=\"token function\">install</span> <span class=\"token operator\">&lt;</span>package<span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>[选项]</p>\n<table>\n<colgroup>\n<col style=\"width: 50%\" />\n<col style=\"width: 50%\" />\n</colgroup>\n<tbody>\n<tr class=\"odd\">\n<td style=\"text-align: left;\">-U, --upgrade</td>\n<td style=\"text-align: left;\">升级, 配合 install 使用</td>\n</tr>\n<tr class=\"even\">\n<td style=\"text-align: left;\">--force-reinstall</td>\n<td style=\"text-align: left;\">强制重新安装依赖</td>\n</tr>\n<tr class=\"odd\">\n<td style=\"text-align: left;\">-I, --ignore-installed</td>\n<td style=\"text-align: left;\">强制安装 (无论是否已安装)</td>\n</tr>\n<tr class=\"even\">\n<td style=\"text-align: left;\">--no-cache-dir</td>\n<td style=\"text-align: left;\">不生成cache</td>\n</tr>\n<tr class=\"odd\">\n<td style=\"text-align: left;\">-i\n<font color=blue><em>url</em></font></td>\n<td style=\"text-align: left;\">使用指定源 (更改配置见 <a\nhref=\"#pip-镜像源\">pip 镜像源</a>)</td>\n</tr>\n<tr class=\"even\">\n<td\nstyle=\"text-align: left;\"><font color=blue><em>package</em></font>==x.x.x</td>\n<td style=\"text-align: left;\">指定版本, 错误版本号 (或为空)\n将返回可用版本号</td>\n</tr>\n<tr class=\"odd\">\n<td\nstyle=\"text-align: left;\">\"<font color=blue><em>package</em></font>&lt;x.x.x\"</td>\n<td style=\"text-align: left;\">指定小于某版本的最新版本, 必须有引号</td>\n</tr>\n</tbody>\n</table>\n<p>检查包 (尝试导入, 查看包版本):</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">python -c <span class=\"token string\">\"import &lt;package>\"</span>\npython -c <span class=\"token string\">\"import &lt;package>; print(&lt;package>.__version__)\"</span>  <span class=\"token comment\"># 版本号</span>\npython -c <span class=\"token string\">\"import &lt;package>; print(&lt;package>.version)\"</span>  <span class=\"token comment\"># 安装位置</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<h4 id=\"使-pip-安装-python-包到用户路径\">使 pip 安装 python\n包到用户路径</h4>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">%%bash\npython -m site <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> <span class=\"token string\">'USER_SITE'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>USER_SITE: &#39;/home/lydia/.local/lib/python3.10/site-packages&#39; (doesn&#39;t exist)\nENABLE_USER_SITE: True</code></pre>\n<ul>\n<li>确认已创建用户包安装路径.<br></li>\n<li>在 <code>~/.bashrc</code> 中设置 <code>PATH</code> 变量:</li>\n</ul>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\"><span class=\"token environment constant\">PATH</span></span><span class=\"token operator\">=</span><span class=\"token environment constant\">$HOME</span>/.local/bin:<span class=\"token environment constant\">$PATH</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<ul>\n<li>使用 <code>install</code> 或 <code>list</code> 时加上选项\n<font color=red>--user</font> (注意: <code>uninstall</code> 不用)</li>\n</ul>\n<blockquote>\n<p><font color=#b32425><em>使用 Anaconda 路径下的 pip\n时不需要这个选项</em></font></p>\n</blockquote>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">pip <span class=\"token function\">install</span> --user <span class=\"token operator\">&lt;</span>pkg_name<span class=\"token operator\">></span>\npip list --user\npip list --outdated --user<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<h3 id=\"anaconda\">Anaconda</h3>\n<h4 id=\"安装-anaconda-或-miniconda-推荐\">安装 Anaconda 或 Miniconda\n(推荐)</h4>\n<ul>\n<li><p>安装 miniconda 64位 (默认安装到\n<font color=blue>~/miniconda3/</font>)</p>\n<p>下载 <a href=\"https://conda.io/miniconda.html\"\nclass=\"uri\">https://conda.io/miniconda.html</a></p></li>\n</ul>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">bash</span> Miniconda3-latest-Linux-x86_64.sh<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<ul>\n<li>在 <code>~/.bashrc</code> 加入如下语句:</li>\n</ul>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\"><span class=\"token environment constant\">PATH</span></span><span class=\"token operator\">=</span><span class=\"token environment constant\">$HOME</span>/miniconda3/bin:<span class=\"token environment constant\">$PATH</span>\n<span class=\"token builtin class-name\">.</span> <span class=\"token environment constant\">$HOME</span>/miniconda3/etc/profile.d/conda.sh<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<p> 完成后执行:</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token builtin class-name\">source</span> ~/.bashrc<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<ul>\n<li>安装好后先更新 conda 和 pip:</li>\n</ul>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">conda update conda pip<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<ul>\n<li>帮助</li>\n</ul>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">conda <span class=\"token punctuation\">[</span>cmd<span class=\"token punctuation\">]</span> --help<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>miniconda 下载 <a href=\"https://conda.io/miniconda.html\"\nclass=\"uri\">https://conda.io/miniconda.html</a><br> 安装参考 <a\nhref=\"https://conda.io/docs/user-guide/install/index.html\"\nclass=\"uri\">https://conda.io/docs/user-guide/install/index.html</a></p>\n<h4 id=\"environment\">environment</h4>\n<p>默认环境为 base<br> <code>-n, --name &lt;env_name&gt;</code>\n指定环境</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">conda create --name <span class=\"token operator\">&lt;</span>env_name<span class=\"token operator\">></span> <span class=\"token punctuation\">[</span><span class=\"token operator\">&lt;</span>packages<span class=\"token operator\">></span><span class=\"token punctuation\">]</span> <span class=\"token assign-left variable\">python</span><span class=\"token operator\">=</span><span class=\"token number\">3.6</span>\nconda create --name <span class=\"token operator\">&lt;</span>env_name<span class=\"token operator\">></span> --clone base\n\n<span class=\"token comment\"># e.g.</span>\nconda create --name intel intelpython3_core <span class=\"token assign-left variable\">python</span><span class=\"token operator\">=</span><span class=\"token number\">3</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token comment\"># 删除环境</span>\nconda-env remove --name <span class=\"token operator\">&lt;</span>env_name<span class=\"token operator\">></span>\n*\n<span class=\"token comment\"># 列出信息</span>\nconda info -e/--envs\nconda-env list\n\n<span class=\"token comment\"># 进入环境</span>\n<span class=\"token builtin class-name\">source</span> activate <span class=\"token operator\">&lt;</span>env_name<span class=\"token operator\">></span>\nconda activate <span class=\"token operator\">&lt;</span>env_name<span class=\"token operator\">></span>\n\n<span class=\"token comment\"># 离开环境</span>\n<span class=\"token builtin class-name\">source</span> deactivate\nconda deactivate\n\n<span class=\"token comment\"># 在某环境中执行操作</span>\nconda <span class=\"token operator\">&lt;</span>commands<span class=\"token operator\">></span> --name <span class=\"token operator\">&lt;</span>env_name<span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h4 id=\"使用-conda-命令\">使用 conda 命令</h4>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">conda info\nconda list <span class=\"token punctuation\">[</span><span class=\"token operator\">&lt;</span>packages<span class=\"token operator\">></span><span class=\"token punctuation\">]</span>\nconda search <span class=\"token operator\">&lt;</span>package<span class=\"token operator\">></span>\nconda search <span class=\"token operator\">&lt;</span>package<span class=\"token operator\">></span> --info\nconda <span class=\"token function\">install</span> <span class=\"token operator\">&lt;</span>packages<span class=\"token operator\">></span>\nconda update/upgrade <span class=\"token operator\">&lt;</span>packages<span class=\"token operator\">></span>\nconda remove/uninstall <span class=\"token operator\">&lt;</span>packages<span class=\"token operator\">></span>\nconda clean --all<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>见 <code>conda --help</code> 或 <code>conda cmd --help</code>,\n<code>conda search</code> 语法见 <a\nhref=\"https://github.com/conda/conda/blob/master/conda/models/match_spec.py\"\nclass=\"uri\">https://github.com/conda/conda/blob/master/conda/models/match_spec.py</a></p>\n<p>配置: <pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token comment\"># 安装确认时显示源的 url, 默认已开启</span>\nconda config --set show_channel_urls True\n\n<span class=\"token comment\"># 禁止每次更新自动检查 conda 的更新, 默认True</span>\nconda config --set auto_update_conda False\n\n<span class=\"token comment\"># 禁止源优先而使用版本优先, 默认True</span>\nconda config --set channel_priority False\n\n<span class=\"token comment\"># 增加设置, 例如增加源 (可使用 url 或别名)</span>\nconda config --add channels <span class=\"token operator\">&lt;</span>channel<span class=\"token operator\">></span>\n\n<span class=\"token comment\"># 删除某项设置的所有值, 例如删除所有自定义源</span>\nconda config --remove-key channels\n\n<span class=\"token comment\"># 删除某项设置的某个值, 例如删除某个源</span>\nconda config --remove channels <span class=\"token operator\">&lt;</span>channel<span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>用户配置文件 <code>~/.condarc</code> (见 <a\nhref=\"#conda-镜像源\">conda 镜像源</a>)<br> 参考链接 <a\nhref=\"https://conda.io/docs/user-guide/configuration/use-condarc.html\"\nclass=\"uri\">https://conda.io/docs/user-guide/configuration/use-condarc.html</a></p>\n<p>也可以在不同的环境用不同的配置文件:\n<code>~/miniconda3/envs/&lt;env_name&gt;/.condarc</code></p>\n<h3 id=\"镜像源\">镜像源</h3>\n<h4 id=\"pip-镜像源\">pip 镜像源</h4>\n<p>用户配置文件:</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">%%bash\n<span class=\"token function\">cat</span> ~/.pip/pip.conf<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>[global]\nindex-url = &lt;https://pypi.douban.com/simple&gt;\ntrusted-host = pypi.doubanio.com</code></pre>\n<h4 id=\"conda-镜像源\">conda 镜像源</h4>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">conda config --add/--prepend channels <span class=\"token operator\">&lt;</span>new_channel<span class=\"token operator\">></span>\nconda config --append channels <span class=\"token operator\">&lt;</span>new_channel<span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<p>清华源:<br> <a\nhref=\"https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/\"\nclass=\"uri\">https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/</a><br>\n<a href=\"https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/\"\nclass=\"uri\">https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/</a><br>\n<a\nhref=\"https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge/\"\nclass=\"uri\">https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge/</a><br></p>\n<p>channels 的默认的优先级为: 前排优先<br> 镜像源中\n<code>pkgs/main</code> 通常比 <code>pkgs/free</code> 新,\n因此将其放在最前.<br> 或使用 <code>channel_priority: false</code>,\n见上一节 <a href=\"#使用-conda-命令\">conda 设置</a>.</p>\n<p>e.g.</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">conda config --add channels <span class=\"token operator\">&lt;</span>https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge/<span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>此时 <code>~/.condarc</code> 的内容:</p>\n<blockquote>\n<p>channels:<br>  - <a\nhref=\"https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge/\"\nclass=\"uri\">https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge/</a><br>\n - defaults</p>\n</blockquote>\n<h3 id=\"troubleshooting\">Troubleshooting</h3>\n<h4 id=\"conda-安装时指定源且禁用其他源\">conda\n安装时指定源且禁用其他源</h4>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">conda <span class=\"token function\">install</span> <span class=\"token operator\">&lt;</span>packages<span class=\"token operator\">></span> -c <span class=\"token operator\">&lt;</span>channel<span class=\"token operator\">></span> --override-channels<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<h4 id=\"astropy-新版不再支持旧版-python\">Astropy 新版不再支持旧版\nPython</h4>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">pip <span class=\"token function\">install</span> <span class=\"token string\">\"astropy&lt;3.0\"</span> <span class=\"token comment\"># for python &lt; 3.5</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<h2 id=\"安装常用包\">安装常用包</h2>\n<h3 id=\"numpy-scipy-matplotlib\">numpy, scipy, matplotlib</h3>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">conda <span class=\"token function\">install</span> numpy\nconda <span class=\"token function\">install</span> scipy\nconda <span class=\"token function\">install</span> matplotlib<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<p> Or <pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">pip <span class=\"token function\">install</span> numpy\npip <span class=\"token function\">install</span> scipy\npip <span class=\"token function\">install</span> matplotlib<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre></p>\n<p>配置启动文件 (Ubuntu), 在 <code>~/.bashrc</code> 中添加:\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">PYTHONSTARTUP</span><span class=\"token operator\">=</span><span class=\"token environment constant\">$HOME</span>/.pythonrc<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">cat <span class=\"token operator\">~</span><span class=\"token operator\">/</span><span class=\"token punctuation\">.</span>pythonrc<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code># Python startup file\n# ~/.pythonrc\nimport matplotlib.pyplot as plt\nfrom matplotlib import cm\nimport numpy as np\nimport os\n\nprint(&quot;&gt;&gt;&gt; import matplotlib.pyplot as plt&quot;)\nprint(&quot;&gt;&gt;&gt; from matplotlib import cm&quot;)\nprint(&quot;&gt;&gt;&gt; import numpy as np&quot;)\nprint(&quot;&gt;&gt;&gt; import os&quot;)\n\ntry:\n    from pprint import pprint\nexcept ImportError:\n    pass\nelse:\n    print(&quot;&gt;&gt;&gt; from pprint import pprint&quot;)\n\n# Tab completion &amp; history\ntry:\n    import atexit, readline, rlcompleter\nexcept ImportError:\n    pass\nelse:\n    readline.parse_and_bind(&#39;tab: complete&#39;) # Tab completion\n    readline.parse_and_bind(&#39;&#39;&#39;control-l:&quot;    &quot;&#39;&#39;&#39;) # Indent, since TAB is occupied\n    histfile = os.path.join(os.environ[&#39;HOME&#39;], &#39;.pyhistory&#39;) # History file\n    try:\n        readline.read_history_file(histfile)\n    except IOError:\n        pass\n    atexit.register(readline.write_history_file, histfile)\n    del histfile, readline, rlcompleter\n    print(&quot;--- Tab completion: [ON] ---&quot;)\n    print(&quot;--- History: [ON] ---&quot;)\n    print(&quot;--- [Tab] -&gt; [Ctrl+L] ---&quot;)</code></pre>\n<h3 id=\"astropy-sunpy\">Astropy, SunPy</h3>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">conda <span class=\"token function\">install</span> astropy\nconda <span class=\"token function\">install</span> sunpy -c conda-forge<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<p> Or <pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">pip <span class=\"token function\">install</span> astropy\npip <span class=\"token function\">install</span> sunpy<span class=\"token punctuation\">[</span>all<span class=\"token punctuation\">]</span> pytest<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre></p>\n<p>测试:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token keyword\">import</span> astropy\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> astropy<span class=\"token punctuation\">.</span>test<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token keyword\">import</span> sunpy\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> sunpy<span class=\"token punctuation\">.</span>self_test<span class=\"token punctuation\">(</span>online<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<p>如果出错: '$USER'权限问题, 见下面修改 <code>~/.sunpy/sunpyrc</code>\n说明.</p>\n<p>查看包信息:</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">%%bash\nconda search <span class=\"token string\">\"conda-forge::sunpy>=4.0\"</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>Loading channels: ...working... done\n# Name                       Version           Build  Channel             \nsunpy                          4.0.0 py310hde88566_0  conda-forge         \nsunpy                          4.0.0  py38h71d37f0_0  conda-forge         \nsunpy                          4.0.0  py39hd257fcd_0  conda-forge         \nsunpy                          4.0.1 py310hde88566_0  conda-forge         \nsunpy                          4.0.1  py38h71d37f0_0  conda-forge         \nsunpy                          4.0.1  py39hd257fcd_0  conda-forge         \nsunpy                          4.0.2 py310hde88566_0  conda-forge         \nsunpy                          4.0.2  py38h71d37f0_0  conda-forge         \nsunpy                          4.0.2  py39hd257fcd_0  conda-forge         \nsunpy                          4.0.3 py310hde88566_0  conda-forge         \nsunpy                          4.0.3  py38h71d37f0_0  conda-forge         \nsunpy                          4.0.3  py39hd257fcd_0  conda-forge         </code></pre>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">%%bash\nconda search <span class=\"token string\">\"sunpy 4.0.3 py310hde88566_0\"</span> --info<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>Loading channels: ...working... done\nsunpy 4.0.3 py310hde88566_0\n---------------------------\nfile name   : sunpy-4.0.3-py310hde88566_0.tar.bz2\nname        : sunpy\nversion     : 4.0.3\nbuild       : py310hde88566_0\nbuild number: 0\nsize        : 5.7 MB\nlicense     : BSD-2-Clause\nsubdir      : linux-64\nurl         : &lt;https://conda.anaconda.org/conda-forge/linux-64/sunpy-4.0.3-py310hde88566_0.tar.bz2&gt;\nmd5         : 5831b8fde0edd2aa0ff9f42b237b7ba2\ntimestamp   : 2022-07-08 16:21:32 UTC\ndependencies: \n  - asdf &gt;=2.8.0\n  - asdf-astropy &gt;=0.1.1\n  - astropy &gt;=4.1.0\n  - beautifulsoup4 &gt;=4.8.0\n  - cdflib &gt;=0.3.19,!=0.4.0\n  - drms &gt;=0.6.1\n  - glymur &gt;=0.8.18,!=0.9.0,!=0.9.5\n  - h5netcdf &gt;=0.8.1\n  - h5py &gt;=3.1.0\n  - libgcc-ng &gt;=12\n  - matplotlib-base &gt;=3.2.0\n  - mpl_animators &gt;=1.0.0\n  - numpy &gt;=1.21.6,&lt;2.0a0\n  - pandas &gt;=1.0.0\n  - parfive &gt;=1.2.0\n  - python &gt;=3.10,&lt;3.11.0a0\n  - python-dateutil &gt;=2.8.0\n  - python_abi 3.10.* *_cp310\n  - reproject\n  - scikit-image &gt;=0.16.0\n  - scipy &gt;=1.3.0\n  - setuptools\n  - sqlalchemy &gt;=1.3.4\n  - tqdm &gt;=4.32.1\n  - zeep &gt;=3.4.0</code></pre>\n<p>用户文件位置: <code>~/.sunpy/sunpyrc</code></p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">cat <span class=\"token operator\">~</span><span class=\"token operator\">/</span><span class=\"token punctuation\">.</span>sunpy<span class=\"token operator\">/</span>sunpyrc<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>[general]\ntime_format = %Y-%m-%d %H:%M:%S\nworking_dir = /home/lydia/sunpy-downloads\n\n[downloads]\ndownload_dir = /home/lydia/sunpy-downloads/data\nsample_dir = /home/lydia/sunpy-downloads/data/sample_data\n\n[database]\nurl = sqlite:////home/lydia/sunpy-downloads/sunpydb.sqlite</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> sunpy\nsunpy<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>system_info<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>==============================\nsunpy Installation Information\n==============================\n\nGeneral\n#######\nOS: Ubuntu (18.04, Linux 4.19.128-microsoft-standard)\nArch: 64bit, (x86_64)\nsunpy: 4.0.3\nInstallation path: /home/lydia/miniconda3/lib/python3.10/site-packages/sunpy-4.0.3.dist-info\n\nRequired Dependencies\n#####################\nastropy: 5.1\nnumpy: 1.23.1\npackaging: 21.3\nparfive: 1.5.1\n\nOptional Dependencies\n#####################\nasdf: 2.12.0\nasdf-astropy: 0.2.1\nbeautifulsoup4: 4.11.1\ncdflib: 0.4.4\ndask: 2022.7.0\ndrms: 0.6.2\nglymur: 0.10.1\nh5netcdf: 0.0.0\nh5py: 3.7.0\nmatplotlib: 3.5.2\nmpl-animators: 1.0.1\npandas: 1.4.1\npython-dateutil: 2.8.2\nreproject: 0.8\nscikit-image: 0.19.3\nscipy: 1.8.1\nsqlalchemy: 1.4.39\ntqdm: 4.64.0\nzeep: 4.1.0</code></pre>\n<p>设置下载位置:<br> (参考 <a\nhref=\"http://docs.sunpy.org/en/stable/guide/customization.html?highlight=sunpy.config.set)\"\nclass=\"uri\">http://docs.sunpy.org/en/stable/guide/customization.html?highlight=sunpy.config.set)</a></p>\n<p>e.g. &gt; [downloads]<br>  download_dir = ...</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token keyword\">import</span> sunpy\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> sunpy<span class=\"token punctuation\">.</span>config<span class=\"token punctuation\">.</span><span class=\"token builtin\">set</span><span class=\"token punctuation\">(</span><span class=\"token string\">'downloads'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'download_dir'</span><span class=\"token punctuation\">,</span>\n                 <span class=\"token string\">'/home/&lt;user>/&lt;your_path>/sunpy-downloads/data'</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<p>退出后再进入 python 如果发现没有修改成功, 则需要手动修改\n~/.sunpy/sunpyrc 文件.<br> 不能用 '$USER' 代替具体的用户名\n'&lt;user&gt;'</p>\n<h3 id=\"jupyter\">Jupyter</h3>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">conda <span class=\"token function\">install</span> jupyter -c conda-forge<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p> Or <pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">pip <span class=\"token function\">install</span> jupyter<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">%%bash\njupyter --path<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>config:\n    /home/lydia/.jupyter\n    /home/lydia/.local/etc/jupyter\n    /home/lydia/miniconda3/etc/jupyter\n    /usr/local/etc/jupyter\n    /etc/jupyter\ndata:\n    /home/lydia/.local/share/jupyter\n    /home/lydia/miniconda3/share/jupyter\n    /usr/local/share/jupyter\n    /usr/share/jupyter\nruntime:\n    /home/lydia/.local/share/jupyter/runtime</code></pre>\n<ul>\n<li>设置双击打开 *.ipynb 文件</li>\n</ul>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">pip <span class=\"token function\">install</span> nbopen<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>再执行:</p>\n<p>Linux/BSD: <br> <pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">python3 -m nbopen.install_xdg<span class=\"token operator\">&lt;</span>br<span class=\"token operator\">></span>\n ``<span class=\"token variable\"><span class=\"token variable\">`</span>   \n\nWindows: <span class=\"token operator\">&lt;</span>br<span class=\"token operator\">></span>\n<span class=\"token variable\">`</span></span>``bash\npython3 -m nbopen.install_win<span class=\"token operator\">&lt;</span>br<span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>Mac: <br>  Clone the repository\n(https://github.com/takluyver/nbopen.git)<br>  and run\n<code>./osx-install.sh</code><br><br>\n之后即可在文件浏览器中选择文件的打开方式为\n<code>Jupyter Notebook</code>.</p>\n<blockquote>\n<p>注意可能会更改 bash 脚本的默认打开方式.</p>\n</blockquote>\n<ul>\n<li>Jupyter\n插件集合<br>(https://github.com/ipython-contrib/jupyter_contrib_nbextensions)</li>\n</ul>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">conda <span class=\"token function\">install</span> jupyter_contrib_nbextensions -c conda-forge<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p> Or <pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">pip <span class=\"token function\">install</span> jupyter_contrib_nbextensions<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre> &gt; This also automatically installs the\nJavascript and CSS files:<br>\n<code>jupyter contrib nbextension install --sys-prefix</code></p>\n<p>安装好后将同时启用 <code>Nbextensions</code> 选项卡,\n手动选择需要的插件, 或者在命令行启用和禁用:</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">jupyter nbextension list <span class=\"token comment\"># 查看</span>\njupyter nbextension <span class=\"token builtin class-name\">enable</span> <span class=\"token operator\">&lt;</span>path<span class=\"token operator\">></span> <span class=\"token comment\"># &lt;path> 为上述 list 中的 &lt;extension>/main</span>\njupyter nbextension disable <span class=\"token operator\">&lt;</span>path<span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<p>注意用如果 jupyter 安装在 conda 路径, 手动安装插件\n(<code>jupyter nbextension install</code>) 时需要指定\n<font color=red>--sys-prefix</font></p>\n<ul>\n<li>notebook 主题 (https://github.com/dunovank/jupyter-themes)</li>\n</ul>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">pip <span class=\"token function\">install</span> jupyterthemes<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<ul>\n<li>演示代码过程的插件 (https://github.com/lgpage/nbtutor)</li>\n</ul>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">conda <span class=\"token function\">install</span> nbtutor -c conda-forge<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p> Or <pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">pip <span class=\"token function\">install</span> nbtutor\njupyter nbextension <span class=\"token function\">install</span> --overwrite --py nbtutor\njupyter nbextension <span class=\"token builtin class-name\">enable</span> --py nbtutor<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre></p>\n<p>载入:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># ipython/jupyter</span>\n<span class=\"token operator\">%</span>load_ext nbtutor<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<p>使用:<br> CodeCell 中首行加入下面语句, 然后执行 Cell (numpy 等需要在\nCell 内导入) <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># ipython/jupyter</span>\n<span class=\"token operator\">%</span><span class=\"token operator\">%</span>nbtutor <span class=\"token operator\">-</span>r <span class=\"token operator\">-</span>f\n<span class=\"token comment\"># 或</span>\n<span class=\"token operator\">%</span><span class=\"token operator\">%</span>nbtutor <span class=\"token operator\">-</span>r <span class=\"token operator\">-</span>f <span class=\"token operator\">-</span>i  <span class=\"token comment\"># 缩减显示</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre></p>\n<h3 id=\"其他\">其他</h3>\n<ul>\n<li>PeakUtils (http://peakutils.readthedocs.io/en/latest/)</li>\n</ul>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> clone <span class=\"token operator\">&lt;</span>https://bitbucket.org/lucashnegri/peakutils.git<span class=\"token operator\">></span>\n<span class=\"token builtin class-name\">cd</span> peakutils\npython setup.py <span class=\"token function\">install</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token keyword\">import</span> peakutils<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<ul>\n<li>LMfit-py (https://github.com/lmfit/lmfit-py)</li>\n</ul>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">conda <span class=\"token function\">install</span> lmfit -c conda-forge\n<span class=\"token comment\"># 或</span>\npip <span class=\"token function\">install</span> lmfit<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token keyword\">import</span> lmfit<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<ul>\n<li>HDF5包 (http://docs.h5py.org/en/latest/index.html)<br></li>\n</ul>\n<p><strong>pandas</strong> <pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">conda <span class=\"token function\">install</span> pytables pandas<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>  Or <pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">pip <span class=\"token function\">install</span> tables pandas<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre> <br><br>\n<strong>h5py</strong> (http://docs.h5py.org/en/latest/index.html)\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">conda <span class=\"token function\">install</span> h5py  <span class=\"token comment\"># 推荐. 将同时安装 hdf5, 并得到 h5dump 等命令</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>  Or <pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">pip <span class=\"token function\">install</span> h5py  <span class=\"token comment\"># 需要 sudo apt-get install libhdf5-dev</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n<ul>\n<li>CDF包<br></li>\n</ul>\n<p>安装 spacepy (https://pythonhosted.org/SpacePy)</p>\n<p>或</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">pip <span class=\"token function\">install</span> cdflib <span class=\"token comment\"># &lt;https://github.com/MAVENSDC/cdflib></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<ul>\n<li>EVTK (https://bitbucket.org/pauloh/pyevtk)</li>\n</ul>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> mercurial  <span class=\"token comment\"># 得到 hg 命令</span>\n\n<span class=\"token function\">hg</span> clone <span class=\"token operator\">&lt;</span>https://bitbucket.org/pauloh/pyevtk<span class=\"token operator\">></span>\n<span class=\"token builtin class-name\">cd</span> pyevtk\npython setup.py build --debug <span class=\"token function\">install</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">hg</span> pull <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">hg</span> update default <span class=\"token comment\"># 更新</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token keyword\">from</span> evtk<span class=\"token punctuation\">.</span>hl <span class=\"token keyword\">import</span> gridToVTK<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<ul>\n<li>Mayavi (http://docs.enthought.com/mayavi/mayavi)</li>\n</ul>\n<p> 需要先安装 cython (conda 或 pip)</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">pip <span class=\"token function\">install</span> mayavi  <span class=\"token comment\"># 将同时安装 vtk. (pip 是目前 mayavi 最保险的安装方式)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token comment\"># shell</span>\nmayavi2<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>"},{"title":"Python 简易教程 (lecture for Solar Group)","date":"2018-07-02T12:56:13.000Z","_content":"[<i class=\"fas fa-download\"></i> Jupyter Notebook](/downloads/notebooks/python-intro.zip)\n\n## 简介\n\n优势: 开源, 用户广, 用途广, 社区完善, 新手友好\n\n<https://www.jetbrains.com/research/python-developers-survey-2017/>\n<br><br>\n2017年的 python 使用调查报告 <https://www.jetbrains.com/research/python-developers-survey-2017/>\n<img src='/main/Python Developers Survey 2017 - Results-018.png' >\n<img src='/main/Python Developers Survey 2017 - Results-019.png' >\n<img src='/main/Python Developers Survey 2017 - Results-020.png' >\n\n参考网站:\n\n  - 官方网站: <https://www.python.org/>\n  - stackoverflow <https://stackoverflow.com/questions/tagged/python>\n  - 官方文档 <https://docs.python.org>\n  - 廖雪峰的网站 (包含 python2.7 和 python3 的教程) <https://www.liaoxuefeng.com>\n  - wikibooks <https://en.wikibooks.org/wiki/Python_Programming>\n  - 演示代码执行过程的工具 <http://pythontutor.com/>\n  - 天文相关教程 (较新) <https://python4astronomers.github.io>\n\n<br>\n获取 python 包/模块/函数的帮助:\n\n```python\n# python\n>>> help(name)\n```\n```sh\n# shell\n$ pydoc <name>\n$ pydoc -w <name>  # 生成一个 html 帮助文件\n```\n```python\n# ipython/jupyter\nname?  # 弹出帮助文档, `Esc` 退出文档\n```\n<!-- more -->\n\n## 基本语法\n\n### 语法特点\n\n* 对象编程的概念<br>\n  类 -> 创建一个实例 -> 使用该实例所属的类下面的方法\n```python\nl = [3, 2, 1]  # l 是 list 的一个实例\nl.reverse()  # reverse 是一个方法(函数), reverse() 是一个实例\nl.__dir__()  # 查看 l 的所有方法(函数)\n```\n<br>\n* 严格缩进 (通常采用4个半角空格)\n```py\nif a > 0:\n      a += 1\nprint(a)\n```\n<br>\n* 空格不敏感\n```python\na + b * c ** 2 / d\nf (a, b)\n```\n<br>\n* 大小写敏感, 使用大小写组合的变量名风格 (下划线仍是合法变量名字符,但有特殊含义, 见 [Python 进阶#脚本相关](advance.html#脚本相关))\n```python\nfrom scipy.interpolate import BSpline\n```\n```python\nimport pandas as pd\ndataFrame = pd.DataFrame(array)\n```\n见 [IDL sav 文件读取](#IDL-sav-文件读取)\n<br><br>\n* 括号内换行不用换行符\n<br><br>\n* 单行注释 `# ...`\n<br><br>\n* 多行注释<br>\n函数或模块的开头的多行注释 (将存储在`__doc__`变量), 可以用 `help()` 打印\n```python\n\"\"\"\n这是一个\n多行注释\n\"\"\"\n```\n<br>\n* 同一行不同语句之间可用分号分隔\n```python\nx = 1; print(x)\n```\n<br>\n* 列表和数组的索引默认从<font color=red>0</font>开始\n<br><br>\n* 列表的最后一个元素可以加逗号\n```python\n[1, 2,]\n{'a' : 1, 'b' : 2,}\n```\n<br>\n* *etc.*\n\n### print函数\n\n```python\na = 1.; b = 2.\n```\n\n```python\nprint('a=%.3f, b=%.1e' % (a, b))\n```\n\n    a=1.000, b=2.0e+00\n\n\n```python\nprint(f'a={a}, b={b:.3f}')\n```\n\n    a=1.0, b=2.000\n\n\n```python\n%%python2\nprint('xxx'),\nprint('yyy')\n```\n\n    xxx yyy\n\n\n```python\n%%python3\nprint('xxx', end=' ')\nprint('yyy')\n```\n\n    xxx yyy\n\n\n更多格式化参考 <https://pyformat.info/>\n\n### 基本运算\n\n运算符参考:<br>\n<https://en.wikibooks.org/wiki/Python_Programming/Basic_Math><br>\n<https://www.tutorialspoint.com/python/python_basic_operators.htm>\n\n```python\na = 1\na += 1  # 没有 a++ 这种语法\na\n```\n\n\n\n\n    2\n\n\n\n```python\n3. ** 2  # 自动转换数据类型\n```\n\n\n\n\n    9.0\n\n\n\n```python\n1 < 2 != 3  # 判断, 可以连写\n```\n\n\n\n\n    True\n\n\n\n```python\na = None\na is None  # 注意这时不用 `==`\n```\n\n\n\n\n    True\n\n\n\n### 字符串\n\n用双引号和单引号皆可 (取决于所引内容).<br>\n字符串具有和列表 (list) 类似的运算规则 (见之后的 list 说明):\n\n```python\n'a' * 10\n```\n\n\n\n\n    'aaaaaaaaaa'\n\n\n\n```python\n'a' + 'b'\n```\n\n\n\n\n    'ab'\n\n\n\n```python\n'abc'[0]\n```\n\n\n\n\n    'a'\n\n\n\n```python\nprint('\\n')\n```\n\n    \n    \n\n\n```python\nprint(r'\\n')  # same as '\\\\n'\n```\n\n    \\n\n\n\n### list, tuple, dict, set\n\n* 有序表 list, tuple\n\n```python\nl = [0, 1, 2, 3, 4, 5]  # list, 元素可变\nt = (0, 1, 2, 3, 4, 5)  # tuple, 元素不可变\n```\n\n```python\nl[0:3]  # 一个切片(slice)\n```\n\n\n\n\n    [0, 1, 2]\n\n\n\n```python\nt[0:3]\n```\n\n\n\n\n    (0, 1, 2)\n\n\n\n```python\nl[1:5:2]  # 索引: [start, stop, step] (结果不包含 stop)\n```\n\n\n\n\n    [1, 3]\n\n\n\n```python\nl[5:1:-1]  # step < 0, 仍然不包含 stop (此例中 stop=1)\n```\n\n\n\n\n    [5, 4, 3, 2]\n\n\n\nlist 常用运算\n\n```python\nl = [0, 1, 2, 3, 4, 5]\nl.append('x')  # 添加在最后\nprint(l)\nl.insert(3, 'y')  # 添加在 l[i] 之前\nprint(l)\nprint(l.pop(1))  # 删除某元素并返回该值\nprint(l)\n```\n\n    [0, 1, 2, 3, 4, 5, 'x']\n    [0, 1, 2, 'y', 3, 4, 5, 'x']\n    1\n    [0, 2, 'y', 3, 4, 5, 'x']\n\n\n```python\nprint(l * 2)  # 重复N遍\nprint(l + [6, 7])  # 合并两个list\n```\n\n    [1, 'y', 2, 3, 4, 5, 'x', 1, 'y', 2, 3, 4, 5, 'x']\n    [1, 'y', 2, 3, 4, 5, 'x', 6, 7]\n\n\nlist 可以排序 (当元素为同一类型且可比较大小时), 返回到原列表\n\n```python\nl = ['b', 'a']\nl.sort()\nl\n```\n\n\n\n\n    ['a', 'b']\n\n\n\n```python\nl = [2, 1]\nl.sort()\nl\n```\n\n\n\n\n    [1, 2]\n\n\n\n* 字典 dict\n\n```python\nd = {'a' : 1, 'b' : 2}\n```\n\n```python\nd = dict(a=1, b=2) # 注意这时没有引号\n```\n\n```python\nd['a']\n```\n\n\n\n\n    1\n\n\n\n* 集合 set\n\n```python\ns = {3, 2, 1, 3}  # set, 将自动排序并去除重复, 常用于 for 循环\ns  # 不能用 s[i] 来索引\n```\n\n\n\n\n    {1, 2, 3}\n\n\n\nset 不可索引, 但可用作 for 循环. 见 [Python 进阶#迭代器](advance.html#循环,-迭代器,-生成器)\n\n```python\nfor i in s:\n    print(i)\n```\n\n    1\n    2\n    3\n\n\n```python\nl2 = [i for i in s]\nprint(l2)\n```\n\n    [1, 2, 3]\n\n\n### if 语句\n\npython 里没有 `case`, 只有 `if` (非零数值、非空字符串、非空 list 等皆为 True)\n```python\nif <条件判断1>:\n    <执行1>\nelif <条件判断2>:\n    <执行2>\nelif <条件判断3>:\n    <执行3>\nelse:\n    <执行4>\n```\n\n### 相关工具\n\n#### pip\n\n<img src='/main/logo-large.72ad8bf1.svg' />\n\n> The **Python Package Index (PyPI)** is a repository of software for the Python programming language.<br/>\nPyPI helps you find and install software developed and shared by the Python community.<br/>\n<https://pypi.org/>\n\n```\n$ pip install <pkg_name>\n```\n&nbsp;&nbsp;&nbsp;&nbsp;(其他命令见 [Python 安装和配置#用 pip 安装 python 包](installpy.html#用-pip-安装-python-包))\n\n#### Anaconda\n\n<img src='/main/DataScienceLibraries-01.png' />\n<img src='/main/Conda-DistributionDiagram-01.png' />\n\n<img src='/main/Conda — Conda documentation.png' />\n\n**Anaconda** (https://www.anaconda.com/)<br>\n安装好的 conda 包含独立于系统的 python 版本, 一部分已编译好的包, pip 工具, 以及不同环境的子目录.<br/>\n可根据需要切换不同的 conda 环境以使用不同的 python 版本或不同的包的组合.\n\n```\n$ conda install <pkg_name>\n```\n其他命令见 [Python 安装和配置#使用 conda 命令](installpy.html#使用-conda-命令)<br>\n详细说明见 [Python 进阶#Anaconda](advance.html#Anaconda)\n\n#### IPython & Jupyter\n\n<img style='float: center;' src='/main/IPython.png' />\n\n```python\n# Have a look (ipython)\n!cd && gnome-terminal --window-with-profile='lydia_white'\n!sleep 0.5 && xdotool type --delay 200 \"ipython\" && xdotool key Return\n!sleep 3 && xdotool type --delay 200 \"!idl\" && xdotool key Return\n!sleep 3 && xdotool key Ctrl+d\n!sleep 1 && xdotool type --delay 200 \"!csh -c sswidl\" && xdotool key Return\n```\n\n<center><http://jupyter.org/></center>\n<img style='float: center;' src='/main/jupyterlogo.png' />\n\n<center><https://nbviewer.jupyter.org/></center>\n<img style='float: center;' src='/main/nbviewer.png' />\n\n参考文档\n<http://jupyter-notebook.readthedocs.io/en/stable/>\n\n* 打开 `jupyter notebook`:\n\n```\n$ jupyter notebook [filename]\n```\n\n## 常用包介绍\n\n### Python 自带包和模块\n\n```python\nfrom math import * # 包含 pi 等, 但更推荐 numpy\nfrom copy import deepcopy\nfrom pprint import pprint  # 打印 list, dict 等更好看\nimport requests\nimport os\nimport sys\n```\n\n### NumPy, SciPy\n\n#### 概览\n\n<center><https://www.scipy.org></center>\n<img src='/main/SciPy.png' />\n\n<center><http://scikit-image.org></center>\n<img src='/main/scikitlogo.png' />\n<img src='/main/skimage01.png' />\n\n```python\nimport numpy as np\n```\n\n导入包的不同方式将在各例子中看到.\n\n参考:\n\n  - NumPy User Guide <https://docs.scipy.org/doc/numpy/user/>\n  - NumPy Reference <https://docs.scipy.org/doc/numpy/reference/>\n  - ndarray<br><https://docs.scipy.org/doc/numpy/reference/arrays.ndarray.html>\n  - Array manipulation routines<br><https://docs.scipy.org/doc/numpy/reference/routines.array-manipulation.html>\n  - SciPy Cookbook <http://scipy-cookbook.readthedocs.io/>\n  - 与 IDL 的语法对照\n    - <http://mathesaurus.sourceforge.net/idl-numpy.html>\n    - <http://blog.rtwilson.com/ten-little-idl-programs-in-python/>\n    - <http://www.astrobetter.com/blog/2009/05/04/idl-vs-python/>\n\n#### 生成 numpy.ndarray 数组\n\n将 list 或 tuple 转换为 `numpy.ndarray`\n```python\nimport numpy as np\na = np.array([0, 1, 2, 3, 4])\n# 切片(slice), 索引可以是 int 或 list (python list 只支持 list作为索引)\na[0]          # 0\na[-1]         # 4\na[0:3]        # array([0, 1, 2]) 注意!\na[:3]         # array([0, 1, 2])\na[2:4]        # array([2, 3])\na[2:-1]       # array([2, 3]) 注意!\na[2:]         # array([2, 3, 4])\na[0:4:2]      # array([0, 2])\na[4:2:-1]     # array([4, 3])\na[[1, 4, 3]]  # array([1, 4, 3]) 花式切片, 索引是一个 list (不能是tuple)\n```\n\n多维:\n\n```python\na = np.array([[0, 1, 2], [3, 4, 5]]); a\n```\n\n\n\n\n    array([[0, 1, 2],\n           [3, 4, 5]])\n\n\n\n```python\na = np.array(((0, 1, 2), (3, 4, 5))); a\n# 这里的tuple已转成ndarray, 于是结果是可变的\n```\n\n\n\n\n    array([[0, 1, 2],\n           [3, 4, 5]])\n\n\n\n```python\na[0, 1]\n```\n\n\n\n\n    1\n\n\n\n```python\na[0][1]\n```\n\n\n\n\n    1\n\n\n\n从一维数组转变为多维:\n\n```python\na = np.arange(12).reshape((3, -1)); a\n# reshape 的参数为 < 0 表示该维度自动判断元素个数\n# reshape 的参数是一个 list 或 tuple, 括号可以展开 (详见帮助文档)\n# 此例中 reshape((3, 2)), reshape(3, 2), reshape((3, -1)), reshape(3, -1) 等价\n```\n\n\n\n\n    array([[ 0,  1,  2,  3],\n           [ 4,  5,  6,  7],\n           [ 8,  9, 10, 11]])\n\n\n\n```python\nb = a.reshape(-1); b  # reshape 的参数只有一个维度且 < 0(自动)  => 展开成一维\n```\n\n\n\n\n    array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11])\n\n\n\n花式切片的多维例子:\n\n```python\na = np.arange(12).reshape(3, -1)\na[[0, 1],[0, 2]]\n# a[col_inds, row_inds], 此例等价于 a[[[0, 1], [0, 2]]], a[([0, 1], [0, 2])]\n```\n\n\n\n\n    array([0, 6])\n\n\n\n* **np.zeros**(shape, dtype=float),&ensp;**np.ones**(shape, dtype=float)\n\n```python\nnp.zeros((2, 3))  # 默认浮点型\n```\n\n\n\n\n    array([[0., 0., 0.],\n           [0., 0., 0.]])\n\n\n\n```python\nnp.ones((2, 3))  # 默认浮点型\n```\n\n\n\n\n    array([[1., 1., 1.],\n           [1., 1., 1.]])\n\n\n\n* **np.arange**([start,] stop[, step,], dtype=None)\n\n生成的数组元素数据类型和参数一致.<br><br>\n方便记忆: 最简形式 `np.arange`(*N*) 中的整数 *N* 即为 *元素个数*.\n\n```python\nnp.arange(6).reshape((3, 2))\n```\n\n\n\n\n    array([[0, 1],\n           [2, 3],\n           [4, 5]])\n\n\n\n```python\nnp.arange(6).reshape((3, -1))\n```\n\n\n\n\n    array([[0, 1],\n           [2, 3],\n           [4, 5]])\n\n\n\n* **np.linspace**(start, stop, num=50, **endpoint=True**, retstep=False, dtype=None)<br>\n默认生成的元素是浮点型<br>\n注意 `np.linspace` 和 `np.arange` 的不同规则\n\n```python\nnp.linspace(0, 1, 2)\n```\n\n\n\n\n    array([0., 1.])\n\n\n\n```python\nnp.linspace(0, 1, 2, endpoint=False) \n```\n\n\n\n\n    array([0. , 0.5])\n\n\n\n更多数组创建方法见 numpy 官网:<br>\n<https://docs.scipy.org/doc/numpy/reference/routines.array-creation.html><br>\n<https://docs.scipy.org/doc/numpy/user/basics.creation.html#arrays-creation>\n\n* 转置\n\n```python\na = np.arange(12).reshape(3, -1); a\n```\n\n\n\n\n    array([[ 0,  1,  2,  3],\n           [ 4,  5,  6,  7],\n           [ 8,  9, 10, 11]])\n\n\n\n```python\na.T\n```\n\n\n\n\n    array([[ 0,  4,  8],\n           [ 1,  5,  9],\n           [ 2,  6, 10],\n           [ 3,  7, 11]])\n\n\n\n更多数组操作见 numpy 官网 <https://docs.scipy.org/doc/numpy/reference/routines.array-manipulation.html>\n矩阵操作见 [Python 进阶#矩阵](advance.html#矩阵)\n\n### Matplotlib\n\n* 官方示例 <https://matplotlib.org/tutorials/index.html>\n<img src='/main/Matplotlib.png' />\n<img src='/main/annotation_demo2_00.png' />\n<img src='/main/contour_demo_05.png' />\n\n* 官方教程 <https://matplotlib.org/tutorials/introductory/usage.html>\n\n```python\nimport matplotlib.pyplot as plt\n```\n\n创建一个图像 (三种写法皆可):\n\n```python\nfig, ax = plt.subplots()\n```\n\n```python\nfig = plt.figure(1, (12, 6), dpi=100)\nax = fig.add_subplot(111)  # 数字 (ijk) 表示: 这是一共i行j列中的组图中的第k个图\n```\n\n```python\nfig = plt.gcf()\nax = plt.gca()\n```\n\n获取帮助:\n\n```python\nhelp(ax)\n```\n\n```python\n# 查看某对象包含的方法\nax.# <Tab>, <Shift-Tab>\nplt.# <Tab>, <Shift-Tab>\n```\n\n例:\n\n```python\n%matplotlib?\n```\n\n```python\n%matplotlib\n%run -e 'examples/test_plot.py'\n```\n\n```python\n%matplotlib\n%run -e 'examples/test_imshow.py'\n```\n\n* 颜色 <https://matplotlib.org/examples/color/colormaps_reference.html>\n* legend <https://matplotlib.org/users/legend_guide.html>\n<br>\n<img src='/main/named_colors.png' />\n\n### 天文相关包\n\n#### Astropy\n\n<img src='/main/astropy_banner.svg' />\n\n官方文档 <http://docs.astropy.org/en/stable/index.html>\n\n坐标系统 <http://docs.astropy.org/en/stable/coordinates/index.html>\n\n```python\nfrom astropy import units as u\nfrom astropy.coordinates import SkyCoord\n```\n\n参考 <https://python4astronomers.github.io/astropy/astropy.html>\n\n#### SunPy\n\n<img src='/main/Screenshot_20180625-005924.png' />\n<img src='/main/sphx_glr_lat_lon_lines_001.png' />\n<img src='/main/sphx_glr_submaps_and_cropping_001.png' />\n\n<br>\nHMI 示例见 [Python 进阶#SunPy 示例](advance.html#SunPy-示例)<br>\n<https://coding.net/u/lydiazly/p/scripts-sunpy/git?public=true>\n\n<br><br>\n参考:\n\n  - Gallery <http://docs.sunpy.org/en/stable/generated/gallery/index.html>\n  - SunPy Guide <http://docs.sunpy.org/en/stable/guide/index.html>\n  - SunPy Map<br><http://docs.sunpy.org/en/stable/code_ref/map.html#sunpy.map.mapbase.GenericMap>\n  - Example Gallery <http://docs.sunpy.org/en/stable/generated/gallery/index.html>\n  - A brief tour of SunPy <http://docs.sunpy.org/en/stable/guide/tour.html>\n  - Finding and Downloading Data using Fido<br><http://docs.sunpy.org/en/stable/guide/acquiring_data/fido.html>\n\n简单的例子 (来自官网):\n\n```python\n%matplotlib inline\n\nimport sunpy.map\nimport matplotlib.pyplot as plt\nimport sunpy.data.sample\n\naia = sunpy.map.Map(sunpy.data.sample.AIA_171_IMAGE)\n\nfig = plt.figure(1, (5, 5), dpi=100)\nax = plt.subplot(111, projection=aia)\n\naia.plot()\naia.draw_limb()\naia.draw_grid()\naia.draw_limb()\nplt.colorbar();\n\n# plt.show()\n```\n\n    /home/lydia/miniconda3/lib/python3.6/site-packages/sunpy/map/sources/sdo.py:48: SunpyDeprecationWarning: Use Matplotlib to load the colormaps\n      self.plot_settings['cmap'] = cm.get_cmap(self._get_cmap_name())\n\n\n\n    \n![png](/main/main_126_1.png)\n    \n\n\n获取一些常数:\n\n```python\nfrom sunpy.sun import constants as con\n# one astronomical unit (the average distance between the Sun and Earth)\nprint(con.au)\n```\n\n      Name   = Astronomical Unit\n      Value  = 149597870700.0\n      Uncertainty  = 0.0\n      Unit  = m\n      Reference = IAU 2012 Resolution B2\n\n\n```python\n# the solar radius\nprint(con.radius)\n```\n\n      Name   = Solar radius\n      Value  = 695508000.0\n      Uncertainty  = 26000.0\n      Unit  = m\n      Reference = Allen's Astrophysical Quantities 4th Ed.\n\n\n## 常见数据文件读写\n\n### 一般情况\n\n```python\nf = open(filename, 'w')  # 'w', 'r', ...\n...\n...\nf.close()\n```\n更好的用法:\n```python\nwith open(filename, 'w') as f:  # 'w', 'r', ...\n    ...\n    ...\n```\n\n### txt, csv 文件读写\n\n* 逐行读取整行的方式:<br>\n使用 `strip` 可以用来去掉读入的每行末尾的 '\\n'\n\n```python\nlines = []\nwith open('data/data.csv', 'r') as f:\n    for line in f:\n        lines.append(line.strip().split(','))\nlines\n```\n\n\n\n\n    [['col1', 'col2', 'col3'],\n     ['row1', '1', '1e1'],\n     ['row2', '2', '2e-1'],\n     ['row3', '3', '3e+2']]\n\n\n\n* 使用 numpy, 读取后直接转成数组的方式 (推荐):<br>\n`np.loadtxt`,&ensp;`np.genfromtxt` (写文件是 `np.savetxt`)<br>\n超大文件读取建议用 pandas 包.\n\ne.g.\n\n```python\n>>> import numpy as np\n>>> arr = np.loadtxt(fname, skiprows=1, delimiter=',') # 默认分割符为空格\n>>> col1, col2 = np.loadtxt(fname, skiprows=1, usecols=(1, 2), unpack=True)\n```\n`np.genfromtxt` 和 `np.loadtxt` 类似, 增加了处理 missing values 的功能.<br>\n(但参数 skiprows=1 需替换为 skip_header=1)\n\n例 (这里使用功能更多的 `np.genfromtxt` 代替 `np.loadtxt`):\n\n```python\narr = np.genfromtxt('data/data.csv',\n                    skip_header=1,\n                    names=('col1', 'col2', 'col3'),\n                    dtype=('U15', 'int', 'float'),\n                    delimiter=',')\nprint(arr[['col1', 'col2']])  # 设定了 names 之后, 可以用名称索引\n```\n\n    [('row1', 1) ('row2', 2) ('row3', 3)]\n\n\n```python\narr = np.genfromtxt('data/data2.csv',\n                    skip_header=1,\n                    names=('col1', 'col2', 'col3'),\n                    dtype=('U15', 'int', 'float'),\n                    missing_values=None,\n                    filling_values=('', 0, np.nan),  # 分开指定\n                    delimiter=',')\nprint(arr)\n```\n\n    [('row1', 0, 10. ) ('', 2,  0.2) ('row3', 3,  nan)]\n\n\n* 一般而言, 对于一个由分隔符分隔的字符串, 转成一个数组的方式:<br>\n`np.fromstring(string, dtype=float, count=-1, sep='')`\n\n```python\nnp.fromstring('0 1 2', dtype=int, sep=' ')\n```\n\n\n\n\n    array([0, 1, 2])\n\n\n\n```python\nnp.fromstring('0., 1., 2.', sep=',')\n```\n\n\n\n\n    array([0., 1., 2.])\n\n\n\n### numpy save 文件读写\n\n```python\nnp.save('fname', arr)  # 'fname.npy'\nnp.savez('fname', arr)  # 'fname.npz', 多个变量\nnp.savez_compressed('fname', arr)  # 'fname.npz', 多个变量 & 压缩\nnp.load('fname.npz')  # Load the files created by savez_compressed.\n```\n\n```python\n# 存入\narr = np.ones(5)  # 默认 `float64`\nnp.savez('data/np_array', a=arr, b=0)\n```\n\n```python\nls data/*.npz\n```\n\n    data/np_array.npz\n\n\n```python\n# 载入\ndata = np.load('data/np_array.npz')\nprint((data['a'], data['b'], int(data['b'])))  # 默认以`ndarray`读取\n```\n\n    (array([1., 1., 1., 1., 1.]), array(0), 0)\n\n\n### IDL sav 文件读取\n\n```python\nfrom scipy.io.idl import readsav\ndata = readsav('dname.sav', verbose=True, python_dict=False)\n```\n默认读出的是`scipy.io.idl.AttrDict`类型, 即 key 的大小写不敏感.<br>\n想要得到大小写敏感的 python dict, 设置 `python_dict=True` 即可.\n<br><br>\n例:\n\n```python\nfrom scipy.io.idl import readsav\ndata = readsav('data/myidlfile.sav')\nprint(type(data))\nprint(data.keys())  # 注意返回的是一个`dict_keys`对象, 如需索引需要手动转为list\nprint(data['X'].shape)  # 大小写不敏感\ndata = readsav('data/myidlfile.sav', python_dict=True)\nprint(type(data))\nprint(data['x'].shape)  # 大小写敏感\n```\n\n    <class 'scipy.io.idl.AttrDict'>\n    dict_keys(['x', 'y', 'str'])\n    (25,)\n    <class 'dict'>\n    (25,)\n\n\n### FITS 文件读取\n\n* Astropy\n\n参考:<br>\n<http://docs.astropy.org/en/stable/io/fits><br>\n<https://python4astronomers.github.io/astropy/fits.html>\n\n> [Note]<br>\nIf you are already familiar with PyFITS, astropy.io.fits is in fact the same code as the latest version of PyFITS, and you can adapt old scripts that use PyFITS to use Astropy by simply doing:\n```python\nfrom astropy.io import fits as pyfits\n```\nHowever, for new scripts, we recommend the following import:\n```python\nfrom astropy.io import fits\n```\n\n`fits.open`\n```python\n>>> from astropy.io import fits\n>>> hdulist = fits.open('<filename>.fit')\n>>> hdulist.info()  # hdulist 是一个由 HDU objects 组成的类似列表的对象\nFilename: <filename>.fit\nNo.    Name         Type      Cards   Dimensions   Format\n0    PRIMARY     PrimaryHDU    ...       ...        ...\n1    ENERGIES    BinTableHDU   ...       ...        ...\n>>> hdu = hdulist[0]\n>>> hdu.data  # ndarray\n>>> hdu.header['<key>']  # 得到某个 header keyword\n# 修改数据后\n>>> hdu.writeto('<filename>.fits') # 保存 HDU object\n>>> hdulist.writeto('<filename>.fits')  # 或保存整个表\n```\n```python\n# 创建一个 fits Primary HDU object\n>>> hdu = fits.PrimaryHDU()\n>>> hdu.writeto('<filename>.fits')  # 保存 HDU object\n>>> hdu.writeto('<filename>.fits', clobber=True)  # 保存到已存在文件\n```\n`fits.getdata`, `fits.getheader`\n```python\n>>> data = fits.getdata('<filename>.fit')\n>>> header = fits.getheader('<filename>.fit')\n```\n<br>\n* SunPy\n\n```python\n>>> import sunpy.io\n>>> hdulist = sunpy.io.read_file('<filename>.fits')  # 自动判断文件类型\n# or use `hdulist = sunpy.io.fits.read('<filename>.fits')`\n>>> hdu = hdulist[1]\n>>> hdu.data  # ndarray\n```\n```python\n>>> import sunpy.map\n>>> smap = sunpy.map.Map('<filename>.fits')\n# 得到一个 sunpy `GenericMap` object\n```\n\n例:\n\n```python\nfrom astropy.io import fits\nfname = 'scripts-sunpy/plothmi/data/hmi.B_720s.20150827_052400_TAI.field.fits'\nhdulist = fits.open(fname)\n```\n\n```python\nhdulist.info()\n```\n\n    Filename: scripts-sunpy/plothmi/data/hmi.B_720s.20150827_052400_TAI.field.fits\n    No.    Name      Ver    Type      Cards   Dimensions   Format\n      0  PRIMARY       1 PrimaryHDU       6   ()      \n      1                1 CompImageHDU    155   (4096, 4096)   int32   \n\n\n```python\nhdulist.verify('silentfix+warn')\nhdu = hdulist[1]\nhdu.data.shape\n```\n\n\n\n\n    (4096, 4096)\n\n\n\n```python\nimport sunpy.io\nhdulist = sunpy.io.read_file(fname)\nhdu = hdulist[1]\nhdu.data.shape\n```\n\n\n\n\n    (4096, 4096)\n\n\n\n## 其他包和软件\n\n* Astroconda <https://astroconda.readthedocs.io/en/latest/>\n> AstroConda is a free Conda channel maintained by the Space Telescope Science Institute (STScI) in Baltimore, Maryland. This channel provides tools and utilities required to process and analyze data from the Hubble Space Telescope (HST), James Webb Space Telescope (JWST), and others.\n<br><br>\n* Canopy <https://www.enthought.com/product/canopy/>\n> Enthought Canopy provides a proven scientific and analytic Python package distribution plus key integrated tools for iterative data analysis, data visualization, and application development. Users have the ability to extend and innovate with scripting and open platform APIs, driving the creation and sharing of innovative workflows, tools, and applications.\n<img src='/main/Canopy-Packages-min-1.png' >\n<br><br>\n* PyCharm <https://www.jetbrains.com/pycharm/>\n<img src='/main/pycharm.jpg' >\n<br><br>\n* Jupyterlab <http://jupyterlab.readthedocs.io/en/stable/>\n<img src='/main/jupyterlab.png' >\n","source":"_posts/2018-07-02-main.md","raw":"---\ntitle: \"Python 简易教程 (lecture for Solar Group)\"\npermalink: main.html\ncategories: 'Solar Physics'\ntags: [python, jupyter]\ndate: 2018-07-02 20:56:13\n---\n[<i class=\"fas fa-download\"></i> Jupyter Notebook](/downloads/notebooks/python-intro.zip)\n\n## 简介\n\n优势: 开源, 用户广, 用途广, 社区完善, 新手友好\n\n<https://www.jetbrains.com/research/python-developers-survey-2017/>\n<br><br>\n2017年的 python 使用调查报告 <https://www.jetbrains.com/research/python-developers-survey-2017/>\n<img src='/main/Python Developers Survey 2017 - Results-018.png' >\n<img src='/main/Python Developers Survey 2017 - Results-019.png' >\n<img src='/main/Python Developers Survey 2017 - Results-020.png' >\n\n参考网站:\n\n  - 官方网站: <https://www.python.org/>\n  - stackoverflow <https://stackoverflow.com/questions/tagged/python>\n  - 官方文档 <https://docs.python.org>\n  - 廖雪峰的网站 (包含 python2.7 和 python3 的教程) <https://www.liaoxuefeng.com>\n  - wikibooks <https://en.wikibooks.org/wiki/Python_Programming>\n  - 演示代码执行过程的工具 <http://pythontutor.com/>\n  - 天文相关教程 (较新) <https://python4astronomers.github.io>\n\n<br>\n获取 python 包/模块/函数的帮助:\n\n```python\n# python\n>>> help(name)\n```\n```sh\n# shell\n$ pydoc <name>\n$ pydoc -w <name>  # 生成一个 html 帮助文件\n```\n```python\n# ipython/jupyter\nname?  # 弹出帮助文档, `Esc` 退出文档\n```\n<!-- more -->\n\n## 基本语法\n\n### 语法特点\n\n* 对象编程的概念<br>\n  类 -> 创建一个实例 -> 使用该实例所属的类下面的方法\n```python\nl = [3, 2, 1]  # l 是 list 的一个实例\nl.reverse()  # reverse 是一个方法(函数), reverse() 是一个实例\nl.__dir__()  # 查看 l 的所有方法(函数)\n```\n<br>\n* 严格缩进 (通常采用4个半角空格)\n```py\nif a > 0:\n      a += 1\nprint(a)\n```\n<br>\n* 空格不敏感\n```python\na + b * c ** 2 / d\nf (a, b)\n```\n<br>\n* 大小写敏感, 使用大小写组合的变量名风格 (下划线仍是合法变量名字符,但有特殊含义, 见 [Python 进阶#脚本相关](advance.html#脚本相关))\n```python\nfrom scipy.interpolate import BSpline\n```\n```python\nimport pandas as pd\ndataFrame = pd.DataFrame(array)\n```\n见 [IDL sav 文件读取](#IDL-sav-文件读取)\n<br><br>\n* 括号内换行不用换行符\n<br><br>\n* 单行注释 `# ...`\n<br><br>\n* 多行注释<br>\n函数或模块的开头的多行注释 (将存储在`__doc__`变量), 可以用 `help()` 打印\n```python\n\"\"\"\n这是一个\n多行注释\n\"\"\"\n```\n<br>\n* 同一行不同语句之间可用分号分隔\n```python\nx = 1; print(x)\n```\n<br>\n* 列表和数组的索引默认从<font color=red>0</font>开始\n<br><br>\n* 列表的最后一个元素可以加逗号\n```python\n[1, 2,]\n{'a' : 1, 'b' : 2,}\n```\n<br>\n* *etc.*\n\n### print函数\n\n```python\na = 1.; b = 2.\n```\n\n```python\nprint('a=%.3f, b=%.1e' % (a, b))\n```\n\n    a=1.000, b=2.0e+00\n\n\n```python\nprint(f'a={a}, b={b:.3f}')\n```\n\n    a=1.0, b=2.000\n\n\n```python\n%%python2\nprint('xxx'),\nprint('yyy')\n```\n\n    xxx yyy\n\n\n```python\n%%python3\nprint('xxx', end=' ')\nprint('yyy')\n```\n\n    xxx yyy\n\n\n更多格式化参考 <https://pyformat.info/>\n\n### 基本运算\n\n运算符参考:<br>\n<https://en.wikibooks.org/wiki/Python_Programming/Basic_Math><br>\n<https://www.tutorialspoint.com/python/python_basic_operators.htm>\n\n```python\na = 1\na += 1  # 没有 a++ 这种语法\na\n```\n\n\n\n\n    2\n\n\n\n```python\n3. ** 2  # 自动转换数据类型\n```\n\n\n\n\n    9.0\n\n\n\n```python\n1 < 2 != 3  # 判断, 可以连写\n```\n\n\n\n\n    True\n\n\n\n```python\na = None\na is None  # 注意这时不用 `==`\n```\n\n\n\n\n    True\n\n\n\n### 字符串\n\n用双引号和单引号皆可 (取决于所引内容).<br>\n字符串具有和列表 (list) 类似的运算规则 (见之后的 list 说明):\n\n```python\n'a' * 10\n```\n\n\n\n\n    'aaaaaaaaaa'\n\n\n\n```python\n'a' + 'b'\n```\n\n\n\n\n    'ab'\n\n\n\n```python\n'abc'[0]\n```\n\n\n\n\n    'a'\n\n\n\n```python\nprint('\\n')\n```\n\n    \n    \n\n\n```python\nprint(r'\\n')  # same as '\\\\n'\n```\n\n    \\n\n\n\n### list, tuple, dict, set\n\n* 有序表 list, tuple\n\n```python\nl = [0, 1, 2, 3, 4, 5]  # list, 元素可变\nt = (0, 1, 2, 3, 4, 5)  # tuple, 元素不可变\n```\n\n```python\nl[0:3]  # 一个切片(slice)\n```\n\n\n\n\n    [0, 1, 2]\n\n\n\n```python\nt[0:3]\n```\n\n\n\n\n    (0, 1, 2)\n\n\n\n```python\nl[1:5:2]  # 索引: [start, stop, step] (结果不包含 stop)\n```\n\n\n\n\n    [1, 3]\n\n\n\n```python\nl[5:1:-1]  # step < 0, 仍然不包含 stop (此例中 stop=1)\n```\n\n\n\n\n    [5, 4, 3, 2]\n\n\n\nlist 常用运算\n\n```python\nl = [0, 1, 2, 3, 4, 5]\nl.append('x')  # 添加在最后\nprint(l)\nl.insert(3, 'y')  # 添加在 l[i] 之前\nprint(l)\nprint(l.pop(1))  # 删除某元素并返回该值\nprint(l)\n```\n\n    [0, 1, 2, 3, 4, 5, 'x']\n    [0, 1, 2, 'y', 3, 4, 5, 'x']\n    1\n    [0, 2, 'y', 3, 4, 5, 'x']\n\n\n```python\nprint(l * 2)  # 重复N遍\nprint(l + [6, 7])  # 合并两个list\n```\n\n    [1, 'y', 2, 3, 4, 5, 'x', 1, 'y', 2, 3, 4, 5, 'x']\n    [1, 'y', 2, 3, 4, 5, 'x', 6, 7]\n\n\nlist 可以排序 (当元素为同一类型且可比较大小时), 返回到原列表\n\n```python\nl = ['b', 'a']\nl.sort()\nl\n```\n\n\n\n\n    ['a', 'b']\n\n\n\n```python\nl = [2, 1]\nl.sort()\nl\n```\n\n\n\n\n    [1, 2]\n\n\n\n* 字典 dict\n\n```python\nd = {'a' : 1, 'b' : 2}\n```\n\n```python\nd = dict(a=1, b=2) # 注意这时没有引号\n```\n\n```python\nd['a']\n```\n\n\n\n\n    1\n\n\n\n* 集合 set\n\n```python\ns = {3, 2, 1, 3}  # set, 将自动排序并去除重复, 常用于 for 循环\ns  # 不能用 s[i] 来索引\n```\n\n\n\n\n    {1, 2, 3}\n\n\n\nset 不可索引, 但可用作 for 循环. 见 [Python 进阶#迭代器](advance.html#循环,-迭代器,-生成器)\n\n```python\nfor i in s:\n    print(i)\n```\n\n    1\n    2\n    3\n\n\n```python\nl2 = [i for i in s]\nprint(l2)\n```\n\n    [1, 2, 3]\n\n\n### if 语句\n\npython 里没有 `case`, 只有 `if` (非零数值、非空字符串、非空 list 等皆为 True)\n```python\nif <条件判断1>:\n    <执行1>\nelif <条件判断2>:\n    <执行2>\nelif <条件判断3>:\n    <执行3>\nelse:\n    <执行4>\n```\n\n### 相关工具\n\n#### pip\n\n<img src='/main/logo-large.72ad8bf1.svg' />\n\n> The **Python Package Index (PyPI)** is a repository of software for the Python programming language.<br/>\nPyPI helps you find and install software developed and shared by the Python community.<br/>\n<https://pypi.org/>\n\n```\n$ pip install <pkg_name>\n```\n&nbsp;&nbsp;&nbsp;&nbsp;(其他命令见 [Python 安装和配置#用 pip 安装 python 包](installpy.html#用-pip-安装-python-包))\n\n#### Anaconda\n\n<img src='/main/DataScienceLibraries-01.png' />\n<img src='/main/Conda-DistributionDiagram-01.png' />\n\n<img src='/main/Conda — Conda documentation.png' />\n\n**Anaconda** (https://www.anaconda.com/)<br>\n安装好的 conda 包含独立于系统的 python 版本, 一部分已编译好的包, pip 工具, 以及不同环境的子目录.<br/>\n可根据需要切换不同的 conda 环境以使用不同的 python 版本或不同的包的组合.\n\n```\n$ conda install <pkg_name>\n```\n其他命令见 [Python 安装和配置#使用 conda 命令](installpy.html#使用-conda-命令)<br>\n详细说明见 [Python 进阶#Anaconda](advance.html#Anaconda)\n\n#### IPython & Jupyter\n\n<img style='float: center;' src='/main/IPython.png' />\n\n```python\n# Have a look (ipython)\n!cd && gnome-terminal --window-with-profile='lydia_white'\n!sleep 0.5 && xdotool type --delay 200 \"ipython\" && xdotool key Return\n!sleep 3 && xdotool type --delay 200 \"!idl\" && xdotool key Return\n!sleep 3 && xdotool key Ctrl+d\n!sleep 1 && xdotool type --delay 200 \"!csh -c sswidl\" && xdotool key Return\n```\n\n<center><http://jupyter.org/></center>\n<img style='float: center;' src='/main/jupyterlogo.png' />\n\n<center><https://nbviewer.jupyter.org/></center>\n<img style='float: center;' src='/main/nbviewer.png' />\n\n参考文档\n<http://jupyter-notebook.readthedocs.io/en/stable/>\n\n* 打开 `jupyter notebook`:\n\n```\n$ jupyter notebook [filename]\n```\n\n## 常用包介绍\n\n### Python 自带包和模块\n\n```python\nfrom math import * # 包含 pi 等, 但更推荐 numpy\nfrom copy import deepcopy\nfrom pprint import pprint  # 打印 list, dict 等更好看\nimport requests\nimport os\nimport sys\n```\n\n### NumPy, SciPy\n\n#### 概览\n\n<center><https://www.scipy.org></center>\n<img src='/main/SciPy.png' />\n\n<center><http://scikit-image.org></center>\n<img src='/main/scikitlogo.png' />\n<img src='/main/skimage01.png' />\n\n```python\nimport numpy as np\n```\n\n导入包的不同方式将在各例子中看到.\n\n参考:\n\n  - NumPy User Guide <https://docs.scipy.org/doc/numpy/user/>\n  - NumPy Reference <https://docs.scipy.org/doc/numpy/reference/>\n  - ndarray<br><https://docs.scipy.org/doc/numpy/reference/arrays.ndarray.html>\n  - Array manipulation routines<br><https://docs.scipy.org/doc/numpy/reference/routines.array-manipulation.html>\n  - SciPy Cookbook <http://scipy-cookbook.readthedocs.io/>\n  - 与 IDL 的语法对照\n    - <http://mathesaurus.sourceforge.net/idl-numpy.html>\n    - <http://blog.rtwilson.com/ten-little-idl-programs-in-python/>\n    - <http://www.astrobetter.com/blog/2009/05/04/idl-vs-python/>\n\n#### 生成 numpy.ndarray 数组\n\n将 list 或 tuple 转换为 `numpy.ndarray`\n```python\nimport numpy as np\na = np.array([0, 1, 2, 3, 4])\n# 切片(slice), 索引可以是 int 或 list (python list 只支持 list作为索引)\na[0]          # 0\na[-1]         # 4\na[0:3]        # array([0, 1, 2]) 注意!\na[:3]         # array([0, 1, 2])\na[2:4]        # array([2, 3])\na[2:-1]       # array([2, 3]) 注意!\na[2:]         # array([2, 3, 4])\na[0:4:2]      # array([0, 2])\na[4:2:-1]     # array([4, 3])\na[[1, 4, 3]]  # array([1, 4, 3]) 花式切片, 索引是一个 list (不能是tuple)\n```\n\n多维:\n\n```python\na = np.array([[0, 1, 2], [3, 4, 5]]); a\n```\n\n\n\n\n    array([[0, 1, 2],\n           [3, 4, 5]])\n\n\n\n```python\na = np.array(((0, 1, 2), (3, 4, 5))); a\n# 这里的tuple已转成ndarray, 于是结果是可变的\n```\n\n\n\n\n    array([[0, 1, 2],\n           [3, 4, 5]])\n\n\n\n```python\na[0, 1]\n```\n\n\n\n\n    1\n\n\n\n```python\na[0][1]\n```\n\n\n\n\n    1\n\n\n\n从一维数组转变为多维:\n\n```python\na = np.arange(12).reshape((3, -1)); a\n# reshape 的参数为 < 0 表示该维度自动判断元素个数\n# reshape 的参数是一个 list 或 tuple, 括号可以展开 (详见帮助文档)\n# 此例中 reshape((3, 2)), reshape(3, 2), reshape((3, -1)), reshape(3, -1) 等价\n```\n\n\n\n\n    array([[ 0,  1,  2,  3],\n           [ 4,  5,  6,  7],\n           [ 8,  9, 10, 11]])\n\n\n\n```python\nb = a.reshape(-1); b  # reshape 的参数只有一个维度且 < 0(自动)  => 展开成一维\n```\n\n\n\n\n    array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11])\n\n\n\n花式切片的多维例子:\n\n```python\na = np.arange(12).reshape(3, -1)\na[[0, 1],[0, 2]]\n# a[col_inds, row_inds], 此例等价于 a[[[0, 1], [0, 2]]], a[([0, 1], [0, 2])]\n```\n\n\n\n\n    array([0, 6])\n\n\n\n* **np.zeros**(shape, dtype=float),&ensp;**np.ones**(shape, dtype=float)\n\n```python\nnp.zeros((2, 3))  # 默认浮点型\n```\n\n\n\n\n    array([[0., 0., 0.],\n           [0., 0., 0.]])\n\n\n\n```python\nnp.ones((2, 3))  # 默认浮点型\n```\n\n\n\n\n    array([[1., 1., 1.],\n           [1., 1., 1.]])\n\n\n\n* **np.arange**([start,] stop[, step,], dtype=None)\n\n生成的数组元素数据类型和参数一致.<br><br>\n方便记忆: 最简形式 `np.arange`(*N*) 中的整数 *N* 即为 *元素个数*.\n\n```python\nnp.arange(6).reshape((3, 2))\n```\n\n\n\n\n    array([[0, 1],\n           [2, 3],\n           [4, 5]])\n\n\n\n```python\nnp.arange(6).reshape((3, -1))\n```\n\n\n\n\n    array([[0, 1],\n           [2, 3],\n           [4, 5]])\n\n\n\n* **np.linspace**(start, stop, num=50, **endpoint=True**, retstep=False, dtype=None)<br>\n默认生成的元素是浮点型<br>\n注意 `np.linspace` 和 `np.arange` 的不同规则\n\n```python\nnp.linspace(0, 1, 2)\n```\n\n\n\n\n    array([0., 1.])\n\n\n\n```python\nnp.linspace(0, 1, 2, endpoint=False) \n```\n\n\n\n\n    array([0. , 0.5])\n\n\n\n更多数组创建方法见 numpy 官网:<br>\n<https://docs.scipy.org/doc/numpy/reference/routines.array-creation.html><br>\n<https://docs.scipy.org/doc/numpy/user/basics.creation.html#arrays-creation>\n\n* 转置\n\n```python\na = np.arange(12).reshape(3, -1); a\n```\n\n\n\n\n    array([[ 0,  1,  2,  3],\n           [ 4,  5,  6,  7],\n           [ 8,  9, 10, 11]])\n\n\n\n```python\na.T\n```\n\n\n\n\n    array([[ 0,  4,  8],\n           [ 1,  5,  9],\n           [ 2,  6, 10],\n           [ 3,  7, 11]])\n\n\n\n更多数组操作见 numpy 官网 <https://docs.scipy.org/doc/numpy/reference/routines.array-manipulation.html>\n矩阵操作见 [Python 进阶#矩阵](advance.html#矩阵)\n\n### Matplotlib\n\n* 官方示例 <https://matplotlib.org/tutorials/index.html>\n<img src='/main/Matplotlib.png' />\n<img src='/main/annotation_demo2_00.png' />\n<img src='/main/contour_demo_05.png' />\n\n* 官方教程 <https://matplotlib.org/tutorials/introductory/usage.html>\n\n```python\nimport matplotlib.pyplot as plt\n```\n\n创建一个图像 (三种写法皆可):\n\n```python\nfig, ax = plt.subplots()\n```\n\n```python\nfig = plt.figure(1, (12, 6), dpi=100)\nax = fig.add_subplot(111)  # 数字 (ijk) 表示: 这是一共i行j列中的组图中的第k个图\n```\n\n```python\nfig = plt.gcf()\nax = plt.gca()\n```\n\n获取帮助:\n\n```python\nhelp(ax)\n```\n\n```python\n# 查看某对象包含的方法\nax.# <Tab>, <Shift-Tab>\nplt.# <Tab>, <Shift-Tab>\n```\n\n例:\n\n```python\n%matplotlib?\n```\n\n```python\n%matplotlib\n%run -e 'examples/test_plot.py'\n```\n\n```python\n%matplotlib\n%run -e 'examples/test_imshow.py'\n```\n\n* 颜色 <https://matplotlib.org/examples/color/colormaps_reference.html>\n* legend <https://matplotlib.org/users/legend_guide.html>\n<br>\n<img src='/main/named_colors.png' />\n\n### 天文相关包\n\n#### Astropy\n\n<img src='/main/astropy_banner.svg' />\n\n官方文档 <http://docs.astropy.org/en/stable/index.html>\n\n坐标系统 <http://docs.astropy.org/en/stable/coordinates/index.html>\n\n```python\nfrom astropy import units as u\nfrom astropy.coordinates import SkyCoord\n```\n\n参考 <https://python4astronomers.github.io/astropy/astropy.html>\n\n#### SunPy\n\n<img src='/main/Screenshot_20180625-005924.png' />\n<img src='/main/sphx_glr_lat_lon_lines_001.png' />\n<img src='/main/sphx_glr_submaps_and_cropping_001.png' />\n\n<br>\nHMI 示例见 [Python 进阶#SunPy 示例](advance.html#SunPy-示例)<br>\n<https://coding.net/u/lydiazly/p/scripts-sunpy/git?public=true>\n\n<br><br>\n参考:\n\n  - Gallery <http://docs.sunpy.org/en/stable/generated/gallery/index.html>\n  - SunPy Guide <http://docs.sunpy.org/en/stable/guide/index.html>\n  - SunPy Map<br><http://docs.sunpy.org/en/stable/code_ref/map.html#sunpy.map.mapbase.GenericMap>\n  - Example Gallery <http://docs.sunpy.org/en/stable/generated/gallery/index.html>\n  - A brief tour of SunPy <http://docs.sunpy.org/en/stable/guide/tour.html>\n  - Finding and Downloading Data using Fido<br><http://docs.sunpy.org/en/stable/guide/acquiring_data/fido.html>\n\n简单的例子 (来自官网):\n\n```python\n%matplotlib inline\n\nimport sunpy.map\nimport matplotlib.pyplot as plt\nimport sunpy.data.sample\n\naia = sunpy.map.Map(sunpy.data.sample.AIA_171_IMAGE)\n\nfig = plt.figure(1, (5, 5), dpi=100)\nax = plt.subplot(111, projection=aia)\n\naia.plot()\naia.draw_limb()\naia.draw_grid()\naia.draw_limb()\nplt.colorbar();\n\n# plt.show()\n```\n\n    /home/lydia/miniconda3/lib/python3.6/site-packages/sunpy/map/sources/sdo.py:48: SunpyDeprecationWarning: Use Matplotlib to load the colormaps\n      self.plot_settings['cmap'] = cm.get_cmap(self._get_cmap_name())\n\n\n\n    \n![png](/main/main_126_1.png)\n    \n\n\n获取一些常数:\n\n```python\nfrom sunpy.sun import constants as con\n# one astronomical unit (the average distance between the Sun and Earth)\nprint(con.au)\n```\n\n      Name   = Astronomical Unit\n      Value  = 149597870700.0\n      Uncertainty  = 0.0\n      Unit  = m\n      Reference = IAU 2012 Resolution B2\n\n\n```python\n# the solar radius\nprint(con.radius)\n```\n\n      Name   = Solar radius\n      Value  = 695508000.0\n      Uncertainty  = 26000.0\n      Unit  = m\n      Reference = Allen's Astrophysical Quantities 4th Ed.\n\n\n## 常见数据文件读写\n\n### 一般情况\n\n```python\nf = open(filename, 'w')  # 'w', 'r', ...\n...\n...\nf.close()\n```\n更好的用法:\n```python\nwith open(filename, 'w') as f:  # 'w', 'r', ...\n    ...\n    ...\n```\n\n### txt, csv 文件读写\n\n* 逐行读取整行的方式:<br>\n使用 `strip` 可以用来去掉读入的每行末尾的 '\\n'\n\n```python\nlines = []\nwith open('data/data.csv', 'r') as f:\n    for line in f:\n        lines.append(line.strip().split(','))\nlines\n```\n\n\n\n\n    [['col1', 'col2', 'col3'],\n     ['row1', '1', '1e1'],\n     ['row2', '2', '2e-1'],\n     ['row3', '3', '3e+2']]\n\n\n\n* 使用 numpy, 读取后直接转成数组的方式 (推荐):<br>\n`np.loadtxt`,&ensp;`np.genfromtxt` (写文件是 `np.savetxt`)<br>\n超大文件读取建议用 pandas 包.\n\ne.g.\n\n```python\n>>> import numpy as np\n>>> arr = np.loadtxt(fname, skiprows=1, delimiter=',') # 默认分割符为空格\n>>> col1, col2 = np.loadtxt(fname, skiprows=1, usecols=(1, 2), unpack=True)\n```\n`np.genfromtxt` 和 `np.loadtxt` 类似, 增加了处理 missing values 的功能.<br>\n(但参数 skiprows=1 需替换为 skip_header=1)\n\n例 (这里使用功能更多的 `np.genfromtxt` 代替 `np.loadtxt`):\n\n```python\narr = np.genfromtxt('data/data.csv',\n                    skip_header=1,\n                    names=('col1', 'col2', 'col3'),\n                    dtype=('U15', 'int', 'float'),\n                    delimiter=',')\nprint(arr[['col1', 'col2']])  # 设定了 names 之后, 可以用名称索引\n```\n\n    [('row1', 1) ('row2', 2) ('row3', 3)]\n\n\n```python\narr = np.genfromtxt('data/data2.csv',\n                    skip_header=1,\n                    names=('col1', 'col2', 'col3'),\n                    dtype=('U15', 'int', 'float'),\n                    missing_values=None,\n                    filling_values=('', 0, np.nan),  # 分开指定\n                    delimiter=',')\nprint(arr)\n```\n\n    [('row1', 0, 10. ) ('', 2,  0.2) ('row3', 3,  nan)]\n\n\n* 一般而言, 对于一个由分隔符分隔的字符串, 转成一个数组的方式:<br>\n`np.fromstring(string, dtype=float, count=-1, sep='')`\n\n```python\nnp.fromstring('0 1 2', dtype=int, sep=' ')\n```\n\n\n\n\n    array([0, 1, 2])\n\n\n\n```python\nnp.fromstring('0., 1., 2.', sep=',')\n```\n\n\n\n\n    array([0., 1., 2.])\n\n\n\n### numpy save 文件读写\n\n```python\nnp.save('fname', arr)  # 'fname.npy'\nnp.savez('fname', arr)  # 'fname.npz', 多个变量\nnp.savez_compressed('fname', arr)  # 'fname.npz', 多个变量 & 压缩\nnp.load('fname.npz')  # Load the files created by savez_compressed.\n```\n\n```python\n# 存入\narr = np.ones(5)  # 默认 `float64`\nnp.savez('data/np_array', a=arr, b=0)\n```\n\n```python\nls data/*.npz\n```\n\n    data/np_array.npz\n\n\n```python\n# 载入\ndata = np.load('data/np_array.npz')\nprint((data['a'], data['b'], int(data['b'])))  # 默认以`ndarray`读取\n```\n\n    (array([1., 1., 1., 1., 1.]), array(0), 0)\n\n\n### IDL sav 文件读取\n\n```python\nfrom scipy.io.idl import readsav\ndata = readsav('dname.sav', verbose=True, python_dict=False)\n```\n默认读出的是`scipy.io.idl.AttrDict`类型, 即 key 的大小写不敏感.<br>\n想要得到大小写敏感的 python dict, 设置 `python_dict=True` 即可.\n<br><br>\n例:\n\n```python\nfrom scipy.io.idl import readsav\ndata = readsav('data/myidlfile.sav')\nprint(type(data))\nprint(data.keys())  # 注意返回的是一个`dict_keys`对象, 如需索引需要手动转为list\nprint(data['X'].shape)  # 大小写不敏感\ndata = readsav('data/myidlfile.sav', python_dict=True)\nprint(type(data))\nprint(data['x'].shape)  # 大小写敏感\n```\n\n    <class 'scipy.io.idl.AttrDict'>\n    dict_keys(['x', 'y', 'str'])\n    (25,)\n    <class 'dict'>\n    (25,)\n\n\n### FITS 文件读取\n\n* Astropy\n\n参考:<br>\n<http://docs.astropy.org/en/stable/io/fits><br>\n<https://python4astronomers.github.io/astropy/fits.html>\n\n> [Note]<br>\nIf you are already familiar with PyFITS, astropy.io.fits is in fact the same code as the latest version of PyFITS, and you can adapt old scripts that use PyFITS to use Astropy by simply doing:\n```python\nfrom astropy.io import fits as pyfits\n```\nHowever, for new scripts, we recommend the following import:\n```python\nfrom astropy.io import fits\n```\n\n`fits.open`\n```python\n>>> from astropy.io import fits\n>>> hdulist = fits.open('<filename>.fit')\n>>> hdulist.info()  # hdulist 是一个由 HDU objects 组成的类似列表的对象\nFilename: <filename>.fit\nNo.    Name         Type      Cards   Dimensions   Format\n0    PRIMARY     PrimaryHDU    ...       ...        ...\n1    ENERGIES    BinTableHDU   ...       ...        ...\n>>> hdu = hdulist[0]\n>>> hdu.data  # ndarray\n>>> hdu.header['<key>']  # 得到某个 header keyword\n# 修改数据后\n>>> hdu.writeto('<filename>.fits') # 保存 HDU object\n>>> hdulist.writeto('<filename>.fits')  # 或保存整个表\n```\n```python\n# 创建一个 fits Primary HDU object\n>>> hdu = fits.PrimaryHDU()\n>>> hdu.writeto('<filename>.fits')  # 保存 HDU object\n>>> hdu.writeto('<filename>.fits', clobber=True)  # 保存到已存在文件\n```\n`fits.getdata`, `fits.getheader`\n```python\n>>> data = fits.getdata('<filename>.fit')\n>>> header = fits.getheader('<filename>.fit')\n```\n<br>\n* SunPy\n\n```python\n>>> import sunpy.io\n>>> hdulist = sunpy.io.read_file('<filename>.fits')  # 自动判断文件类型\n# or use `hdulist = sunpy.io.fits.read('<filename>.fits')`\n>>> hdu = hdulist[1]\n>>> hdu.data  # ndarray\n```\n```python\n>>> import sunpy.map\n>>> smap = sunpy.map.Map('<filename>.fits')\n# 得到一个 sunpy `GenericMap` object\n```\n\n例:\n\n```python\nfrom astropy.io import fits\nfname = 'scripts-sunpy/plothmi/data/hmi.B_720s.20150827_052400_TAI.field.fits'\nhdulist = fits.open(fname)\n```\n\n```python\nhdulist.info()\n```\n\n    Filename: scripts-sunpy/plothmi/data/hmi.B_720s.20150827_052400_TAI.field.fits\n    No.    Name      Ver    Type      Cards   Dimensions   Format\n      0  PRIMARY       1 PrimaryHDU       6   ()      \n      1                1 CompImageHDU    155   (4096, 4096)   int32   \n\n\n```python\nhdulist.verify('silentfix+warn')\nhdu = hdulist[1]\nhdu.data.shape\n```\n\n\n\n\n    (4096, 4096)\n\n\n\n```python\nimport sunpy.io\nhdulist = sunpy.io.read_file(fname)\nhdu = hdulist[1]\nhdu.data.shape\n```\n\n\n\n\n    (4096, 4096)\n\n\n\n## 其他包和软件\n\n* Astroconda <https://astroconda.readthedocs.io/en/latest/>\n> AstroConda is a free Conda channel maintained by the Space Telescope Science Institute (STScI) in Baltimore, Maryland. This channel provides tools and utilities required to process and analyze data from the Hubble Space Telescope (HST), James Webb Space Telescope (JWST), and others.\n<br><br>\n* Canopy <https://www.enthought.com/product/canopy/>\n> Enthought Canopy provides a proven scientific and analytic Python package distribution plus key integrated tools for iterative data analysis, data visualization, and application development. Users have the ability to extend and innovate with scripting and open platform APIs, driving the creation and sharing of innovative workflows, tools, and applications.\n<img src='/main/Canopy-Packages-min-1.png' >\n<br><br>\n* PyCharm <https://www.jetbrains.com/pycharm/>\n<img src='/main/pycharm.jpg' >\n<br><br>\n* Jupyterlab <http://jupyterlab.readthedocs.io/en/stable/>\n<img src='/main/jupyterlab.png' >\n","slug":"main","published":1,"updated":"2018-07-02T12:56:13.000Z","__permalink":"main.html","comments":1,"layout":"post","photos":[],"link":"","_id":"cl5kegawe000xvxgv8jcbb1cn","content":"<p><a\nhref=\"/downloads/notebooks/python-intro.zip\"><i class=\"fas fa-download\"></i>\nJupyter Notebook</a></p>\n<h2 id=\"简介\">简介</h2>\n<p>优势: 开源, 用户广, 用途广, 社区完善, 新手友好</p>\n<p><a\nhref=\"https://www.jetbrains.com/research/python-developers-survey-2017/\"\nclass=\"uri\">https://www.jetbrains.com/research/python-developers-survey-2017/</a>\n<br><br> 2017年的 python 使用调查报告 <a\nhref=\"https://www.jetbrains.com/research/python-developers-survey-2017/\"\nclass=\"uri\">https://www.jetbrains.com/research/python-developers-survey-2017/</a>\n<img src='/main/Python Developers Survey 2017 - Results-018.png' >\n<img src='/main/Python Developers Survey 2017 - Results-019.png' >\n<img src='/main/Python Developers Survey 2017 - Results-020.png' ></p>\n<p>参考网站:</p>\n<ul>\n<li>官方网站: <a href=\"https://www.python.org/\"\nclass=\"uri\">https://www.python.org/</a></li>\n<li>stackoverflow <a\nhref=\"https://stackoverflow.com/questions/tagged/python\"\nclass=\"uri\">https://stackoverflow.com/questions/tagged/python</a></li>\n<li>官方文档 <a href=\"https://docs.python.org\"\nclass=\"uri\">https://docs.python.org</a></li>\n<li>廖雪峰的网站 (包含 python2.7 和 python3 的教程) <a\nhref=\"https://www.liaoxuefeng.com\"\nclass=\"uri\">https://www.liaoxuefeng.com</a></li>\n<li>wikibooks <a href=\"https://en.wikibooks.org/wiki/Python_Programming\"\nclass=\"uri\">https://en.wikibooks.org/wiki/Python_Programming</a></li>\n<li>演示代码执行过程的工具 <a href=\"http://pythontutor.com/\"\nclass=\"uri\">http://pythontutor.com/</a></li>\n<li>天文相关教程 (较新) <a href=\"https://python4astronomers.github.io\"\nclass=\"uri\">https://python4astronomers.github.io</a></li>\n</ul>\n<p><br> 获取 python 包/模块/函数的帮助:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># python</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token builtin\">help</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-sh\" data-language=\"sh\"><code class=\"language-sh\"># shell\n$ pydoc &lt;name&gt;\n$ pydoc -w &lt;name&gt;  # 生成一个 html 帮助文件<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># ipython/jupyter</span>\nname?  <span class=\"token comment\"># 弹出帮助文档, `Esc` 退出文档</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<span id=\"more\"></span>\n<h2 id=\"基本语法\">基本语法</h2>\n<h3 id=\"语法特点\">语法特点</h3>\n<ul>\n<li>对象编程的概念<br> 类 -&gt; 创建一个实例 -&gt;\n使用该实例所属的类下面的方法 <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">l <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># l 是 list 的一个实例</span>\nl<span class=\"token punctuation\">.</span>reverse<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># reverse 是一个方法(函数), reverse() 是一个实例</span>\nl<span class=\"token punctuation\">.</span>__dir__<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 查看 l 的所有方法(函数)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre> <br></li>\n<li>严格缩进 (通常采用4个半角空格) <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">if</span> a <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span>\n      a <span class=\"token operator\">+=</span> <span class=\"token number\">1</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre> <br></li>\n<li>空格不敏感 <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">+</span> b <span class=\"token operator\">*</span> c <span class=\"token operator\">**</span> <span class=\"token number\">2</span> <span class=\"token operator\">/</span> d\nf <span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre> <br></li>\n<li>大小写敏感, 使用大小写组合的变量名风格\n(下划线仍是合法变量名字符,但有特殊含义, 见 <a\nhref=\"advance.html#脚本相关\">Python 进阶#脚本相关</a>) <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> scipy<span class=\"token punctuation\">.</span>interpolate <span class=\"token keyword\">import</span> BSpline<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd\ndataFrame <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>DataFrame<span class=\"token punctuation\">(</span>array<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre> 见 <a href=\"#IDL-sav-文件读取\">IDL sav 文件读取</a>\n<br><br></li>\n<li>括号内换行不用换行符 <br><br></li>\n<li>单行注释 <code># ...</code> <br><br></li>\n<li>多行注释<br> 函数或模块的开头的多行注释\n(将存储在<code>__doc__</code>变量), 可以用 <code>help()</code> 打印\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token triple-quoted-string string\">\"\"\"\n这是一个\n多行注释\n\"\"\"</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre> <br></li>\n<li>同一行不同语句之间可用分号分隔 <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">x <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre> <br></li>\n<li>列表和数组的索引默认从<font color=red>0</font>开始 <br><br></li>\n<li>列表的最后一个元素可以加逗号 <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">&#123;</span><span class=\"token string\">'a'</span> <span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'b'</span> <span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre> <br></li>\n<li><em>etc.</em></li>\n</ul>\n<h3 id=\"print函数\">print函数</h3>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> <span class=\"token number\">1.</span><span class=\"token punctuation\">;</span> b <span class=\"token operator\">=</span> <span class=\"token number\">2.</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'a=%.3f, b=%.1e'</span> <span class=\"token operator\">%</span> <span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>a=1.000, b=2.0e+00</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f'a=</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>a<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">, b=</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>b<span class=\"token punctuation\">:</span><span class=\"token format-spec\">.3f</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">'</span></span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>a=1.0, b=2.000</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">%</span><span class=\"token operator\">%</span>python2\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'xxx'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'yyy'</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<pre><code>xxx yyy</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">%</span><span class=\"token operator\">%</span>python3\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'xxx'</span><span class=\"token punctuation\">,</span> end<span class=\"token operator\">=</span><span class=\"token string\">' '</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'yyy'</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<pre><code>xxx yyy</code></pre>\n<p>更多格式化参考 <a href=\"https://pyformat.info/\"\nclass=\"uri\">https://pyformat.info/</a></p>\n<h3 id=\"基本运算\">基本运算</h3>\n<p>运算符参考:<br> <a\nhref=\"https://en.wikibooks.org/wiki/Python_Programming/Basic_Math\"\nclass=\"uri\">https://en.wikibooks.org/wiki/Python_Programming/Basic_Math</a><br>\n<a\nhref=\"https://www.tutorialspoint.com/python/python_basic_operators.htm\"\nclass=\"uri\">https://www.tutorialspoint.com/python/python_basic_operators.htm</a></p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\na <span class=\"token operator\">+=</span> <span class=\"token number\">1</span>  <span class=\"token comment\"># 没有 a++ 这种语法</span>\na<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<pre><code>2</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token number\">3.</span> <span class=\"token operator\">**</span> <span class=\"token number\">2</span>  <span class=\"token comment\"># 自动转换数据类型</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>9.0</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token number\">1</span> <span class=\"token operator\">&lt;</span> <span class=\"token number\">2</span> <span class=\"token operator\">!=</span> <span class=\"token number\">3</span>  <span class=\"token comment\"># 判断, 可以连写</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>True</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> <span class=\"token boolean\">None</span>\na <span class=\"token keyword\">is</span> <span class=\"token boolean\">None</span>  <span class=\"token comment\"># 注意这时不用 `==`</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>True</code></pre>\n<h3 id=\"字符串\">字符串</h3>\n<p>用双引号和单引号皆可 (取决于所引内容).<br> 字符串具有和列表 (list)\n类似的运算规则 (见之后的 list 说明):</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token string\">'a'</span> <span class=\"token operator\">*</span> <span class=\"token number\">10</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>&#39;aaaaaaaaaa&#39;</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token string\">'a'</span> <span class=\"token operator\">+</span> <span class=\"token string\">'b'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>&#39;ab&#39;</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token string\">'abc'</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>&#39;a&#39;</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\n'</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">r'\\n'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># same as '\\\\n'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>\\n</code></pre>\n<h3 id=\"list-tuple-dict-set\">list, tuple, dict, set</h3>\n<ul>\n<li>有序表 list, tuple</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">l <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># list, 元素可变</span>\nt <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># tuple, 元素不可变</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">l<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">:</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># 一个切片(slice)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>[0, 1, 2]</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">t<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">:</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>(0, 1, 2)</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">l<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">:</span><span class=\"token number\">5</span><span class=\"token punctuation\">:</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># 索引: [start, stop, step] (结果不包含 stop)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>[1, 3]</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">l<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">:</span><span class=\"token number\">1</span><span class=\"token punctuation\">:</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># step &lt; 0, 仍然不包含 stop (此例中 stop=1)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>[5, 4, 3, 2]</code></pre>\n<p>list 常用运算</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">l <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span>\nl<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token string\">'x'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 添加在最后</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">)</span>\nl<span class=\"token punctuation\">.</span>insert<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'y'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 添加在 l[i] 之前</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">.</span>pop<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 删除某元素并返回该值</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code>[0, 1, 2, 3, 4, 5, &#39;x&#39;]\n[0, 1, 2, &#39;y&#39;, 3, 4, 5, &#39;x&#39;]\n1\n[0, 2, &#39;y&#39;, 3, 4, 5, &#39;x&#39;]</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>l <span class=\"token operator\">*</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 重复N遍</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>l <span class=\"token operator\">+</span> <span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 合并两个list</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>[1, &#39;y&#39;, 2, 3, 4, 5, &#39;x&#39;, 1, &#39;y&#39;, 2, 3, 4, 5, &#39;x&#39;]\n[1, &#39;y&#39;, 2, 3, 4, 5, &#39;x&#39;, 6, 7]</code></pre>\n<p>list 可以排序 (当元素为同一类型且可比较大小时), 返回到原列表</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">l <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'b'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'a'</span><span class=\"token punctuation\">]</span>\nl<span class=\"token punctuation\">.</span>sort<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nl<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<pre><code>[&#39;a&#39;, &#39;b&#39;]</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">l <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span>\nl<span class=\"token punctuation\">.</span>sort<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nl<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<pre><code>[1, 2]</code></pre>\n<ul>\n<li>字典 dict</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">d <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token string\">'a'</span> <span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'b'</span> <span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">d <span class=\"token operator\">=</span> <span class=\"token builtin\">dict</span><span class=\"token punctuation\">(</span>a<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> b<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># 注意这时没有引号</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">d<span class=\"token punctuation\">[</span><span class=\"token string\">'a'</span><span class=\"token punctuation\">]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>1</code></pre>\n<ul>\n<li>集合 set</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">s <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">&#125;</span>  <span class=\"token comment\"># set, 将自动排序并去除重复, 常用于 for 循环</span>\ns  <span class=\"token comment\"># 不能用 s[i] 来索引</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>&#123;1, 2, 3&#125;</code></pre>\n<p>set 不可索引, 但可用作 for 循环. 见 <a\nhref=\"advance.html#循环,-迭代器,-生成器\">Python 进阶#迭代器</a></p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> s<span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>1\n2\n3</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">l2 <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>i <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> s<span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>l2<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>[1, 2, 3]</code></pre>\n<h3 id=\"if-语句\">if 语句</h3>\n<p>python 里没有 <code>case</code>, 只有 <code>if</code>\n(非零数值、非空字符串、非空 list 等皆为 True) <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">if</span> <span class=\"token operator\">&lt;</span>条件判断<span class=\"token number\">1</span><span class=\"token operator\">></span><span class=\"token punctuation\">:</span>\n    <span class=\"token operator\">&lt;</span>执行<span class=\"token number\">1</span><span class=\"token operator\">></span>\n<span class=\"token keyword\">elif</span> <span class=\"token operator\">&lt;</span>条件判断<span class=\"token number\">2</span><span class=\"token operator\">></span><span class=\"token punctuation\">:</span>\n    <span class=\"token operator\">&lt;</span>执行<span class=\"token number\">2</span><span class=\"token operator\">></span>\n<span class=\"token keyword\">elif</span> <span class=\"token operator\">&lt;</span>条件判断<span class=\"token number\">3</span><span class=\"token operator\">></span><span class=\"token punctuation\">:</span>\n    <span class=\"token operator\">&lt;</span>执行<span class=\"token number\">3</span><span class=\"token operator\">></span>\n<span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n    <span class=\"token operator\">&lt;</span>执行<span class=\"token number\">4</span><span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<h3 id=\"相关工具\">相关工具</h3>\n<h4 id=\"pip\">pip</h4>\n<p><img src='/main/logo-large.72ad8bf1.svg' /></p>\n<blockquote>\n<p>The <strong>Python Package Index (PyPI)</strong> is a repository of\nsoftware for the Python programming language.<br/> PyPI helps you find\nand install software developed and shared by the Python community.<br/>\n<a href=\"https://pypi.org/\" class=\"uri\">https://pypi.org/</a></p>\n</blockquote>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">$ pip install &lt;pkg_name&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>    (其他命令见 <a href=\"installpy.html#用-pip-安装-python-包\">Python\n安装和配置#用 pip 安装 python 包</a>)</p>\n<h4 id=\"anaconda\">Anaconda</h4>\n<p><img src='/main/DataScienceLibraries-01.png' />\n<img src='/main/Conda-DistributionDiagram-01.png' /></p>\n<p><img src='/main/Conda — Conda documentation.png' /></p>\n<p><strong>Anaconda</strong> (https://www.anaconda.com/)<br> 安装好的\nconda 包含独立于系统的 python 版本, 一部分已编译好的包, pip 工具,\n以及不同环境的子目录.<br/> 可根据需要切换不同的 conda 环境以使用不同的\npython 版本或不同的包的组合.</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">$ conda install &lt;pkg_name&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>其他命令见 <a href=\"installpy.html#使用-conda-命令\">Python\n安装和配置#使用 conda 命令</a><br> 详细说明见 <a\nhref=\"advance.html#Anaconda\">Python 进阶#Anaconda</a></p>\n<h4 id=\"ipython-jupyter\">IPython &amp; Jupyter</h4>\n<p><img style='float: center;' src='/main/IPython.png' /></p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># Have a look (ipython)</span>\n!cd <span class=\"token operator\">&amp;</span><span class=\"token operator\">&amp;</span> gnome<span class=\"token operator\">-</span>terminal <span class=\"token operator\">-</span><span class=\"token operator\">-</span>window<span class=\"token operator\">-</span><span class=\"token keyword\">with</span><span class=\"token operator\">-</span>profile<span class=\"token operator\">=</span><span class=\"token string\">'lydia_white'</span>\n!sleep <span class=\"token number\">0.5</span> <span class=\"token operator\">&amp;</span><span class=\"token operator\">&amp;</span> xdotool <span class=\"token builtin\">type</span> <span class=\"token operator\">-</span><span class=\"token operator\">-</span>delay <span class=\"token number\">200</span> <span class=\"token string\">\"ipython\"</span> <span class=\"token operator\">&amp;</span><span class=\"token operator\">&amp;</span> xdotool key Return\n!sleep <span class=\"token number\">3</span> <span class=\"token operator\">&amp;</span><span class=\"token operator\">&amp;</span> xdotool <span class=\"token builtin\">type</span> <span class=\"token operator\">-</span><span class=\"token operator\">-</span>delay <span class=\"token number\">200</span> <span class=\"token string\">\"!idl\"</span> <span class=\"token operator\">&amp;</span><span class=\"token operator\">&amp;</span> xdotool key Return\n!sleep <span class=\"token number\">3</span> <span class=\"token operator\">&amp;</span><span class=\"token operator\">&amp;</span> xdotool key Ctrl<span class=\"token operator\">+</span>d\n!sleep <span class=\"token number\">1</span> <span class=\"token operator\">&amp;</span><span class=\"token operator\">&amp;</span> xdotool <span class=\"token builtin\">type</span> <span class=\"token operator\">-</span><span class=\"token operator\">-</span>delay <span class=\"token number\">200</span> <span class=\"token string\">\"!csh -c sswidl\"</span> <span class=\"token operator\">&amp;</span><span class=\"token operator\">&amp;</span> xdotool key Return<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<center>\n<a href=\"http://jupyter.org/\" class=\"uri\">http://jupyter.org/</a>\n</center>\n<p><img style='float: center;' src='/main/jupyterlogo.png' /></p>\n<center>\n<a href=\"https://nbviewer.jupyter.org/\"\nclass=\"uri\">https://nbviewer.jupyter.org/</a>\n</center>\n<p><img style='float: center;' src='/main/nbviewer.png' /></p>\n<p>参考文档 <a href=\"http://jupyter-notebook.readthedocs.io/en/stable/\"\nclass=\"uri\">http://jupyter-notebook.readthedocs.io/en/stable/</a></p>\n<ul>\n<li>打开 <code>jupyter notebook</code>:</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">$ jupyter notebook [filename]<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<h2 id=\"常用包介绍\">常用包介绍</h2>\n<h3 id=\"python-自带包和模块\">Python 自带包和模块</h3>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> math <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span> <span class=\"token comment\"># 包含 pi 等, 但更推荐 numpy</span>\n<span class=\"token keyword\">from</span> copy <span class=\"token keyword\">import</span> deepcopy\n<span class=\"token keyword\">from</span> pprint <span class=\"token keyword\">import</span> pprint  <span class=\"token comment\"># 打印 list, dict 等更好看</span>\n<span class=\"token keyword\">import</span> requests\n<span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">import</span> sys<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h3 id=\"numpy-scipy\">NumPy, SciPy</h3>\n<h4 id=\"概览\">概览</h4>\n<center>\n<a href=\"https://www.scipy.org\" class=\"uri\">https://www.scipy.org</a>\n</center>\n<p><img src='/main/SciPy.png' /></p>\n<center>\n<a href=\"http://scikit-image.org\"\nclass=\"uri\">http://scikit-image.org</a>\n</center>\n<p><img src='/main/scikitlogo.png' />\n<img src='/main/skimage01.png' /></p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>导入包的不同方式将在各例子中看到.</p>\n<p>参考:</p>\n<ul>\n<li>NumPy User Guide <a href=\"https://docs.scipy.org/doc/numpy/user/\"\nclass=\"uri\">https://docs.scipy.org/doc/numpy/user/</a></li>\n<li>NumPy Reference <a\nhref=\"https://docs.scipy.org/doc/numpy/reference/\"\nclass=\"uri\">https://docs.scipy.org/doc/numpy/reference/</a></li>\n<li>ndarray<br><a\nhref=\"https://docs.scipy.org/doc/numpy/reference/arrays.ndarray.html\"\nclass=\"uri\">https://docs.scipy.org/doc/numpy/reference/arrays.ndarray.html</a></li>\n<li>Array manipulation routines<br><a\nhref=\"https://docs.scipy.org/doc/numpy/reference/routines.array-manipulation.html\"\nclass=\"uri\">https://docs.scipy.org/doc/numpy/reference/routines.array-manipulation.html</a></li>\n<li>SciPy Cookbook <a href=\"http://scipy-cookbook.readthedocs.io/\"\nclass=\"uri\">http://scipy-cookbook.readthedocs.io/</a></li>\n<li>与 IDL 的语法对照\n<ul>\n<li><a href=\"http://mathesaurus.sourceforge.net/idl-numpy.html\"\nclass=\"uri\">http://mathesaurus.sourceforge.net/idl-numpy.html</a></li>\n<li><a\nhref=\"http://blog.rtwilson.com/ten-little-idl-programs-in-python/\"\nclass=\"uri\">http://blog.rtwilson.com/ten-little-idl-programs-in-python/</a></li>\n<li><a href=\"http://www.astrobetter.com/blog/2009/05/04/idl-vs-python/\"\nclass=\"uri\">http://www.astrobetter.com/blog/2009/05/04/idl-vs-python/</a></li>\n</ul></li>\n</ul>\n<h4 id=\"生成-numpy.ndarray-数组\">生成 numpy.ndarray 数组</h4>\n<p>将 list 或 tuple 转换为 <code>numpy.ndarray</code> <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np\na <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 切片(slice), 索引可以是 int 或 list (python list 只支持 list作为索引)</span>\na<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>          <span class=\"token comment\"># 0</span>\na<span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>         <span class=\"token comment\"># 4</span>\na<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">:</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span>        <span class=\"token comment\"># array([0, 1, 2]) 注意!</span>\na<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span>         <span class=\"token comment\"># array([0, 1, 2])</span>\na<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">:</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span>        <span class=\"token comment\"># array([2, 3])</span>\na<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">:</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>       <span class=\"token comment\"># array([2, 3]) 注意!</span>\na<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span>         <span class=\"token comment\"># array([2, 3, 4])</span>\na<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">:</span><span class=\"token number\">4</span><span class=\"token punctuation\">:</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span>      <span class=\"token comment\"># array([0, 2])</span>\na<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">:</span><span class=\"token number\">2</span><span class=\"token punctuation\">:</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>     <span class=\"token comment\"># array([4, 3])</span>\na<span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># array([1, 4, 3]) 花式切片, 索引是一个 list (不能是tuple)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>多维:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> a<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>array([[0, 1, 2],\n       [3, 4, 5]])</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> a\n<span class=\"token comment\"># 这里的tuple已转成ndarray, 于是结果是可变的</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>array([[0, 1, 2],\n       [3, 4, 5]])</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>1</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>1</code></pre>\n<p>从一维数组转变为多维:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>arange<span class=\"token punctuation\">(</span><span class=\"token number\">12</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> a\n<span class=\"token comment\"># reshape 的参数为 &lt; 0 表示该维度自动判断元素个数</span>\n<span class=\"token comment\"># reshape 的参数是一个 list 或 tuple, 括号可以展开 (详见帮助文档)</span>\n<span class=\"token comment\"># 此例中 reshape((3, 2)), reshape(3, 2), reshape((3, -1)), reshape(3, -1) 等价</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code>array([[ 0,  1,  2,  3],\n       [ 4,  5,  6,  7],\n       [ 8,  9, 10, 11]])</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">b <span class=\"token operator\">=</span> a<span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> b  <span class=\"token comment\"># reshape 的参数只有一个维度且 &lt; 0(自动)  => 展开成一维</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11])</code></pre>\n<p>花式切片的多维例子:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>arange<span class=\"token punctuation\">(</span><span class=\"token number\">12</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\na<span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span>\n<span class=\"token comment\"># a[col_inds, row_inds], 此例等价于 a[[[0, 1], [0, 2]]], a[([0, 1], [0, 2])]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<pre><code>array([0, 6])</code></pre>\n<ul>\n<li><strong>np.zeros</strong>(shape,\ndtype=float), <strong>np.ones</strong>(shape, dtype=float)</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">np<span class=\"token punctuation\">.</span>zeros<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 默认浮点型</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>array([[0., 0., 0.],\n       [0., 0., 0.]])</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">np<span class=\"token punctuation\">.</span>ones<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 默认浮点型</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>array([[1., 1., 1.],\n       [1., 1., 1.]])</code></pre>\n<ul>\n<li><strong>np.arange</strong>([start,] stop[, step,], dtype=None)</li>\n</ul>\n<p>生成的数组元素数据类型和参数一致.<br><br> 方便记忆: 最简形式\n<code>np.arange</code>(<em>N</em>) 中的整数 <em>N</em> 即为\n<em>元素个数</em>.</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">np<span class=\"token punctuation\">.</span>arange<span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>array([[0, 1],\n       [2, 3],\n       [4, 5]])</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">np<span class=\"token punctuation\">.</span>arange<span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>array([[0, 1],\n       [2, 3],\n       [4, 5]])</code></pre>\n<ul>\n<li><strong>np.linspace</strong>(start, stop, num=50,\n<strong>endpoint=True</strong>, retstep=False, dtype=None)<br>\n默认生成的元素是浮点型<br> 注意 <code>np.linspace</code> 和\n<code>np.arange</code> 的不同规则</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">np<span class=\"token punctuation\">.</span>linspace<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>array([0., 1.])</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">np<span class=\"token punctuation\">.</span>linspace<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> endpoint<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span> <span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>array([0. , 0.5])</code></pre>\n<p>更多数组创建方法见 numpy 官网:<br> <a\nhref=\"https://docs.scipy.org/doc/numpy/reference/routines.array-creation.html\"\nclass=\"uri\">https://docs.scipy.org/doc/numpy/reference/routines.array-creation.html</a><br>\n<a\nhref=\"https://docs.scipy.org/doc/numpy/user/basics.creation.html#arrays-creation\"\nclass=\"uri\">https://docs.scipy.org/doc/numpy/user/basics.creation.html#arrays-creation</a></p>\n<ul>\n<li>转置</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>arange<span class=\"token punctuation\">(</span><span class=\"token number\">12</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> a<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>array([[ 0,  1,  2,  3],\n       [ 4,  5,  6,  7],\n       [ 8,  9, 10, 11]])</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a<span class=\"token punctuation\">.</span>T<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>array([[ 0,  4,  8],\n       [ 1,  5,  9],\n       [ 2,  6, 10],\n       [ 3,  7, 11]])</code></pre>\n<p>更多数组操作见 numpy 官网 <a\nhref=\"https://docs.scipy.org/doc/numpy/reference/routines.array-manipulation.html\"\nclass=\"uri\">https://docs.scipy.org/doc/numpy/reference/routines.array-manipulation.html</a>\n矩阵操作见 <a href=\"advance.html#矩阵\">Python 进阶#矩阵</a></p>\n<h3 id=\"matplotlib\">Matplotlib</h3>\n<ul>\n<li><p>官方示例 <a href=\"https://matplotlib.org/tutorials/index.html\"\nclass=\"uri\">https://matplotlib.org/tutorials/index.html</a>\n<img src='/main/Matplotlib.png' />\n<img src='/main/annotation_demo2_00.png' />\n<img src='/main/contour_demo_05.png' /></p></li>\n<li><p>官方教程 <a\nhref=\"https://matplotlib.org/tutorials/introductory/usage.html\"\nclass=\"uri\">https://matplotlib.org/tutorials/introductory/usage.html</a></p></li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> matplotlib<span class=\"token punctuation\">.</span>pyplot <span class=\"token keyword\">as</span> plt<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>创建一个图像 (三种写法皆可):</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">fig<span class=\"token punctuation\">,</span> ax <span class=\"token operator\">=</span> plt<span class=\"token punctuation\">.</span>subplots<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">fig <span class=\"token operator\">=</span> plt<span class=\"token punctuation\">.</span>figure<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> dpi<span class=\"token operator\">=</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span>\nax <span class=\"token operator\">=</span> fig<span class=\"token punctuation\">.</span>add_subplot<span class=\"token punctuation\">(</span><span class=\"token number\">111</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 数字 (ijk) 表示: 这是一共i行j列中的组图中的第k个图</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">fig <span class=\"token operator\">=</span> plt<span class=\"token punctuation\">.</span>gcf<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nax <span class=\"token operator\">=</span> plt<span class=\"token punctuation\">.</span>gca<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<p>获取帮助:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token builtin\">help</span><span class=\"token punctuation\">(</span>ax<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># 查看某对象包含的方法</span>\nax<span class=\"token punctuation\">.</span><span class=\"token comment\"># &lt;Tab>, &lt;Shift-Tab></span>\nplt<span class=\"token punctuation\">.</span><span class=\"token comment\"># &lt;Tab>, &lt;Shift-Tab></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<p>例:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">%</span>matplotlib?<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">%</span>matplotlib\n<span class=\"token operator\">%</span>run <span class=\"token operator\">-</span>e <span class=\"token string\">'examples/test_plot.py'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">%</span>matplotlib\n<span class=\"token operator\">%</span>run <span class=\"token operator\">-</span>e <span class=\"token string\">'examples/test_imshow.py'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<ul>\n<li>颜色 <a\nhref=\"https://matplotlib.org/examples/color/colormaps_reference.html\"\nclass=\"uri\">https://matplotlib.org/examples/color/colormaps_reference.html</a></li>\n<li>legend <a href=\"https://matplotlib.org/users/legend_guide.html\"\nclass=\"uri\">https://matplotlib.org/users/legend_guide.html</a> <br>\n<img src='/main/named_colors.png' /></li>\n</ul>\n<h3 id=\"天文相关包\">天文相关包</h3>\n<h4 id=\"astropy\">Astropy</h4>\n<p><img src='/main/astropy_banner.svg' /></p>\n<p>官方文档 <a href=\"http://docs.astropy.org/en/stable/index.html\"\nclass=\"uri\">http://docs.astropy.org/en/stable/index.html</a></p>\n<p>坐标系统 <a\nhref=\"http://docs.astropy.org/en/stable/coordinates/index.html\"\nclass=\"uri\">http://docs.astropy.org/en/stable/coordinates/index.html</a></p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> astropy <span class=\"token keyword\">import</span> units <span class=\"token keyword\">as</span> u\n<span class=\"token keyword\">from</span> astropy<span class=\"token punctuation\">.</span>coordinates <span class=\"token keyword\">import</span> SkyCoord<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<p>参考 <a\nhref=\"https://python4astronomers.github.io/astropy/astropy.html\"\nclass=\"uri\">https://python4astronomers.github.io/astropy/astropy.html</a></p>\n<h4 id=\"sunpy\">SunPy</h4>\n<p><img src='/main/Screenshot_20180625-005924.png' />\n<img src='/main/sphx_glr_lat_lon_lines_001.png' />\n<img src='/main/sphx_glr_submaps_and_cropping_001.png' /></p>\n<p><br> HMI 示例见 <a href=\"advance.html#SunPy-示例\">Python 进阶#SunPy\n示例</a><br> <a\nhref=\"https://coding.net/u/lydiazly/p/scripts-sunpy/git?public=true\"\nclass=\"uri\">https://coding.net/u/lydiazly/p/scripts-sunpy/git?public=true</a></p>\n<p><br><br> 参考:</p>\n<ul>\n<li>Gallery <a\nhref=\"http://docs.sunpy.org/en/stable/generated/gallery/index.html\"\nclass=\"uri\">http://docs.sunpy.org/en/stable/generated/gallery/index.html</a></li>\n<li>SunPy Guide <a\nhref=\"http://docs.sunpy.org/en/stable/guide/index.html\"\nclass=\"uri\">http://docs.sunpy.org/en/stable/guide/index.html</a></li>\n<li>SunPy Map<br><a\nhref=\"http://docs.sunpy.org/en/stable/code_ref/map.html#sunpy.map.mapbase.GenericMap\"\nclass=\"uri\">http://docs.sunpy.org/en/stable/code_ref/map.html#sunpy.map.mapbase.GenericMap</a></li>\n<li>Example Gallery <a\nhref=\"http://docs.sunpy.org/en/stable/generated/gallery/index.html\"\nclass=\"uri\">http://docs.sunpy.org/en/stable/generated/gallery/index.html</a></li>\n<li>A brief tour of SunPy <a\nhref=\"http://docs.sunpy.org/en/stable/guide/tour.html\"\nclass=\"uri\">http://docs.sunpy.org/en/stable/guide/tour.html</a></li>\n<li>Finding and Downloading Data using Fido<br><a\nhref=\"http://docs.sunpy.org/en/stable/guide/acquiring_data/fido.html\"\nclass=\"uri\">http://docs.sunpy.org/en/stable/guide/acquiring_data/fido.html</a></li>\n</ul>\n<p>简单的例子 (来自官网):</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">%</span>matplotlib inline\n\n<span class=\"token keyword\">import</span> sunpy<span class=\"token punctuation\">.</span><span class=\"token builtin\">map</span>\n<span class=\"token keyword\">import</span> matplotlib<span class=\"token punctuation\">.</span>pyplot <span class=\"token keyword\">as</span> plt\n<span class=\"token keyword\">import</span> sunpy<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>sample\n\naia <span class=\"token operator\">=</span> sunpy<span class=\"token punctuation\">.</span><span class=\"token builtin\">map</span><span class=\"token punctuation\">.</span>Map<span class=\"token punctuation\">(</span>sunpy<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>sample<span class=\"token punctuation\">.</span>AIA_171_IMAGE<span class=\"token punctuation\">)</span>\n\nfig <span class=\"token operator\">=</span> plt<span class=\"token punctuation\">.</span>figure<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> dpi<span class=\"token operator\">=</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span>\nax <span class=\"token operator\">=</span> plt<span class=\"token punctuation\">.</span>subplot<span class=\"token punctuation\">(</span><span class=\"token number\">111</span><span class=\"token punctuation\">,</span> projection<span class=\"token operator\">=</span>aia<span class=\"token punctuation\">)</span>\n\naia<span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\naia<span class=\"token punctuation\">.</span>draw_limb<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\naia<span class=\"token punctuation\">.</span>draw_grid<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\naia<span class=\"token punctuation\">.</span>draw_limb<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>colorbar<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\"># plt.show()</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code>/home/lydia/miniconda3/lib/python3.6/site-packages/sunpy/map/sources/sdo.py:48: SunpyDeprecationWarning: Use Matplotlib to load the colormaps\n  self.plot_settings[&#39;cmap&#39;] = cm.get_cmap(self._get_cmap_name())</code></pre>\n<figure>\n<img src=\"/main/main_126_1.png\" alt=\"png\" />\n<figcaption aria-hidden=\"true\">png</figcaption>\n</figure>\n<p>获取一些常数:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> sunpy<span class=\"token punctuation\">.</span>sun <span class=\"token keyword\">import</span> constants <span class=\"token keyword\">as</span> con\n<span class=\"token comment\"># one astronomical unit (the average distance between the Sun and Earth)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>con<span class=\"token punctuation\">.</span>au<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<pre><code>  Name   = Astronomical Unit\n  Value  = 149597870700.0\n  Uncertainty  = 0.0\n  Unit  = m\n  Reference = IAU 2012 Resolution B2</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># the solar radius</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>con<span class=\"token punctuation\">.</span>radius<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>  Name   = Solar radius\n  Value  = 695508000.0\n  Uncertainty  = 26000.0\n  Unit  = m\n  Reference = Allen&#39;s Astrophysical Quantities 4th Ed.</code></pre>\n<h2 id=\"常见数据文件读写\">常见数据文件读写</h2>\n<h3 id=\"一般情况\">一般情况</h3>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">f <span class=\"token operator\">=</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span>filename<span class=\"token punctuation\">,</span> <span class=\"token string\">'w'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 'w', 'r', ...</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\nf<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<p>更好的用法: <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span>filename<span class=\"token punctuation\">,</span> <span class=\"token string\">'w'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span>  <span class=\"token comment\"># 'w', 'r', ...</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre></p>\n<h3 id=\"txt-csv-文件读写\">txt, csv 文件读写</h3>\n<ul>\n<li>逐行读取整行的方式:<br> 使用 <code>strip</code>\n可以用来去掉读入的每行末尾的 ''</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">lines <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'data/data.csv'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'r'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">for</span> line <span class=\"token keyword\">in</span> f<span class=\"token punctuation\">:</span>\n        lines<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>line<span class=\"token punctuation\">.</span>strip<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token string\">','</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nlines<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code>[[&#39;col1&#39;, &#39;col2&#39;, &#39;col3&#39;],\n [&#39;row1&#39;, &#39;1&#39;, &#39;1e1&#39;],\n [&#39;row2&#39;, &#39;2&#39;, &#39;2e-1&#39;],\n [&#39;row3&#39;, &#39;3&#39;, &#39;3e+2&#39;]]</code></pre>\n<ul>\n<li>使用 numpy, 读取后直接转成数组的方式 (推荐):<br>\n<code>np.loadtxt</code>, <code>np.genfromtxt</code> (写文件是\n<code>np.savetxt</code>)<br> 超大文件读取建议用 pandas 包.</li>\n</ul>\n<p>e.g.</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> arr <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>loadtxt<span class=\"token punctuation\">(</span>fname<span class=\"token punctuation\">,</span> skiprows<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> delimiter<span class=\"token operator\">=</span><span class=\"token string\">','</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># 默认分割符为空格</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> col1<span class=\"token punctuation\">,</span> col2 <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>loadtxt<span class=\"token punctuation\">(</span>fname<span class=\"token punctuation\">,</span> skiprows<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> usecols<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> unpack<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<p><code>np.genfromtxt</code> 和 <code>np.loadtxt</code> 类似,\n增加了处理 missing values 的功能.<br> (但参数 skiprows=1 需替换为\nskip_header=1)</p>\n<p>例 (这里使用功能更多的 <code>np.genfromtxt</code> 代替\n<code>np.loadtxt</code>):</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">arr <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>genfromtxt<span class=\"token punctuation\">(</span><span class=\"token string\">'data/data.csv'</span><span class=\"token punctuation\">,</span>\n                    skip_header<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n                    names<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token string\">'col1'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'col2'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'col3'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                    dtype<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token string\">'U15'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'int'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'float'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                    delimiter<span class=\"token operator\">=</span><span class=\"token string\">','</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>arr<span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token string\">'col1'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'col2'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 设定了 names 之后, 可以用名称索引</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code>[(&#39;row1&#39;, 1) (&#39;row2&#39;, 2) (&#39;row3&#39;, 3)]</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">arr <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>genfromtxt<span class=\"token punctuation\">(</span><span class=\"token string\">'data/data2.csv'</span><span class=\"token punctuation\">,</span>\n                    skip_header<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n                    names<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token string\">'col1'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'col2'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'col3'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                    dtype<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token string\">'U15'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'int'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'float'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                    missing_values<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span>\n                    filling_values<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> np<span class=\"token punctuation\">.</span>nan<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\"># 分开指定</span>\n                    delimiter<span class=\"token operator\">=</span><span class=\"token string\">','</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>arr<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code>[(&#39;row1&#39;, 0, 10. ) (&#39;&#39;, 2,  0.2) (&#39;row3&#39;, 3,  nan)]</code></pre>\n<ul>\n<li>一般而言, 对于一个由分隔符分隔的字符串, 转成一个数组的方式:<br>\n<code>np.fromstring(string, dtype=float, count=-1, sep='')</code></li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">np<span class=\"token punctuation\">.</span>fromstring<span class=\"token punctuation\">(</span><span class=\"token string\">'0 1 2'</span><span class=\"token punctuation\">,</span> dtype<span class=\"token operator\">=</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">,</span> sep<span class=\"token operator\">=</span><span class=\"token string\">' '</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>array([0, 1, 2])</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">np<span class=\"token punctuation\">.</span>fromstring<span class=\"token punctuation\">(</span><span class=\"token string\">'0., 1., 2.'</span><span class=\"token punctuation\">,</span> sep<span class=\"token operator\">=</span><span class=\"token string\">','</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>array([0., 1., 2.])</code></pre>\n<h3 id=\"numpy-save-文件读写\">numpy save 文件读写</h3>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">np<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span><span class=\"token string\">'fname'</span><span class=\"token punctuation\">,</span> arr<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 'fname.npy'</span>\nnp<span class=\"token punctuation\">.</span>savez<span class=\"token punctuation\">(</span><span class=\"token string\">'fname'</span><span class=\"token punctuation\">,</span> arr<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 'fname.npz', 多个变量</span>\nnp<span class=\"token punctuation\">.</span>savez_compressed<span class=\"token punctuation\">(</span><span class=\"token string\">'fname'</span><span class=\"token punctuation\">,</span> arr<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 'fname.npz', 多个变量 &amp; 压缩</span>\nnp<span class=\"token punctuation\">.</span>load<span class=\"token punctuation\">(</span><span class=\"token string\">'fname.npz'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># Load the files created by savez_compressed.</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># 存入</span>\narr <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>ones<span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 默认 `float64`</span>\nnp<span class=\"token punctuation\">.</span>savez<span class=\"token punctuation\">(</span><span class=\"token string\">'data/np_array'</span><span class=\"token punctuation\">,</span> a<span class=\"token operator\">=</span>arr<span class=\"token punctuation\">,</span> b<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">ls data<span class=\"token operator\">/</span><span class=\"token operator\">*</span><span class=\"token punctuation\">.</span>npz<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>data/np_array.npz</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># 载入</span>\ndata <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>load<span class=\"token punctuation\">(</span><span class=\"token string\">'data/np_array.npz'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">[</span><span class=\"token string\">'a'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">[</span><span class=\"token string\">'b'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">[</span><span class=\"token string\">'b'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 默认以`ndarray`读取</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<pre><code>(array([1., 1., 1., 1., 1.]), array(0), 0)</code></pre>\n<h3 id=\"idl-sav-文件读取\">IDL sav 文件读取</h3>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> scipy<span class=\"token punctuation\">.</span>io<span class=\"token punctuation\">.</span>idl <span class=\"token keyword\">import</span> readsav\ndata <span class=\"token operator\">=</span> readsav<span class=\"token punctuation\">(</span><span class=\"token string\">'dname.sav'</span><span class=\"token punctuation\">,</span> verbose<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> python_dict<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<p>默认读出的是<code>scipy.io.idl.AttrDict</code>类型, 即 key\n的大小写不敏感.<br> 想要得到大小写敏感的 python dict, 设置\n<code>python_dict=True</code> 即可. <br><br> 例:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> scipy<span class=\"token punctuation\">.</span>io<span class=\"token punctuation\">.</span>idl <span class=\"token keyword\">import</span> readsav\ndata <span class=\"token operator\">=</span> readsav<span class=\"token punctuation\">(</span><span class=\"token string\">'data/myidlfile.sav'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">type</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">.</span>keys<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 注意返回的是一个`dict_keys`对象, 如需索引需要手动转为list</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">[</span><span class=\"token string\">'X'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 大小写不敏感</span>\ndata <span class=\"token operator\">=</span> readsav<span class=\"token punctuation\">(</span><span class=\"token string\">'data/myidlfile.sav'</span><span class=\"token punctuation\">,</span> python_dict<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">type</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">[</span><span class=\"token string\">'x'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 大小写敏感</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code>&lt;class &#39;scipy.io.idl.AttrDict&#39;&gt;\ndict_keys([&#39;x&#39;, &#39;y&#39;, &#39;str&#39;])\n(25,)\n&lt;class &#39;dict&#39;&gt;\n(25,)</code></pre>\n<h3 id=\"fits-文件读取\">FITS 文件读取</h3>\n<ul>\n<li>Astropy</li>\n</ul>\n<p>参考:<br> <a href=\"http://docs.astropy.org/en/stable/io/fits\"\nclass=\"uri\">http://docs.astropy.org/en/stable/io/fits</a><br> <a\nhref=\"https://python4astronomers.github.io/astropy/fits.html\"\nclass=\"uri\">https://python4astronomers.github.io/astropy/fits.html</a></p>\n<blockquote>\n<p>[Note]<br> If you are already familiar with PyFITS, astropy.io.fits\nis in fact the same code as the latest version of PyFITS, and you can\nadapt old scripts that use PyFITS to use Astropy by simply doing:\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> astropy<span class=\"token punctuation\">.</span>io <span class=\"token keyword\">import</span> fits <span class=\"token keyword\">as</span> pyfits<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre> However, for new scripts, we recommend the following\nimport: <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> astropy<span class=\"token punctuation\">.</span>io <span class=\"token keyword\">import</span> fits<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n</blockquote>\n<p><code>fits.open</code> <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token keyword\">from</span> astropy<span class=\"token punctuation\">.</span>io <span class=\"token keyword\">import</span> fits\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> hdulist <span class=\"token operator\">=</span> fits<span class=\"token punctuation\">.</span><span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;filename>.fit'</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> hdulist<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># hdulist 是一个由 HDU objects 组成的类似列表的对象</span>\nFilename<span class=\"token punctuation\">:</span> <span class=\"token operator\">&lt;</span>filename<span class=\"token operator\">></span><span class=\"token punctuation\">.</span>fit\nNo<span class=\"token punctuation\">.</span>    Name         Type      Cards   Dimensions   Format\n<span class=\"token number\">0</span>    PRIMARY     PrimaryHDU    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>       <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>        <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token number\">1</span>    ENERGIES    BinTableHDU   <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>       <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>        <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> hdu <span class=\"token operator\">=</span> hdulist<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> hdu<span class=\"token punctuation\">.</span>data  <span class=\"token comment\"># ndarray</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> hdu<span class=\"token punctuation\">.</span>header<span class=\"token punctuation\">[</span><span class=\"token string\">'&lt;key>'</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># 得到某个 header keyword</span>\n<span class=\"token comment\"># 修改数据后</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> hdu<span class=\"token punctuation\">.</span>writeto<span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;filename>.fits'</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># 保存 HDU object</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> hdulist<span class=\"token punctuation\">.</span>writeto<span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;filename>.fits'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 或保存整个表</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre> <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># 创建一个 fits Primary HDU object</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> hdu <span class=\"token operator\">=</span> fits<span class=\"token punctuation\">.</span>PrimaryHDU<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> hdu<span class=\"token punctuation\">.</span>writeto<span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;filename>.fits'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 保存 HDU object</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> hdu<span class=\"token punctuation\">.</span>writeto<span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;filename>.fits'</span><span class=\"token punctuation\">,</span> clobber<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 保存到已存在文件</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<code>fits.getdata</code>, <code>fits.getheader</code> <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> data <span class=\"token operator\">=</span> fits<span class=\"token punctuation\">.</span>getdata<span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;filename>.fit'</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> header <span class=\"token operator\">=</span> fits<span class=\"token punctuation\">.</span>getheader<span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;filename>.fit'</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<br> * SunPy</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token keyword\">import</span> sunpy<span class=\"token punctuation\">.</span>io\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> hdulist <span class=\"token operator\">=</span> sunpy<span class=\"token punctuation\">.</span>io<span class=\"token punctuation\">.</span>read_file<span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;filename>.fits'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 自动判断文件类型</span>\n<span class=\"token comment\"># or use `hdulist = sunpy.io.fits.read('&lt;filename>.fits')`</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> hdu <span class=\"token operator\">=</span> hdulist<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> hdu<span class=\"token punctuation\">.</span>data  <span class=\"token comment\"># ndarray</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token keyword\">import</span> sunpy<span class=\"token punctuation\">.</span><span class=\"token builtin\">map</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> smap <span class=\"token operator\">=</span> sunpy<span class=\"token punctuation\">.</span><span class=\"token builtin\">map</span><span class=\"token punctuation\">.</span>Map<span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;filename>.fits'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 得到一个 sunpy `GenericMap` object</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<p>例:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> astropy<span class=\"token punctuation\">.</span>io <span class=\"token keyword\">import</span> fits\nfname <span class=\"token operator\">=</span> <span class=\"token string\">'scripts-sunpy/plothmi/data/hmi.B_720s.20150827_052400_TAI.field.fits'</span>\nhdulist <span class=\"token operator\">=</span> fits<span class=\"token punctuation\">.</span><span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span>fname<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">hdulist<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>Filename: scripts-sunpy/plothmi/data/hmi.B_720s.20150827_052400_TAI.field.fits\nNo.    Name      Ver    Type      Cards   Dimensions   Format\n  0  PRIMARY       1 PrimaryHDU       6   ()      \n  1                1 CompImageHDU    155   (4096, 4096)   int32   </code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">hdulist<span class=\"token punctuation\">.</span>verify<span class=\"token punctuation\">(</span><span class=\"token string\">'silentfix+warn'</span><span class=\"token punctuation\">)</span>\nhdu <span class=\"token operator\">=</span> hdulist<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>\nhdu<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>shape<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<pre><code>(4096, 4096)</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> sunpy<span class=\"token punctuation\">.</span>io\nhdulist <span class=\"token operator\">=</span> sunpy<span class=\"token punctuation\">.</span>io<span class=\"token punctuation\">.</span>read_file<span class=\"token punctuation\">(</span>fname<span class=\"token punctuation\">)</span>\nhdu <span class=\"token operator\">=</span> hdulist<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>\nhdu<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>shape<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code>(4096, 4096)</code></pre>\n<h2 id=\"其他包和软件\">其他包和软件</h2>\n<ul>\n<li>Astroconda <a href=\"https://astroconda.readthedocs.io/en/latest/\"\nclass=\"uri\">https://astroconda.readthedocs.io/en/latest/</a> &gt;\nAstroConda is a free Conda channel maintained by the Space Telescope\nScience Institute (STScI) in Baltimore, Maryland. This channel provides\ntools and utilities required to process and analyze data from the Hubble\nSpace Telescope (HST), James Webb Space Telescope (JWST), and others.\n<br><br></li>\n<li>Canopy <a href=\"https://www.enthought.com/product/canopy/\"\nclass=\"uri\">https://www.enthought.com/product/canopy/</a> &gt; Enthought\nCanopy provides a proven scientific and analytic Python package\ndistribution plus key integrated tools for iterative data analysis, data\nvisualization, and application development. Users have the ability to\nextend and innovate with scripting and open platform APIs, driving the\ncreation and sharing of innovative workflows, tools, and applications.\n<img src='/main/Canopy-Packages-min-1.png' > <br><br></li>\n<li>PyCharm <a href=\"https://www.jetbrains.com/pycharm/\"\nclass=\"uri\">https://www.jetbrains.com/pycharm/</a>\n<img src='/main/pycharm.jpg' > <br><br></li>\n<li>Jupyterlab <a href=\"http://jupyterlab.readthedocs.io/en/stable/\"\nclass=\"uri\">http://jupyterlab.readthedocs.io/en/stable/</a>\n<img src='/main/jupyterlab.png' ></li>\n</ul>\n","site":{"data":{}},"excerpt":"<p><a\nhref=\"/downloads/notebooks/python-intro.zip\"><i class=\"fas fa-download\"></i>\nJupyter Notebook</a></p>\n<h2 id=\"简介\">简介</h2>\n<p>优势: 开源, 用户广, 用途广, 社区完善, 新手友好</p>\n<p><a\nhref=\"https://www.jetbrains.com/research/python-developers-survey-2017/\"\nclass=\"uri\">https://www.jetbrains.com/research/python-developers-survey-2017/</a>\n<br><br> 2017年的 python 使用调查报告 <a\nhref=\"https://www.jetbrains.com/research/python-developers-survey-2017/\"\nclass=\"uri\">https://www.jetbrains.com/research/python-developers-survey-2017/</a>\n<img src='/main/Python Developers Survey 2017 - Results-018.png' >\n<img src='/main/Python Developers Survey 2017 - Results-019.png' >\n<img src='/main/Python Developers Survey 2017 - Results-020.png' ></p>\n<p>参考网站:</p>\n<ul>\n<li>官方网站: <a href=\"https://www.python.org/\"\nclass=\"uri\">https://www.python.org/</a></li>\n<li>stackoverflow <a\nhref=\"https://stackoverflow.com/questions/tagged/python\"\nclass=\"uri\">https://stackoverflow.com/questions/tagged/python</a></li>\n<li>官方文档 <a href=\"https://docs.python.org\"\nclass=\"uri\">https://docs.python.org</a></li>\n<li>廖雪峰的网站 (包含 python2.7 和 python3 的教程) <a\nhref=\"https://www.liaoxuefeng.com\"\nclass=\"uri\">https://www.liaoxuefeng.com</a></li>\n<li>wikibooks <a href=\"https://en.wikibooks.org/wiki/Python_Programming\"\nclass=\"uri\">https://en.wikibooks.org/wiki/Python_Programming</a></li>\n<li>演示代码执行过程的工具 <a href=\"http://pythontutor.com/\"\nclass=\"uri\">http://pythontutor.com/</a></li>\n<li>天文相关教程 (较新) <a href=\"https://python4astronomers.github.io\"\nclass=\"uri\">https://python4astronomers.github.io</a></li>\n</ul>\n<p><br> 获取 python 包/模块/函数的帮助:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># python</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token builtin\">help</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-sh\" data-language=\"sh\"><code class=\"language-sh\"># shell\n$ pydoc &lt;name&gt;\n$ pydoc -w &lt;name&gt;  # 生成一个 html 帮助文件<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># ipython/jupyter</span>\nname?  <span class=\"token comment\"># 弹出帮助文档, `Esc` 退出文档</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>","more":"<h2 id=\"基本语法\">基本语法</h2>\n<h3 id=\"语法特点\">语法特点</h3>\n<ul>\n<li>对象编程的概念<br> 类 -&gt; 创建一个实例 -&gt;\n使用该实例所属的类下面的方法 <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">l <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># l 是 list 的一个实例</span>\nl<span class=\"token punctuation\">.</span>reverse<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># reverse 是一个方法(函数), reverse() 是一个实例</span>\nl<span class=\"token punctuation\">.</span>__dir__<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 查看 l 的所有方法(函数)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre> <br></li>\n<li>严格缩进 (通常采用4个半角空格) <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">if</span> a <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span>\n      a <span class=\"token operator\">+=</span> <span class=\"token number\">1</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre> <br></li>\n<li>空格不敏感 <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">+</span> b <span class=\"token operator\">*</span> c <span class=\"token operator\">**</span> <span class=\"token number\">2</span> <span class=\"token operator\">/</span> d\nf <span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre> <br></li>\n<li>大小写敏感, 使用大小写组合的变量名风格\n(下划线仍是合法变量名字符,但有特殊含义, 见 <a\nhref=\"advance.html#脚本相关\">Python 进阶#脚本相关</a>) <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> scipy<span class=\"token punctuation\">.</span>interpolate <span class=\"token keyword\">import</span> BSpline<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd\ndataFrame <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>DataFrame<span class=\"token punctuation\">(</span>array<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre> 见 <a href=\"#IDL-sav-文件读取\">IDL sav 文件读取</a>\n<br><br></li>\n<li>括号内换行不用换行符 <br><br></li>\n<li>单行注释 <code># ...</code> <br><br></li>\n<li>多行注释<br> 函数或模块的开头的多行注释\n(将存储在<code>__doc__</code>变量), 可以用 <code>help()</code> 打印\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token triple-quoted-string string\">\"\"\"\n这是一个\n多行注释\n\"\"\"</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre> <br></li>\n<li>同一行不同语句之间可用分号分隔 <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">x <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre> <br></li>\n<li>列表和数组的索引默认从<font color=red>0</font>开始 <br><br></li>\n<li>列表的最后一个元素可以加逗号 <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">&#123;</span><span class=\"token string\">'a'</span> <span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'b'</span> <span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre> <br></li>\n<li><em>etc.</em></li>\n</ul>\n<h3 id=\"print函数\">print函数</h3>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> <span class=\"token number\">1.</span><span class=\"token punctuation\">;</span> b <span class=\"token operator\">=</span> <span class=\"token number\">2.</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'a=%.3f, b=%.1e'</span> <span class=\"token operator\">%</span> <span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>a=1.000, b=2.0e+00</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f'a=</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>a<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">, b=</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>b<span class=\"token punctuation\">:</span><span class=\"token format-spec\">.3f</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">'</span></span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>a=1.0, b=2.000</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">%</span><span class=\"token operator\">%</span>python2\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'xxx'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'yyy'</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<pre><code>xxx yyy</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">%</span><span class=\"token operator\">%</span>python3\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'xxx'</span><span class=\"token punctuation\">,</span> end<span class=\"token operator\">=</span><span class=\"token string\">' '</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'yyy'</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<pre><code>xxx yyy</code></pre>\n<p>更多格式化参考 <a href=\"https://pyformat.info/\"\nclass=\"uri\">https://pyformat.info/</a></p>\n<h3 id=\"基本运算\">基本运算</h3>\n<p>运算符参考:<br> <a\nhref=\"https://en.wikibooks.org/wiki/Python_Programming/Basic_Math\"\nclass=\"uri\">https://en.wikibooks.org/wiki/Python_Programming/Basic_Math</a><br>\n<a\nhref=\"https://www.tutorialspoint.com/python/python_basic_operators.htm\"\nclass=\"uri\">https://www.tutorialspoint.com/python/python_basic_operators.htm</a></p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\na <span class=\"token operator\">+=</span> <span class=\"token number\">1</span>  <span class=\"token comment\"># 没有 a++ 这种语法</span>\na<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<pre><code>2</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token number\">3.</span> <span class=\"token operator\">**</span> <span class=\"token number\">2</span>  <span class=\"token comment\"># 自动转换数据类型</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>9.0</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token number\">1</span> <span class=\"token operator\">&lt;</span> <span class=\"token number\">2</span> <span class=\"token operator\">!=</span> <span class=\"token number\">3</span>  <span class=\"token comment\"># 判断, 可以连写</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>True</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> <span class=\"token boolean\">None</span>\na <span class=\"token keyword\">is</span> <span class=\"token boolean\">None</span>  <span class=\"token comment\"># 注意这时不用 `==`</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>True</code></pre>\n<h3 id=\"字符串\">字符串</h3>\n<p>用双引号和单引号皆可 (取决于所引内容).<br> 字符串具有和列表 (list)\n类似的运算规则 (见之后的 list 说明):</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token string\">'a'</span> <span class=\"token operator\">*</span> <span class=\"token number\">10</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>&#39;aaaaaaaaaa&#39;</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token string\">'a'</span> <span class=\"token operator\">+</span> <span class=\"token string\">'b'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>&#39;ab&#39;</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token string\">'abc'</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>&#39;a&#39;</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\n'</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">r'\\n'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># same as '\\\\n'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>\\n</code></pre>\n<h3 id=\"list-tuple-dict-set\">list, tuple, dict, set</h3>\n<ul>\n<li>有序表 list, tuple</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">l <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># list, 元素可变</span>\nt <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># tuple, 元素不可变</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">l<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">:</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># 一个切片(slice)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>[0, 1, 2]</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">t<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">:</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>(0, 1, 2)</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">l<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">:</span><span class=\"token number\">5</span><span class=\"token punctuation\">:</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># 索引: [start, stop, step] (结果不包含 stop)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>[1, 3]</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">l<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">:</span><span class=\"token number\">1</span><span class=\"token punctuation\">:</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># step &lt; 0, 仍然不包含 stop (此例中 stop=1)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>[5, 4, 3, 2]</code></pre>\n<p>list 常用运算</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">l <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span>\nl<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token string\">'x'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 添加在最后</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">)</span>\nl<span class=\"token punctuation\">.</span>insert<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'y'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 添加在 l[i] 之前</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">.</span>pop<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 删除某元素并返回该值</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code>[0, 1, 2, 3, 4, 5, &#39;x&#39;]\n[0, 1, 2, &#39;y&#39;, 3, 4, 5, &#39;x&#39;]\n1\n[0, 2, &#39;y&#39;, 3, 4, 5, &#39;x&#39;]</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>l <span class=\"token operator\">*</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 重复N遍</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>l <span class=\"token operator\">+</span> <span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 合并两个list</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>[1, &#39;y&#39;, 2, 3, 4, 5, &#39;x&#39;, 1, &#39;y&#39;, 2, 3, 4, 5, &#39;x&#39;]\n[1, &#39;y&#39;, 2, 3, 4, 5, &#39;x&#39;, 6, 7]</code></pre>\n<p>list 可以排序 (当元素为同一类型且可比较大小时), 返回到原列表</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">l <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'b'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'a'</span><span class=\"token punctuation\">]</span>\nl<span class=\"token punctuation\">.</span>sort<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nl<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<pre><code>[&#39;a&#39;, &#39;b&#39;]</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">l <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span>\nl<span class=\"token punctuation\">.</span>sort<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nl<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<pre><code>[1, 2]</code></pre>\n<ul>\n<li>字典 dict</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">d <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token string\">'a'</span> <span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'b'</span> <span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">d <span class=\"token operator\">=</span> <span class=\"token builtin\">dict</span><span class=\"token punctuation\">(</span>a<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> b<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># 注意这时没有引号</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">d<span class=\"token punctuation\">[</span><span class=\"token string\">'a'</span><span class=\"token punctuation\">]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>1</code></pre>\n<ul>\n<li>集合 set</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">s <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">&#125;</span>  <span class=\"token comment\"># set, 将自动排序并去除重复, 常用于 for 循环</span>\ns  <span class=\"token comment\"># 不能用 s[i] 来索引</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>&#123;1, 2, 3&#125;</code></pre>\n<p>set 不可索引, 但可用作 for 循环. 见 <a\nhref=\"advance.html#循环,-迭代器,-生成器\">Python 进阶#迭代器</a></p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> s<span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>1\n2\n3</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">l2 <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>i <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> s<span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>l2<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>[1, 2, 3]</code></pre>\n<h3 id=\"if-语句\">if 语句</h3>\n<p>python 里没有 <code>case</code>, 只有 <code>if</code>\n(非零数值、非空字符串、非空 list 等皆为 True) <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">if</span> <span class=\"token operator\">&lt;</span>条件判断<span class=\"token number\">1</span><span class=\"token operator\">></span><span class=\"token punctuation\">:</span>\n    <span class=\"token operator\">&lt;</span>执行<span class=\"token number\">1</span><span class=\"token operator\">></span>\n<span class=\"token keyword\">elif</span> <span class=\"token operator\">&lt;</span>条件判断<span class=\"token number\">2</span><span class=\"token operator\">></span><span class=\"token punctuation\">:</span>\n    <span class=\"token operator\">&lt;</span>执行<span class=\"token number\">2</span><span class=\"token operator\">></span>\n<span class=\"token keyword\">elif</span> <span class=\"token operator\">&lt;</span>条件判断<span class=\"token number\">3</span><span class=\"token operator\">></span><span class=\"token punctuation\">:</span>\n    <span class=\"token operator\">&lt;</span>执行<span class=\"token number\">3</span><span class=\"token operator\">></span>\n<span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n    <span class=\"token operator\">&lt;</span>执行<span class=\"token number\">4</span><span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<h3 id=\"相关工具\">相关工具</h3>\n<h4 id=\"pip\">pip</h4>\n<p><img src='/main/logo-large.72ad8bf1.svg' /></p>\n<blockquote>\n<p>The <strong>Python Package Index (PyPI)</strong> is a repository of\nsoftware for the Python programming language.<br/> PyPI helps you find\nand install software developed and shared by the Python community.<br/>\n<a href=\"https://pypi.org/\" class=\"uri\">https://pypi.org/</a></p>\n</blockquote>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">$ pip install &lt;pkg_name&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>    (其他命令见 <a href=\"installpy.html#用-pip-安装-python-包\">Python\n安装和配置#用 pip 安装 python 包</a>)</p>\n<h4 id=\"anaconda\">Anaconda</h4>\n<p><img src='/main/DataScienceLibraries-01.png' />\n<img src='/main/Conda-DistributionDiagram-01.png' /></p>\n<p><img src='/main/Conda — Conda documentation.png' /></p>\n<p><strong>Anaconda</strong> (https://www.anaconda.com/)<br> 安装好的\nconda 包含独立于系统的 python 版本, 一部分已编译好的包, pip 工具,\n以及不同环境的子目录.<br/> 可根据需要切换不同的 conda 环境以使用不同的\npython 版本或不同的包的组合.</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">$ conda install &lt;pkg_name&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>其他命令见 <a href=\"installpy.html#使用-conda-命令\">Python\n安装和配置#使用 conda 命令</a><br> 详细说明见 <a\nhref=\"advance.html#Anaconda\">Python 进阶#Anaconda</a></p>\n<h4 id=\"ipython-jupyter\">IPython &amp; Jupyter</h4>\n<p><img style='float: center;' src='/main/IPython.png' /></p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># Have a look (ipython)</span>\n!cd <span class=\"token operator\">&amp;</span><span class=\"token operator\">&amp;</span> gnome<span class=\"token operator\">-</span>terminal <span class=\"token operator\">-</span><span class=\"token operator\">-</span>window<span class=\"token operator\">-</span><span class=\"token keyword\">with</span><span class=\"token operator\">-</span>profile<span class=\"token operator\">=</span><span class=\"token string\">'lydia_white'</span>\n!sleep <span class=\"token number\">0.5</span> <span class=\"token operator\">&amp;</span><span class=\"token operator\">&amp;</span> xdotool <span class=\"token builtin\">type</span> <span class=\"token operator\">-</span><span class=\"token operator\">-</span>delay <span class=\"token number\">200</span> <span class=\"token string\">\"ipython\"</span> <span class=\"token operator\">&amp;</span><span class=\"token operator\">&amp;</span> xdotool key Return\n!sleep <span class=\"token number\">3</span> <span class=\"token operator\">&amp;</span><span class=\"token operator\">&amp;</span> xdotool <span class=\"token builtin\">type</span> <span class=\"token operator\">-</span><span class=\"token operator\">-</span>delay <span class=\"token number\">200</span> <span class=\"token string\">\"!idl\"</span> <span class=\"token operator\">&amp;</span><span class=\"token operator\">&amp;</span> xdotool key Return\n!sleep <span class=\"token number\">3</span> <span class=\"token operator\">&amp;</span><span class=\"token operator\">&amp;</span> xdotool key Ctrl<span class=\"token operator\">+</span>d\n!sleep <span class=\"token number\">1</span> <span class=\"token operator\">&amp;</span><span class=\"token operator\">&amp;</span> xdotool <span class=\"token builtin\">type</span> <span class=\"token operator\">-</span><span class=\"token operator\">-</span>delay <span class=\"token number\">200</span> <span class=\"token string\">\"!csh -c sswidl\"</span> <span class=\"token operator\">&amp;</span><span class=\"token operator\">&amp;</span> xdotool key Return<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<center>\n<a href=\"http://jupyter.org/\" class=\"uri\">http://jupyter.org/</a>\n</center>\n<p><img style='float: center;' src='/main/jupyterlogo.png' /></p>\n<center>\n<a href=\"https://nbviewer.jupyter.org/\"\nclass=\"uri\">https://nbviewer.jupyter.org/</a>\n</center>\n<p><img style='float: center;' src='/main/nbviewer.png' /></p>\n<p>参考文档 <a href=\"http://jupyter-notebook.readthedocs.io/en/stable/\"\nclass=\"uri\">http://jupyter-notebook.readthedocs.io/en/stable/</a></p>\n<ul>\n<li>打开 <code>jupyter notebook</code>:</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">$ jupyter notebook [filename]<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<h2 id=\"常用包介绍\">常用包介绍</h2>\n<h3 id=\"python-自带包和模块\">Python 自带包和模块</h3>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> math <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span> <span class=\"token comment\"># 包含 pi 等, 但更推荐 numpy</span>\n<span class=\"token keyword\">from</span> copy <span class=\"token keyword\">import</span> deepcopy\n<span class=\"token keyword\">from</span> pprint <span class=\"token keyword\">import</span> pprint  <span class=\"token comment\"># 打印 list, dict 等更好看</span>\n<span class=\"token keyword\">import</span> requests\n<span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">import</span> sys<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h3 id=\"numpy-scipy\">NumPy, SciPy</h3>\n<h4 id=\"概览\">概览</h4>\n<center>\n<a href=\"https://www.scipy.org\" class=\"uri\">https://www.scipy.org</a>\n</center>\n<p><img src='/main/SciPy.png' /></p>\n<center>\n<a href=\"http://scikit-image.org\"\nclass=\"uri\">http://scikit-image.org</a>\n</center>\n<p><img src='/main/scikitlogo.png' />\n<img src='/main/skimage01.png' /></p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>导入包的不同方式将在各例子中看到.</p>\n<p>参考:</p>\n<ul>\n<li>NumPy User Guide <a href=\"https://docs.scipy.org/doc/numpy/user/\"\nclass=\"uri\">https://docs.scipy.org/doc/numpy/user/</a></li>\n<li>NumPy Reference <a\nhref=\"https://docs.scipy.org/doc/numpy/reference/\"\nclass=\"uri\">https://docs.scipy.org/doc/numpy/reference/</a></li>\n<li>ndarray<br><a\nhref=\"https://docs.scipy.org/doc/numpy/reference/arrays.ndarray.html\"\nclass=\"uri\">https://docs.scipy.org/doc/numpy/reference/arrays.ndarray.html</a></li>\n<li>Array manipulation routines<br><a\nhref=\"https://docs.scipy.org/doc/numpy/reference/routines.array-manipulation.html\"\nclass=\"uri\">https://docs.scipy.org/doc/numpy/reference/routines.array-manipulation.html</a></li>\n<li>SciPy Cookbook <a href=\"http://scipy-cookbook.readthedocs.io/\"\nclass=\"uri\">http://scipy-cookbook.readthedocs.io/</a></li>\n<li>与 IDL 的语法对照\n<ul>\n<li><a href=\"http://mathesaurus.sourceforge.net/idl-numpy.html\"\nclass=\"uri\">http://mathesaurus.sourceforge.net/idl-numpy.html</a></li>\n<li><a\nhref=\"http://blog.rtwilson.com/ten-little-idl-programs-in-python/\"\nclass=\"uri\">http://blog.rtwilson.com/ten-little-idl-programs-in-python/</a></li>\n<li><a href=\"http://www.astrobetter.com/blog/2009/05/04/idl-vs-python/\"\nclass=\"uri\">http://www.astrobetter.com/blog/2009/05/04/idl-vs-python/</a></li>\n</ul></li>\n</ul>\n<h4 id=\"生成-numpy.ndarray-数组\">生成 numpy.ndarray 数组</h4>\n<p>将 list 或 tuple 转换为 <code>numpy.ndarray</code> <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np\na <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 切片(slice), 索引可以是 int 或 list (python list 只支持 list作为索引)</span>\na<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>          <span class=\"token comment\"># 0</span>\na<span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>         <span class=\"token comment\"># 4</span>\na<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">:</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span>        <span class=\"token comment\"># array([0, 1, 2]) 注意!</span>\na<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span>         <span class=\"token comment\"># array([0, 1, 2])</span>\na<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">:</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span>        <span class=\"token comment\"># array([2, 3])</span>\na<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">:</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>       <span class=\"token comment\"># array([2, 3]) 注意!</span>\na<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span>         <span class=\"token comment\"># array([2, 3, 4])</span>\na<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">:</span><span class=\"token number\">4</span><span class=\"token punctuation\">:</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span>      <span class=\"token comment\"># array([0, 2])</span>\na<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">:</span><span class=\"token number\">2</span><span class=\"token punctuation\">:</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>     <span class=\"token comment\"># array([4, 3])</span>\na<span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># array([1, 4, 3]) 花式切片, 索引是一个 list (不能是tuple)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>\n<p>多维:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> a<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>array([[0, 1, 2],\n       [3, 4, 5]])</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> a\n<span class=\"token comment\"># 这里的tuple已转成ndarray, 于是结果是可变的</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>array([[0, 1, 2],\n       [3, 4, 5]])</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>1</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>1</code></pre>\n<p>从一维数组转变为多维:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>arange<span class=\"token punctuation\">(</span><span class=\"token number\">12</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> a\n<span class=\"token comment\"># reshape 的参数为 &lt; 0 表示该维度自动判断元素个数</span>\n<span class=\"token comment\"># reshape 的参数是一个 list 或 tuple, 括号可以展开 (详见帮助文档)</span>\n<span class=\"token comment\"># 此例中 reshape((3, 2)), reshape(3, 2), reshape((3, -1)), reshape(3, -1) 等价</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code>array([[ 0,  1,  2,  3],\n       [ 4,  5,  6,  7],\n       [ 8,  9, 10, 11]])</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">b <span class=\"token operator\">=</span> a<span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> b  <span class=\"token comment\"># reshape 的参数只有一个维度且 &lt; 0(自动)  => 展开成一维</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11])</code></pre>\n<p>花式切片的多维例子:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>arange<span class=\"token punctuation\">(</span><span class=\"token number\">12</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\na<span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span>\n<span class=\"token comment\"># a[col_inds, row_inds], 此例等价于 a[[[0, 1], [0, 2]]], a[([0, 1], [0, 2])]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<pre><code>array([0, 6])</code></pre>\n<ul>\n<li><strong>np.zeros</strong>(shape,\ndtype=float), <strong>np.ones</strong>(shape, dtype=float)</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">np<span class=\"token punctuation\">.</span>zeros<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 默认浮点型</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>array([[0., 0., 0.],\n       [0., 0., 0.]])</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">np<span class=\"token punctuation\">.</span>ones<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 默认浮点型</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>array([[1., 1., 1.],\n       [1., 1., 1.]])</code></pre>\n<ul>\n<li><strong>np.arange</strong>([start,] stop[, step,], dtype=None)</li>\n</ul>\n<p>生成的数组元素数据类型和参数一致.<br><br> 方便记忆: 最简形式\n<code>np.arange</code>(<em>N</em>) 中的整数 <em>N</em> 即为\n<em>元素个数</em>.</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">np<span class=\"token punctuation\">.</span>arange<span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>array([[0, 1],\n       [2, 3],\n       [4, 5]])</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">np<span class=\"token punctuation\">.</span>arange<span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>array([[0, 1],\n       [2, 3],\n       [4, 5]])</code></pre>\n<ul>\n<li><strong>np.linspace</strong>(start, stop, num=50,\n<strong>endpoint=True</strong>, retstep=False, dtype=None)<br>\n默认生成的元素是浮点型<br> 注意 <code>np.linspace</code> 和\n<code>np.arange</code> 的不同规则</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">np<span class=\"token punctuation\">.</span>linspace<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>array([0., 1.])</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">np<span class=\"token punctuation\">.</span>linspace<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> endpoint<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span> <span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>array([0. , 0.5])</code></pre>\n<p>更多数组创建方法见 numpy 官网:<br> <a\nhref=\"https://docs.scipy.org/doc/numpy/reference/routines.array-creation.html\"\nclass=\"uri\">https://docs.scipy.org/doc/numpy/reference/routines.array-creation.html</a><br>\n<a\nhref=\"https://docs.scipy.org/doc/numpy/user/basics.creation.html#arrays-creation\"\nclass=\"uri\">https://docs.scipy.org/doc/numpy/user/basics.creation.html#arrays-creation</a></p>\n<ul>\n<li>转置</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>arange<span class=\"token punctuation\">(</span><span class=\"token number\">12</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> a<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>array([[ 0,  1,  2,  3],\n       [ 4,  5,  6,  7],\n       [ 8,  9, 10, 11]])</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">a<span class=\"token punctuation\">.</span>T<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>array([[ 0,  4,  8],\n       [ 1,  5,  9],\n       [ 2,  6, 10],\n       [ 3,  7, 11]])</code></pre>\n<p>更多数组操作见 numpy 官网 <a\nhref=\"https://docs.scipy.org/doc/numpy/reference/routines.array-manipulation.html\"\nclass=\"uri\">https://docs.scipy.org/doc/numpy/reference/routines.array-manipulation.html</a>\n矩阵操作见 <a href=\"advance.html#矩阵\">Python 进阶#矩阵</a></p>\n<h3 id=\"matplotlib\">Matplotlib</h3>\n<ul>\n<li><p>官方示例 <a href=\"https://matplotlib.org/tutorials/index.html\"\nclass=\"uri\">https://matplotlib.org/tutorials/index.html</a>\n<img src='/main/Matplotlib.png' />\n<img src='/main/annotation_demo2_00.png' />\n<img src='/main/contour_demo_05.png' /></p></li>\n<li><p>官方教程 <a\nhref=\"https://matplotlib.org/tutorials/introductory/usage.html\"\nclass=\"uri\">https://matplotlib.org/tutorials/introductory/usage.html</a></p></li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> matplotlib<span class=\"token punctuation\">.</span>pyplot <span class=\"token keyword\">as</span> plt<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>创建一个图像 (三种写法皆可):</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">fig<span class=\"token punctuation\">,</span> ax <span class=\"token operator\">=</span> plt<span class=\"token punctuation\">.</span>subplots<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">fig <span class=\"token operator\">=</span> plt<span class=\"token punctuation\">.</span>figure<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> dpi<span class=\"token operator\">=</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span>\nax <span class=\"token operator\">=</span> fig<span class=\"token punctuation\">.</span>add_subplot<span class=\"token punctuation\">(</span><span class=\"token number\">111</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 数字 (ijk) 表示: 这是一共i行j列中的组图中的第k个图</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">fig <span class=\"token operator\">=</span> plt<span class=\"token punctuation\">.</span>gcf<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nax <span class=\"token operator\">=</span> plt<span class=\"token punctuation\">.</span>gca<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<p>获取帮助:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token builtin\">help</span><span class=\"token punctuation\">(</span>ax<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># 查看某对象包含的方法</span>\nax<span class=\"token punctuation\">.</span><span class=\"token comment\"># &lt;Tab>, &lt;Shift-Tab></span>\nplt<span class=\"token punctuation\">.</span><span class=\"token comment\"># &lt;Tab>, &lt;Shift-Tab></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<p>例:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">%</span>matplotlib?<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">%</span>matplotlib\n<span class=\"token operator\">%</span>run <span class=\"token operator\">-</span>e <span class=\"token string\">'examples/test_plot.py'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">%</span>matplotlib\n<span class=\"token operator\">%</span>run <span class=\"token operator\">-</span>e <span class=\"token string\">'examples/test_imshow.py'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<ul>\n<li>颜色 <a\nhref=\"https://matplotlib.org/examples/color/colormaps_reference.html\"\nclass=\"uri\">https://matplotlib.org/examples/color/colormaps_reference.html</a></li>\n<li>legend <a href=\"https://matplotlib.org/users/legend_guide.html\"\nclass=\"uri\">https://matplotlib.org/users/legend_guide.html</a> <br>\n<img src='/main/named_colors.png' /></li>\n</ul>\n<h3 id=\"天文相关包\">天文相关包</h3>\n<h4 id=\"astropy\">Astropy</h4>\n<p><img src='/main/astropy_banner.svg' /></p>\n<p>官方文档 <a href=\"http://docs.astropy.org/en/stable/index.html\"\nclass=\"uri\">http://docs.astropy.org/en/stable/index.html</a></p>\n<p>坐标系统 <a\nhref=\"http://docs.astropy.org/en/stable/coordinates/index.html\"\nclass=\"uri\">http://docs.astropy.org/en/stable/coordinates/index.html</a></p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> astropy <span class=\"token keyword\">import</span> units <span class=\"token keyword\">as</span> u\n<span class=\"token keyword\">from</span> astropy<span class=\"token punctuation\">.</span>coordinates <span class=\"token keyword\">import</span> SkyCoord<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<p>参考 <a\nhref=\"https://python4astronomers.github.io/astropy/astropy.html\"\nclass=\"uri\">https://python4astronomers.github.io/astropy/astropy.html</a></p>\n<h4 id=\"sunpy\">SunPy</h4>\n<p><img src='/main/Screenshot_20180625-005924.png' />\n<img src='/main/sphx_glr_lat_lon_lines_001.png' />\n<img src='/main/sphx_glr_submaps_and_cropping_001.png' /></p>\n<p><br> HMI 示例见 <a href=\"advance.html#SunPy-示例\">Python 进阶#SunPy\n示例</a><br> <a\nhref=\"https://coding.net/u/lydiazly/p/scripts-sunpy/git?public=true\"\nclass=\"uri\">https://coding.net/u/lydiazly/p/scripts-sunpy/git?public=true</a></p>\n<p><br><br> 参考:</p>\n<ul>\n<li>Gallery <a\nhref=\"http://docs.sunpy.org/en/stable/generated/gallery/index.html\"\nclass=\"uri\">http://docs.sunpy.org/en/stable/generated/gallery/index.html</a></li>\n<li>SunPy Guide <a\nhref=\"http://docs.sunpy.org/en/stable/guide/index.html\"\nclass=\"uri\">http://docs.sunpy.org/en/stable/guide/index.html</a></li>\n<li>SunPy Map<br><a\nhref=\"http://docs.sunpy.org/en/stable/code_ref/map.html#sunpy.map.mapbase.GenericMap\"\nclass=\"uri\">http://docs.sunpy.org/en/stable/code_ref/map.html#sunpy.map.mapbase.GenericMap</a></li>\n<li>Example Gallery <a\nhref=\"http://docs.sunpy.org/en/stable/generated/gallery/index.html\"\nclass=\"uri\">http://docs.sunpy.org/en/stable/generated/gallery/index.html</a></li>\n<li>A brief tour of SunPy <a\nhref=\"http://docs.sunpy.org/en/stable/guide/tour.html\"\nclass=\"uri\">http://docs.sunpy.org/en/stable/guide/tour.html</a></li>\n<li>Finding and Downloading Data using Fido<br><a\nhref=\"http://docs.sunpy.org/en/stable/guide/acquiring_data/fido.html\"\nclass=\"uri\">http://docs.sunpy.org/en/stable/guide/acquiring_data/fido.html</a></li>\n</ul>\n<p>简单的例子 (来自官网):</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">%</span>matplotlib inline\n\n<span class=\"token keyword\">import</span> sunpy<span class=\"token punctuation\">.</span><span class=\"token builtin\">map</span>\n<span class=\"token keyword\">import</span> matplotlib<span class=\"token punctuation\">.</span>pyplot <span class=\"token keyword\">as</span> plt\n<span class=\"token keyword\">import</span> sunpy<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>sample\n\naia <span class=\"token operator\">=</span> sunpy<span class=\"token punctuation\">.</span><span class=\"token builtin\">map</span><span class=\"token punctuation\">.</span>Map<span class=\"token punctuation\">(</span>sunpy<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>sample<span class=\"token punctuation\">.</span>AIA_171_IMAGE<span class=\"token punctuation\">)</span>\n\nfig <span class=\"token operator\">=</span> plt<span class=\"token punctuation\">.</span>figure<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> dpi<span class=\"token operator\">=</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span>\nax <span class=\"token operator\">=</span> plt<span class=\"token punctuation\">.</span>subplot<span class=\"token punctuation\">(</span><span class=\"token number\">111</span><span class=\"token punctuation\">,</span> projection<span class=\"token operator\">=</span>aia<span class=\"token punctuation\">)</span>\n\naia<span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\naia<span class=\"token punctuation\">.</span>draw_limb<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\naia<span class=\"token punctuation\">.</span>draw_grid<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\naia<span class=\"token punctuation\">.</span>draw_limb<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>colorbar<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\"># plt.show()</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code>/home/lydia/miniconda3/lib/python3.6/site-packages/sunpy/map/sources/sdo.py:48: SunpyDeprecationWarning: Use Matplotlib to load the colormaps\n  self.plot_settings[&#39;cmap&#39;] = cm.get_cmap(self._get_cmap_name())</code></pre>\n<figure>\n<img src=\"/main/main_126_1.png\" alt=\"png\" />\n<figcaption aria-hidden=\"true\">png</figcaption>\n</figure>\n<p>获取一些常数:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> sunpy<span class=\"token punctuation\">.</span>sun <span class=\"token keyword\">import</span> constants <span class=\"token keyword\">as</span> con\n<span class=\"token comment\"># one astronomical unit (the average distance between the Sun and Earth)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>con<span class=\"token punctuation\">.</span>au<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<pre><code>  Name   = Astronomical Unit\n  Value  = 149597870700.0\n  Uncertainty  = 0.0\n  Unit  = m\n  Reference = IAU 2012 Resolution B2</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># the solar radius</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>con<span class=\"token punctuation\">.</span>radius<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<pre><code>  Name   = Solar radius\n  Value  = 695508000.0\n  Uncertainty  = 26000.0\n  Unit  = m\n  Reference = Allen&#39;s Astrophysical Quantities 4th Ed.</code></pre>\n<h2 id=\"常见数据文件读写\">常见数据文件读写</h2>\n<h3 id=\"一般情况\">一般情况</h3>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">f <span class=\"token operator\">=</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span>filename<span class=\"token punctuation\">,</span> <span class=\"token string\">'w'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 'w', 'r', ...</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\nf<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<p>更好的用法: <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span>filename<span class=\"token punctuation\">,</span> <span class=\"token string\">'w'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span>  <span class=\"token comment\"># 'w', 'r', ...</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre></p>\n<h3 id=\"txt-csv-文件读写\">txt, csv 文件读写</h3>\n<ul>\n<li>逐行读取整行的方式:<br> 使用 <code>strip</code>\n可以用来去掉读入的每行末尾的 ''</li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">lines <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'data/data.csv'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'r'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">for</span> line <span class=\"token keyword\">in</span> f<span class=\"token punctuation\">:</span>\n        lines<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>line<span class=\"token punctuation\">.</span>strip<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token string\">','</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nlines<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code>[[&#39;col1&#39;, &#39;col2&#39;, &#39;col3&#39;],\n [&#39;row1&#39;, &#39;1&#39;, &#39;1e1&#39;],\n [&#39;row2&#39;, &#39;2&#39;, &#39;2e-1&#39;],\n [&#39;row3&#39;, &#39;3&#39;, &#39;3e+2&#39;]]</code></pre>\n<ul>\n<li>使用 numpy, 读取后直接转成数组的方式 (推荐):<br>\n<code>np.loadtxt</code>, <code>np.genfromtxt</code> (写文件是\n<code>np.savetxt</code>)<br> 超大文件读取建议用 pandas 包.</li>\n</ul>\n<p>e.g.</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> arr <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>loadtxt<span class=\"token punctuation\">(</span>fname<span class=\"token punctuation\">,</span> skiprows<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> delimiter<span class=\"token operator\">=</span><span class=\"token string\">','</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># 默认分割符为空格</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> col1<span class=\"token punctuation\">,</span> col2 <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>loadtxt<span class=\"token punctuation\">(</span>fname<span class=\"token punctuation\">,</span> skiprows<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> usecols<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> unpack<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<p><code>np.genfromtxt</code> 和 <code>np.loadtxt</code> 类似,\n增加了处理 missing values 的功能.<br> (但参数 skiprows=1 需替换为\nskip_header=1)</p>\n<p>例 (这里使用功能更多的 <code>np.genfromtxt</code> 代替\n<code>np.loadtxt</code>):</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">arr <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>genfromtxt<span class=\"token punctuation\">(</span><span class=\"token string\">'data/data.csv'</span><span class=\"token punctuation\">,</span>\n                    skip_header<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n                    names<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token string\">'col1'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'col2'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'col3'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                    dtype<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token string\">'U15'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'int'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'float'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                    delimiter<span class=\"token operator\">=</span><span class=\"token string\">','</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>arr<span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token string\">'col1'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'col2'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 设定了 names 之后, 可以用名称索引</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code>[(&#39;row1&#39;, 1) (&#39;row2&#39;, 2) (&#39;row3&#39;, 3)]</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">arr <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>genfromtxt<span class=\"token punctuation\">(</span><span class=\"token string\">'data/data2.csv'</span><span class=\"token punctuation\">,</span>\n                    skip_header<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n                    names<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token string\">'col1'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'col2'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'col3'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                    dtype<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token string\">'U15'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'int'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'float'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                    missing_values<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span>\n                    filling_values<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> np<span class=\"token punctuation\">.</span>nan<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\"># 分开指定</span>\n                    delimiter<span class=\"token operator\">=</span><span class=\"token string\">','</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>arr<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code>[(&#39;row1&#39;, 0, 10. ) (&#39;&#39;, 2,  0.2) (&#39;row3&#39;, 3,  nan)]</code></pre>\n<ul>\n<li>一般而言, 对于一个由分隔符分隔的字符串, 转成一个数组的方式:<br>\n<code>np.fromstring(string, dtype=float, count=-1, sep='')</code></li>\n</ul>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">np<span class=\"token punctuation\">.</span>fromstring<span class=\"token punctuation\">(</span><span class=\"token string\">'0 1 2'</span><span class=\"token punctuation\">,</span> dtype<span class=\"token operator\">=</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">,</span> sep<span class=\"token operator\">=</span><span class=\"token string\">' '</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>array([0, 1, 2])</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">np<span class=\"token punctuation\">.</span>fromstring<span class=\"token punctuation\">(</span><span class=\"token string\">'0., 1., 2.'</span><span class=\"token punctuation\">,</span> sep<span class=\"token operator\">=</span><span class=\"token string\">','</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>array([0., 1., 2.])</code></pre>\n<h3 id=\"numpy-save-文件读写\">numpy save 文件读写</h3>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">np<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span><span class=\"token string\">'fname'</span><span class=\"token punctuation\">,</span> arr<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 'fname.npy'</span>\nnp<span class=\"token punctuation\">.</span>savez<span class=\"token punctuation\">(</span><span class=\"token string\">'fname'</span><span class=\"token punctuation\">,</span> arr<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 'fname.npz', 多个变量</span>\nnp<span class=\"token punctuation\">.</span>savez_compressed<span class=\"token punctuation\">(</span><span class=\"token string\">'fname'</span><span class=\"token punctuation\">,</span> arr<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 'fname.npz', 多个变量 &amp; 压缩</span>\nnp<span class=\"token punctuation\">.</span>load<span class=\"token punctuation\">(</span><span class=\"token string\">'fname.npz'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># Load the files created by savez_compressed.</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># 存入</span>\narr <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>ones<span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 默认 `float64`</span>\nnp<span class=\"token punctuation\">.</span>savez<span class=\"token punctuation\">(</span><span class=\"token string\">'data/np_array'</span><span class=\"token punctuation\">,</span> a<span class=\"token operator\">=</span>arr<span class=\"token punctuation\">,</span> b<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">ls data<span class=\"token operator\">/</span><span class=\"token operator\">*</span><span class=\"token punctuation\">.</span>npz<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>data/np_array.npz</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># 载入</span>\ndata <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>load<span class=\"token punctuation\">(</span><span class=\"token string\">'data/np_array.npz'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">[</span><span class=\"token string\">'a'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">[</span><span class=\"token string\">'b'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">[</span><span class=\"token string\">'b'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 默认以`ndarray`读取</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<pre><code>(array([1., 1., 1., 1., 1.]), array(0), 0)</code></pre>\n<h3 id=\"idl-sav-文件读取\">IDL sav 文件读取</h3>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> scipy<span class=\"token punctuation\">.</span>io<span class=\"token punctuation\">.</span>idl <span class=\"token keyword\">import</span> readsav\ndata <span class=\"token operator\">=</span> readsav<span class=\"token punctuation\">(</span><span class=\"token string\">'dname.sav'</span><span class=\"token punctuation\">,</span> verbose<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> python_dict<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<p>默认读出的是<code>scipy.io.idl.AttrDict</code>类型, 即 key\n的大小写不敏感.<br> 想要得到大小写敏感的 python dict, 设置\n<code>python_dict=True</code> 即可. <br><br> 例:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> scipy<span class=\"token punctuation\">.</span>io<span class=\"token punctuation\">.</span>idl <span class=\"token keyword\">import</span> readsav\ndata <span class=\"token operator\">=</span> readsav<span class=\"token punctuation\">(</span><span class=\"token string\">'data/myidlfile.sav'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">type</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">.</span>keys<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 注意返回的是一个`dict_keys`对象, 如需索引需要手动转为list</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">[</span><span class=\"token string\">'X'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 大小写不敏感</span>\ndata <span class=\"token operator\">=</span> readsav<span class=\"token punctuation\">(</span><span class=\"token string\">'data/myidlfile.sav'</span><span class=\"token punctuation\">,</span> python_dict<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">type</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">[</span><span class=\"token string\">'x'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 大小写敏感</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code>&lt;class &#39;scipy.io.idl.AttrDict&#39;&gt;\ndict_keys([&#39;x&#39;, &#39;y&#39;, &#39;str&#39;])\n(25,)\n&lt;class &#39;dict&#39;&gt;\n(25,)</code></pre>\n<h3 id=\"fits-文件读取\">FITS 文件读取</h3>\n<ul>\n<li>Astropy</li>\n</ul>\n<p>参考:<br> <a href=\"http://docs.astropy.org/en/stable/io/fits\"\nclass=\"uri\">http://docs.astropy.org/en/stable/io/fits</a><br> <a\nhref=\"https://python4astronomers.github.io/astropy/fits.html\"\nclass=\"uri\">https://python4astronomers.github.io/astropy/fits.html</a></p>\n<blockquote>\n<p>[Note]<br> If you are already familiar with PyFITS, astropy.io.fits\nis in fact the same code as the latest version of PyFITS, and you can\nadapt old scripts that use PyFITS to use Astropy by simply doing:\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> astropy<span class=\"token punctuation\">.</span>io <span class=\"token keyword\">import</span> fits <span class=\"token keyword\">as</span> pyfits<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre> However, for new scripts, we recommend the following\nimport: <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> astropy<span class=\"token punctuation\">.</span>io <span class=\"token keyword\">import</span> fits<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre></p>\n</blockquote>\n<p><code>fits.open</code> <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token keyword\">from</span> astropy<span class=\"token punctuation\">.</span>io <span class=\"token keyword\">import</span> fits\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> hdulist <span class=\"token operator\">=</span> fits<span class=\"token punctuation\">.</span><span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;filename>.fit'</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> hdulist<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># hdulist 是一个由 HDU objects 组成的类似列表的对象</span>\nFilename<span class=\"token punctuation\">:</span> <span class=\"token operator\">&lt;</span>filename<span class=\"token operator\">></span><span class=\"token punctuation\">.</span>fit\nNo<span class=\"token punctuation\">.</span>    Name         Type      Cards   Dimensions   Format\n<span class=\"token number\">0</span>    PRIMARY     PrimaryHDU    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>       <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>        <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token number\">1</span>    ENERGIES    BinTableHDU   <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>       <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>        <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> hdu <span class=\"token operator\">=</span> hdulist<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> hdu<span class=\"token punctuation\">.</span>data  <span class=\"token comment\"># ndarray</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> hdu<span class=\"token punctuation\">.</span>header<span class=\"token punctuation\">[</span><span class=\"token string\">'&lt;key>'</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># 得到某个 header keyword</span>\n<span class=\"token comment\"># 修改数据后</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> hdu<span class=\"token punctuation\">.</span>writeto<span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;filename>.fits'</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># 保存 HDU object</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> hdulist<span class=\"token punctuation\">.</span>writeto<span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;filename>.fits'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 或保存整个表</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre> <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># 创建一个 fits Primary HDU object</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> hdu <span class=\"token operator\">=</span> fits<span class=\"token punctuation\">.</span>PrimaryHDU<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> hdu<span class=\"token punctuation\">.</span>writeto<span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;filename>.fits'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 保存 HDU object</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> hdu<span class=\"token punctuation\">.</span>writeto<span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;filename>.fits'</span><span class=\"token punctuation\">,</span> clobber<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 保存到已存在文件</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<code>fits.getdata</code>, <code>fits.getheader</code> <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> data <span class=\"token operator\">=</span> fits<span class=\"token punctuation\">.</span>getdata<span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;filename>.fit'</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> header <span class=\"token operator\">=</span> fits<span class=\"token punctuation\">.</span>getheader<span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;filename>.fit'</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<br> * SunPy</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token keyword\">import</span> sunpy<span class=\"token punctuation\">.</span>io\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> hdulist <span class=\"token operator\">=</span> sunpy<span class=\"token punctuation\">.</span>io<span class=\"token punctuation\">.</span>read_file<span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;filename>.fits'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 自动判断文件类型</span>\n<span class=\"token comment\"># or use `hdulist = sunpy.io.fits.read('&lt;filename>.fits')`</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> hdu <span class=\"token operator\">=</span> hdulist<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> hdu<span class=\"token punctuation\">.</span>data  <span class=\"token comment\"># ndarray</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token keyword\">import</span> sunpy<span class=\"token punctuation\">.</span><span class=\"token builtin\">map</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> smap <span class=\"token operator\">=</span> sunpy<span class=\"token punctuation\">.</span><span class=\"token builtin\">map</span><span class=\"token punctuation\">.</span>Map<span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;filename>.fits'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 得到一个 sunpy `GenericMap` object</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<p>例:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> astropy<span class=\"token punctuation\">.</span>io <span class=\"token keyword\">import</span> fits\nfname <span class=\"token operator\">=</span> <span class=\"token string\">'scripts-sunpy/plothmi/data/hmi.B_720s.20150827_052400_TAI.field.fits'</span>\nhdulist <span class=\"token operator\">=</span> fits<span class=\"token punctuation\">.</span><span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span>fname<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">hdulist<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre><code>Filename: scripts-sunpy/plothmi/data/hmi.B_720s.20150827_052400_TAI.field.fits\nNo.    Name      Ver    Type      Cards   Dimensions   Format\n  0  PRIMARY       1 PrimaryHDU       6   ()      \n  1                1 CompImageHDU    155   (4096, 4096)   int32   </code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">hdulist<span class=\"token punctuation\">.</span>verify<span class=\"token punctuation\">(</span><span class=\"token string\">'silentfix+warn'</span><span class=\"token punctuation\">)</span>\nhdu <span class=\"token operator\">=</span> hdulist<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>\nhdu<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>shape<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<pre><code>(4096, 4096)</code></pre>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> sunpy<span class=\"token punctuation\">.</span>io\nhdulist <span class=\"token operator\">=</span> sunpy<span class=\"token punctuation\">.</span>io<span class=\"token punctuation\">.</span>read_file<span class=\"token punctuation\">(</span>fname<span class=\"token punctuation\">)</span>\nhdu <span class=\"token operator\">=</span> hdulist<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>\nhdu<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>shape<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<pre><code>(4096, 4096)</code></pre>\n<h2 id=\"其他包和软件\">其他包和软件</h2>\n<ul>\n<li>Astroconda <a href=\"https://astroconda.readthedocs.io/en/latest/\"\nclass=\"uri\">https://astroconda.readthedocs.io/en/latest/</a> &gt;\nAstroConda is a free Conda channel maintained by the Space Telescope\nScience Institute (STScI) in Baltimore, Maryland. This channel provides\ntools and utilities required to process and analyze data from the Hubble\nSpace Telescope (HST), James Webb Space Telescope (JWST), and others.\n<br><br></li>\n<li>Canopy <a href=\"https://www.enthought.com/product/canopy/\"\nclass=\"uri\">https://www.enthought.com/product/canopy/</a> &gt; Enthought\nCanopy provides a proven scientific and analytic Python package\ndistribution plus key integrated tools for iterative data analysis, data\nvisualization, and application development. Users have the ability to\nextend and innovate with scripting and open platform APIs, driving the\ncreation and sharing of innovative workflows, tools, and applications.\n<img src='/main/Canopy-Packages-min-1.png' > <br><br></li>\n<li>PyCharm <a href=\"https://www.jetbrains.com/pycharm/\"\nclass=\"uri\">https://www.jetbrains.com/pycharm/</a>\n<img src='/main/pycharm.jpg' > <br><br></li>\n<li>Jupyterlab <a href=\"http://jupyterlab.readthedocs.io/en/stable/\"\nclass=\"uri\">http://jupyterlab.readthedocs.io/en/stable/</a>\n<img src='/main/jupyterlab.png' ></li>\n</ul>"},{"title":"Python 的脚本与交互式环境","date":"2018-10-15T14:46:01.000Z","_content":"\n目的是从交互环境调用脚本产生的变量, 可用于调试脚本和测试数据等等.\n\n比如当前目录下有一个包含如下内容的脚本:\n\n``` python\n#!/usr/bin/env python\na=1\nprint('a =', a)\n```\n<!-- more -->\n\n### 方法 1. shell -> interactive mode (推荐)\n\n使用 `-i` 选项:\n\n```bash\n# shell\n$ python -i test.py\n```\n\n执行结束随即进入 python 交互环境, 并且保留了脚本中定义的变量:\n\n```python\n# python\na = 1\n>>> a\n1\n```\n\n### 方法 2. In ipython / jupyter (第二推荐)\n\n```python\n# ipython\nIn [1]: %run test.py\na = 1\n\nIn [2]: a\nOut[2]: 1\n\nIn [3]: %who\na\n\nIn [4]: %whos\nVariable   Type    Data/Info\n----------------------------\na          int     1\n```\n\n### 方法 3. In interactive mode\n\n> **NOTE**: Python 3 取消了 `execfile()` 这个函数! 如今使用 `exec()`.\n\n```python\n# python\n>>> exec(open('test.py').read())\na = 1\n>>> a\n1\n>>> 'a' in dir()\nTrue\n>>> globals()['a']  # same as vars()['a']\n1\n```\n\n但这之后文件并没有关闭, 虽然多数时候没有影响, 但如果实在要关闭, 建议使用 `with` :\n\n```python\n# python\nwith open('test.py') as f:\n    exec(f.read())  # ctrl+D to exit the block\n```\n\n总之十分不方便, 因此不推荐.\n<br><br>\n对于没有使用 `if __name__ == \"__main__\"` 的脚本, 当脚本处在当前目录或 `$PYTHONPATH` 中时, 也可以有比较方便的办法<br>(\n注意这里因为是调用 module 的形式, 所以不要加 '.py' ):\n\n```python\n# python\n>>> import test\na = 1\n```\n\n<br>\n补充说明在 python 交互环境中查看当前环境中的变量的方法 (ipython / jupyter 使用 `%who`, `%whos` 即可):\n\n```python\ndir()  # without an argument, return the names in the current scope\nglobals()  # a dictionary containing the current scope's global variables\nlocals()  # a dictionary containing the current scope's local variables\nvars()  # without arguments, equivalent to locals();\n        # with an argument, equivalent to object.__dict__.\n```\n","source":"_posts/2018-10-15-scripts-and-interactive-mode.md","raw":"---\ntitle: \"Python 的脚本与交互式环境\"\ncategories: 'Solar Physics'\ntags: python\ndate: 2018-10-15 22:46:01\n---\n\n目的是从交互环境调用脚本产生的变量, 可用于调试脚本和测试数据等等.\n\n比如当前目录下有一个包含如下内容的脚本:\n\n``` python\n#!/usr/bin/env python\na=1\nprint('a =', a)\n```\n<!-- more -->\n\n### 方法 1. shell -> interactive mode (推荐)\n\n使用 `-i` 选项:\n\n```bash\n# shell\n$ python -i test.py\n```\n\n执行结束随即进入 python 交互环境, 并且保留了脚本中定义的变量:\n\n```python\n# python\na = 1\n>>> a\n1\n```\n\n### 方法 2. In ipython / jupyter (第二推荐)\n\n```python\n# ipython\nIn [1]: %run test.py\na = 1\n\nIn [2]: a\nOut[2]: 1\n\nIn [3]: %who\na\n\nIn [4]: %whos\nVariable   Type    Data/Info\n----------------------------\na          int     1\n```\n\n### 方法 3. In interactive mode\n\n> **NOTE**: Python 3 取消了 `execfile()` 这个函数! 如今使用 `exec()`.\n\n```python\n# python\n>>> exec(open('test.py').read())\na = 1\n>>> a\n1\n>>> 'a' in dir()\nTrue\n>>> globals()['a']  # same as vars()['a']\n1\n```\n\n但这之后文件并没有关闭, 虽然多数时候没有影响, 但如果实在要关闭, 建议使用 `with` :\n\n```python\n# python\nwith open('test.py') as f:\n    exec(f.read())  # ctrl+D to exit the block\n```\n\n总之十分不方便, 因此不推荐.\n<br><br>\n对于没有使用 `if __name__ == \"__main__\"` 的脚本, 当脚本处在当前目录或 `$PYTHONPATH` 中时, 也可以有比较方便的办法<br>(\n注意这里因为是调用 module 的形式, 所以不要加 '.py' ):\n\n```python\n# python\n>>> import test\na = 1\n```\n\n<br>\n补充说明在 python 交互环境中查看当前环境中的变量的方法 (ipython / jupyter 使用 `%who`, `%whos` 即可):\n\n```python\ndir()  # without an argument, return the names in the current scope\nglobals()  # a dictionary containing the current scope's global variables\nlocals()  # a dictionary containing the current scope's local variables\nvars()  # without arguments, equivalent to locals();\n        # with an argument, equivalent to object.__dict__.\n```\n","slug":"scripts-and-interactive-mode","published":1,"updated":"2018-10-15T14:46:01.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl5kegawf000yvxgv46k4bg2k","content":"<p>目的是从交互环境调用脚本产生的变量, 可用于调试脚本和测试数据等等.</p>\n<p>比如当前目录下有一个包含如下内容的脚本:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\">#!/usr/bin/env python</span>\na<span class=\"token operator\">=</span><span class=\"token number\">1</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'a ='</span><span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<span id=\"more\"></span>\n<h3 id=\"方法-1.-shell---interactive-mode-推荐\">方法 1. shell -&gt;\ninteractive mode (推荐)</h3>\n<p>使用 <code>-i</code> 选项:</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token comment\"># shell</span>\n$ python -i test.py<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<p>执行结束随即进入 python 交互环境, 并且保留了脚本中定义的变量:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># python</span>\na <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> a\n<span class=\"token number\">1</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<h3 id=\"方法-2.-in-ipython-jupyter-第二推荐\">方法 2. In ipython /\njupyter (第二推荐)</h3>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># ipython</span>\nIn <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span> <span class=\"token operator\">%</span>run test<span class=\"token punctuation\">.</span>py\na <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n\nIn <span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span> a\nOut<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span>\n\nIn <span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span> <span class=\"token operator\">%</span>who\na\n\nIn <span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span> <span class=\"token operator\">%</span>whos\nVariable   Type    Data<span class=\"token operator\">/</span>Info\n<span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span>\na          <span class=\"token builtin\">int</span>     <span class=\"token number\">1</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h3 id=\"方法-3.-in-interactive-mode\">方法 3. In interactive mode</h3>\n<blockquote>\n<p><strong>NOTE</strong>: Python 3 取消了 <code>execfile()</code>\n这个函数! 如今使用 <code>exec()</code>.</p>\n</blockquote>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># python</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token keyword\">exec</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'test.py'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\na <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> a\n<span class=\"token number\">1</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token string\">'a'</span> <span class=\"token keyword\">in</span> <span class=\"token builtin\">dir</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token boolean\">True</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token builtin\">globals</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token string\">'a'</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># same as vars()['a']</span>\n<span class=\"token number\">1</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>但这之后文件并没有关闭, 虽然多数时候没有影响, 但如果实在要关闭,\n建议使用 <code>with</code> :</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># python</span>\n<span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'test.py'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">exec</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># ctrl+D to exit the block</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<p>总之十分不方便, 因此不推荐. <br><br> 对于没有使用\n<code>if __name__ == \"__main__\"</code> 的脚本, 当脚本处在当前目录或\n<code>$PYTHONPATH</code> 中时, 也可以有比较方便的办法<br>(\n注意这里因为是调用 module 的形式, 所以不要加 '.py' ):</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># python</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token keyword\">import</span> test\na <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<p><br> 补充说明在 python 交互环境中查看当前环境中的变量的方法 (ipython\n/ jupyter 使用 <code>%who</code>, <code>%whos</code> 即可):</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token builtin\">dir</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># without an argument, return the names in the current scope</span>\n<span class=\"token builtin\">globals</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># a dictionary containing the current scope's global variables</span>\n<span class=\"token builtin\">locals</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># a dictionary containing the current scope's local variables</span>\n<span class=\"token builtin\">vars</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># without arguments, equivalent to locals();</span>\n        <span class=\"token comment\"># with an argument, equivalent to object.__dict__.</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n","site":{"data":{}},"excerpt":"<p>目的是从交互环境调用脚本产生的变量, 可用于调试脚本和测试数据等等.</p>\n<p>比如当前目录下有一个包含如下内容的脚本:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\">#!/usr/bin/env python</span>\na<span class=\"token operator\">=</span><span class=\"token number\">1</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'a ='</span><span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>","more":"<h3 id=\"方法-1.-shell---interactive-mode-推荐\">方法 1. shell -&gt;\ninteractive mode (推荐)</h3>\n<p>使用 <code>-i</code> 选项:</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token comment\"># shell</span>\n$ python -i test.py<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<p>执行结束随即进入 python 交互环境, 并且保留了脚本中定义的变量:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># python</span>\na <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> a\n<span class=\"token number\">1</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<h3 id=\"方法-2.-in-ipython-jupyter-第二推荐\">方法 2. In ipython /\njupyter (第二推荐)</h3>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># ipython</span>\nIn <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span> <span class=\"token operator\">%</span>run test<span class=\"token punctuation\">.</span>py\na <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n\nIn <span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span> a\nOut<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span>\n\nIn <span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span> <span class=\"token operator\">%</span>who\na\n\nIn <span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span> <span class=\"token operator\">%</span>whos\nVariable   Type    Data<span class=\"token operator\">/</span>Info\n<span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span>\na          <span class=\"token builtin\">int</span>     <span class=\"token number\">1</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h3 id=\"方法-3.-in-interactive-mode\">方法 3. In interactive mode</h3>\n<blockquote>\n<p><strong>NOTE</strong>: Python 3 取消了 <code>execfile()</code>\n这个函数! 如今使用 <code>exec()</code>.</p>\n</blockquote>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># python</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token keyword\">exec</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'test.py'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\na <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> a\n<span class=\"token number\">1</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token string\">'a'</span> <span class=\"token keyword\">in</span> <span class=\"token builtin\">dir</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token boolean\">True</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token builtin\">globals</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token string\">'a'</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># same as vars()['a']</span>\n<span class=\"token number\">1</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>但这之后文件并没有关闭, 虽然多数时候没有影响, 但如果实在要关闭,\n建议使用 <code>with</code> :</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># python</span>\n<span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'test.py'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">exec</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># ctrl+D to exit the block</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<p>总之十分不方便, 因此不推荐. <br><br> 对于没有使用\n<code>if __name__ == \"__main__\"</code> 的脚本, 当脚本处在当前目录或\n<code>$PYTHONPATH</code> 中时, 也可以有比较方便的办法<br>(\n注意这里因为是调用 module 的形式, 所以不要加 '.py' ):</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\"># python</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token keyword\">import</span> test\na <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<p><br> 补充说明在 python 交互环境中查看当前环境中的变量的方法 (ipython\n/ jupyter 使用 <code>%who</code>, <code>%whos</code> 即可):</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token builtin\">dir</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># without an argument, return the names in the current scope</span>\n<span class=\"token builtin\">globals</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># a dictionary containing the current scope's global variables</span>\n<span class=\"token builtin\">locals</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># a dictionary containing the current scope's local variables</span>\n<span class=\"token builtin\">vars</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># without arguments, equivalent to locals();</span>\n        <span class=\"token comment\"># with an argument, equivalent to object.__dict__.</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>"},{"title":"使用 pickle 模块存取 dict","date":"2018-10-20T08:41:13.000Z","_content":"\nPython 自带一个存取 dict 到二进制文件的工具 [pickle](https://docs.python.org/3/library/pickle.html), 支持数值型的 key ([numpy.savez](https://docs.scipy.org/doc/numpy/reference/generated/numpy.savez.html) 和 [numpy.savez_compressed](https://docs.scipy.org/doc/numpy/reference/generated/numpy.savez_compressed.html) 只支持字符串作为 key).\n\n用法:\n\n```python\nimport pickle\n# 存入\npickle.dump(data, open(\"filename.p\", \"wb\"))  # type(data): dict\n# 读取\ndata = pickle.load(open(\"filename.p\", \"rb\"))  # 返回一个 dict\n```\n<!-- more -->\n\n以下示例特地使用了数值型的 key:\n\n```python\n>>> import pickle\n>>> a = {1.1:1.1, 2:2}  # 以 float 和 int 作为 key\n>>> import pickle\n>>> pickle.dump(a, open(\"data.p\", \"wb\"))  # 并不会自动添加后缀名\n>>> b = pickle.load(open(\"data.p\", \"rb\"))\n>>> b.keys()\ndict_keys([1.1, 2])\n>>> b[1.1]\n1.1\n```\n\n注意 `pickle.load()` 返回的类型是 dict, 但 `numpy.load()` 读取 '\\*.npz' 文件所返回是一个可以像 dict 一样使用 key 来索引数据的 `numpy.lib.npyio.NpzFile` 对象.\n\n'\\*.p' 文件的大小和非压缩的 '\\*.npz' (`numpy.savez()`) 一致, 然而压缩过的 '\\*.npz' (`numpy.savez_compressed()`) 显然占用空间更小, 因此在方便的情况下 (例如 key 是字符串, 读取后直接操作数据而不需要得到一个 dict), 推荐优先使用 numpy.\n<br><br>\n如果要存入上述示例中同样的数据到 '\\*.npz' 格式, 需要转换 key 的类型 (读取时也需要使用字符串型的 key):\n\n```python\n>>> a = {str(key):value for key, value in a.items()}\n>>> a\n{'1.1': 1.1, '2': 2}\n>>> np.savez_compressed('data2', **a)  # 会自动添加后缀名, 得到 'data2.npz'\n```\n\n---\n\n其他数据存取教程:\n\n- [Python 简易教程 (lecture for Solar Group)](main.html#4-常见数据文件读写)\n  - [4.1. 一般情况](main.html#41-一般情况)\n  - [4.2. txt, csv 文件读写](main.html#42-txt-csv-文件读写)\n  - [4.3. numpy save 文件读写](main.html#43-numpy-save-文件读写)\n  - [4.4. IDL sav 文件读取](main.html#44-idl-sav-文件读取)\n  - [4.5. FITS 文件读取](main.html#45-fits-文件读取)\n\n- [Python 进阶 (lecture for Solar Group)](advance.html#9-其他格式文件读写)\n  - [9.1. 用 pandas 读 csv](advance.html#91-用-pandas-读-csv)\n  - [9.2. Fortran 二进制文件读写](advance.html#92-fortran-二进制文件读写)\n  - [9.3. HDF5 文件读写, NCDF, CDF 文件读取](advance.html#93-hdf5-文件读写-ncdf-cdf-文件读取)\n  - [9.4. NumPy to VTK](advance.html#94-numpy-to-vtk)\n  - [9.5. Matlab mat 文件读写](advance.html#95-matlab-mat-文件读写)\n","source":"_posts/2018-10-20-pickle.md","raw":"---\ntitle: \"使用 pickle 模块存取 dict\"\ncategories: 'Solar Physics'\ntags: python\ndate: 2018-10-20 16:41:13\n---\n\nPython 自带一个存取 dict 到二进制文件的工具 [pickle](https://docs.python.org/3/library/pickle.html), 支持数值型的 key ([numpy.savez](https://docs.scipy.org/doc/numpy/reference/generated/numpy.savez.html) 和 [numpy.savez_compressed](https://docs.scipy.org/doc/numpy/reference/generated/numpy.savez_compressed.html) 只支持字符串作为 key).\n\n用法:\n\n```python\nimport pickle\n# 存入\npickle.dump(data, open(\"filename.p\", \"wb\"))  # type(data): dict\n# 读取\ndata = pickle.load(open(\"filename.p\", \"rb\"))  # 返回一个 dict\n```\n<!-- more -->\n\n以下示例特地使用了数值型的 key:\n\n```python\n>>> import pickle\n>>> a = {1.1:1.1, 2:2}  # 以 float 和 int 作为 key\n>>> import pickle\n>>> pickle.dump(a, open(\"data.p\", \"wb\"))  # 并不会自动添加后缀名\n>>> b = pickle.load(open(\"data.p\", \"rb\"))\n>>> b.keys()\ndict_keys([1.1, 2])\n>>> b[1.1]\n1.1\n```\n\n注意 `pickle.load()` 返回的类型是 dict, 但 `numpy.load()` 读取 '\\*.npz' 文件所返回是一个可以像 dict 一样使用 key 来索引数据的 `numpy.lib.npyio.NpzFile` 对象.\n\n'\\*.p' 文件的大小和非压缩的 '\\*.npz' (`numpy.savez()`) 一致, 然而压缩过的 '\\*.npz' (`numpy.savez_compressed()`) 显然占用空间更小, 因此在方便的情况下 (例如 key 是字符串, 读取后直接操作数据而不需要得到一个 dict), 推荐优先使用 numpy.\n<br><br>\n如果要存入上述示例中同样的数据到 '\\*.npz' 格式, 需要转换 key 的类型 (读取时也需要使用字符串型的 key):\n\n```python\n>>> a = {str(key):value for key, value in a.items()}\n>>> a\n{'1.1': 1.1, '2': 2}\n>>> np.savez_compressed('data2', **a)  # 会自动添加后缀名, 得到 'data2.npz'\n```\n\n---\n\n其他数据存取教程:\n\n- [Python 简易教程 (lecture for Solar Group)](main.html#4-常见数据文件读写)\n  - [4.1. 一般情况](main.html#41-一般情况)\n  - [4.2. txt, csv 文件读写](main.html#42-txt-csv-文件读写)\n  - [4.3. numpy save 文件读写](main.html#43-numpy-save-文件读写)\n  - [4.4. IDL sav 文件读取](main.html#44-idl-sav-文件读取)\n  - [4.5. FITS 文件读取](main.html#45-fits-文件读取)\n\n- [Python 进阶 (lecture for Solar Group)](advance.html#9-其他格式文件读写)\n  - [9.1. 用 pandas 读 csv](advance.html#91-用-pandas-读-csv)\n  - [9.2. Fortran 二进制文件读写](advance.html#92-fortran-二进制文件读写)\n  - [9.3. HDF5 文件读写, NCDF, CDF 文件读取](advance.html#93-hdf5-文件读写-ncdf-cdf-文件读取)\n  - [9.4. NumPy to VTK](advance.html#94-numpy-to-vtk)\n  - [9.5. Matlab mat 文件读写](advance.html#95-matlab-mat-文件读写)\n","slug":"pickle","published":1,"updated":"2018-10-20T08:41:13.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl5kegawh0010vxgve3x76euv","content":"<p>Python 自带一个存取 dict 到二进制文件的工具 <a\nhref=\"https://docs.python.org/3/library/pickle.html\">pickle</a>,\n支持数值型的 key (<a\nhref=\"https://docs.scipy.org/doc/numpy/reference/generated/numpy.savez.html\">numpy.savez</a>\n和 <a\nhref=\"https://docs.scipy.org/doc/numpy/reference/generated/numpy.savez_compressed.html\">numpy.savez_compressed</a>\n只支持字符串作为 key).</p>\n<p>用法:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> pickle\n<span class=\"token comment\"># 存入</span>\npickle<span class=\"token punctuation\">.</span>dump<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">,</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"filename.p\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"wb\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># type(data): dict</span>\n<span class=\"token comment\"># 读取</span>\ndata <span class=\"token operator\">=</span> pickle<span class=\"token punctuation\">.</span>load<span class=\"token punctuation\">(</span><span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"filename.p\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"rb\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 返回一个 dict</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<span id=\"more\"></span>\n<p>以下示例特地使用了数值型的 key:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token keyword\">import</span> pickle\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> a <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token number\">1.1</span><span class=\"token punctuation\">:</span><span class=\"token number\">1.1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">:</span><span class=\"token number\">2</span><span class=\"token punctuation\">&#125;</span>  <span class=\"token comment\"># 以 float 和 int 作为 key</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token keyword\">import</span> pickle\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> pickle<span class=\"token punctuation\">.</span>dump<span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"data.p\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"wb\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 并不会自动添加后缀名</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> b <span class=\"token operator\">=</span> pickle<span class=\"token punctuation\">.</span>load<span class=\"token punctuation\">(</span><span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"data.p\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"rb\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> b<span class=\"token punctuation\">.</span>keys<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\ndict_keys<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">1.1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> b<span class=\"token punctuation\">[</span><span class=\"token number\">1.1</span><span class=\"token punctuation\">]</span>\n<span class=\"token number\">1.1</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>注意 <code>pickle.load()</code> 返回的类型是 dict, 但\n<code>numpy.load()</code> 读取 '*.npz' 文件所返回是一个可以像 dict\n一样使用 key 来索引数据的 <code>numpy.lib.npyio.NpzFile</code> 对象.</p>\n<p>'*.p' 文件的大小和非压缩的 '*.npz' (<code>numpy.savez()</code>) 一致,\n然而压缩过的 '*.npz' (<code>numpy.savez_compressed()</code>)\n显然占用空间更小, 因此在方便的情况下 (例如 key 是字符串,\n读取后直接操作数据而不需要得到一个 dict), 推荐优先使用 numpy. <br><br>\n如果要存入上述示例中同样的数据到 '*.npz' 格式, 需要转换 key 的类型\n(读取时也需要使用字符串型的 key):</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> a <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>value <span class=\"token keyword\">for</span> key<span class=\"token punctuation\">,</span> value <span class=\"token keyword\">in</span> a<span class=\"token punctuation\">.</span>items<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> a\n<span class=\"token punctuation\">&#123;</span><span class=\"token string\">'1.1'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1.1</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'2'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">&#125;</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> np<span class=\"token punctuation\">.</span>savez_compressed<span class=\"token punctuation\">(</span><span class=\"token string\">'data2'</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">**</span>a<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 会自动添加后缀名, 得到 'data2.npz'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<hr />\n<p>其他数据存取教程:</p>\n<ul>\n<li><a href=\"main.html#4-常见数据文件读写\">Python 简易教程 (lecture for\nSolar Group)</a>\n<ul>\n<li><a href=\"main.html#41-一般情况\">4.1. 一般情况</a></li>\n<li><a href=\"main.html#42-txt-csv-文件读写\">4.2. txt, csv\n文件读写</a></li>\n<li><a href=\"main.html#43-numpy-save-文件读写\">4.3. numpy save\n文件读写</a></li>\n<li><a href=\"main.html#44-idl-sav-文件读取\">4.4. IDL sav\n文件读取</a></li>\n<li><a href=\"main.html#45-fits-文件读取\">4.5. FITS 文件读取</a></li>\n</ul></li>\n<li><a href=\"advance.html#9-其他格式文件读写\">Python 进阶 (lecture for\nSolar Group)</a>\n<ul>\n<li><a href=\"advance.html#91-用-pandas-读-csv\">9.1. 用 pandas 读\ncsv</a></li>\n<li><a href=\"advance.html#92-fortran-二进制文件读写\">9.2. Fortran\n二进制文件读写</a></li>\n<li><a href=\"advance.html#93-hdf5-文件读写-ncdf-cdf-文件读取\">9.3. HDF5\n文件读写, NCDF, CDF 文件读取</a></li>\n<li><a href=\"advance.html#94-numpy-to-vtk\">9.4. NumPy to VTK</a></li>\n<li><a href=\"advance.html#95-matlab-mat-文件读写\">9.5. Matlab mat\n文件读写</a></li>\n</ul></li>\n</ul>\n","site":{"data":{}},"excerpt":"<p>Python 自带一个存取 dict 到二进制文件的工具 <a\nhref=\"https://docs.python.org/3/library/pickle.html\">pickle</a>,\n支持数值型的 key (<a\nhref=\"https://docs.scipy.org/doc/numpy/reference/generated/numpy.savez.html\">numpy.savez</a>\n和 <a\nhref=\"https://docs.scipy.org/doc/numpy/reference/generated/numpy.savez_compressed.html\">numpy.savez_compressed</a>\n只支持字符串作为 key).</p>\n<p>用法:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> pickle\n<span class=\"token comment\"># 存入</span>\npickle<span class=\"token punctuation\">.</span>dump<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">,</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"filename.p\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"wb\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># type(data): dict</span>\n<span class=\"token comment\"># 读取</span>\ndata <span class=\"token operator\">=</span> pickle<span class=\"token punctuation\">.</span>load<span class=\"token punctuation\">(</span><span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"filename.p\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"rb\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 返回一个 dict</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>","more":"<p>以下示例特地使用了数值型的 key:</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token keyword\">import</span> pickle\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> a <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token number\">1.1</span><span class=\"token punctuation\">:</span><span class=\"token number\">1.1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">:</span><span class=\"token number\">2</span><span class=\"token punctuation\">&#125;</span>  <span class=\"token comment\"># 以 float 和 int 作为 key</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token keyword\">import</span> pickle\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> pickle<span class=\"token punctuation\">.</span>dump<span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"data.p\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"wb\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 并不会自动添加后缀名</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> b <span class=\"token operator\">=</span> pickle<span class=\"token punctuation\">.</span>load<span class=\"token punctuation\">(</span><span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"data.p\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"rb\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> b<span class=\"token punctuation\">.</span>keys<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\ndict_keys<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">1.1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> b<span class=\"token punctuation\">[</span><span class=\"token number\">1.1</span><span class=\"token punctuation\">]</span>\n<span class=\"token number\">1.1</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>注意 <code>pickle.load()</code> 返回的类型是 dict, 但\n<code>numpy.load()</code> 读取 '*.npz' 文件所返回是一个可以像 dict\n一样使用 key 来索引数据的 <code>numpy.lib.npyio.NpzFile</code> 对象.</p>\n<p>'*.p' 文件的大小和非压缩的 '*.npz' (<code>numpy.savez()</code>) 一致,\n然而压缩过的 '*.npz' (<code>numpy.savez_compressed()</code>)\n显然占用空间更小, 因此在方便的情况下 (例如 key 是字符串,\n读取后直接操作数据而不需要得到一个 dict), 推荐优先使用 numpy. <br><br>\n如果要存入上述示例中同样的数据到 '*.npz' 格式, 需要转换 key 的类型\n(读取时也需要使用字符串型的 key):</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> a <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>value <span class=\"token keyword\">for</span> key<span class=\"token punctuation\">,</span> value <span class=\"token keyword\">in</span> a<span class=\"token punctuation\">.</span>items<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> a\n<span class=\"token punctuation\">&#123;</span><span class=\"token string\">'1.1'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1.1</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'2'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">&#125;</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> np<span class=\"token punctuation\">.</span>savez_compressed<span class=\"token punctuation\">(</span><span class=\"token string\">'data2'</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">**</span>a<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 会自动添加后缀名, 得到 'data2.npz'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<hr />\n<p>其他数据存取教程:</p>\n<ul>\n<li><a href=\"main.html#4-常见数据文件读写\">Python 简易教程 (lecture for\nSolar Group)</a>\n<ul>\n<li><a href=\"main.html#41-一般情况\">4.1. 一般情况</a></li>\n<li><a href=\"main.html#42-txt-csv-文件读写\">4.2. txt, csv\n文件读写</a></li>\n<li><a href=\"main.html#43-numpy-save-文件读写\">4.3. numpy save\n文件读写</a></li>\n<li><a href=\"main.html#44-idl-sav-文件读取\">4.4. IDL sav\n文件读取</a></li>\n<li><a href=\"main.html#45-fits-文件读取\">4.5. FITS 文件读取</a></li>\n</ul></li>\n<li><a href=\"advance.html#9-其他格式文件读写\">Python 进阶 (lecture for\nSolar Group)</a>\n<ul>\n<li><a href=\"advance.html#91-用-pandas-读-csv\">9.1. 用 pandas 读\ncsv</a></li>\n<li><a href=\"advance.html#92-fortran-二进制文件读写\">9.2. Fortran\n二进制文件读写</a></li>\n<li><a href=\"advance.html#93-hdf5-文件读写-ncdf-cdf-文件读取\">9.3. HDF5\n文件读写, NCDF, CDF 文件读取</a></li>\n<li><a href=\"advance.html#94-numpy-to-vtk\">9.4. NumPy to VTK</a></li>\n<li><a href=\"advance.html#95-matlab-mat-文件读写\">9.5. Matlab mat\n文件读写</a></li>\n</ul></li>\n</ul>"},{"title":"Pandas sep='\\s+' 的问题","date":"2018-12-04T09:00:03.000Z","_content":"\nPandas 的 `read_table` ([官方文档](https://pandas.pydata.org/pandas-docs/stable/generated/pandas.read_table.html))\n和 `read_csv` ([官方文档](https://pandas.pydata.org/pandas-docs/stable/generated/pandas.read_csv.html)) (指定分隔符的情况下两者无区别),\n有关键字 `sep=` (`read_table` 默认为 `sep='\\t'`, `read_csv` 默认为 `sep=','`).\n\n但当需要指定多个空格的情况下, 指定 `sep='\\s+'` 可能无法被正确识别.\n<!-- more -->\n\n请使用 **`' +'`** 代替.\n\n官方文档中关于 `sep` 关键字的说明有如下描述:\n\n> In addition, separators longer than 1 character and\n> **different from ``'\\s+'``** will be interpreted as regular expressions and\n> will also force the use of the Python parsing engine.\n\n指定 `sep='\\s+'` 可能无法被正确识别, \n\n暂时的办法是:<br>\n加上参数 `engine='python'`, 或使用 **`' +'`** 代替 (此时 `engine='python'`).<br>\n如果设为 `engine='c'`, 速度较快, 但不便识别正则表达, 追求效率的话可以配合使用:<br>\n`quoting=3` (即使用 `csv.QUOTE_NONE`)\n\n---\n\nPandas 的读取方法简单介绍参见:\n[用 pandas 读 csv](advance.html#91-用-pandas-读-csv)","source":"_posts/2018-12-04-pandas-sep.md","raw":"---\ntitle: \"Pandas sep='\\\\s+' 的问题\"\ncategories: 'Solar Physics'\ntags: [python, pandas]\ndate: 2018-12-04 17:00:03\n---\n\nPandas 的 `read_table` ([官方文档](https://pandas.pydata.org/pandas-docs/stable/generated/pandas.read_table.html))\n和 `read_csv` ([官方文档](https://pandas.pydata.org/pandas-docs/stable/generated/pandas.read_csv.html)) (指定分隔符的情况下两者无区别),\n有关键字 `sep=` (`read_table` 默认为 `sep='\\t'`, `read_csv` 默认为 `sep=','`).\n\n但当需要指定多个空格的情况下, 指定 `sep='\\s+'` 可能无法被正确识别.\n<!-- more -->\n\n请使用 **`' +'`** 代替.\n\n官方文档中关于 `sep` 关键字的说明有如下描述:\n\n> In addition, separators longer than 1 character and\n> **different from ``'\\s+'``** will be interpreted as regular expressions and\n> will also force the use of the Python parsing engine.\n\n指定 `sep='\\s+'` 可能无法被正确识别, \n\n暂时的办法是:<br>\n加上参数 `engine='python'`, 或使用 **`' +'`** 代替 (此时 `engine='python'`).<br>\n如果设为 `engine='c'`, 速度较快, 但不便识别正则表达, 追求效率的话可以配合使用:<br>\n`quoting=3` (即使用 `csv.QUOTE_NONE`)\n\n---\n\nPandas 的读取方法简单介绍参见:\n[用 pandas 读 csv](advance.html#91-用-pandas-读-csv)","slug":"pandas-sep","published":1,"updated":"2018-12-04T09:00:03.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl5kegawi0012vxgv5zhv4lok","content":"<p>Pandas 的 <code>read_table</code> (<a\nhref=\"https://pandas.pydata.org/pandas-docs/stable/generated/pandas.read_table.html\">官方文档</a>)\n和 <code>read_csv</code> (<a\nhref=\"https://pandas.pydata.org/pandas-docs/stable/generated/pandas.read_csv.html\">官方文档</a>)\n(指定分隔符的情况下两者无区别), 有关键字 <code>sep=</code>\n(<code>read_table</code> 默认为 <code>sep='\\t'</code>,\n<code>read_csv</code> 默认为 <code>sep=','</code>).</p>\n<p>但当需要指定多个空格的情况下, 指定 <code>sep='\\s+'</code>\n可能无法被正确识别. <span id=\"more\"></span></p>\n<p>请使用 <strong><code>' +'</code></strong> 代替.</p>\n<p>官方文档中关于 <code>sep</code> 关键字的说明有如下描述:</p>\n<blockquote>\n<p>In addition, separators longer than 1 character and <strong>different\nfrom <code>'\\s+'</code></strong> will be interpreted as regular\nexpressions and will also force the use of the Python parsing\nengine.</p>\n</blockquote>\n<p>指定 <code>sep='\\s+'</code> 可能无法被正确识别,</p>\n<p>暂时的办法是:<br> 加上参数 <code>engine='python'</code>, 或使用\n<strong><code>' +'</code></strong> 代替 (此时\n<code>engine='python'</code>).<br> 如果设为 <code>engine='c'</code>,\n速度较快, 但不便识别正则表达, 追求效率的话可以配合使用:<br>\n<code>quoting=3</code> (即使用 <code>csv.QUOTE_NONE</code>)</p>\n<hr />\n<p>Pandas 的读取方法简单介绍参见: <a\nhref=\"advance.html#91-用-pandas-读-csv\">用 pandas 读 csv</a></p>\n","site":{"data":{}},"excerpt":"<p>Pandas 的 <code>read_table</code> (<a\nhref=\"https://pandas.pydata.org/pandas-docs/stable/generated/pandas.read_table.html\">官方文档</a>)\n和 <code>read_csv</code> (<a\nhref=\"https://pandas.pydata.org/pandas-docs/stable/generated/pandas.read_csv.html\">官方文档</a>)\n(指定分隔符的情况下两者无区别), 有关键字 <code>sep=</code>\n(<code>read_table</code> 默认为 <code>sep='\\t'</code>,\n<code>read_csv</code> 默认为 <code>sep=','</code>).</p>\n<p>但当需要指定多个空格的情况下, 指定 <code>sep='\\s+'</code>\n可能无法被正确识别.","more":"</p>\n<p>请使用 <strong><code>' +'</code></strong> 代替.</p>\n<p>官方文档中关于 <code>sep</code> 关键字的说明有如下描述:</p>\n<blockquote>\n<p>In addition, separators longer than 1 character and <strong>different\nfrom <code>'\\s+'</code></strong> will be interpreted as regular\nexpressions and will also force the use of the Python parsing\nengine.</p>\n</blockquote>\n<p>指定 <code>sep='\\s+'</code> 可能无法被正确识别,</p>\n<p>暂时的办法是:<br> 加上参数 <code>engine='python'</code>, 或使用\n<strong><code>' +'</code></strong> 代替 (此时\n<code>engine='python'</code>).<br> 如果设为 <code>engine='c'</code>,\n速度较快, 但不便识别正则表达, 追求效率的话可以配合使用:<br>\n<code>quoting=3</code> (即使用 <code>csv.QUOTE_NONE</code>)</p>\n<hr />\n<p>Pandas 的读取方法简单介绍参见: <a\nhref=\"advance.html#91-用-pandas-读-csv\">用 pandas 读 csv</a></p>"},{"title":"Coming back soon ...","date":"2022-07-12T15:39:03.000Z","sticky":100,"_content":"I'm keep on restoring my old posts, as the original site has not been accessable for quit a long time.\n\nSee you later~","source":"_posts/2022-07-12-Coming-back-soon.md","raw":"---\ntitle: \"Coming back soon ...\"\ndate: 2022-07-12 23:39:03\nsticky: 100\n---\nI'm keep on restoring my old posts, as the original site has not been accessable for quit a long time.\n\nSee you later~","slug":"Coming-back-soon","published":1,"updated":"2022-07-12T15:39:03.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl5kegawk0015vxgv2xsx85wn","content":"<p>I'm keep on restoring my old posts, as the original site has not been\naccessable for quit a long time.</p>\n<p>See you later~</p>\n","site":{"data":{}},"excerpt":"","more":"<p>I'm keep on restoring my old posts, as the original site has not been\naccessable for quit a long time.</p>\n<p>See you later~</p>\n"}],"PostAsset":[{"_id":"source/_posts/2018-07-02-advance/Screenshot_20180617-181206.png","post":"cl5kegavj0001vxgv4b6o07o3","slug":"Screenshot_20180617-181206.png","modified":1,"renderable":1},{"_id":"source/_posts/2018-07-02-advance/Screenshot_20180618-151438.png","post":"cl5kegavj0001vxgv4b6o07o3","slug":"Screenshot_20180618-151438.png","modified":1,"renderable":1},{"_id":"source/_posts/2018-07-02-advance/advance_205_0.png","post":"cl5kegavj0001vxgv4b6o07o3","slug":"advance_205_0.png","modified":1,"renderable":1},{"_id":"source/_posts/2018-07-02-advance/advance_279_1.png","post":"cl5kegavj0001vxgv4b6o07o3","slug":"advance_279_1.png","modified":1,"renderable":1},{"_id":"source/_posts/2018-07-02-advance/advance_283_0.png","post":"cl5kegavj0001vxgv4b6o07o3","slug":"advance_283_0.png","modified":1,"renderable":1},{"_id":"source/_posts/2018-07-02-advance/advance_285_0.png","post":"cl5kegavj0001vxgv4b6o07o3","slug":"advance_285_0.png","modified":1,"renderable":1},{"_id":"source/_posts/2018-07-02-advance/anatomy.png","post":"cl5kegavj0001vxgv4b6o07o3","slug":"anatomy.png","modified":1,"renderable":1},{"_id":"source/_posts/2018-07-02-advance/nbtutor1.png","post":"cl5kegavj0001vxgv4b6o07o3","slug":"nbtutor1.png","modified":1,"renderable":1},{"_id":"source/_posts/2018-07-02-advance/nbtutor2.png","post":"cl5kegavj0001vxgv4b6o07o3","slug":"nbtutor2.png","modified":1,"renderable":1},{"_id":"source/_posts/2018-07-02-advance/nbtutor3.png","post":"cl5kegavj0001vxgv4b6o07o3","slug":"nbtutor3.png","modified":1,"renderable":1},{"_id":"source/_posts/2018-07-02-advance/nbtutor4.png","post":"cl5kegavj0001vxgv4b6o07o3","slug":"nbtutor4.png","modified":1,"renderable":1},{"_id":"source/_posts/2018-07-02-advance/nbtutor5.png","post":"cl5kegavj0001vxgv4b6o07o3","slug":"nbtutor5.png","modified":1,"renderable":1},{"_id":"source/_posts/2018-07-02-advance/scope_resolution_1.png","post":"cl5kegavj0001vxgv4b6o07o3","slug":"scope_resolution_1.png","modified":1,"renderable":1},{"_id":"source/_posts/2018-07-02-advance/tut_a_2.png","post":"cl5kegavj0001vxgv4b6o07o3","slug":"tut_a_2.png","modified":1,"renderable":1},{"_id":"source/_posts/2018-07-02-main/Canopy-Packages-min-1.png","post":"cl5kegawe000xvxgv8jcbb1cn","slug":"Canopy-Packages-min-1.png","modified":1,"renderable":1},{"_id":"source/_posts/2018-07-02-main/Conda — Conda documentation.png","post":"cl5kegawe000xvxgv8jcbb1cn","slug":"Conda — Conda documentation.png","modified":1,"renderable":1},{"_id":"source/_posts/2018-07-02-main/Conda-DistributionDiagram-01.png","post":"cl5kegawe000xvxgv8jcbb1cn","slug":"Conda-DistributionDiagram-01.png","modified":1,"renderable":1},{"_id":"source/_posts/2018-07-02-main/DataScienceLibraries-01.png","post":"cl5kegawe000xvxgv8jcbb1cn","slug":"DataScienceLibraries-01.png","modified":1,"renderable":1},{"_id":"source/_posts/2018-07-02-main/IPython.png","post":"cl5kegawe000xvxgv8jcbb1cn","slug":"IPython.png","modified":1,"renderable":1},{"_id":"source/_posts/2018-07-02-main/Matplotlib.png","post":"cl5kegawe000xvxgv8jcbb1cn","slug":"Matplotlib.png","modified":1,"renderable":1},{"_id":"source/_posts/2018-07-02-main/Python Developers Survey 2017 - Results-018.png","post":"cl5kegawe000xvxgv8jcbb1cn","slug":"Python Developers Survey 2017 - Results-018.png","modified":1,"renderable":1},{"_id":"source/_posts/2018-07-02-main/Python Developers Survey 2017 - Results-019.png","post":"cl5kegawe000xvxgv8jcbb1cn","slug":"Python Developers Survey 2017 - Results-019.png","modified":1,"renderable":1},{"_id":"source/_posts/2018-07-02-main/Python Developers Survey 2017 - Results-020.png","post":"cl5kegawe000xvxgv8jcbb1cn","slug":"Python Developers Survey 2017 - Results-020.png","modified":1,"renderable":1},{"_id":"source/_posts/2018-07-02-main/SciPy.png","post":"cl5kegawe000xvxgv8jcbb1cn","slug":"SciPy.png","modified":1,"renderable":1},{"_id":"source/_posts/2018-07-02-main/Screenshot_20180625-005924.png","post":"cl5kegawe000xvxgv8jcbb1cn","slug":"Screenshot_20180625-005924.png","modified":1,"renderable":1},{"_id":"source/_posts/2018-07-02-main/annotation_demo2_00.png","post":"cl5kegawe000xvxgv8jcbb1cn","slug":"annotation_demo2_00.png","modified":1,"renderable":1},{"_id":"source/_posts/2018-07-02-main/astropy_banner.svg","post":"cl5kegawe000xvxgv8jcbb1cn","slug":"astropy_banner.svg","modified":1,"renderable":1},{"_id":"source/_posts/2018-07-02-main/contour_demo_05.png","post":"cl5kegawe000xvxgv8jcbb1cn","slug":"contour_demo_05.png","modified":1,"renderable":1},{"_id":"source/_posts/2018-07-02-main/jupyterlab.png","post":"cl5kegawe000xvxgv8jcbb1cn","slug":"jupyterlab.png","modified":1,"renderable":1},{"_id":"source/_posts/2018-07-02-main/jupyterlogo.png","post":"cl5kegawe000xvxgv8jcbb1cn","slug":"jupyterlogo.png","modified":1,"renderable":1},{"_id":"source/_posts/2018-07-02-main/logo-large.72ad8bf1.svg","post":"cl5kegawe000xvxgv8jcbb1cn","slug":"logo-large.72ad8bf1.svg","modified":1,"renderable":1},{"_id":"source/_posts/2018-07-02-main/main_126_1.png","post":"cl5kegawe000xvxgv8jcbb1cn","slug":"main_126_1.png","modified":1,"renderable":1},{"_id":"source/_posts/2018-07-02-main/named_colors.png","post":"cl5kegawe000xvxgv8jcbb1cn","slug":"named_colors.png","modified":1,"renderable":1},{"_id":"source/_posts/2018-07-02-main/nbviewer.png","post":"cl5kegawe000xvxgv8jcbb1cn","slug":"nbviewer.png","modified":1,"renderable":1},{"_id":"source/_posts/2018-07-02-main/pycharm.jpg","post":"cl5kegawe000xvxgv8jcbb1cn","slug":"pycharm.jpg","modified":1,"renderable":1},{"_id":"source/_posts/2018-07-02-main/scikitlogo.png","post":"cl5kegawe000xvxgv8jcbb1cn","slug":"scikitlogo.png","modified":1,"renderable":1},{"_id":"source/_posts/2018-07-02-main/skimage01.png","post":"cl5kegawe000xvxgv8jcbb1cn","slug":"skimage01.png","modified":1,"renderable":1},{"_id":"source/_posts/2018-07-02-main/sphx_glr_lat_lon_lines_001.png","post":"cl5kegawe000xvxgv8jcbb1cn","slug":"sphx_glr_lat_lon_lines_001.png","modified":1,"renderable":1},{"_id":"source/_posts/2018-07-02-main/sphx_glr_submaps_and_cropping_001.png","post":"cl5kegawe000xvxgv8jcbb1cn","slug":"sphx_glr_submaps_and_cropping_001.png","modified":1,"renderable":1}],"PostCategory":[{"post_id":"cl5kegavj0001vxgv4b6o07o3","category_id":"cl5kegavr0004vxgv6ma09ixa","_id":"cl5kegaw5000bvxgv0m02b4bd"},{"post_id":"cl5kegavm0003vxgv2lqjf5w9","category_id":"cl5kegavr0004vxgv6ma09ixa","_id":"cl5kegaw7000dvxgv63fk16kq"},{"post_id":"cl5kegawe000xvxgv8jcbb1cn","category_id":"cl5kegavr0004vxgv6ma09ixa","_id":"cl5kegawj0013vxgv46pberu3"},{"post_id":"cl5kegawf000yvxgv46k4bg2k","category_id":"cl5kegavr0004vxgv6ma09ixa","_id":"cl5kegawl0016vxgv6fim64dv"},{"post_id":"cl5kegawh0010vxgve3x76euv","category_id":"cl5kegavr0004vxgv6ma09ixa","_id":"cl5kegawm0019vxgv0cfjeyuo"},{"post_id":"cl5kegawi0012vxgv5zhv4lok","category_id":"cl5kegavr0004vxgv6ma09ixa","_id":"cl5kegawn001avxgvao5bc9e7"}],"PostTag":[{"post_id":"cl5kegavj0001vxgv4b6o07o3","tag_id":"cl5kegavx0005vxgv8ft3e213","_id":"cl5kegaw8000hvxgvbh3m6rxo"},{"post_id":"cl5kegavj0001vxgv4b6o07o3","tag_id":"cl5kegaw2000avxgv2dwg33sq","_id":"cl5kegaw8000ivxgv0zqudegq"},{"post_id":"cl5kegavj0001vxgv4b6o07o3","tag_id":"cl5kegaw6000cvxgv9ljr2st8","_id":"cl5kegaw9000kvxgvefs134b2"},{"post_id":"cl5kegavj0001vxgv4b6o07o3","tag_id":"cl5kegaw7000evxgvhdmm4ftb","_id":"cl5kegaw9000lvxgv7q4rbmlt"},{"post_id":"cl5kegavj0001vxgv4b6o07o3","tag_id":"cl5kegaw7000fvxgvbsn18px2","_id":"cl5kegaw9000nvxgv1of29t8j"},{"post_id":"cl5kegavm0003vxgv2lqjf5w9","tag_id":"cl5kegavx0005vxgv8ft3e213","_id":"cl5kegawb000rvxgv99488nkc"},{"post_id":"cl5kegavm0003vxgv2lqjf5w9","tag_id":"cl5kegaw2000avxgv2dwg33sq","_id":"cl5kegawb000svxgve1wy0fwd"},{"post_id":"cl5kegavm0003vxgv2lqjf5w9","tag_id":"cl5kegaw6000cvxgv9ljr2st8","_id":"cl5kegawb000tvxgv5af4hh0a"},{"post_id":"cl5kegavm0003vxgv2lqjf5w9","tag_id":"cl5kegaw7000evxgvhdmm4ftb","_id":"cl5kegawb000uvxgvba564uqr"},{"post_id":"cl5kegavm0003vxgv2lqjf5w9","tag_id":"cl5kegaw7000fvxgvbsn18px2","_id":"cl5kegawc000vvxgv456d7pd8"},{"post_id":"cl5kegavm0003vxgv2lqjf5w9","tag_id":"cl5kegawa000qvxgvfd9nf8kt","_id":"cl5kegawc000wvxgvd4ondb08"},{"post_id":"cl5kegawe000xvxgv8jcbb1cn","tag_id":"cl5kegavx0005vxgv8ft3e213","_id":"cl5kegawh000zvxgvbi8e8iu0"},{"post_id":"cl5kegawe000xvxgv8jcbb1cn","tag_id":"cl5kegaw6000cvxgv9ljr2st8","_id":"cl5kegawi0011vxgve4dd6uzd"},{"post_id":"cl5kegawf000yvxgv46k4bg2k","tag_id":"cl5kegavx0005vxgv8ft3e213","_id":"cl5kegawj0014vxgv7pcv9hv0"},{"post_id":"cl5kegawh0010vxgve3x76euv","tag_id":"cl5kegavx0005vxgv8ft3e213","_id":"cl5kegawm0018vxgv0ztd4ya7"},{"post_id":"cl5kegawi0012vxgv5zhv4lok","tag_id":"cl5kegavx0005vxgv8ft3e213","_id":"cl5kegawn001bvxgv207r22vs"},{"post_id":"cl5kegawi0012vxgv5zhv4lok","tag_id":"cl5kegawl0017vxgvbqjsa0yl","_id":"cl5kegawn001cvxgvcd17411e"}],"Tag":[{"name":"python","_id":"cl5kegavx0005vxgv8ft3e213"},{"name":"conda","_id":"cl5kegaw2000avxgv2dwg33sq"},{"name":"jupyter","_id":"cl5kegaw6000cvxgv9ljr2st8"},{"name":"astropy","_id":"cl5kegaw7000evxgvhdmm4ftb"},{"name":"sunpy","_id":"cl5kegaw7000fvxgvbsn18px2"},{"name":"install","_id":"cl5kegawa000qvxgvfd9nf8kt"},{"name":"pandas","_id":"cl5kegawl0017vxgvbqjsa0yl"}]}}